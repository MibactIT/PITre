<?xml version="1.0" encoding="utf-8" ?>
<?xml-stylesheet type="text/xsl" href="queryListStyle.xsl"?>
<listeQuery>
  <query>
    <name>U_SIGN_PREFERENCE</name>
    <value>
      UPDATE PEOPLE SET CHA_TIPO_FIRMA = '@param2@' WHERE SYSTEM_ID = @param1@
    </value>
  </query>
  <query>
    <name>S_CONFIG_CACHE</name>
    <value>
      SELECT * from  DPA_CONFIG_CACHE
      where idAmministrazione = @idAmministrazione@
    </value>
  </query>
  <query>
    <name>I_CONFIG_CACHE</name>
    <value>
      INSERT INTO DPA_CONFIG_CACHE
      (idAmministrazione
      ,caching
      ,massima_dimensione_caching
      ,massima_dimensione_file
      ,doc_root_server
      ,ora_inizio_cache
      ,ora_fine_cache
      ,urlwscaching
      ,url_ws_caching_locale
      ,doc_root_server_locale)
      VALUES
      (@idAmministrazione@
      ,@caching@
      ,@massima_dimensione_caching@
      ,@massima_dimensione_file@
      ,@doc_root_server@
      ,@ora_inizio_cache@
      ,@ora_fine_cache@
      ,@urlwscaching@
      ,@urlwscachinglocale@
      ,@doc_root_server_locale@
      )
    </value>
  </query>
  <query>
    <name>S_VERIFICA_FILE_IN_CACHE</name>
    <value>
      SELECT PATHCACHE FROM DPA_CACHE
      WHERE DOCNUMBER =@docnumber@ AND
      VERSION_ID= @version_id@ AND
      idAmministrazione = @idAmministrazione@
    </value>
  </query>
  <query>
    <name>S_FILE_IN_CACHE</name>
    <value>
      SELECT * FROM DPA_CACHE
      WHERE DOCNUMBER =@docnumber@
    </value>
  </query>
  <query>
    <name>S_COMPONENTS_FILE</name>
    <value>
      SELECT isnull(PATH,'')PATH
      ,isnull(LOCKED,'')LOCKED
      ,isnull(COMPTYPE,'')COMPTYPE
      ,VERSION_ID
      ,DOCNUMBER
      ,FILE_SIZE
      ,isnull(ALTERNATE_PATH,'')ALTERNATE_PATH
      ,isnull(VAR_IMPRONTA,'')VAR_IMPRONTA
      ,isnull(EXT,'')EXT
      ,isnull(CHA_FIRMATO,'')CHA_FIRMATO
      FROM COMPONENTS
      WHERE DOCNUMBER =@docnumber@ AND
      VERSION_ID= @version_id@
    </value>
  </query>
  <query>
    <name>S_INFOUTENTE</name>
    <value>
      SELECT A.GROUPS_SYSTEM_ID,B.system_id,B.user_id, B.ID_AMM
      FROM  PEOPLEGROUPS AS A INNER JOIN PEOPLE AS B ON
      A.PEOPLE_SYSTEM_ID = B.SYSTEM_ID
      WHERE user_id = @user_id@
    </value>
  </query>
  <query>
    <name>U_CONFIG_CACHE</name>
    <value>
      UPDATE DPA_CONFIG_CACHE
      SET idAmministrazione = @idAmministrazione@
      ,caching = @caching@
      ,massima_dimensione_caching = @massima_dimensione_caching@
      ,massima_dimensione_file = @massima_dimensione_file@
      ,doc_root_server = @doc_root_server@
      ,ora_inizio_cache = @ora_inizio_cache@
      ,ora_fine_cache = @ora_fine_cache@
      ,urlwscaching = @urlwscaching@
      ,url_ws_caching_locale = @urlwscachinglocale@
      ,doc_root_server_locale = @doc_root_server_locale@
      WHERE idAmministrazione = @idAmministrazione@
    </value>
  </query>
  <query>
    <name>D_CONFIG_CACHE</name>
    <value>
      DELETE FROM DPA_CONFIG_CACHE
      WHERE idAmministrazione = @idAmministrazione@
    </value>
  </query>
  <query>
    <name>S_CACHE</name>
    <value>
      SELECT A.DOCNUMBER
      ,A.PATHCACHE
      ,A.idAmministrazione
      ,A.AGGIORNATO
      ,A.FILE_SIZE
      ,A.VERSION_ID
      FROM DPA_CACHE as a
      where a.idAmministrazione = @idAmministrazione@
      and a.AGGIORNATO = @aggiornato@
      order by LAST_ACCESS, file_size asc
    </value>
  </query>
  <query>
    <name>S_CACHE_DA_TRASFERIRE</name>
    <value>
      SELECT *
      FROM DPA_CACHE as a
      where a.idAmministrazione = @idAmministrazione@
      and a.AGGIORNATO = @aggiornato@
      order by file_size
    </value>
  </query>
  <query>
    <name>S_CACHE_ALL</name>
    <value>
      SELECT *
      FROM DPA_CACHE as a
      where a.DOCNUMBER = @docnumber@ and a.idAmministrazione = @idAmministrazione@
      and a.VERSION_ID = @version_id@
    </value>
  </query>
  <query>
    <name>S_CACHE_BY_DOCNUMBER</name>
    <value>
      SELECT *
      FROM DPA_CACHE as a
      where a.DOCNUMBER = @docnumber@
      order by version_id desc
    </value>
  </query>
  <query>
    <name>S_CACHE_MAX_VESIONE</name>
    <value>
      select pathcache, ext, max(version_id) as version_id
      from dpa_cache
      where docnumber = @docnumber@
      group by pathcache, ext
    </value>
  </query>
  <query>
    <name>S_CACHE_MAX_VESIONE_COMPONENTS</name>
    <value>
      select path, ext, max(version_id) as version_id
      from components
      where docnumber = @docnumber@
      group by path, ext
    </value>
  </query>
  <query>
    <name>VERIFICA_FILE_IN_CACHE_CON_VERISON_ID</name>
    <value>
      SELECT *
      FROM DPA_CACHE as a
      where a.DOCNUMBER = @docnumber@ and
      a.version_id = @versionId@
    </value>
  </query>
  <query>
    <name>DELETE_CACHE</name>
    <value>
      DELETE FROM DPA_CACHE
      WHERE DOCNUMBER = @docnumber@
      AND idAmministrazione = @idAmministrazione@
      AND AGGIORNATO = @aggiornato@
    </value>
  </query>
  <query>
    <name>U_CACHE_COMPONENTS</name>
    <value>
      UPDATE COMPONENTS
      SET PATH = @PATH@
      ,LOCKED = @LOCKED@
      ,COMPTYPE = @COMPTYPE@
      ,VERSION_ID = @VERSION_ID@
      ,DOCNUMBER = @DOCNUMBER@
      ,FILE_SIZE = @FILE_SIZE@
      ,ALTERNATE_PATH = @ALTERNATE_PATH@
      ,VAR_IMPRONTA = @VAR_IMPRONTA@
      ,EXT = @EXT@
      WHERE DOCNUMBER = @DOCNUMBER@
      and VERSION_ID = @VERSION_ID@
    </value>
  </query>
  <query>
    <name>U_CACHE</name>
    <value>
      UPDATE DPA_CACHE SET
      DOCNUMBER = @docnumber@,
      PATHCACHE = @pathcache@,
      idAmministrazione = @idAmministrazione@,
      AGGIORNATO = @aggiornato@,
      VERSION_ID = @version_id@,
      LOCKED = @loked@,
      COMPTYPE = @comptype@,
      FILE_SIZE = @file_size@,
      ALTERNATE_PATH = @alternate_path@,
      VAR_IMPRONTA = @var_impronta@,
      LAST_ACCESS = @data@,
      EXT = @ext@
      WHERE
      DOCNUMBER = @docnumber@
      and idAmministrazione = @idAmministrazione@
      and VERSION_ID = @version_id@
    </value>
  </query>
  <query>
    <name>I_CACHE</name>
    <value>
      INSERT INTO DPA_CACHE
      (
      DOCNUMBER,
      PATHCACHE,
      idAmministrazione,
      AGGIORNATO,
      VERSION_ID,
      LOCKED,
      COMPTYPE,
      FILE_SIZE,
      ALTERNATE_PATH,
      VAR_IMPRONTA,
      EXT,
      LAST_ACCESS
      )
      VALUES
      (
      @docnumber@,
      @pathcache@,
      @idAmministrazione@,
      @aggiornato@,
      @version_id@,
      @loked@,
      @comptype@,
      @file_size@,
      @alternate_path@,
      @var_impronta@,
      @ext@,
      @data@
      )
    </value>
  </query>
  <query>
    <name>GET_ID_AMM_BY_DOC_NUMER</name>
    <value>
      select idamm from
      profile where docnumber = @docnumber@
    </value>
  </query>
  <query>
    <name>GET_DOCNUMER_BY_SEGNATURA</name>
    <value>
      select DOCNUMBER from PROFILE WITH(NOLOCK) where VAR_SEGNATURA = @segnatura@
    </value>
  </query>

  <!--fine modifica-->

  <query>
    <name>S_DPA_UTENTE</name>
    <value>
      SELECT * FROM PEOPLE WHERE SYSTEM_ID = @idUtente@
    </value>
  </query>
  <query>
    <name>S_DPA_RUOLO</name>
    <value>
      SELECT
      CG.SYSTEM_ID,
      CG.ID_REGISTRO,
      CG.ID_AMM,
      CG.VAR_COD_RUBRICA,
      CG.VAR_DESC_CORR,
      CG.ID_OLD,
      CG.DTA_FINE,
      TR.NUM_LIVELLO,
      CG.VAR_CODICE,
      CG.ID_GRUPPO,
      CG.CHA_TIPO_CORR,
      CG.CHA_TIPO_IE,
      CG.CHA_TIPO_URP,
      CG.VAR_CODICE_AOO,
      CG.VAR_CODICE_AMM,
      CG.VAR_CODICE_ISTAT,
      CG.VAR_EMAIL,
      CG.CHA_DISABLED_TRASM,
      CG.ID_UO
      FROM DPA_CORR_GLOBALI CG, DPA_TIPO_RUOLO TR
      WHERE CG.SYSTEM_ID = @idCorrGlobali@
      AND CG.ID_TIPO_RUOLO = TR.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>UPD_TRASM_UTENTE_RIMOSSO_DAL_RUOLO</name>
    <value>
      UPDATE DPA_TRASM_UTENTE SET CHA_IN_TODOLIST = '0'
      , DTA_RIMOZIONE_TODOLIST = @param1@
      WHERE system_id in(
      SELECT   c.system_id
      FROM dpa_trasmissione a,
      dpa_trasm_singola b,
      dpa_trasm_utente c WITH (nolock),
      dpa_ragione_trasm d
      WHERE a.system_id = b.id_trasmissione
      AND b.system_id = c.id_trasm_singola
      AND a.dta_invio IS NOT NULL
      AND b.id_corr_globale IN (@param2@) and b.cha_tipo_dest='R'
      AND (a.cha_tipo_oggetto = 'D' OR a.cha_tipo_oggetto = 'F')
      AND b.id_ragione = d.system_id
      AND c.id_people   IN (@param3@)  and c.cha_in_todolist='1'
      )
    </value>
  </query>
  <query>
    <name>I_DELETED_SECURITY_ACCESSRIGHT20</name>
    <value>
      INSERT INTO DELETED_SECURITY
      (THING, PERSONORGROUP, ACCESSRIGHTS,
      ID_GRUPPO_TRASM, CHA_TIPO_DIRITTO, NOTE, DTA_REVOCA,
      ID_UTENTE_REV, ID_RUOLO_REV, HIDE_DOC_VERSIONS,
      CHA_COPIA_VISIBILITA)
      (
      SELECT S.THING, S.PERSONORGROUP, S.ACCESSRIGHTS,
      S.ID_GRUPPO_TRASM, S.CHA_TIPO_DIRITTO,
      'Visibilita'' rimossa dall''amministratore per mancanza di utenti nel ruolo',
      @date@,null ,null , S.HIDE_DOC_VERSIONS, S.CHA_COPIA_VISIBILITA
      FROM SECURITY S
      WHERE PERSONORGROUP = @idGruppo@ and ACCESSRIGHTS=20
      )
    </value>
  </query>
  <query>
    <name>D_SECURITY_ACCESSRIGHT20</name>
    <value>
      DELETE FROM SECURITY
      WHERE PERSONORGROUP = @idGruppo@ and ACCESSRIGHTS=20
    </value>
  </query>
  <query>
    <name>S_AMM_APPARTENENZA_UTENTE</name>
    <value>
      SELECT
      a.SYSTEM_ID as ID, a.VAR_CODICE_AMM as CODICE, a.VAR_DESC_AMM as DESCR
      FROM
      PEOPLE p, DPA_AMMINISTRA a
      WHERE
      p.ID_AMM = a.SYSTEM_ID
      AND p.USER_ID = '@param1@'
    </value>
  </query>
  <query>
    <name>PD_GET_RUOLI_TIPO_DOC</name>
    <value>
      SELECT * FROM DPA_VIS_TIPO_DOC
      WHERE
      ID_TIPO_DOC = @idTipoDoc@
    </value>
  </query>
  <query>
    <name>PD_INSERT_ASS_DOC_RUOLI</name>
    <value>
      INSERT INTO DPA_VIS_TIPO_DOC
      (
      @colID@
      ID_TIPO_DOC,
      ID_RUOLO,
      DIRITTI
      )
      VALUES
      (
      @id@
      @idTipoDoc@,
      @idRuolo@,
      @diritti@
      )
    </value>
  </query>
  <query>
    <name>PD_DELETE_ASS_DOC_RUOLI</name>
    <value>
      DELETE FROM DPA_VIS_TIPO_DOC
      WHERE
      ID_TIPO_DOC = @idTipoDoc@
    </value>
  </query>
  <query>
    <name>U_LOGIN_AMM</name>
    <value>
      UPDATE DPA_LOGIN
      SET DTA_CONNESSIONE=@param1@,SESSION_ID='@param2@'
      WHERE USER_ID = '@param3@'
    </value>
  </query>
  <!--ADP modifica con aggiunta selezione per Sistema_Proprietario di competenza-->
  <query>
    <name>PD_GET_TIPOATTO_INS_RIC</name>
    <value>
      SELECT DISTINCT DPA_TIPO_ATTO.SYSTEM_ID, VAR_DESC_ATTO
      FROM DPA_TIPO_ATTO, DPA_VIS_TIPO_DOC
      WHERE
      (ID_AMM = @param2@ OR ID_AMM IS NULL) AND
      @paramInEsercizio@
      DPA_TIPO_ATTO.SYSTEM_ID = DPA_VIS_TIPO_DOC.ID_TIPO_DOC AND
      DPA_VIS_TIPO_DOC.ID_RUOLO = 0
      @iperdocumento_and@
      UNION

      SELECT DISTINCT DPA_TIPO_ATTO.SYSTEM_ID, VAR_DESC_ATTO
      FROM DPA_TIPO_ATTO, DPA_VIS_TIPO_DOC
      WHERE
      (ID_AMM = @param2@ OR ID_AMM IS NULL) AND
      @paramInEsercizio@
      DPA_TIPO_ATTO.SYSTEM_ID = DPA_VIS_TIPO_DOC.ID_TIPO_DOC AND
      DPA_VIS_TIPO_DOC.ID_RUOLO = @param3@ AND DPA_VIS_TIPO_DOC.DIRITTI
      @param4@
      @iperdocumento_and@
      @iperdocumento_or@
      ORDER BY @param1@
    </value>
  </query>
  <query>
    <name>PD_GET_RUOLI_BY_AMM</name>
    <value>
      SELECT DPA_CORR_GLOBALI.SYSTEM_ID, DPA_CORR_GLOBALI.ID_GRUPPO, DPA_CORR_GLOBALI.VAR_DESC_CORR, DPA_CORR_GLOBALI.VAR_COD_RUBRICA
      FROM DPA_CORR_GLOBALI
      @tableParam@
      WHERE
      DPA_CORR_GLOBALI.CHA_TIPO_IE = 'I'
      AND
      DPA_CORR_GLOBALI.CHA_TIPO_URP = 'R'
      @param@
      AND
      DPA_CORR_GLOBALI.DTA_FINE is null
      ORDER BY DPA_CORR_GLOBALI.VAR_DESC_CORR ASC
    </value>
  </query>
  <query>
    <name>D_LOGIN_AMM</name>
    <value>
      DELETE FROM DPA_LOGIN
      WHERE USER_ID = '@param1@'
    </value>
  </query>
  <query>
    <name>S_CORR_GLOB_GENERIC</name>
    <value>
      select @param1@
      from dpa_corr_globali
      where @param2@
    </value>
  </query>
  <query>
    <name>S_AMM_LOGIN</name>
    <value>
      select system_id as ID, cha_amministratore as TIPO
      from people
      where user_id = '@param1@'
      and user_password = '@param2@'
      and disabled = 'N'
    </value>
  </query>
  <query>
    <name>S_AMM_LOGIN2</name>
    <value>
      select system_id_registro
      from dpa_useradmin_registri
      where system_id_corr_glob in (select system_id from dpa_corr_globali where id_people = @param1@)
    </value>
  </query>
  <query>
    <name>S_AMM_COD_UNIVOCO</name>
    <value>
      SELECT
      COUNT(*)
      FROM DPA_AMMINISTRA
      WHERE VAR_CODICE_AMM = '@param1@'
    </value>
  </query>
  <query>
    <name>GET_PROJECT_ID_FROM_LINK</name>
    <value>
      SELECT PROJECT_ID
      FROM PROJECT_COMPONENTS
      WHERE
      LINK = @param1@
    </value>
  </query>
  <query>
    <name>LS_IS_UNIQUE_COD</name>
    <value>
      SELECT SYSTEM_ID
      FROM DPA_CORR_GLOBALI
      WHERE ID_AMM = @param2@
      AND VAR_COD_RUBRICA = '@param1@'
    </value>
  </query>
  <query>
    <name>LS_IS_UNIQUE_COD_LISTA</name>
    <value>
      SELECT SYSTEM_ID
      FROM DPA_CORR_GLOBALI
      WHERE CHA_TIPO_URP='L' AND
      ID_AMM = @param2@
      AND VAR_COD_RUBRICA = '@param1@'
    </value>
  </query>
  <query>
    <name>LS_IS_UNIQUE_NOME_LISTA</name>
    <value>
      SELECT SYSTEM_ID
      FROM DPA_CORR_GLOBALI
      WHERE
      CHA_TIPO_URP = 'L'
      AND VAR_DESC_CORR = '@param1@' AND ID_AMM = @param2@
    </value>
  </query>
  <query>
    <name>LS_GET_CODICE_LISTA</name>
    <value>
      SELECT VAR_COD_RUBRICA
      FROM DPA_CORR_GLOBALI
      WHERE
      SYSTEM_ID = @param1@
      AND CHA_TIPO_URP = 'L'
    </value>
  </query>
  <query>
    <name>LS_GET_RUOLO_LISTA</name>
    <value>
      SELECT ID_GRUPPO_LISTE
      FROM DPA_CORR_GLOBALI
      WHERE
      SYSTEM_ID = @param1@
      AND CHA_TIPO_URP = 'L'
    </value>
  </query>
  <query>
    <name>LS_GET_NOME_LISTA</name>
    <value>
      SELECT VAR_DESC_CORR
      FROM DPA_CORR_GLOBALI
      WHERE
      VAR_COD_RUBRICA = '@param1@'
      @param2@
    </value>
  </query>
  <query>
    <name>LS_GET_CORRISPONDENTI_BY_COD_LISTA</name>
    <value>
      SELECT ID_DPA_CORR, L.ID_AMM
      FROM DPA_LISTE_DISTR, DPA_CORR_GLOBALI L,DPA_CORR_GLOBALI C
      WHERE
      L.VAR_COD_RUBRICA = '@param1@' AND
      L.SYSTEM_ID = DPA_LISTE_DISTR.ID_LISTA_DPA_CORR
      AND C.SYSTEM_ID=DPA_LISTE_DISTR.ID_DPA_CORR
      AND C.DTA_FINE IS NULL @param2@
      ORDER BY C.VAR_DESC_CORR ASC
    </value>
  </query>
  <query>
    <name>LS_GET_CORRISPONDENTI_BY_COD_LISTA_BY_UTENTE</name>
    <value>
      SELECT ID_DPA_CORR, L.ID_AMM
      FROM DPA_LISTE_DISTR, DPA_CORR_GLOBALI L,DPA_CORR_GLOBALI C
      WHERE
      L.VAR_COD_RUBRICA = '@param1@'
      AND ((L.id_people_liste=@idPeople@ AND L.id_gruppo_liste is null)  OR (L.id_gruppo_liste=@idGruppo@ AND L.id_people_liste is null)  OR (L.id_people_liste is null AND L.id_gruppo_liste is null))
      AND L.SYSTEM_ID = DPA_LISTE_DISTR.ID_LISTA_DPA_CORR
      AND C.SYSTEM_ID=DPA_LISTE_DISTR.ID_DPA_CORR
      AND C.DTA_FINE IS NULL @param2@
      ORDER BY LTRIM(C.VAR_DESC_CORR) ASC
    </value>
  </query>
  <query>
    <name>LS_GET_LISTE_PER_MODIFICA_UT</name>
    <value>
      SELECT SYSTEM_ID, VAR_DESC_CORR
      FROM DPA_CORR_GLOBALI
      WHERE
      ID_PEOPLE_LISTE = @param1@ AND
      CHA_TIPO_URP = 'L'
      ORDER BY VAR_DESC_CORR
    </value>
  </query>
  <query>
    <name>LS_GET_LISTE_PER_RUOLO_UT</name>
    <value>
      SELECT SYSTEM_ID, VAR_DESC_CORR, VAR_COD_RUBRICA
      FROM DPA_CORR_GLOBALI
      WHERE
      (ID_PEOPLE_LISTE = @param1@ OR ID_GRUPPO_LISTE = @param2@)
      AND CHA_TIPO_URP = 'L'
      ORDER BY VAR_DESC_CORR
    </value>
  </query>
  <query>
    <name>LS_GET_LISTE_1</name>
    <value>
      SELECT SYSTEM_ID, NOME_LISTA
      FROM DPA_ELENCO_LISTE
      WHERE
      (ID_UTENTE = @param1@ AND ID_AMM = @param2@)
      OR
      (ID_UTENTE IS NULL AND ID_AMM = @param2@)
    </value>
  </query>
  <query>
    <name>LS_GET_LISTE_2</name>
    <value>
      SELECT SYSTEM_ID, VAR_DESC_CORR, VAR_COD_RUBRICA
      FROM DPA_CORR_GLOBALI
      WHERE
      ID_AMM = @param1@ AND ID_PEOPLE_LISTE IS NULL
      AND ID_GRUPPO_LISTE IS NULL
      AND CHA_TIPO_URP = 'L'
    </value>
  </query>
  <query>
    <name>LS_GET_LISTE_3</name>
    <value>
      SELECT VAR_COD_RUBRICA, VAR_DESC_CORR
      FROM DPA_CORR_GLOBALI
      WHERE
      @param1@
      (ID_PEOPLE_LISTE IS NULL AND ID_AMM = @param2@))
      AND
      VAR_DESC_CORR LIKE '%@param3@%'
      AND
      CHA_TIPO_URP = 'L'
    </value>
  </query>
  <query>
    <name>LS_DELETE_LISTA</name>
    <value>
      DELETE FROM DPA_CORR_GLOBALI
      WHERE SYSTEM_ID = @param1@ AND
      CHA_TIPO_URP = 'L'
    </value>
  </query>
  <query>
    <name>LS_GET_CORRISPONDENTI_LISTA</name>
    <value>
      SELECT ID_DPA_CORR, VAR_DESC_CORR, VAR_COD_RUBRICA, CHA_TIPO_IE, CHA_DISABLED_TRASM
      FROM DPA_LISTE_DISTR, DPA_CORR_GLOBALI
      WHERE
      DPA_LISTE_DISTR.ID_DPA_CORR = DPA_CORR_GLOBALI.SYSTEM_ID AND
      DPA_LISTE_DISTR.ID_LISTA_DPA_CORR = @param1@
      AND DPA_CORR_GLOBALI.DTA_FINE IS NULL
      ORDER BY VAR_DESC_CORR ASC
    </value>
  </query>
  <query>
    <name>LS_DELETE_CORR_LISTA</name>
    <value>
      DELETE FROM DPA_LISTE_DISTR
      WHERE ID_DPA_CORR = @param1@
    </value>
  </query>
  <query>
    <name>LS_RICERCA_CORR_LISTA</name>
    <value>
      SELECT SYSTEM_ID,VAR_DESC_CORR
      FROM DPA_CORR_GLOBALI
      WHERE
      VAR_DESC_CORR LIKE '%@param1@%' AND CHA_TIPO_IE = 'E'
    </value>
  </query>
  <query>
    <name>LS_SALVA_DPA_ELENCO_LISTE_1</name>
    <value>
      INSERT INTO DPA_CORR_GLOBALI
      (
      @colID@
      ID_REGISTRO,
      ID_AMM,
      VAR_COD_RUBRICA,
      VAR_DESC_CORR,
      ID_PEOPLE_LISTE,
      CHA_TIPO_URP
      )
      VALUES
      (
      @id@
      NULL,
      '@param2@',
      '@param3@',
      '@param1@',
      NULL,
      'L'
      )
    </value>
  </query>
  <query>
    <name>LS_SALVA_DPA_ELENCO_LISTE_2</name>
    <value>
      INSERT INTO DPA_CORR_GLOBALI
      (
      @colID@
      ID_REGISTRO,
      ID_AMM,
      VAR_COD_RUBRICA,
      VAR_DESC_CORR,
      ID_PEOPLE_LISTE,
      CHA_TIPO_URP
      )
      VALUES
      (
      @id@
      NULL,
      '@param3@',
      '@param4@',
      '@param1@',
      '@param2@',
      'L'
      )
    </value>
  </query>
  <query>
    <name>LS_SALVA_DPA_LISTE_DISTR</name>
    <value>
      INSERT INTO DPA_LISTE_DISTR
      (
      @colID@
      ID_LISTA_DPA_CORR,
      ID_DPA_CORR
      )
      VALUES
      (
      @id@
      @param1@,
      @param2@
      )
    </value>
  </query>
  <query>
    <name>LS_SALVA_DPA_ELENCO_LISTE_GRUPPO_1</name>
    <value>
      INSERT INTO DPA_CORR_GLOBALI
      (
      @colID@
      ID_REGISTRO,
      ID_AMM,
      VAR_COD_RUBRICA,
      VAR_DESC_CORR,
      ID_GRUPPO_LISTE,
      CHA_TIPO_URP
      )
      VALUES
      (
      @id@
      NULL,
      '@param2@',
      '@param3@',
      '@param1@',
      NULL,
      'L'
      )
    </value>
  </query>
  <query>
    <name>LS_SALVA_DPA_ELENCO_LISTE_GRUPPO_2</name>
    <value>
      INSERT INTO DPA_CORR_GLOBALI
      (
      @colID@
      ID_REGISTRO,
      ID_AMM,
      VAR_COD_RUBRICA,
      VAR_DESC_CORR,
      ID_GRUPPO_LISTE,
      CHA_TIPO_URP
      )
      VALUES
      (
      @id@
      NULL,
      '@param3@',
      '@param4@',
      '@param1@',
      '@param2@',
      'L'
      )
    </value>
  </query>
  <query>
    <name>LS_MODIFICA_LISTA_1</name>
    <value>
      DELETE FROM DPA_LISTE_DISTR
      WHERE ID_LISTA_DPA_CORR = @param1@
    </value>
  </query>
  <query>
    <name>LS_MODIFICA_LISTA_2</name>
    <value>
      INSERT INTO DPA_LISTE_DISTR
      (
      @colID@
      ID_LISTA_DPA_CORR,
      ID_DPA_CORR
      )
      VALUES
      (
      @id@
      @param1@,
      @param2@
      )
    </value>
  </query>
  <query>
    <name>LS_MODIFICA_LISTA_4</name>
    <value>
      UPDATE DPA_CORR_GLOBALI
      SET VAR_COD_RUBRICA = '@param1@',
      VAR_DESC_CORR = '@param2@',
      ID_PEOPLE_LISTE = NULL,
      ID_GRUPPO_LISTE = @param4@
      WHERE
      SYSTEM_ID = @param3@
    </value>
  </query>
  <query>
    <name>LS_MODIFICA_LISTA_5</name>
    <value>
      UPDATE DPA_CORR_GLOBALI
      SET VAR_COD_RUBRICA = '@param1@',
      VAR_DESC_CORR = '@param2@',
      ID_PEOPLE_LISTE = @param4@,
      ID_GRUPPO_LISTE = NULL
      WHERE
      SYSTEM_ID = @param3@
    </value>
  </query>
  <query>
    <name>LS_MODIFICA_LISTA_3</name>
    <value>
      UPDATE DPA_CORR_GLOBALI
      SET VAR_COD_RUBRICA = '@param1@',
      VAR_DESC_CORR = '@param2@'
      WHERE
      SYSTEM_ID = @param3@
    </value>
  </query>
  <query>
    <name>LS_GET_ID_ELENCO_LISTE_1</name>
    <value>
      SELECT SYSTEM_ID FROM DPA_CORR_GLOBALI
      WHERE
      VAR_DESC_CORR = '@param1@' AND
      ID_PEOPLE_LISTE IS NULL AND
      ID_AMM = '@param3@'
      AND CHA_TIPO_URP = 'L'
    </value>
  </query>
  <query>
    <name>LS_GET_ID_ELENCO_LISTE</name>
    <value>
      SELECT SYSTEM_ID FROM DPA_CORR_GLOBALI
      WHERE
      VAR_DESC_CORR = '@param1@' AND
      ID_PEOPLE_LISTE = '@param2@' AND
      ID_AMM = '@param3@'
      AND CHA_TIPO_URP = 'L'
    </value>
  </query>
  <query>
    <name>GET_CORRISPONDENTE_SEMPLICE</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      A.ID_PEOPLE,
      A.ID_REGISTRO,
      A.ID_AMM,
      A.VAR_DESC_CORR,
      A.VAR_CODICE,
      A.VAR_COD_RUBRICA,
      A.VAR_NOME,
      A.VAR_COGNOME,
      A.CHA_DETTAGLI,
      A.CHA_PA,
      A.CHA_TIPO_URP,
      A.ID_TIPO_RUOLO,
      A.VAR_EMAIL,
      A.VAR_SMTP,
      A.NUM_PORTA_SMTP,
      A.NUM_LIVELLO,
      A.VAR_CODICE_AMM,
      A.VAR_CODICE_AOO,
      A.VAR_CODICE_ISTAT,
      A.ID_PARENT,
      A.ID_UO,
      A.ID_GRUPPO,
      A.DTA_FINE,
      A.CHA_DISABLED_TRASM,
      A.InteropUrl
      FROM
      DPA_CORR_GLOBALI A
      WHERE
      A.SYSTEM_ID=@param1@
      AND ((A.ID_AMM IS NULL) OR (A.ID_AMM='@param2@'))
      AND A.CHA_TIPO_CORR='S'

    </value>
  </query>
  <query>
    <name>S_STORICO_MITT_1</name>
    <value>
      SELECT A.SYSTEM_ID, A.ID_PEOPLE, A.ID_RUOLO_IN_UO,
      A.DTA_MODIFICA AS DTA_MODIFICA,
      B.VAR_DESC_CORR, B.VAR_COD_RUBRICA
      FROM DPA_CORR_STO A, DPA_CORR_globali B
      WHERE A.ID_MITT_DEST = B.SYSTEM_ID AND  A.CHA_TIPO_MITT_DES in ('@param1@')
      AND A.ID_PROFILE = @param2@
    </value>
  </query>

  <query>
    <name>GET_CORRISPONDENTE_SEMPLICE_EST</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      A.ID_PEOPLE,
      A.ID_REGISTRO,
      A.ID_AMM,
      A.VAR_DESC_CORR,
      A.VAR_CODICE,
      A.VAR_COD_RUBRICA,
      A.VAR_NOME,
      A.VAR_COGNOME,
      A.CHA_DETTAGLI,
      A.CHA_PA,
      A.CHA_TIPO_URP,
      A.ID_TIPO_RUOLO,
      A.VAR_EMAIL,
      A.VAR_SMTP,
      A.NUM_PORTA_SMTP,
      A.NUM_LIVELLO,
      A.VAR_CODICE_AMM,
      A.VAR_CODICE_AOO,
      A.VAR_CODICE_ISTAT,
      A.ID_PARENT,
      A.ID_UO,
      A.DTA_FINE,
      A.ID_GRUPPO,
      A.CHA_TIPO_CORR,
      A.CHA_TIPO_IE,
      A.InteropUrl
      FROM
      DPA_CORR_GLOBALI A
      WHERE
      A.SYSTEM_ID=@param1@
      AND ((A.ID_AMM IS NULL) OR (A.ID_AMM='@param2@'))
      AND A.CHA_TIPO_IE='E'
    </value>
  </query>
  <query>
    <name>GET_UTENTE_INTERNO_AOO</name>
    <value>
      SELECT D.ID_GRUPPO
      FROM PEOPLEGROUPS PG, DPA_CORR_GLOBALI D, DPA_L_RUOLO_REG LR
      WHERE
      PG.PEOPLE_SYSTEM_ID = @param1@
      AND LR.ID_REGISTRO = @param2@
      AND D.ID_GRUPPO = PG.GROUPS_SYSTEM_ID
      AND D.SYSTEM_ID = LR.ID_RUOLO_IN_UO
    </value>
  </query>
  <query>
    <name>GET_FOLDER_ROOT</name>
    <value>
      SELECT SYSTEM_ID FROM PROJECT WHERE ID_PARENT=@param1@ AND DESCRIPTION='@param2@'
    </value>
  </query>
  <query>
    <name>GET_TRASMISSIONI_COMPLETE</name>
    <value>
      <!--
			SELECT TU.SYSTEM_ID 
			FROM DPA_TRASMISSIONE T,DPA_TRASM_SINGOLA TS,DPA_TRASM_UTENTE TU,DPA_RAGIONE_TRASM RT 
			WHERE 
			RT.SYSTEM_ID = TS.ID_RAGIONE AND
			TU.ID_TRASM_SINGOLA=TS.SYSTEM_ID AND 
			TS.ID_TRASMISSIONE=T.SYSTEM_ID AND
			RT.CHA_EREDITA &lt; &gt;'0' AND
			( 
			  (RT.CHA_TIPO_RAGIONE='N' AND TU.CHA_VISTA='0') 
			  OR
			  (RT.CHA_TIPO_RAGIONE='W' AND TU.DTA_ACCETTATA IS NULL AND TU.DTA_RISPOSTA IS NULL)
			)
			AND TS.CHA_TIPO_DEST='R'
			AND TS.ID_CORR_GLOBALE = @param1@
			AND TU.ID_PEOPLE= @param2@
			-->
      SELECT C.SYSTEM_ID, B.CHA_TIPO_DEST, B.SYSTEM_ID AS ID_TRASM_SINGOLA
      FROM DPA_TRASMISSIONE A, DPA_TRASM_SINGOLA B, DPA_TRASM_UTENTE C, DPA_RAGIONE_TRASM D
      WHERE A.SYSTEM_ID = B.ID_TRASMISSIONE
      AND B.SYSTEM_ID = C.ID_TRASM_SINGOLA
      AND C.CHA_VALIDA = '1'
      AND A.DTA_INVIO IS NOT NULL
      AND ((B.ID_CORR_GLOBALE = @param1@ AND C.ID_PEOPLE=@param2@) OR B.ID_CORR_GLOBALE=@param3@)
      AND (A.CHA_TIPO_OGGETTO = 'D' OR A.CHA_TIPO_OGGETTO = 'F')
      AND B.ID_RAGIONE = D.SYSTEM_ID
      AND ((D.CHA_TIPO_RAGIONE = 'W' AND C.CHA_ACCETTATA='0' AND C.CHA_RIFIUTATA = '0' AND C.CHA_VALIDA = '1') OR ((D.CHA_TIPO_RAGIONE = 'N' OR D.CHA_TIPO_RAGIONE = 'I') AND C.CHA_VISTA = '0'))
    </value>
  </query>

  <query>
    <name>GET_TRASM_UTENTE_BY_IDTRASM_IDPEOPLE</name>
    <value>
      SELECT COUNT(*) AS TOT FROM DPA_TRASM_UTENTE WHERE ID_TRASM_SINGOLA = @param1@ AND ID_PEOPLE = @param2@
    </value>
  </query>

  <query>
    <name>DELETE_TRASM_UTENTE</name>
    <value>
      DELETE FROM DPA_TRASM_UTENTE WHERE SYSTEM_ID = @param1@ AND ID_PEOPLE = @param1@
    </value>
  </query>

  <query>
    <name>UPDATE_TRASM_UTENTE</name>
    <value>
      UPDATE DPA_TRASM_UTENTE SET ID_PEOPLE = @param1@ WHERE SYSTEM_ID = @param2@
    </value>
  </query>

  <query>
    <name>UPDATE_TRASM_SINGOLA</name>
    <value>
      UPDATE DPA_TRASM_SINGOLA SET ID_CORR_GLOBALE = @param1@ WHERE SYSTEM_ID = @param2@
    </value>
  </query>

  <query>
    <name>UPDATE_TRASM_SECURITY</name>
    <value>
      UPDATE SECURITY
      SET PERSONORGROUP = @param1@
      WHERE PERSONORGROUP = @param2@
      AND CHA_TIPO_DIRITTO = 'T'
    </value>
  </query>

  <query>
    <name>GET_TRASMISSIONI_RUOLO</name>
    <value>
      SELECT * FROM DPA_TRASMISSIONI WHERE ID_RUOLO_IN_UO=@param1@
    </value>
  </query>

  <query>
    <name>GET_TRASMISSIONISINGOLE</name>
    <value>
      SELECT * FROM DPA_TRASM_SINGOLA,DPA_RAGIONE_TRASM WHERE DPA_RAGIONE_TRASM.SYSTEM_ID=DPA_TRASM_SINGOLA.ID_RAGIONE AND ID_TRASMISSIONE=@param1@
    </value>
  </query>

  <query>
    <name>GET_IDUTENTEUO_BY_USERID</name>
    <value>
      SELECT SYSTEM_ID FROM DPA_CORR_GLOBALI WHERE VAR_CODICE = '@param1@' AND ID_AMM=@param2@
    </value>
  </query>

  <query>
    <name>GET_NOMEUTENTE_BY_USERID</name>
    <value>
      SELECT FULL_NAME FROM PEOPLE WHERE user_id = '@param1@'
    </value>
  </query>

  <query>
    <name>GET_UTENTI_CONNESSI</name>
    <value>
      SELECT L.*, P.VAR_COGNOME FROM DPA_LOGIN L, PEOPLE P WHERE L.ID_AMM=@param1@
      AND P.USER_ID = L.USER_ID
      ORDER BY P.VAR_COGNOME ASC
    </value>
  </query>

  <query>
    <name>UNLOCK_USER_LOGIN</name>
    <value>
      DELETE FROM DPA_LOGIN WHERE USER_ID = '@param1@' @param2@
    </value>
  </query>
  <query>
    <name>UNLOCK_USER_LOGIN_ON_SESSION_ID</name>
    <value>
      DELETE FROM DPA_LOGIN WHERE USER_ID = '@param1@' @param2@ @param3@
    </value>
  </query>

  <query>
    <name>UNLOCK_AMM_LOGIN_ON_SESSION_ID</name>
    <value>
      DELETE FROM DPA_LOGIN WHERE SESSION_ID='@param1@'
    </value>
  </query>

  <query>
    <name>LOCK_USER_LOGIN</name>
    <value>
      INSERT INTO DPA_LOGIN (USER_ID,ID_AMM,IP_ADDRESS,DTA_CONNESSIONE, SESSION_ID,DST) VALUES
      (UPPER('@param1@'),@param2@,'@param3@',@param4@, '@param5@','@param6@')
    </value>
  </query>
  <query>
    <name>CHECK_USER_LOGIN</name>
    <value>
      SELECT COUNT(*) AS TOT
      FROM DPA_LOGIN
      WHERE USER_ID = '@param1@'
      AND ID_AMM = @param2@
    </value>
  </query>
  <query>
    <name>CHECK_LDAP_LOGIN</name>
    <value>
      SELECT DATEDIFF(SECOND,DTA_CONNESSIONE,GETDATE()) as TRASCORSO
      FROM DPA_LOGIN WHERE SESSION_ID = '@userId@'
    </value>
  </query>

  <query>
    <name>DELETE_LDAP_LOGIN</name>
    <value>
      DELETE DPA_LOGIN WHERE SESSION_ID = '@userId@'
    </value>
  </query>

  <query>
    <name>CHECK_USER_LOGIN_AMM</name>
    <value>
      SELECT DTA_CONNESSIONE
      FROM DPA_LOGIN
      WHERE USER_ID = '@param1@'
    </value>
  </query>

  <query>
    <name>S_IP_ADDRESS_USER_LOGIN</name>
    <value>
      SELECT IP_ADDRESS
      FROM DPA_LOGIN
      WHERE USER_ID = '@param1@'
      AND ID_AMM = @param2@
    </value>
  </query>

  <query>
    <name>CHECK_USER_LOGIN_ON_SESSION_ID</name>
    <value>
      SELECT COUNT(*) AS TOT
      FROM DPA_LOGIN
      WHERE SESSION_ID = '@param1@' AND
      USER_ID = '@userid@' AND
      ID_AMM = @idamm@
    </value>
  </query>


  <query>
    <name>UO_HAS_REFERENCE_ROLE</name>
    <value>
      SELECT * FROM DPA_CORR_GLOBALI WHERE
      cha_tipo_urp	= 'R'
      AND cha_riferimento = '1'
      AND id_uo			= @param1@
    </value>
  </query>

  <query>
    <name>CHECK_PROJECT</name>
    <value>
      SELECT COUNT(*) AS TOT
      FROM PROJECT
      WHERE SYSTEM_ID=@param1@
    </value>
  </query>

  <query>
    <name>S_J_DPA_CORR_GLOBALI__TIPO_RUOLO4</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      A.ID_GRUPPO,
      B.VAR_DESC_RUOLO,
      A.VAR_CODICE,
      A.VAR_COD_RUBRICA,
      A.ID_PARENT,
      A.ID_UO
      FROM DPA_CORR_GLOBALI A, DPA_TIPO_RUOLO B
      @param1@
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__SECURITY__TIPO_RUOLO</name>
    <value>
      SELECT DISTINCT A.SYSTEM_ID, A.VAR_COD_RUBRICA, A.ID_REGISTRO,
      A.ID_AMM, C.VAR_DESC_RUOLO, B.CHA_TIPO_DIRITTO, B.ACCESSRIGHTS, A.ID_UO, B.PERSONORGROUP
      FROM DPA_CORR_GLOBALI A, SECURITY as  B  WITH (nolock) , DPA_TIPO_RUOLO C
      WHERE B.THING=@param1@
      AND A.ID_GRUPPO=B.PERSONORGROUP AND C.SYSTEM_ID=A.ID_TIPO_RUOLO
      ORDER BY B.ACCESSRIGHTS DESC, A.ID_UO ASC
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__DELETED_SECURITY__TIPO_RUOLO_FASC</name>
    <value>
      SELECT DISTINCT A.SYSTEM_ID, A.VAR_COD_RUBRICA, A.ID_REGISTRO,
      A.ID_AMM, C.VAR_DESC_RUOLO, B.CHA_TIPO_DIRITTO, B.ACCESSRIGHTS, A.ID_UO, B.NOTE, B.PERSONORGROUP
      FROM DPA_CORR_GLOBALI A, DELETED_SECURITY B, DPA_TIPO_RUOLO C
      WHERE B.THING=@param1@
      AND A.ID_GRUPPO=B.PERSONORGROUP AND C.SYSTEM_ID=A.ID_TIPO_RUOLO
      ORDER BY B.ACCESSRIGHTS DESC, A.ID_UO ASC
    </value>
  </query>
  <query>
    <name>S_DPAFormattaSegn</name>
    <value>
      SELECT VAR_STRINGA,ID_PESO
      FROM DPA_FORMATTA_SEGN
      WHERE CHA_VISUALIZZA = '1'
      AND ID_AMM = @param1@ ORDER BY ID_PESO
    </value>
  </query>
  <query>
    <name>S_DPAELRegistri5</name>
    <value>
      SELECT A.VAR_CODICE
      FROM DPA_EL_REGISTRI A
      WHERE A.SYSTEM_ID = @param1@
    </value>
  </query>
  <query>
    <name>S_EMAIL_REGISTRO</name>
    <value>
      SELECT A.VAR_EMAIL_REGISTRO
      FROM DPA_EL_REGISTRI A
      WHERE A.VAR_CODICE = '@param1@'
    </value>
  </query>
  <query>
    <name>S_J_DPA_TRASMISSIONE__TRASM_SINGOLA__TRASM_UTENTE</name>
    <value>
      SELECT /*+ index (A INDX_TRASM3) */ A.ID_RUOLO_IN_UO, A.ID_PEOPLE, A.CHA_TIPO_OGGETTO,
      A.ID_PROFILE, A.ID_PROJECT,@param1@ AS DTA_INVIO_F,
      A.VAR_NOTE_GENERALI,B.ID_RAGIONE, B.ID_TRASMISSIONE,
      B.ID_TRASM_UTENTE, B.CHA_TIPO_DEST,B.ID_CORR_GLOBALE,
      B.HIDE_DOC_VERSIONS,B.VAR_NOTE_SING, B.CHA_TIPO_TRASM,@param2@ AS DTA_SCADENZA,
      C.SYSTEM_ID AS ID_TRASMISSIONE_UTENTE, C.ID_PEOPLE AS ID_DESTINATARIO,
      @param3@ AS DTA_VISTA,CHA_VISTA,@param4@ AS DTA_ACCETTATA,CHA_ACCETTATA,
      @param5@ AS DTA_RIFIUTATA,CHA_RIFIUTATA,C.VAR_NOTE_RIF, C.VAR_NOTE_ACC,
      C.ID_TRASM_SINGOLA, C.CHA_VALIDA, C.DTA_RIMOZIONE_TODOLIST AS DTA_RIMOSSA_TDL, A.CHA_SALVATA_CON_CESSIONE,
      A.ID_PEOPLE_DELEGATO AS ID_PEOPLE_DELEGATO, C.ID_PEOPLE_DELEGATO AS DELEGATO_UTENTE, C.CHA_ACCETTATA_DELEGATO AS ACCETTATA_DELEGATO, C.CHA_VISTA_DELEGATO AS VISTA_DELEGATO, C.CHA_RIFIUTATA_DELEGATO AS RIFIUTATA_DELEGATO,
      ISNULL(@dbuser@.Vardescribe(id_profile,'SEGNATURA_CODFASC'),@dbuser@.Vardescribe(id_project,'CODFASC')) ID_SEGN_CODFASC,
      ISNULL(@dbuser@.Vardescribe(id_profile,'DATADOC'),@dbuser@.Vardescribe(id_project,'DATA_CREAZ')) DATA_DOC_FASC,
      z.var_desc_corr, e.full_name, f.var_desc_corr AS desc_ruolo_mitt,
      g.cha_tipo_ragione, g.var_desc_ragione, g.cha_eredita,
      g.cha_tipo_diritti, h.FULL_NAME as desc_destinatario, f.var_codice as cod_ruolo_mitt,
      e.user_id, g.cha_risposta,
      g.cha_tipo_dest AS tipo_dest_rag, g.var_note, g.cha_tipo_risposta,
      g.var_notifica_trasm, g.var_testo_msg_notifica_doc,
      g.var_testo_msg_notifica_fasc, g.cha_cede_diritti,
      g.cha_mantieni_lett,
      g.CHA_PROC_RES,
      g.CHA_FASC_OBBLIGATORIA
      FROM DPA_TRASMISSIONE A, DPA_TRASM_SINGOLA B, DPA_TRASM_UTENTE C,
      dpa_corr_globali z,
      people e,
      dpa_corr_globali f,
      dpa_ragione_trasm g,
      people h @param7@
      WHERE A.SYSTEM_ID=B.ID_TRASMISSIONE AND B.SYSTEM_ID=C.ID_TRASM_SINGOLA
      @param6@
      AND z.system_id = b.id_corr_globale
      AND e.system_id = a.id_people
      AND f.system_id = a.id_ruolo_in_uo
      AND g.system_id = b.id_ragione
      AND h.system_id = c.id_people
      ORDER BY A.DTA_INVIO DESC, B.ID_TRASMISSIONE DESC, C.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>S_J_DPA_TRASM_UTENTE__TRASM_SINGOLA</name>
    <value>
      SELECT B.ID_TRASMISSIONE
      FROM DPA_TRASM_UTENTE A, DPA_TRASM_SINGOLA B
      WHERE @param1@
      AND A.SYSTEM_ID= @param2@
    </value>
  </query>
  <query>
    <name>S_J_DPA_TRASM_UTENTE__TRASM_SINGOLA2</name>
    <value>
      SELECT A.SYSTEM_ID, A.CHA_TIPO_DEST, A.CHA_TIPO_TRASM
      FROM DPA_TRASM_SINGOLA A, DPA_TRASM_UTENTE B
      WHERE A.SYSTEM_ID=B.ID_TRASM_SINGOLA
      AND B.SYSTEM_ID IN (SELECT TU.SYSTEM_ID FROM
      DPA_TRASM_UTENTE TU,DPA_TRASMISSIONE TX,DPA_TRASM_SINGOLA TS WHERE TU.ID_PEOPLE=@param1@ AND
      TX.SYSTEM_ID=TS.ID_TRASMISSIONE AND TX.SYSTEM_ID=@param2@ AND TS.SYSTEM_ID=TU.ID_TRASM_SINGOLA
      and TS.SYSTEM_ID = (SELECT ID_TRASM_SINGOLA FROM DPA_TRASM_UTENTE WHERE SYSTEM_ID =@param3@)
      )
      ORDER BY CHA_TIPO_DEST
    </value>
  </query>
  <!-- query per i report -->
  <query>
    <name>S_J_DPA_TRASM__DPA_RAGIONE__DPA_CORR_GLOBALI</name>
    <value>
      SELECT		F.VAR_DESC_CORR AS MITT_UT,  G.VAR_DESC_CORR  AS MITT_RU, E.VAR_DESC_RAGIONE AS RAGIONE, H.VAR_DESC_CORR AS DEST_RU, D.VAR_DESC_CORR AS DEST_UT,D.ID_PEOPLE AS SYSTEM_ID_DEST_UT,
      @param1@ AS DATA_INVIO, @param2@ AS DATA_VISTA, @param3@ AS DATA_ACCET, @param4@ AS DATA_RIFIU, A.VAR_NOTE_GENERALI AS NOTE_GENER, B.VAR_NOTE_SING AS NOTE_INDIVID, F.ID_PEOPLE AS SYSTEM_ID_MITT_UT
      FROM		DPA_TRASMISSIONE A, DPA_TRASM_SINGOLA B, DPA_TRASM_UTENTE C,
      DPA_CORR_GLOBALI D, DPA_RAGIONE_TRASM E, DPA_CORR_GLOBALI F,
      DPA_CORR_GLOBALI G, DPA_CORR_GLOBALI H
      WHERE       @param5@
      AND C.ID_TRASM_SINGOLA = B.SYSTEM_ID AND B.ID_TRASMISSIONE = A.SYSTEM_ID
      AND C.ID_PEOPLE = D.ID_PEOPLE AND D.CHA_TIPO_IE = 'I'
      AND B.ID_CORR_GLOBALE = H.SYSTEM_ID
      AND A.ID_PEOPLE = F.ID_PEOPLE AND F.CHA_TIPO_IE = 'I'
      AND A.ID_RUOLO_IN_UO = G.SYSTEM_ID AND G.CHA_TIPO_IE = 'I'
      AND B.ID_RAGIONE = E.SYSTEM_ID
      AND DTA_INVIO IS NOT NULL
      ORDER BY    A.DTA_INVIO DESC, A.SYSTEM_ID,  G.VAR_DESC_CORR, F.VAR_DESC_CORR, H.VAR_DESC_CORR, D.VAR_DESC_CORR
    </value>
  </query>
  <query>
    <name>S_J_DPA_TRASM__DPA_RAGIONE__DPA_CORR_GLOBALI__UO_D</name>
    <value>
      SELECT		F.VAR_DESC_CORR AS MITT_UT,
      G.VAR_DESC_CORR  AS MITT_RU,
      E.VAR_DESC_RAGIONE AS RAGIONE,
      D.VAR_DESC_CORR AS DEST,
      @param1@ AS DATA_INVIO,
      C.DOCNUMBER AS ID,
      @param5@.GETCODREG(C.ID_REGISTRO) AS COD_REG,
      C.NUM_PROTO AS NUM_PROTO,
      C.NUM_ANNO_PROTO AS ANNO,
      C.VAR_SEGNATURA AS SEGNATURA,
      C.VAR_PROF_OGGETTO AS DESCR,
      A.VAR_NOTE_GENERALI AS NOTE_GENER,
      B.VAR_NOTE_SING AS NOTE_INDIVID
      FROM		DPA_TRASMISSIONE A, DPA_TRASM_SINGOLA B,
      PROFILE C,
      DPA_CORR_GLOBALI D, DPA_RAGIONE_TRASM E, DPA_CORR_GLOBALI F,
      DPA_CORR_GLOBALI G
      WHERE     	B.ID_TRASMISSIONE = A.SYSTEM_ID
      AND A.ID_PROFILE = C.SYSTEM_ID AND A.CHA_TIPO_OGGETTO = 'D'
      AND B.ID_CORR_GLOBALE = D.SYSTEM_ID AND D.CHA_TIPO_IE = 'I'
      AND A.ID_PEOPLE = F.ID_PEOPLE AND F.CHA_TIPO_IE = 'I'
      AND A.ID_RUOLO_IN_UO = G.SYSTEM_ID AND G.CHA_TIPO_IE = 'I'
      AND B.ID_RAGIONE = E.SYSTEM_ID
      AND DTA_INVIO IS NOT NULL
      @param2@
      ORDER BY    A.DTA_INVIO DESC, A.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>S_J_DPA_TRASM__DPA_RAGIONE__DPA_CORR_GLOBALI__UO_F</name>
    <value>
      SELECT		F.VAR_DESC_CORR AS MITT_UT,
      G.VAR_DESC_CORR  AS MITT_RU,
      E.VAR_DESC_RAGIONE AS RAGIONE,
      D.VAR_DESC_CORR AS DEST,
      @param1@ AS DATA_INVIO,
      C.VAR_CODICE AS ID,
      C.DESCRIPTION AS DESCR,
      A.VAR_NOTE_GENERALI AS NOTE_GENER
      FROM		DPA_TRASMISSIONE A, DPA_TRASM_SINGOLA B,
      PROJECT C,
      DPA_CORR_GLOBALI D, DPA_RAGIONE_TRASM E, DPA_CORR_GLOBALI F,
      DPA_CORR_GLOBALI G
      WHERE     	B.ID_TRASMISSIONE = A.SYSTEM_ID
      AND A.ID_PROJECT = C.SYSTEM_ID AND A.CHA_TIPO_OGGETTO = 'F'
      AND B.ID_CORR_GLOBALE = D.SYSTEM_ID AND D.CHA_TIPO_IE = 'I'
      AND A.ID_PEOPLE = F.ID_PEOPLE AND F.CHA_TIPO_IE = 'I'
      AND A.ID_RUOLO_IN_UO = G.SYSTEM_ID AND G.CHA_TIPO_IE = 'I'
      AND B.ID_RAGIONE = E.SYSTEM_ID
      AND DTA_INVIO IS NOT NULL
      @param2@
      ORDER BY    A.DTA_INVIO DESC, A.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>S_DPAAmministra</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      LTRIM(RTRIM(A.VAR_CODICE_AMM)) AS VAR_CODICE_AMM,
      A.VAR_DESC_AMM,
      A.VAR_LIBRERIA
      FROM DPA_AMMINISTRA A
      ORDER BY A.VAR_CODICE_AMM
    </value>
  </query>
  <query>
    <name>S_DPAAmministra2</name>
    <value>
      SELECT
      @param1@
      FROM DPA_AMMINISTRA
      WHERE SYSTEM_ID = @param2@
    </value>
  </query>
  <query>
    <name>S_DPAAmministra3</name>
    <value>
      SELECT
      @param1@
      FROM DPA_AMMINISTRA
      @param2@
    </value>
  </query>


  <query>
    <name>S_DPAAmministraByUser</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      A.VAR_CODICE_AMM,
      A.VAR_DESC_AMM,
      A.VAR_LIBRERIA
      FROM PEOPLE P LEFT JOIN  DPA_AMMINISTRA A ON a.system_id = p.id_amm
      WHERE user_Id = '@param1@'
      @param2@
      ORDER BY A.VAR_CODICE_AMM
    </value>
  </query>
  <query>
    <name>S_DPAAmministraByUserAdministrator</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      A.VAR_CODICE_AMM,
      A.VAR_DESC_AMM,
      A.VAR_LIBRERIA
      FROM PEOPLE P LEFT JOIN  DPA_AMMINISTRA A ON a.system_id = p.id_amm
      WHERE user_Id = '@param1@' AND P.cha_amministratore in ('1','2','3')
      @param2@
      ORDER BY A.VAR_CODICE_AMM
    </value>
  </query>

  <query>
    <name>S_DPAAreaLavoroProfile</name>
    <value>
      SELECT @param1@
      FROM DPA_AREA_LAVORO A, PROFILE P
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>S_DPAAreaLavoro</name>
    <value>
      SELECT @param1@
      FROM DPA_AREA_LAVORO
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>S_J_DPA_CANALI_REG__CANALI__DOCUMENTTYPES</name>
    <value>
      SELECT
      A.VAR_SERVER_SMTP,
      A.NUM_PORTA_SMTP,
      C.CHA_TIPO_CANALE,
      A.SYSTEM_ID
      FROM DPA_CANALI_REG B, DPA_CANALI A, DOCUMENTTYPES C
      WHERE B.ID_CANALE = A.SYSTEM_ID
      AND B.ID_DOCUMENTTYPE = C.SYSTEM_ID
      AND @param1@
    </value>
  </query>
  <query>
    <name>S_IDCorrGlobaliPeople</name>
    <value>
      SELECT system_id
      FROM DPA_CORR_GLOBALI
      WHERE CHA_TIPO_URP NOT IN ('L')
      AND ID_PEOPLE = @param1@
    </value>
  </query>
  <query>
    <name>S_DPACorrGlobali</name>
    <value>
      SELECT
      @param1@
      FROM DPA_CORR_GLOBALI A
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>S_DPACorrGlobali_1</name>
    <value>
      SELECT
      *
      FROM DPA_CORR_GLOBALI A
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>S_DPACorrGlobali1</name>
    <value>
      SELECT SYSTEM_ID
      FROM DPA_CORR_GLOBALI
      WHERE VAR_COD_RUBRICA = @param1@
      AND (ID_AMM = @param2@
      OR ID_AMM IS NULL)
      AND DTA_FINE IS NULL
      @param3@
    </value>
  </query>
  <query>
    <name>S_DPACorrGlobali2</name>
    <value>
      SELECT
      B.ID_GRUPPO,
      B.SYSTEM_ID,
      B.VAR_DESC_CORR,
      B.VAR_COD_RUBRICA,
      B.ID_AMM,
      B.ID_TIPO_RUOLO,
      B.VAR_EMAIL,
      B.VAR_CODICE_ISTAT,
      B.CHA_TIPO_IE,
      B.VAR_CODICE,
      B.VAR_SMTP,
      B.NUM_PORTA_SMTP
      FROM DPA_CORR_GLOBALI B
      WHERE B.ID_UO = @param1@
      AND B.ID_AMM = @param2@
      AND B.DTA_FINE IS NULL
      ORDER BY B.VAR_DESC_CORR
    </value>
  </query>
  <query>
    <name>S_DPACorrGlobali_VALID</name>
    <value>
      SELECT
      SYSTEM_ID
      FROM DPA_CORR_GLOBALI
      WHERE DTA_FINE IS NULL  AND SYSTEM_ID = @param1@
    </value>
  </query>

  <query>
    <name>S_DPACorrGlobaliByIdPeople</name>
    <value>
      SELECT
      SYSTEM_ID
      FROM DPA_CORR_GLOBALI
      WHERE DTA_FINE IS NULL  AND ID_PEOPLE = @param1@
    </value>
  </query>

  <!--elisa query per protocollo interno-->
  <query>
    <name>S_DPACorrGlobali_ProtoInt_U</name>
    <value>
      SELECT
      @param1@
      FROM DPA_CORR_GLOBALI U, DPA_CORR_GLOBALI R, DPA_TIPO_RUOLO B, DPA_L_RUOLO_REG C
      WHERE
      R.ID_UO=U.SYSTEM_ID AND
      R.ID_TIPO_RUOLO=B.SYSTEM_ID AND
      R.SYSTEM_ID=C.ID_RUOLO_IN_UO AND
      U.CHA_TIPO_URP='U' AND
      U.CHA_TIPO_IE='I' AND
      U.CHA_TIPO_CORR='S' AND
      R.CHA_TIPO_URP='R' AND
      R.CHA_TIPO_IE='I' AND
      R.CHA_TIPO_CORR='S'
      @param2@
    </value>
  </query>
  <query>
    <name>S_DPACorrGlobali_ProtoInt_R</name>
    <value>
      SELECT
      @param1@
      FROM DPA_CORR_GLOBALI R, DPA_TIPO_RUOLO B, DPA_L_RUOLO_REG C
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>S_DPACorrGlobali_ProtoInt_P</name>
    <value>
      SELECT
      @param1@
      FROM
      DPA_CORR_GLOBALI P, DPA_CORR_GLOBALI R, DPA_TIPO_RUOLO B, DPA_L_RUOLO_REG C, PEOPLEGROUPS PG, PEOPLE E
      WHERE @param2@
    </value>
  </query>
  <!---->
  <query>
    <name>S_DPACorrGruppo</name>
    <value>
      SELECT ID_COMP_GRUPPO
      FROM DPA_CORR_GRUPPO
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>S_DPACorrGlob</name>
    <value>
      SELECT SYSTEM_ID
      FROM DPA_CORR_GLOBALI
      WHERE ID_UO = @param1@
    </value>
  </query>
  <query>
    <name>S_DPALOG</name>
    <value>
      SELECT	USER_ID,
      VAR_COD_AZIONE,
      DTA_AZIONE,
      VAR_COD_OGGETTO,
      VAR_DESC_OGGETTO
      FROM    DPA_LOG
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>S_J_DPAANAGRAFICA_LOG__DPA_LOG_ATTIVATI</name>
    <value>
      SELECT  AN.VAR_CODICE
      , AN.VAR_DESCRIZIONE
      , AN.VAR_OGGETTO
      , AT.NOTIFY
      FROM    DPA_LOG_ATTIVATI AT, DPA_ANAGRAFICA_LOG AN
      WHERE   (AT.SYSTEM_ID_ANAGRAFICA = AN.SYSTEM_ID) @param1@
      AND (AN.VAR_METODO = @param2@)
    </value>
  </query>
  <query>
    <name>I_DPACorrGlob</name>
    <value>
      INSERT INTO DPA_CORR_GLOBALI
      (
      @param1@
      ID_REGISTRO,
      ID_AMM,
      VAR_COD_RUBRICA,
      VAR_DESC_CORR,
      ID_OLD,
      DTA_INIZIO,
      DTA_FINE,
      ID_PARENT,
      NUM_LIVELLO,
      VAR_CODICE,
      ID_GRUPPO,
      ID_TIPO_RUOLO,
      CHA_DEFAULT_TRASM,
      ID_UO,
      VAR_COGNOME,
      VAR_NOME,
      ID_PEOPLE,
      CHA_TIPO_CORR,
      CHA_TIPO_IE,
      CHA_TIPO_URP,
      CHA_PA,
      VAR_CODICE_AOO,
      VAR_CODICE_AMM,
      VAR_CODICE_ISTAT,
      ID_PESO, VAR_EMAIL,
      CHA_DETTAGLI,
      NUM_FIGLI,
      VAR_SMTP,
      NUM_PORTA_SMTP,
      VAR_FAX_USER_LOGIN
      )
      (SELECT DISTINCT
      @param2@
      A.ID_REGISTRO,
      A.ID_AMM,
      A.VAR_COD_RUBRICA,
      B.VAR_DESC_RUOLO + @param3@,
      A.SYSTEM_ID,
      A.DTA_INIZIO,
      A.DTA_FINE,
      A.ID_PARENT,
      A.NUM_LIVELLO,
      A.VAR_CODICE,
      A.ID_GRUPPO,
      A.ID_TIPO_RUOLO,
      A.CHA_DEFAULT_TRASM,
      @param4@,
      A.VAR_COGNOME,
      A.VAR_NOME,
      A.ID_PEOPLE,
      A.CHA_TIPO_CORR,
      A.CHA_TIPO_IE,
      A.CHA_TIPO_URP,
      A.CHA_PA,
      VAR_CODICE_AOO,
      A.VAR_CODICE_AMM,
      A.VAR_CODICE_ISTAT,
      A.ID_PESO,
      A.VAR_EMAIL,
      A.CHA_DETTAGLI,
      A.NUM_FIGLI,
      A.VAR_SMTP,
      A.NUM_PORTA_SMTP,
      A.VAR_FAX_USER_LOGIN
      FROM DPA_CORR_GLOBALI A, DPA_TIPO_RUOLO B
      WHERE B.SYSTEM_ID = A.ID_TIPO_RUOLO
      AND A.SYSTEM_ID = @param5@
      )
    </value>
  </query>
  <query>
    <name>I_DPADettGlob</name>
    <value>
      INSERT INTO DPA_DETT_GLOBALI
      (
      @param1@
      ID_CORR_GLOBALI,
      VAR_INDIRIZZO,
      VAR_CAP,
      VAR_PROVINCIA,
      VAR_NAZIONE,
      VAR_COD_FISCALE,
      VAR_TELEFONO,
      VAR_TELEFONO2,
      VAR_FAX,
      VAR_NOTE,
      VAR_CITTA,
      var_cod_fisc, VAR_COD_PI
      )
      (SELECT
      @param2@
      @param3@,
      VAR_INDIRIZZO,
      VAR_CAP,
      VAR_PROVINCIA,
      VAR_NAZIONE,
      VAR_COD_FISCALE,
      VAR_TELEFONO,
      VAR_TELEFONO2,
      VAR_FAX,
      VAR_NOTE,
      VAR_CITTA,
      var_cod_fisc, VAR_COD_PI
      FROM DPA_DETT_GLOBALI
      WHERE ID_CORR_GLOBALI = @param4@
      )
    </value>
  </query>
  <query>
    <name>I_DPALRuoloReg</name>
    <value>
      INSERT INTO DPA_L_RUOLO_REG
      (
      SYSTEM_ID,
      ID_REGISTRO,
      ID_RUOLO_IN_UO,
      CHA_PREFERITO,
      CHA_RIFERIMENTO
      )
      (SELECT
      1,
      ID_REGISTRO,
      @param1@,
      CHA_PREFERITO,
      CHA_RIFERIMENTO
      FROM DPA_L_RUOLO_REG
      WHERE ID_RUOLO_IN_UO = @param2@
      )
    </value>
  </query>
  <query>
    <name>S_DPACorrGlob5</name>
    <value>
      SELECT
      VAR_FAX_USER_LOGIN
      FROM DPA_CORR_GLOBALI
      WHERE SYSTEM_ID = @param1@
    </value>
  </query>
  <query>
    <name>S_DPACorrGlob6</name>
    <value>
      SELECT
      VAR_FAX_USER_LOGIN,
      VAR_COD_RUBRICA
      FROM DPA_CORR_GLOBALI
      WHERE ID_PEOPLE IN
      (SELECT
      PEOPLE_SYSTEM_ID
      FROM
      PEOPLEGROUPS B, DPA_CORR_GLOBALI A
      WHERE
      A.ID_GRUPPO = B.GROUPS_SYSTEM_ID
      AND B.DTA_FINE IS NULL
      AND A.ID_UO = @param1@
      )
    </value>
  </query>
  <query>
    <name>S_DPACorrGlob7</name>
    <value>
      SELECT
      VAR_FAX_USER_LOGIN
      FROM DPA_CORR_GLOBALI
      WHERE ID_PEOPLE = @param1@
    </value>
  </query>
  <query>
    <name>S_DPACorrGlob8</name>
    <value>
      SELECT
      SYSTEM_ID,
      VAR_COD_RUBRICA
      FROM DPA_CORR_GLOBALI
      WHERE CHA_TIPO_IE = 'E'
      AND VAR_CODICE = '@param1@'
      AND ID_AMM = @param2@
      AND ID_REGISTRO = @param3@
    </value>
  </query>
  <query>
    <name>S_DPACorrGlob9</name>
    <value>
      SELECT
      SYSTEM_ID,
      VAR_COD_RUBRICA
      FROM DPA_CORR_GLOBALI
      WHERE VAR_DESC_CORR = '@param1@'
      AND ID_AMM = @param2@
      AND CHA_TIPO_IE = 'E'
      AND CHA_TIPO_URP = 'U'
      AND ID_PARENT = @param3@
    </value>
  </query>
  <query>
    <name>S_DPACorrGlob10</name>
    <value>
      SELECT
      SYSTEM_ID,
      ID_PARENT
      FROM DPA_CORR_GLOBALI
      WHERE CHA_TIPO_URP = 'U'
      AND NUM_LIVELLO >= @param1@
    </value>
  </query>
  <query>
    <name>S_DPACorrGlob11</name>
    <value>
      SELECT
      SYSTEM_ID
      FROM DPA_CORR_GLOBALI
      WHERE ID_PEOPLE = @param1@
    </value>
  </query>
  <query>
    <name>S_DPACorrGlob12</name>
    <value>
      SELECT
      SYSTEM_ID
      FROM DPA_CORR_GLOBALI
      WHERE CHA_TIPO_URP = 'U' AND CHA_TIPO_IE = 'I'
      AND NUM_LIVELLO = @param1@
      AND ID_PARENT = @param2@
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__CORR_GLOBALI</name>
    <value>
      SELECT @param1@
      FROM DPA_CORR_GLOBALI A, DPA_CORR_GLOBALI B
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__CORR_GRUPPO__CORR_GLOBALI</name>
    <value>
      SELECT @param1@
      FROM DPA_CORR_GLOBALI A,DPA_CORR_GRUPPO B, DPA_CORR_GLOBALI C
      WHERE A.SYSTEM_ID = B.ID_COMP_GRUPPO
      AND C.SYSTEM_ID = B.ID_GRUPPO
      AND @param2@
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__CORR_GLOBALI__PEOPLE__CORR_GRUPPO</name>
    <value>
      SELECT @param1@
      FROM DPA_CORR_GLOBALI A , DPA_CORR_GLOBALI C, PEOPLE E, DPA_CORR_GRUPPO F
      WHERE A.ID_PEOPLE = E.SYSTEM_ID
      AND A.SYSTEM_ID = F.ID_COMP_GRUPPO
      AND F.ID_GRUPPO = C.SYSTEM_ID
      AND @param2@
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__DOC_ARRIVO_PAR</name>
    <value>
      SELECT @param1@
      FROM DPA_CORR_GLOBALI A, DPA_DOC_ARRIVO_PAR B, PROFILE P
      WHERE A.SYSTEM_ID = B.ID_MITT_DEST AND B.ID_PROFILE=P.SYSTEM_ID
      AND @param2@
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__DOC_ARRIVO_PAR__CORR_GRUPPO</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      A.VAR_COD_RUBRICA,
      A.ID_AMM,
      A.CHA_TIPO_IE,
      A.CHA_TIPO_CORR,
      B.CHA_TIPO_MITT_DEST,
      A.VAR_DESC_CORR
      FROM DPA_CORR_GLOBALI A, DPA_DOC_ARRIVO_PAR B, DPA_CORR_GRUPPO C
      WHERE A.SYSTEM_ID = B.ID_MITT_DEST
      AND A.SYSTEM_ID = C.ID_COMP_GRUPPO
      AND @param1@
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__PEOPLEGROUPS__CORR_GLOBALI__PEOPLE__TIPO_RUOLO</name>
    <value>
      SELECT distinct
      A.SYSTEM_ID,
      A.ID_PEOPLE,
      A.ID_REGISTRO,
      A.ID_AMM,
      E.VAR_NOME,
      E.VAR_COGNOME,
      E.EMAIL_ADDRESS,
      E.CHA_NOTIFICA,
      E.VAR_TELEFONO,
      A.VAR_DESC_CORR,
      A.VAR_CODICE,
      A.VAR_COD_RUBRICA,
      A.CHA_DETTAGLI,
      A.CHA_TIPO_URP,
      A.VAR_SMTP,
      A.NUM_PORTA_SMTP,
      A.VAR_CODICE_AMM,
      A.VAR_CODICE_AOO,
      A.DTA_FINE,
      C.SYSTEM_ID AS RUOLO_SYSTEM_ID,
      D.VAR_DESC_RUOLO AS RUOLO_DESC,
      C.VAR_CODICE AS RUOLO_CODICE,
      C.ID_UO AS RUOLO_ID_UO,
      C.VAR_COD_RUBRICA AS RUOLO_COD_RUBRICA,
      C.CHA_DETTAGLI AS RUOLO_DETTAGLI,
      E.CHA_NOTIFICA_CON_ALLEGATO,
      E.DISABLED
      FROM
      DPA_CORR_GLOBALI A, PEOPLEGROUPS B, DPA_CORR_GLOBALI C, PEOPLE E, DPA_TIPO_RUOLO D
      WHERE
      B.PEOPLE_SYSTEM_ID = A.ID_PEOPLE
      AND C.ID_GRUPPO = B.GROUPS_SYSTEM_ID
      AND D.SYSTEM_ID = C.ID_TIPO_RUOLO
      AND E.SYSTEM_ID = A.ID_PEOPLE
      AND @param1@
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__PEOPLEGROUPS__TIPO_RUOLO__CORR_GLOBALI</name>
    <value>
      SELECT
      A.PEOPLE_SYSTEM_ID,
      B.SYSTEM_ID,
      B.ID_GRUPPO,
      C.NUM_LIVELLO,
      B.ID_REGISTRO,
      C.VAR_CODICE,
      C.VAR_DESC_RUOLO,
      D.NUM_LIVELLO AS NUM_LIVELLO_UO,
      B.ID_UO,
      B.VAR_COD_RUBRICA, B.ID_AMM,
      B.VAR_DESC_CORR,
      A.CHA_PREFERITO,
      b.CHA_RIFERIMENTO,
      b.CHA_RESPONSABILE,
      b.CHA_SEGRETARIO
      FROM
      PEOPLEGROUPS A, DPA_CORR_GLOBALI B, DPA_TIPO_RUOLO C, DPA_CORR_GLOBALI D
      WHERE
      B.ID_GRUPPO = A.GROUPS_SYSTEM_ID
      AND B.ID_TIPO_RUOLO = C.SYSTEM_ID
      AND D.SYSTEM_ID = B.ID_UO
      AND A.DTA_FINE IS NULL
      AND @param1@
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__PEOPLEGROUPS__TIPO_RUOLO__CORR_GLOBALI_E_D</name>
    <value>
      SELECT
      A.PEOPLE_SYSTEM_ID,
      B.SYSTEM_ID,
      B.ID_GRUPPO,
      C.NUM_LIVELLO,
      B.ID_REGISTRO,
      C.VAR_CODICE,
      C.VAR_DESC_RUOLO,
      D.NUM_LIVELLO AS NUM_LIVELLO_UO,
      B.ID_UO,
      B.VAR_COD_RUBRICA, B.ID_AMM,
      B.VAR_DESC_CORR,
      A.CHA_PREFERITO,
      b.CHA_RIFERIMENTO,
      b.CHA_RESPONSABILE,
      b.CHA_SEGRETARIO
      FROM
      PEOPLEGROUPS A, DPA_CORR_GLOBALI B, DPA_TIPO_RUOLO C, DPA_CORR_GLOBALI D
      WHERE
      B.ID_GRUPPO = A.GROUPS_SYSTEM_ID
      AND B.ID_TIPO_RUOLO = C.SYSTEM_ID
      AND D.SYSTEM_ID = B.ID_UO
      AND @param1@
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__PEOPLEGROUPS__TIPO_RUOLO</name>
    <value>
      SELECT
      A.PEOPLE_SYSTEM_ID,
      B.SYSTEM_ID,
      B.ID_GRUPPO,
      C.NUM_LIVELLO,
      C.VAR_CODICE,
      C.VAR_DESC_RUOLO,
      B.NUM_LIVELLO,
      B.ID_UO,
      B.VAR_COD_RUBRICA,
      B.ID_REGISTRO, B.ID_AMM ,B.VAR_DESC_CORR,
      A.CHA_PREFERITO,
      b.CHA_RIFERIMENTO,
      b.CHA_RESPONSABILE,
      b.CHA_SEGRETARIO
      FROM
      PEOPLEGROUPS A, DPA_CORR_GLOBALI B, DPA_TIPO_RUOLO C
      WHERE
      B.ID_GRUPPO = A.GROUPS_SYSTEM_ID
      AND B.ID_TIPO_RUOLO = C.SYSTEM_ID
      AND A.DTA_FINE IS NULL
      and B.DTA_FINE is null
      AND @param1@
      ORDER BY @param2@
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__RUOE_UTENTE__CORR_GLOBALI</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      A.VAR_COGNOME,
      A.VAR_NOME,
      A.VAR_DESC_CORR,
      A.VAR_CODICE,
      A.VAR_COD_RUBRICA,
      A.CHA_DETTAGLI,
      A.CHA_TIPO_URP,
      A.ID_REGISTRO,
      A.VAR_EMAIL,
      A.VAR_SMTP,
      A.VAR_CODICE_AOO,
      A.VAR_CODICE_AMM,
      A.NUM_PORTA_SMTP,
      C.SYSTEM_ID AS RUOLO_SYSTEM_ID,
      C.VAR_DESC_CORR AS RUOLO_DESC,
      C.VAR_CODICE AS RUOLO_CODICE,
      C.ID_UO AS RUOLO_ID_UO,
      C.VAR_COD_RUBRICA AS RUOLO_COD_RUBRICA,
      C.CHA_DETTAGLI AS RUOLO_DETTAGLI
      FROM  DPA_CORR_GLOBALI A,DPA_RUOE_UTENTE B, DPA_CORR_GLOBALI C
      WHERE B.ID_UTENTE_EST = A.SYSTEM_ID
      AND C.SYSTEM_ID = B.ID_RUOE
      AND @param1@
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__PEOPLE__SECURITY</name>
    <value>
      SELECT DISTINCT @param1@
      FROM PEOPLE A, SECURITY as B  WITH (nolock) , DPA_CORR_GLOBALI C
      WHERE A.SYSTEM_ID = B.PERSONORGROUP
      AND C.ID_PEOPLE = A.SYSTEM_ID
      AND @param2@
    </value>
  </query>
  <query>
    <name>S_SECURITY_PROPRIETARIO</name>
    <value>
      SELECT PERSONORGROUP, ACCESSRIGHTS, ID_GRUPPO_TRASM FROM SECURITY  WITH (nolock)  WHERE THING=@param1@ AND CHA_TIPO_DIRITTO=@param2@
    </value>
  </query>
  <query>
    <name>S_SECURITY__DPA_CORR_GLOBALI__PROPRIETARIO</name>
    <value>
      SELECT S.PERSONORGROUP, S.ACCESSRIGHTS, S.ID_GRUPPO_TRASM, C.VAR_COD_RUBRICA, C.ID_GRUPPO FROM SECURITY as S  WITH (nolock) , DPA_CORR_GLOBALI C WHERE S.THING=@param1@ AND S.CHA_TIPO_DIRITTO=@param2@ AND (S.PERSONORGROUP=C.ID_PEOPLE OR S.PERSONORGROUP=C.ID_GRUPPO)
    </value>
  </query>
  <query>
    <name>S_DELETED_SECURITY_PROPRIETARIO</name>
    <value>
      SELECT S.PERSONORGROUP, S.ACCESSRIGHTS, S.ID_GRUPPO_TRASM, S.HIDE_DOC_VERSIONS, C.VAR_COD_RUBRICA, C.ID_PEOPLE
      FROM DELETED_SECURITY S, DPA_CORR_GLOBALI C
      WHERE S.THING=@param1@ AND S.CHA_TIPO_DIRITTO='P' AND (S.PERSONORGROUP=C.ID_PEOPLE OR S.PERSONORGROUP=C.ID_GRUPPO)
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__PEOPLE__DELETED_SECURITY</name>
    <value>
      SELECT DISTINCT @param1@
      FROM PEOPLE A, DELETED_SECURITY B, DPA_CORR_GLOBALI C
      WHERE A.SYSTEM_ID = B.PERSONORGROUP
      AND C.ID_PEOPLE = A.SYSTEM_ID
      AND @param2@
    </value>
  </query>
  <query>
    <name>S_GET_COUNT_DELETED_SECURITY</name>
    <value>
      SELECT COUNT(*)
      FROM DELETED_SECURITY
      WHERE @param1@
      And Not Exists (Select 'x' From security as sec   Where sec.thing = sec.thing And sec.accessrights > 20 And sec.personorgroup = sec.personorgroup)
    </value>
  </query>
  <query>
    <name>S_GET_COUNT_SECURITY</name>
    <value>
      SELECT isnull(max(thing),'0')
      FROM SECURITY
      WHERE @dbuser@.checkSecurityDocumento(@idProfile@, @idPeople@, @idGroup@, @idRuoloPubblico@,'D') > 0
    </value>
  </query>
  <query>
    <name>S_GET_COUNT_ACL</name>
    <value>
      SELECT COUNT(*)
      FROM SECURITY
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>S_GET_COUNT_SECURITY_2</name>
    <value>
      SELECT COUNT(*)
      FROM SECURITY
      WHERE @dbuser@.checkSecurity(@idObj@, @idPeople@, @idGroup@, @idRuoloPubblico@,'F') > 0
      and thing=@idObj@ and PERSONORGROUP in (@idPeople@, @idGroup@, @idRuoloPubblico@)
    </value>
  </query>
  <query>
    <name>S_GET_COUNT_DPA_LOG</name>
    <value>
      SELECT COUNT(*)
      FROM DPA_LOG
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>S_GET_COUNT_PERSON_DELETED_SECURITY</name>
    <value>
      SELECT COUNT(*)
      FROM DELETED_SECURITY
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__DPA_LOG</name>
    <value>
      select
      log.USERID_OPERATORE, corr.var_desc_corr, log.dta_azione, log.var_desc_oggetto
      from dpa_log log, dpa_corr_globali corr
      where id_oggetto = @param1@ and var_cod_azione @param2@ AND CHA_ESITO=1
      and log.id_gruppo_operatore=corr.id_gruppo
    </value>
  </query>
  <query>
    <name>UPDATE_TODOLIST_ACL</name>
    <value>
      UPDATE dpa_trasm_utente
      SET  CHA_IN_TODOLIST = '0',
      CHA_VISTA  = (CASE WHEN DTA_VISTA IS NULL THEN 1 ELSE 0 END)
      WHERE (SYSTEM_ID = @param3@
      OR
      SYSTEM_ID = (SELECT TU.SYSTEM_ID FROM
      DPA_TRASM_UTENTE TU,DPA_TRASMISSIONE TX,DPA_TRASM_SINGOLA TS WHERE TU.ID_PEOPLE=@param4@ AND
      TX.SYSTEM_ID=TS.ID_TRASMISSIONE AND TX.SYSTEM_ID in (@param5@) AND TS.SYSTEM_ID=TU.ID_TRASM_SINGOLA
      AND TS.CHA_TIPO_DEST= 'U')
      )
      AND CHA_VALIDA='1'
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__TIPO_RUOLO</name>
    <value>
      SELECT @param1@
      FROM DPA_CORR_GLOBALI A, DPA_TIPO_RUOLO B
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__TIPO_RUOLO2</name>
    <value>
      SELECT DISTINCT
      A.SYSTEM_ID,
      A.ID_GRUPPO,
      B.VAR_DESC_RUOLO,
      A.VAR_CODICE,
      A.VAR_COD_RUBRICA,
      A.ID_UO
      FROM DPA_CORR_GLOBALI A, DPA_TIPO_RUOLO B
      @param1@ AND A.DTA_FINE IS NULL
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__TIPO_RUOLO3</name>
    <value>
      SELECT DISTINCT
      A.SYSTEM_ID,
      A.ID_GRUPPO,
      B.NUM_LIVELLO,
      A.VAR_DESC_CORR AS VAR_DESC_RUOLO,
      A.VAR_CODICE,
      A.VAR_COD_RUBRICA,
      A.ID_PARENT,
      A.ID_UO
      FROM DPA_CORR_GLOBALI A, DPA_TIPO_RUOLO B
      @param1@
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__SECURITY__TIPO_RUOLO2</name>
    <value>
      SELECT DISTINCT @param1@, B.ACCESSRIGHTS, A.ID_UO
      FROM DPA_CORR_GLOBALI A, SECURITY as B  WITH (nolock) , DPA_TIPO_RUOLO C
      WHERE A.ID_GRUPPO = B.PERSONORGROUP
      AND C.SYSTEM_ID = A.ID_TIPO_RUOLO
      AND B.THING NOT IN (SELECT SYSTEM_ID FROM PROFILE WITH(NOLOCK) P WHERE P.SYSTEM_ID=B.THING AND ISNULL(P.CHA_IN_CESTINO, '0') = '1')
      AND @param2@
      ORDER BY B.ACCESSRIGHTS DESC, A.ID_UO ASC
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__DELETED_SECURITY__TIPO_RUOLO</name>
    <value>
      SELECT DISTINCT @param1@, B.ACCESSRIGHTS, A.ID_UO
      FROM DPA_CORR_GLOBALI A, DELETED_SECURITY B, DPA_TIPO_RUOLO C
      WHERE A.ID_GRUPPO = B.PERSONORGROUP
      AND C.SYSTEM_ID = A.ID_TIPO_RUOLO
      AND @param2@
      ORDER BY B.ACCESSRIGHTS DESC, A.ID_UO ASC
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__TIPO_F_RUOLO__TIPO_FUNZIONE__TIPO_RUOLO__CORR_GLOBALI__L_RUOLO_REG</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      A.VAR_CODICE,
      A.VAR_COD_RUBRICA,
      D.VAR_DESC_RUOLO,
      A.ID_GRUPPO,
      A.ID_UO,
      D.NUM_LIVELLO,
      E.VAR_DESC_CORR
      FROM DPA_CORR_GLOBALI A,
      DPA_TIPO_F_RUOLO B,
      DPA_TIPO_FUNZIONE C,
      DPA_TIPO_RUOLO D,
      DPA_CORR_GLOBALI E,
      DPA_L_RUOLO_REG F
      WHERE A.CHA_TIPO_URP = 'R'
      AND F.ID_REGISTRO = @param1@
      AND B.ID_RUOLO_IN_UO = A.SYSTEM_ID
      AND B.ID_TIPO_FUNZ = C.SYSTEM_ID
      AND C.VAR_COD_TIPO = 'PRAU'
      AND D.SYSTEM_ID = A.ID_TIPO_RUOLO
      AND E.SYSTEM_ID = A.ID_UO
      AND F.ID_RUOLO_IN_UO = A.SYSTEM_ID
      AND C.ID_AMM = @param2@
    </value>
  </query>
  <query>
    <name>S_DPACorrSto</name>
    <value>
      SELECT
      @param1@ AS DTA_MODIFICA
      FROM DPA_CORR_STO
      WHERE ID_PROFILE = @param2@
    </value>
  </query>
  <query>
    <name>S_DPADettGlob</name>
    <value>
      SELECT *
      FROM DPA_DETT_GLOBALI
      WHERE ID_CORR_GLOBALI = @param1@
    </value>
  </query>
  <query>
    <name>S_DPADettGlob2</name>
    <value>
      SELECT SYSTEM_ID
      FROM DPA_DETT_GLOBALI
      WHERE ID_CORR_GLOBALI = @param1@
    </value>
  </query>
  <query>
    <name>S_DPADettGlob3</name>
    <value>
      SELECT
      VAR_FAX
      FROM DPA_DETT_GLOBALI
      WHERE ID_CORR_GLOBALI = @param1@
    </value>
  </query>
  <query>
    <name>S_DPADettGlob4</name>
    <value>
      SELECT
      VAR_FAX,
      VAR_INDIRIZZO,
      VAR_CAP,
      VAR_PROVINCIA,
      VAR_CITTA
      FROM DPA_DETT_GLOBALI
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>S_DPADettGlob5</name>
    <value>
      SELECT *
      FROM DPA_DETT_GLOBALI
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>S_DPADocArrivoPar</name>
    <value>
      SELECT COUNT(*)
      FROM DPA_DOC_ARRIVO_PAR
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>S_DPADocArrivoPar2</name>
    <value>
      SELECT SYSTEM_ID
      FROM DPA_DOC_ARRIVO_PAR
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>S_DPA_STATO_INVIO</name>
    <value>
      SELECT COUNT(*)
      FROM DPA_STATO_INVIO
      WHERE ID_PROFILE = @param1@
      AND ID_CORR_GLOBALE = @param2@
    </value>
  </query>
  <query>
    <name>S_DPA_STATO_INVIO2</name>
    <value>
      SELECT COUNT(*)
      FROM DPA_STATO_INVIO
      WHERE ID_PROFILE = @param1@
    </value>
  </query>
  <query>
    <name>S_DPATrasm</name>
    <value>
      SELECT
      COUNT(system_id)
      FROM
      DPA_TRASMISSIONE
      WHERE
      @param1@
    </value>
  </query>
  <query>
    <name>S_DPATrasmUtente</name>
    <value>
      SELECT
      COUNT(system_id)
      FROM
      DPA_TRASM_UTENTE
      WHERE
      @param1@
    </value>
  </query>
  <query>
    <name>S_DPADocCollegamenti</name>
    <value>
      SELECT @param1@
      FROM DPA_DOC_COLLEGAMENTI
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>S_J_DPA_EL_REGISTRI</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      A.VAR_CODICE,
      A.NUM_RIF,
      A.VAR_DESC_REGISTRO,
      A.VAR_EMAIL_REGISTRO,
      A.CHA_STATO,
      A.ID_AMM
      @param1@
      @param2@
      @param3@
      FROM DPA_EL_REGISTRI A
      WHERE A.CHA_RF = '0'
      AND A.ID_AMM = @param4@
      ORDER BY A.VAR_DESC_REGISTRO
    </value>
  </query>
  <query>
    <name>S_J_DPA_EL_REGISTRI__L_AOO_UO</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      A.VAR_CODICE,
      A.NUM_RIF,
      A.VAR_DESC_REGISTRO,
      A.VAR_EMAIL_REGISTRO,
      A.CHA_STATO,
      A.ID_AMM,
      @param1@
      @param2@
      @param3@
      FROM DPA_EL_REGISTRI A, DPA_L_AOO_UO B
      WHERE A.SYSTEM_ID = B.ID_REGISTRO AND A.CHA_RF = '0'
      AND B.ID_UO = @param4@
      ORDER BY A.VAR_DESC_REGISTRO
    </value>
  </query>
  <query>
    <name>S_DPAElRegistri</name>
    <value>
      SELECT @param1@
      FROM DPA_EL_REGISTRI WITH(NOLOCK)
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>S_DPAElRegistri_IS</name>
    <value>
      SELECT @param1@
      FROM DPA_EL_REGISTRI R, DPA_AMMINISTRA A
      WHERE A.VAR_CODICE_AMM = '@codiceAmministrazione@'
      AND R.ID_AMM = A.SYSTEM_ID
      AND R.VAR_CODICE = '@codiceRegistro@'
    </value>
  </query>
  <query>
    <name>S_DPAELRegistri1</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      A.VAR_CODICE,
      A.NUM_RIF,
      A.VAR_DESC_REGISTRO,
      A.VAR_EMAIL_REGISTRO,
      A.CHA_STATO,
      A.ID_AMM,
      @param1@
      @param2@
      @param3@
      FROM DPA_EL_REGISTRI A
      @param100@
    </value>
  </query>
  <query>
    <name>S_DPAELRegistri2</name>
    <value>
      SELECT
      SYSTEM_ID,
      VAR_CODICE,
      VAR_EMAIL_REGISTRO,
      VAR_USER_MAIL,
      VAR_PWD_MAIL,
      VAR_SERVER_POP,
      NUM_PORTA_POP,
      CHA_STATO,CHA_POP_SSL,
      CHA_SMTP_SSL,
      CHA_SMTP_STA,
      CHA_IMAP_SSL,
      VAR_SERVER_IMAP,
      NUM_PORTA_IMAP,
      VAR_TIPO_CONNESSIONE,
      VAR_INBOX_IMAP,
      VAR_BOX_MAIL_ELABORATE,
      VAR_MAIL_NON_ELABORATE,
      VAR_SOLO_MAIL_PEC
      FROM DPA_EL_REGISTRI
      WHERE SYSTEM_ID = @param1@
    </value>
  </query>
  <query>
    <name>S_DPAELRegistri3</name>
    <value>
      SELECT
      SYSTEM_ID,
      CHA_STATO,
      @param1@ AS DTA_CLOSE,
      VAR_DESC_REGISTRO
      FROM DPA_EL_REGISTRI
      WHERE SYSTEM_ID = @param2@
      ORDER BY SYSTEM_ID DESC
    </value>
  </query>
  <query>
    <name>S_DPAELRegistri4</name>
    <value>
      SELECT
      VAR_CODICE
      FROM DPA_EL_REGISTRI
      WHERE SYSTEM_ID = @param1@
    </value>
  </query>
  <query>
    <name>S_J_DPA_EL_REGISTRI__AMMINISTRA</name>
    <value>
      SELECT
      A.VAR_CODICE,
      B.VAR_CODICE_AMM
      FROM DPA_EL_REGISTRI A, DPA_AMMINISTRA B
      WHERE A.SYSTEM_ID = @param1@
      AND B.SYSTEM_ID=A.ID_AMM
    </value>
  </query>
  <query>
    <name>S_J_DPA_EL_REGISTRI__AMMINISTRA2</name>
    <value>
      SELECT  A.VAR_CODICE,
      A.ID_AMM,
      A.VAR_USER_MAIL,
      A.VAR_PWD_MAIL,
      A.VAR_SERVER_SMTP,
      A.NUM_PORTA_SMTP,
      A.VAR_EMAIL_REGISTRO,
      B.VAR_CODICE_AMM,
      A.VAR_USER_SMTP,
      B.CHA_STR_SEGNATURA,
      A.VAR_PWD_SMTP,A.CHA_POP_SSL,A.CHA_SMTP_SSL,A.CHA_SMTP_STA,
      A.VAR_SERVER_IMAP,
      A.NUM_PORTA_IMAP,
      A.VAR_TIPO_CONNESSIONE,
      A.VAR_INBOX_IMAP,
      A.VAR_BOX_MAIL_ELABORATE,
      A.VAR_MAIL_NON_ELABORATE,
      A.CHA_IMAP_SSL,
      A.VAR_SOLO_MAIL_PEC
      FROM DPA_EL_REGISTRI A, DPA_AMMINISTRA B
      WHERE A.SYSTEM_ID = @param1@
      AND B.SYSTEM_ID = A.ID_AMM
    </value>
  </query>
  <query>
    <name>S_J_DPA_EL_REGISTRI__AMMINISTRA3</name>
    <value>
      SELECT
      A.VAR_CODICE,
      A.VAR_USER_MAIL,
      A.VAR_PWD_MAIL,
      A.VAR_SERVER_SMTP,
      A.NUM_PORTA_SMTP,
      A.VAR_EMAIL_REGISTRO,
      B.VAR_CODICE_AMM,
      A.VAR_USER_SMTP,
      A.VAR_PWD_SMTP,A.CHA_SMTP_SSL,A.CHA_POP_SSL,A.CHA_SMTP_STA,
      A.VAR_SERVER_IMAP,
      A.NUM_PORTA_IMAP,
      A.VAR_TIPO_CONNESSIONE,
      A.VAR_INBOX_IMAP,
      A.VAR_BOX_MAIL_ELABORATE,
      A.VAR_MAIL_NON_ELABORATE,
      A.CHA_IMAP_SSL,
      A.VAR_SOLO_MAIL_PEC,
      A.CHA_RICEVUTA_PEC
      FROM DPA_EL_REGISTRI A, DPA_AMMINISTRA B
      WHERE A.SYSTEM_ID = @param1@
      AND B.SYSTEM_ID = A.ID_AMM
    </value>
  </query>
  <query>
    <name>S_J_DPA_EL_REGISTRI__L_RUOLO_REG</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      A.VAR_CODICE,
      A.NUM_RIF,
      A.VAR_DESC_REGISTRO,
      A.VAR_EMAIL_REGISTRO,
      A.CHA_STATO, A.ID_AMM,
      @param1@
      @param2@
      @param3@
      FROM DPA_EL_REGISTRI A, DPA_L_RUOLO_REG B
      WHERE A.SYSTEM_ID = B.ID_REGISTRO
      AND B.ID_RUOLO_IN_UO = @param4@ AND A.CHA_RF = '0'
      ORDER BY A.VAR_DESC_REGISTRO
    </value>
  </query>
  <query>
    <name>S_DPAFirmatari</name>
    <value>
      SELECT
      SYSTEM_ID,
      VAR_COD_FISCALE
      FROM DPA_FIRMATARI
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>S_J_DPA_FIRMATARI__FIRMA_VERS</name>
    <value>
      SELECT @param1@
      FROM DPA_FIRMATARI A, DPA_FIRMA_VERS B
      WHERE A.SYSTEM_ID = B.ID_FIRMATARIO
      AND B.ID_VERSIONE = @param2@
    </value>
  </query>
  <query>
    <name>S_DPAFormattaFasc</name>
    <value>
      SELECT
      VAR_STRINGA,
      ID_PESO
      FROM DPA_FORMATTA_FASC
      WHERE CHA_VISUALIZZA = '1'
      AND ID_AMM = @param1@
      ORDER BY ID_PESO
    </value>
  </query>
  <query>
    <name>S_J_DPA_FUNZIONI__TIPO_FUNZIONE__TIPO_F_RUOLO</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      A.COD_FUNZIONE,
      A.VAR_DESC_FUNZIONE,
      A.ID_TIPO_FUNZIONE,
      B.VAR_COD_TIPO, B.VAR_DESC_TIPO_FUN
      FROM DPA_FUNZIONI A, DPA_TIPO_FUNZIONE B, DPA_TIPO_F_RUOLO C
      WHERE A.ID_TIPO_FUNZIONE = B.SYSTEM_ID
      AND B.SYSTEM_ID = C.ID_TIPO_FUNZ
      AND @param1@
    </value>
  </query>
  <query>
    <name>S_J_DPA_FUNZIONI__TIPO_F_RUOLO</name>
    <value>
      SELECT
      B.SYSTEM_ID
      FROM DPA_FUNZIONI A, DPA_TIPO_F_RUOLO B
      WHERE B.ID_TIPO_FUNZ = A.ID_TIPO_FUNZIONE
      AND A.COD_FUNZIONE = @param1@
      AND B.ID_RUOLO_IN_UO = @param2@
    </value>
  </query>
  <query>
    <name>S_J_DPA_TIPO_FUNZIONE__TIPO_F_RUOLO</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      A.VAR_COD_TIPO,
      A.VAR_DESC_TIPO_FUN,
      A.CHA_VIS
      FROM DPA_TIPO_FUNZIONE A, DPA_TIPO_F_RUOLO B
      WHERE A.SYSTEM_ID = B.ID_TIPO_FUNZ
      AND B.ID_RUOLO_IN_UO = @param1@
      ORDER BY A.VAR_DESC_TIPO_FUN
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__TIPO_RUOLO__L_RUOLO_REG</name>
    <value>
      SELECT
      B.*,
      C.NUM_LIVELLO AS liv
      FROM DPA_L_RUOLO_REG A, DPA_CORR_GLOBALI B, DPA_TIPO_RUOLO C
      WHERE A.ID_REGISTRO = @param1@
      AND A.CHA_RIFERIMENTO = '1'
      AND B.SYSTEM_ID = A.ID_RUOLO_IN_UO
      AND C.SYSTEM_ID = B.ID_TIPO_RUOLO
    </value>
  </query>
  <query>
    <name>S_J_DPA_L_RUOLO_REG__EL_REGISTRI</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      A.VAR_CODICE,
      A.NUM_RIF,
      A.VAR_DESC_REGISTRO,
      A.VAR_EMAIL_REGISTRO,
      A.CHA_STATO,
      A.ID_AMM,
      @param1@,
      A.DIRITTO_RUOLO_AOO,
      A.INVIO_RICEVUTA_MANUALE,
      A.FLAG_WSPIA
      FROM DPA_L_RUOLO_REG B, DPA_EL_REGISTRI A
      WHERE A.SYSTEM_ID = B.ID_REGISTRO AND CHA_RF = '0'
      AND @param2@
      ORDER BY @param3@
    </value>
  </query>
  <query>
    <name>S_DPAMailElab</name>
    <value>
      SELECT *
      FROM DPA_MAIL_ELABORATE WITH(NOLOCK)
      WHERE VAR_MESSAGE = @param1@
      and cha_ragione_elab = 'E'
      AND(ID_REGISTRO IS NULL
      OR ID_REGISTRO = @idRegistro@)
    </value>
  </query>
  <query>
    <name>S_DPAOggettario2</name>
    <value>
      SELECT @param1@
      FROM DPA_OGGETTARIO A LEFT OUTER JOIN DPA_EL_REGISTRI B ON A.ID_REGISTRO = B.SYSTEM_ID
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>S_DPAOggSto</name>
    <value>
      SELECT
      @param1@ AS DTA_MODIFICA
      FROM DPA_OGGETTI_STO
      WHERE ID_PROFILE = @param2@
    </value>
  </query>
  <query>
    <name>S_J_DPA_OGGETTI_STO__OGGETTARIO</name>
    <value>
      SELECT @param1@
      FROM DPA_OGGETTI_STO A, DPA_OGGETTARIO B
      WHERE A.ID_OGGETTO = B.SYSTEM_ID
      AND @param2@
    </value>
  </query>
  <query>
    <name>S_DPAParole</name>
    <value>
      SELECT COUNT(*)
      FROM DPA_PAROLE
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>S_DPAParole2</name>
    <value>
      SELECT
      SYSTEM_ID,
      VAR_DESC_PAROLA
      FROM DPA_PAROLE
      WHERE @param1@
      ORDER BY VAR_DESC_PAROLA
    </value>
  </query>
  <query>
    <name>S_J_DPA_PROF_PAROLE__PAROLE</name>
    <value>
      SELECT
      DPA_PROF_PAROLE.ID_PAROLA,
      DPA_PAROLE.VAR_DESC_PAROLA,
      DPA_PAROLE.ID_AMM,
      DPA_PROF_PAROLE.ID_PROFILE
      FROM DPA_PROF_PAROLE, DPA_PAROLE
      WHERE DPA_PROF_PAROLE.ID_PAROLA = DPA_PAROLE.SYSTEM_ID
      AND @param1@
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__PEOPLE</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      A.USER_ID,
      B.SYSTEM_ID,
      B.VAR_DESC_CORR,
      B.VAR_COD_RUBRICA,
      B.ID_AMM,
      B.CHA_TIPO_IE,
      B.VAR_NOME,
      B.VAR_COGNOME,
      A.CHA_NOTIFICA
      FROM PEOPLE A, DPA_CORR_GLOBALI B
      WHERE A.SYSTEM_ID = B.ID_PEOPLE
      AND B.CHA_TIPO_URP = 'P'
      AND B.DTA_FINE IS NULL
      @param1@
      ORDER BY B.VAR_DESC_CORR
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__PEOPLE2</name>
    <value>
      SELECT
      A.USER_ID,
      B.SYSTEM_ID,
      B.VAR_DESC_CORR,
      B.VAR_COD_RUBRICA,
      B.ID_AMM,
      B.CHA_TIPO_IE,
      B.VAR_NOME,
      B.VAR_COGNOME,
      A.CHA_NOTIFICA,
      B.VAR_SMTP,
      B.NUM_PORTA_SMTP
      FROM  PEOPLE A, DPA_CORR_GLOBALI B
      WHERE A.SYSTEM_ID = B.ID_PEOPLE
      AND B.CHA_TIPO_URP = 'P'
      @param1@
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__PEOPLEGROUPS__CORR_GLOBALI</name>
    <value>
      SELECT
      A.GROUPS_SYSTEM_ID,
      B.SYSTEM_ID,
      B.VAR_DESC_CORR,
      B.VAR_COD_RUBRICA,
      B.ID_AMM,
      B.ID_UO,
      C.VAR_DESC_CORR
      FROM
      PEOPLEGROUPS A, DPA_CORR_GLOBALI B, DPA_CORR_GLOBALI C
      WHERE
      A.GROUPS_SYSTEM_ID = B.ID_GRUPPO
      AND B.ID_UO = C.SYSTEM_ID
      AND A.PEOPLE_SYSTEM_ID = @param1@
      AND A.DTA_FINE IS NULL
      ORDER BY B.VAR_DESC_CORR
    </value>
  </query>
  <query>
    <name>S_J_RUOLO_PREFERITO_UTENTE</name>
    <value>
      SELECT
      A.GROUPS_SYSTEM_ID,
      B.SYSTEM_ID,
      B.VAR_DESC_CORR,
      B.VAR_COD_RUBRICA,
      B.ID_AMM,
      B.ID_UO,
      C.VAR_DESC_CORR
      FROM
      PEOPLEGROUPS A, DPA_CORR_GLOBALI B, DPA_CORR_GLOBALI C
      WHERE
      A.GROUPS_SYSTEM_ID = B.ID_GRUPPO
      AND B.ID_UO = C.SYSTEM_ID
      AND A.PEOPLE_SYSTEM_ID = @param1@
      AND A.DTA_FINE IS NULL
      ORDER BY A.CHA_PREFERITO DESC
    </value>
  </query>
  <query>
    <name>S_J_PEOPLE__PEOPLEGROUPS</name>
    <value>
      SELECT
      A.USER_ID,
      A.USER_PASSWORD
      FROM
      PEOPLE A, PEOPLEGROUPS B
      WHERE
      A.SYSTEM_ID = B.PEOPLE_SYSTEM_ID
      AND B.GROUPS_SYSTEM_ID = @param1@
      AND B.CHA_UTENTE_RIF = '1'
      AND B.DTA_FINE IS NULL
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__PROFILE__DOC_ARRIVO_PAR</name>
    <value>
      SELECT
      A.VAR_PROTO_IN,
      A.DTA_PROTO_IN,
      B.VAR_CODICE_AMM,
      B.CHA_TIPO_IE,
      B.VAR_COD_RUBRICA,
      B.ID_AMM,
      B.SYSTEM_ID
      FROM PROFILE A WITH(NOLOCK),
      DPA_CORR_GLOBALI B,
      DPA_DOC_ARRIVO_PAR C
      WHERE A.SYSTEM_ID = @param1@
      AND B.SYSTEM_ID = C.ID_MITT_DEST
      AND C.ID_PROFILE = A.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__UFFICIO_REFERENTE</name>
    <value>
      SELECT
      A.SYSTEM_ID, A.VAR_COD_RUBRICA, A.ID_AMM, A.CHA_TIPO_CORR, A.VAR_DESC_CORR, P.CHA_TIPO_PROTO
      FROM  DPA_CORR_GLOBALI A , PROFILE P
      WHERE P.SYSTEM_ID = @param1@
      AND P.ID_UO_REF = A.SYSTEM_ID AND A.CHA_TIPO_IE = 'I'
    </value>
  </query>
  <query>
    <name>S_PROFILE_ID_UO_REF</name>
    <value>
      SELECT ID_UO_REF FROM PROFILE WITH(NOLOCK) WHERE SYSTEM_ID = @param1@
    </value>
  </query>
  <query>
    <name>U_PROFILE_ID_UO_REF</name>
    <value>
      UPDATE PROFILE SET ID_UO_REF = @param1@, LAST_EDIT_DATE = GETDATE() WHERE SYSTEM_ID = @param2@
    </value>
  </query>
  <query>
    <name>S_J_PROFILE__DPA_EL_REGISTRI</name>
    <value>
      SELECT
      A.SYSTEM_ID
      FROM PROFILE A WITH(NOLOCK), DPA_EL_REGISTRI B
      WHERE A.ID_REGISTRO = B.SYSTEM_ID
      AND B.VAR_CODICE = '@param1@'
      AND A.NUM_PROTO = @param2@
      AND A.NUM_ANNO_PROTO = @param3@
    </value>
  </query>
  <query>
    <name>S_Profile</name>
    <value>
      SELECT
      DTA_PROTO,
      NUM_PROTO,
      DTA_ANNULLA,
      VAR_AUT_ANNULLA
      FROM PROFILE WITH(NOLOCK)
      WHERE SYSTEM_ID = @param1@
    </value>
  </query>
  <query>
    <name>S_DPARagTrasm</name>
    <value>
      SELECT *
      FROM DPA_RAGIONE_TRASM
      WHERE CHA_TIPO_RAGIONE='N'
      AND CHA_TIPO_DIRITTI='W'
    </value>
  </query>
  <query>
    <name>S_DPARagTrasm2</name>
    <value>
      SELECT *
      FROM DPA_RAGIONE_TRASM
      WHERE CHA_TIPO_RAGIONE = '@param2@'
      AND CHA_TIPO_DIRITTI = 'W'
      AND ID_AMM=@param1@
    </value>
  </query>
  <query>
    <name>S_DPARagNotifica</name>
    <value>
      SELECT
      SYSTEM_ID,
      VAR_DESC_RAGIONE,
      CHA_TIPO_RAGIONE,
      CHA_TIPO_DIRITTI,
      CHA_RISPOSTA,
      CHA_TIPO_DEST,
      VAR_NOTE,
      CHA_EREDITA,
      CHA_TIPO_RISPOSTA,
      VAR_NOTIFICA_TRASM,
      CHA_CEDE_DIRITTI
      FROM DPA_RAGIONE_TRASM
      WHERE
      CHA_TIPO_DIRITTI = 'N'
      AND
      VAR_DESC_RAGIONE = 'NOTIFICA'
      AND
      (ID_AMM=@idAmm@ OR ID_AMM is null)
    </value>
  </query>
  <query>
    <name>S_DPARagTrasm3</name>
    <value>
      SELECT
      SYSTEM_ID,
      VAR_DESC_RAGIONE,
      CHA_TIPO_RAGIONE,
      CHA_TIPO_DIRITTI,
      CHA_RISPOSTA,
      CHA_TIPO_DEST,
      VAR_NOTE,
      CHA_EREDITA,
      CHA_TIPO_RISPOSTA,
      VAR_NOTIFICA_TRASM,
      VAR_TESTO_MSG_NOTIFICA_DOC,
      VAR_TESTO_MSG_NOTIFICA_FASC,
      CHA_CEDE_DIRITTI,
      CHA_MANTIENI_LETT,
      CHA_MANTIENI_SCRITT
      FROM DPA_RAGIONE_TRASM
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>S_DPARagTrasm_ALL</name>
    <value>
      SELECT
      @param1@
      FROM DPA_RAGIONE_TRASM
      @param2@
    </value>
  </query>
  <query>
    <name>S_All_DPARagTrasm</name>
    <value>
      SELECT
      SYSTEM_ID,
      VAR_DESC_RAGIONE,
      CHA_TIPO_RAGIONE,
      CHA_TIPO_DIRITTI,
      CHA_RISPOSTA,
      CHA_TIPO_DEST,
      VAR_NOTE,
      CHA_EREDITA,
      CHA_TIPO_RISPOSTA,
      VAR_NOTIFICA_TRASM,
      VAR_TESTO_MSG_NOTIFICA_DOC,
      VAR_TESTO_MSG_NOTIFICA_FASC,
      CHA_CEDE_DIRITTI,
      CHA_MANTIENI_LETT
      FROM DPA_RAGIONE_TRASM
    </value>
  </query>
  <query>
    <name>S_DPARagTrasm4</name>
    <value>
      SELECT
      COUNT(*) AS TOT
      FROM
      DPA_AMMINISTRA a, DPA_RAGIONE_TRASM b
      WHERE
      a.SYSTEM_ID = @param1@
      AND a.SYSTEM_ID = b.ID_AMM
      AND (
      (a.VAR_RAGIONE_TO = b.VAR_DESC_RAGIONE)
      OR
      (a.VAR_RAGIONE_CC = b.VAR_DESC_RAGIONE)

    </value>
  </query>
  <query>
    <name>S_DPARagTrasm4Bis</name>
    <value>
      SELECT
      DISTINCT ID_RAGIONE_TO, ID_RAGIONE_CC @param2@
      FROM
      DPA_AMMINISTRA a, DPA_RAGIONE_TRASM b
      WHERE
      a.SYSTEM_ID = @param1@
      AND a.SYSTEM_ID = b.ID_AMM
      AND ((a.ID_RAGIONE_TO = b.SYSTEM_ID)
      OR
      (a.ID_RAGIONE_CC = b.SYSTEM_ID) @param3@

    </value>
  </query>
  <query>
    <name>S_DPARagTrasm5</name>
    <value>
      SELECT
      a.SYSTEM_ID,
      a.VAR_DESC_RAGIONE,
      a.CHA_TIPO_RAGIONE,
      a.CHA_TIPO_DIRITTI,
      a.CHA_RISPOSTA,
      a.CHA_TIPO_DEST,
      a.VAR_NOTE,
      a.CHA_EREDITA,
      a.CHA_TIPO_RISPOSTA,
      a.VAR_NOTIFICA_TRASM,
      a.VAR_TESTO_MSG_NOTIFICA_DOC,
      a.VAR_TESTO_MSG_NOTIFICA_FASC,
      a.CHA_CEDE_DIRITTI,
      a.CHA_MANTIENI_LETT
      FROM DPA_RAGIONE_TRASM a, DPA_AMMINISTRA b
      WHERE a.ID_AMM = @param1@
      AND a.ID_AMM = b.SYSTEM_ID
      AND a.SYSTEM_ID = b.ID_RAGIONE_@param2@
    </value>
  </query>
  <query>
    <name>S_DPARagTrasm6</name>
    <value>
      SELECT
      ID_RAGIONE_REFERENTE
      FROM
      DPA_AMMINISTRA A, DPA_RAGIONE_TRASM B
      WHERE
      A.SYSTEM_ID = @param1@
      AND A.SYSTEM_ID = B.ID_AMM
      AND (A.ID_RAGIONE_REFERENTE = B.SYSTEM_ID)
    </value>
  </query>
  <query>
    <name>S_DPARegProto</name>
    <value>
      SELECT NUM_RIF
      FROM DPA_REG_PROTO WITH(NOLOCK)
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>S_DescRegistroBySystemId</name>
    <value>
      SELECT VAR_CODICE
      FROM DPA_EL_REGISTRI
      WHERE SYSTEM_ID = @param1@
    </value>
  </query>
  <query>
    <name>S_DPAServerPosta</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      A.VAR_SERVER_POP,
      A.NUM_PORTA_POP,
      A.VAR_SERVER_SMTP,
      A.NUM_PORTA_SMTP,
      A.VAR_DESCRIZIONE,
      A.VAR_DOMINIO
      FROM DPA_SERVER_POSTA A
      ORDER BY A.VAR_DESCRIZIONE
    </value>
  </query>
  <query>
    <name>S_DPAStampaReg</name>
    <value>
      SELECT
      SYSTEM_ID,
      ID_REGISTRO,
      NUM_PROTO_START,
      NUM_PROTO_END,
      NUM_ANNO,
      NUM_ORD_FILE,
      NUM_PAGINA_END,
      DOCNUMBER,
      @param1@ AS DTA_STAMPA
      FROM DPA_STAMPAREGISTRI
      WHERE ID_REGISTRO = @param2@
      ORDER BY NUM_ANNO DESC,
      NUM_PROTO_END DESC,
      DTA_STAMPA DESC
    </value>
  </query>
  <query>
    <name>S_DPAStatoinvio</name>
    <value>
      SELECT @param1@
      FROM DPA_STATO_INVIO
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>S_DPATCanaleCorr</name>
    <value>
      SELECT ID_DOCUMENTTYPE
      FROM DPA_T_CANALE_CORR
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>S_DPATCanaleCorr1</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      A.DESCRIPTION,
      A.TYPE_ID
      FROM DOCUMENTTYPES A, DPA_T_CANALE_CORR B
      WHERE A.SYSTEM_ID = B.ID_DOCUMENTTYPE
      AND B.ID_CORR_GLOBALE = @param1@
      AND B.CHA_PREFERITO = '1'
    </value>
  </query>
  <query>
    <name>S_DPATCanaleCorr2</name>
    <value>
      SELECT SYSTEM_ID
      FROM DPA_T_CANALE_CORR
      WHERE ID_CORR_GLOBALE = @param1@
      @param2@
    </value>
  </query>
  <query>
    <name>S_J_DPA_T_CANALE_CORR__DOCUMENTTYPES</name>
    <value>
      SELECT
      A.SYSTEM_ID
      FROM DPA_T_CANALE_CORR A, DOCUMENTTYPES B
      WHERE A.ID_DOCUMENTTYPE = B.SYSTEM_ID
      AND B.CHA_TIPO_CANALE='F'
      AND A.ID_CORR_GLOBALE = @param1@
      AND A.CHA_PREFERITO = '1'
    </value>
  </query>
  <query>
    <name>S_J_DPA_T_CANALE_CORR__DOCUMENTTYPES2</name>
    <value>
      SELECT
      A.SYSTEM_ID
      FROM DPA_T_CANALE_CORR A, DOCUMENTTYPES B
      WHERE A.ID_DOCUMENTTYPE = B.SYSTEM_ID
      AND B.CHA_TIPO_CANALE  in ( 'M','I') <!--= 'M'-->
      AND A.ID_CORR_GLOBALE = @param1@
      AND A.CHA_PREFERITO = '1'
    </value>
  </query>
  <query>
    <name>S_DPATipoAtto</name>
    <value>
      SELECT SYSTEM_ID, VAR_DESC_ATTO
      FROM DPA_TIPO_ATTO
      WHERE SYSTEM_ID = @param1@
    </value>
  </query>

  <query>
    <name>S_DPATipoAtto3</name>
    <value>
      SELECT
      SYSTEM_ID
      FROM DPA_TIPO_ATTO
      WHERE VAR_DESC_ATTO = @param1@
    </value>
  </query>
  <query>
    <name>S_DPATipoAtto4</name>
    <value>
      SELECT SYSTEM_ID, VAR_DESC_ATTO
      FROM DPA_TIPO_ATTO
      WHERE
      (ID_AMM = @param2@ OR ID_AMM IS NULL) AND
      (In_Esercizio &lt;&gt; 'NO' OR In_Esercizio IS NULL) AND
      (Abilitato_SI_NO &lt;&gt; 0 OR Abilitato_SI_NO IS NULL)
      ORDER BY @param1@
    </value>
  </query>
  <query>
    <name>S_DPATipoFunzione</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      A.VAR_COD_TIPO,
      A.VAR_DESC_TIPO_FUN,
      A.CHA_VIS
      FROM DPA_TIPO_FUNZIONE A
      @param1@
    </value>
  </query>
  <query>
    <name>S_DPATipoRuolo</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      A.ID_AMM,
      A.ID_PARENT,
      A.NUM_LIVELLO,
      A.VAR_CODICE,
      A.VAR_DESC_RUOLO
      FROM DPA_TIPO_RUOLO A
      @param1@
    </value>
  </query>
  <query>
    <name>S_DPATrasmissione</name>
    <value>
      SELECT SYSTEM_ID
      FROM DPA_TRASMISSIONE
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>S_J_DPA_TRASMISSIONE__TRASM_SINGOLA__TRASM_UTENTE2</name>
    <value>
      SELECT /*+index(c) index(b) index(a) */ @param1@,
      ISNULL(@dbuser@.Vardescribe(id_profile,'SEGNATURA_CODFASC'),@dbuser@.Vardescribe(id_project,'CODFASC')) ID_SEGN_CODFASC,
      ISNULL(@dbuser@.Vardescribe(id_profile,'DATADOC'),@dbuser@.Vardescribe(id_project,'DATA_CREAZ')) DATA_DOC_FASC,
      z.var_desc_corr, e.full_name, f.var_desc_corr AS desc_ruolo_mitt,
      g.cha_tipo_ragione, g.var_desc_ragione, g.cha_eredita,
      g.cha_tipo_diritti, h.FULL_NAME as desc_destinatario, f.var_codice as cod_ruolo_mitt,
      e.user_id, g.cha_risposta,
      g.cha_tipo_dest AS tipo_dest_rag, g.var_note, g.cha_tipo_risposta,
      g.var_notifica_trasm, g.var_testo_msg_notifica_doc,
      g.var_testo_msg_notifica_fasc, g.cha_cede_diritti,
      g.cha_mantieni_lett
      FROM   DPA_TRASM_UTENTE C,DPA_TRASM_SINGOLA B,DPA_TRASMISSIONE A, dpa_corr_globali z,
      people e,
      dpa_corr_globali f,
      dpa_ragione_trasm g,
      people h
      @param2@
      WHERE @param3@
      AND z.system_id = b.id_corr_globale
      AND e.system_id = a.id_people
      AND f.system_id = a.id_ruolo_in_uo
      AND g.system_id = b.id_ragione
      AND h.system_id = c.id_people
      ORDER BY A.DTA_INVIO DESC, B.ID_TRASMISSIONE DESC, C.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>S_J_DPA_TRASMISSIONE__TRASM_SINGOLA__RAGIONE_TRASM</name>
    <value>
      SELECT @param1@
      FROM DPA_TRASMISSIONE A, DPA_TRASM_SINGOLA B, DPA_RAGIONE_TRASM D
      WHERE A.SYSTEM_ID = B.ID_TRASMISSIONE
      AND B.ID_RAGIONE = D.SYSTEM_ID
      AND D.CHA_TIPO_RISPOSTA = 'C'
    </value>
  </query>
  <query>
    <name>S_DPATemplTrasm</name>
    <value>
      SELECT COUNT(*)
      FROM DPA_TEMPL_TRASM
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>S_J_DPA_TRASMISSIONE__TEMPL_TRASM</name>
    <value>
      SELECT A.SYSTEM_ID, A.ID_TRASMISSIONE, A.VAR_TEMPLATE
      FROM DPA_TEMPL_TRASM A, DPA_TRASMISSIONE B
      WHERE A.ID_TRASMISSIONE = B.SYSTEM_ID
      AND @param1@
      ORDER BY @param2@
    </value>
  </query>
  <query>
    <name>S_Apps</name>
    <value>
      SELECT
      @param1@
      FROM APPS
      @param2@
    </value>
  </query>
  <query>
    <name>S_Apps2</name>
    <value>
      SELECT
      SYSTEM_ID,
      DEFAULT_EXTENSION
      FROM APPS
      ORDER BY @param1@
    </value>
  </query>
  <query>
    <name>S_Components</name>
    <value>
      SELECT
      @param1@
      FROM COMPONENTS
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>S_J_COMPONENTS__VERSIONS</name>
    <value>
      SELECT
      A.VAR_IMPRONTA,
      B.VERSION
      FROM COMPONENTS A, VERSIONS B
      WHERE A.VERSION_ID = B.VERSION_ID
      AND A.DOCNUMBER = @param1@
      ORDER BY B.VERSION DESC
    </value>
  </query>
  <query>
    <name>S_J_COMPONENTS__VERSIONS2</name>
    <value>
      SELECT @param1@
      FROM COMPONENTS A, VERSIONS B ,People P
      @param2@
    </value>
  </query>
  <query>
    <name>S_J_COMPONENTS__VERSIONS3</name>
    <value>
      SELECT @param1@
      FROM COMPONENTS A, VERSIONS B
      @param2@
    </value>
  </query>
  <query>
    <name>S_DocumentTypes</name>
    <value>
      SELECT
      DESCRIPTION
      FROM DOCUMENTTYPES
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>S_DocumentTypes1</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      A.TYPE_ID,
      A.DESCRIPTION,
      A.CHA_TIPO_CANALE
      FROM DOCUMENTTYPES A
      ORDER BY A.DESCRIPTION
    </value>
  </query>
  <query>
    <name>S_DocumentTypes2</name>
    <value>
      SELECT
      SYSTEM_ID
      FROM DOCUMENTTYPES
      WHERE CHA_TIPO_CANALE IN ('M', 'I')
    </value>
  </query>
  <query>
    <name>S_DocumentTypes3</name>
    <value>
      SELECT
      SYSTEM_ID,
      TYPE_ID,
      DESCRIPTION
      FROM DOCUMENTTYPES
      WHERE DISABLED IS NULL
    </value>
  </query>
  <query>
    <name>S_DocumentTypes4</name>
    <value>
      SELECT
      SYSTEM_ID
      FROM DOCUMENTTYPES
      WHERE TYPE_ID = @param1@
    </value>
  </query>
  <query>
    <name>S_DocumentTypes5</name>
    <value>
      SELECT
      CHA_TIPO_CANALE
      FROM DOCUMENTTYPES
      WHERE SYSTEM_ID = @param1@
    </value>
  </query>
  <query>
    <name>S_DocumentTypes7</name>
    <value>
      SELECT
      LABEL
      FROM DOCUMENTTYPES
      WHERE TYPE_ID = '@param1@'
    </value>
  </query>
  DocsPaWR
  <query>
    <name>S_DocumentTypes8</name>
    <value>
      SELECT
      DESCRIPTION
      FROM DOCUMENTTYPES
      WHERE TYPE_ID = '@param1@'
    </value>
  </query>
  <query>
    <name>S_DocumentTypes6</name>
    <value>
      SELECT
      SYSTEM_ID
      FROM DOCUMENTTYPES
      WHERE CHA_TIPO_CANALE IN ('I')
    </value>
  </query>
  <query>
    <name>S_NetworkAliases</name>
    <value>
      SELECT NETWORK_ID
      FROM NETWORK_ALIASES
      WHERE PERSONORGROUP = @param1@
    </value>
  </query>
  <query>
    <name>S_Components1</name>
    <value>
      SELECT PATH
      FROM COMPONENTS WITH (nolock)
      WHERE VERSION_ID = @param1@
      AND DOCNUMBER=@param2@
    </value>
  </query>
  <query>
    <name>S_People</name>
    <value>
      SELECT @param1@
      FROM PEOPLE
      WHERE @param2@ AND NOT(DISABLED='Y')
    </value>
  </query>
  <query>
    <name>S_People1</name>
    <value>
      SELECT
      SYSTEM_ID
      FROM PEOPLE
      WHERE USER_PASSWORD = @param1@
      AND SYSTEM_ID = @param2@ AND NOT(DISABLED='Y')
    </value>
  </query>
  <query>
    <name>S_People_Disabled</name>
    <value>
      SELECT
      DISABLED
      FROM PEOPLE
      WHERE
      user_Id = '@param1@'
      @param2@
    </value>
  </query>
  <query>
    <name>S_People_all</name>
    <value>
      SELECT @param1@
      FROM PEOPLE
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>S_LOGS</name>
    <value>
      SELECT @param1@
      FROM @param3@
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>S_LOG_DISATTIVI</name>
    <value>
      SELECT VAR_CODICE as CODICE, VAR_DESCRIZIONE as DESCRIZIONE, VAR_OGGETTO as OGGETTO, VAR_METODO as METODO, 0 as ATTIVO
      FROM DPA_ANAGRAFICA_LOG
      WHERE VAR_CODICE not like 'AMM_%'
      ORDER BY VAR_OGGETTO
    </value>
  </query>
  <query>
    <name>J_LOG_ATTIVI_DISATTIVI</name>
    <value>
      SELECT DISTINCT a.VAR_CODICE AS CODICE, a.VAR_DESCRIZIONE AS DESCRIZIONE, a.VAR_OGGETTO AS OGGETTO, VAR_METODO AS METODO, 0 AS ATTIVO,
      case when a.NOTIFICATION is null then '0' else a.NOTIFICATION end as notification,
      case when a.CONFIGURABLE is null then '0' else a.CONFIGURABLE end as configurable
      FROM DPA_ANAGRAFICA_LOG a , DPA_LOG_ATTIVATI b
      WHERE a.system_id NOT IN
      (SELECT system_id_anagrafica FROM DPA_LOG_ATTIVATI WHERE id_amm = @param1@)
      AND b.ID_AMM = @param1@
      AND (a.id_amm = @param1@ OR a.id_amm is null)
      AND a.VAR_CODICE not like 'AMM_%'
      ORDER BY a.VAR_OGGETTO
    </value>
  </query>
  <query>
    <name>S_Login</name>
    <value>
      SELECT
      SYSTEM_ID
      FROM PEOPLE
      WHERE
      user_Id = '@param1@'
      AND user_password = '@param2@'
      AND DISABLED = 'N' AND (ID_AMM=@param3@ OR ID_AMM IS NULL)
    </value>
  </query>
  <query>
    <name>S_Login_verificaUser</name>
    <value>
      SELECT
      SYSTEM_ID
      FROM PEOPLE
      WHERE
      user_Id = '@param1@'
      AND DISABLED = 'N'
      AND (ID_AMM=@param2@ OR ID_AMM IS NULL)
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__PEOPLE__SECURITY2</name>
    <value>
      SELECT DISTINCT A.SYSTEM_ID, C.ID_REGISTRO, C.ID_AMM, A.VAR_NOME,
      A.VAR_COGNOME, C.VAR_COD_RUBRICA, B.CHA_TIPO_DIRITTO, B.PERSONORGROUP, B.ACCESSRIGHTS, A.DISABLED
      FROM PEOPLE A, SECURITY as B  WITH (nolock) , DPA_CORR_GLOBALI C
      WHERE B.THING= @param1@
      AND A.SYSTEM_ID=B.PERSONORGROUP AND C.ID_PEOPLE=A.SYSTEM_ID AND C.CHA_TIPO_URP &lt;&gt; 'L'
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__PEOPLE__DELETED_SECURITY_UTENTI</name>
    <value>
      SELECT DISTINCT A.SYSTEM_ID, C.ID_REGISTRO, C.ID_AMM, A.VAR_NOME,
      A.VAR_COGNOME, C.VAR_COD_RUBRICA, B.CHA_TIPO_DIRITTO, B.ACCESSRIGHTS, B.NOTE, B.PERSONORGROUP
      FROM PEOPLE A, DELETED_SECURITY B, DPA_CORR_GLOBALI C
      WHERE B.THING= @param1@
      AND A.SYSTEM_ID=B.PERSONORGROUP AND C.ID_PEOPLE=A.SYSTEM_ID AND C.CHA_TIPO_URP &lt;&gt; 'L'
    </value>
  </query>
  <query>
    <name>S_J_PEOPLE__PEOPLEGROUPS2</name>
    <value>
      SELECT DISTINCT
      A.SYSTEM_ID,
      A.USER_ID
      @param1@
      AND A.ID_AMM = @param2@
      ORDER BY A.USER_ID
    </value>
  </query>
  <query>
    <name>S_Profile0</name>
    <value>
      SELECT @param1@
      FROM PROFILE WITH(NOLOCK)
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>S_Profile1</name>
    <value>
      SELECT
      DISTINCT NUM_ANNO_PROTO
      FROM PROFILE WITH(NOLOCK)
      WHERE ID_REGISTRO = @param1@
      AND (CHA_TIPO_PROTO = 'P' OR CHA_TIPO_PROTO = 'I' OR CHA_TIPO_PROTO = 'A')
      AND NUM_ANNO_PROTO IS NOT NULL
      ORDER BY NUM_ANNO_PROTO
    </value>
  </query>
  <query>
    <name>S_Profile2</name>
    <value>
      SELECT
      DISTINCT A.SYSTEM_ID
      FROM PROFILE A WITH(NOLOCK)
      WHERE A.CHA_TIPO_PROTO IN ('A','P', 'I')
      AND A.NUM_ANNO_PROTO = @param1@
      AND A.NUM_PROTO @param2@
      AND A.NUM_PROTO @param3@
      AND A.ID_REGISTRO = @param4@
      ORDER BY A.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>S_Profile3</name>
    <value>
      SELECT
      MAX(NUM_PROTO) AS NUMMAX
      FROM PROFILE
      WHERE ID_REGISTRO = @param1@
      AND NUM_ANNO_PROTO = @param2@
      AND (CHA_TIPO_PROTO = 'P' OR CHA_TIPO_PROTO = 'I' OR CHA_TIPO_PROTO = 'A')
    </value>
  </query>
  <query>
    <name>S_J_PROFILE__COMPONENTS__VERSIONS</name>
    <value>
      select * from (
      SELECT  A.DOCNUMBER,
      A.DOCSERVER_LOC,
      A.VAR_PROF_OGGETTO AS OGGETTO,
      A.PATH,
      B.CHA_FIRMATO AS FIRMATO,
      B.PATH AS FILENAME,
      B.FILE_SIZE,
      B.ID_PEOPLE_PUTFILE,
      B.ID_PEOPLE_DELEGATO_PUTFILE,
      B.DTA_FILE_ACQUIRED,
      B.CHA_TIPO_FIRMA AS TIPO_FIRMA,
      C.NUM_PAG_ALLEGATI,
      CONVERT(int, SUBSTRING(C.VERSION_LABEL,2,LEN(C.VERSION_LABEL))) AS VERSION_INDEX,
      C.VERSION,
      C.VERSION_ID,
      C.SUBVERSION,
      C.VERSION_LABEL,
      C.COMMENTS,
      C.AUTHOR,
      C.ID_PEOPLE_DELEGATO,
      A.CREATION_DATE AS DTA_CREAZIONE,
      C.V_NAME_FN,
      C.CARTACEO,
      A.FORWARDING_SOURCE,
      A.IN_LIBROFIRMA
      FROM 	PROFILE A,
      COMPONENTS B,
      VERSIONS C
      WHERE A.DOCNUMBER = B.DOCNUMBER
      and isnull(a.CHA_IN_CESTINO,'0') != '1'
      AND B.VERSION_ID = C.VERSION_ID
      AND (
      (A.DOCNUMBER =  @param1@ AND C.VERSION = 0)
      )
      union
      SELECT  A.DOCNUMBER,
      A.DOCSERVER_LOC,
      A.VAR_PROF_OGGETTO AS OGGETTO,
      A.PATH,
      B.CHA_FIRMATO AS FIRMATO,
      B.PATH AS FILENAME,
      B.FILE_SIZE,
      B.ID_PEOPLE_PUTFILE,
      B.ID_PEOPLE_DELEGATO_PUTFILE,
      B.DTA_FILE_ACQUIRED,
      B.CHA_TIPO_FIRMA AS TIPO_FIRMA,
      C.NUM_PAG_ALLEGATI,
      CONVERT(int, SUBSTRING(C.VERSION_LABEL,2,LEN(C.VERSION_LABEL))) AS VERSION_INDEX,
      C.VERSION,
      C.VERSION_ID,
      C.SUBVERSION,
      C.VERSION_LABEL,
      C.COMMENTS,
      C.AUTHOR,
      C.ID_PEOPLE_DELEGATO,
      A.CREATION_DATE AS DTA_CREAZIONE,
      C.V_NAME_FN,
      C.CARTACEO,
      A.FORWARDING_SOURCE,
      A.IN_LIBROFIRMA
      FROM PROFILE A WITH(NOLOCK),
      COMPONENTS B,
      VERSIONS C
      WHERE A.DOCNUMBER = B.DOCNUMBER
      and isnull(a.CHA_IN_CESTINO,'0') != '1'
      AND B.VERSION_ID = C.VERSION_ID
      AND
      (
      A.ID_DOCUMENTO_PRINCIPALE = (SELECT SYSTEM_ID FROM PROFILE WITH(NOLOCK) WHERE DOCNUMBER = @param1@)
      AND C.VERSION IN
      (
      SELECT MAX(VERSION)
      FROM VERSIONS
      WHERE DOCNUMBER = A.DOCNUMBER
      ))
      ) C
      ORDER BY C.DOCNUMBER ASC, C.VERSION_ID ASC
    </value>
  </query>
  <query>
    <name>S_J_PROFILE__DOCUMENTTYPES</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      A.DOCNUMBER,
      A.DOCSERVER_LOC,
      A.PATH,
      CONVERT(datetime,A.CREATION_DATE,109) as CREATION_DATE,
      CONVERT(datetime,A.CREATION_TIME,109) as CREATION_TIME,
      B.TYPE_ID,
      B.DESCRIPTION,
      A.ID_PEOPLE_DELEGATO,
      A.IN_LIBROFIRMA
      FROM PROFILE A WITH(NOLOCK), DOCUMENTTYPES B
      WHERE A.DOCUMENTTYPE = B.SYSTEM_ID
      AND @param1@
    </value>
  </query>
  <query>
    <name>S_J_PROFILE__DPA_OGGETTARIO</name>
    <value>
      SELECT
      DISTINCT
      A.SYSTEM_ID,
      A.DOCNUMBER,
      A.CHA_TIPO_PROTO,
      A.DTA_ANNULLA,
      A.NUM_PROTO,
      @param1@ AS DATA,
      A.VAR_PROF_OGGETTO AS OGGETTO,
      A.ID_REGISTRO,
      A.CHA_DA_PROTO
      FROM PROFILE A WITH(NOLOCK)
      WHERE A.CHA_TIPO_PROTO IN ('A','P','I')
      AND A.NUM_ANNO_PROTO = @param2@
      AND A.NUM_PROTO @param3@
      AND A.NUM_PROTO @param4@
      AND A.ID_REGISTRO = @param5@
      ORDER BY A.NUM_PROTO
    </value>
  </query>
  <query>
    <name>S_J_PROFILE__DPA_OGGETTARIO_WITH_FILTERS</name>
    <value>
      SELECT 	DISTINCT
      A.SYSTEM_ID,
      A.DOCNUMBER,
      A.CHA_TIPO_PROTO,
      A.DTA_ANNULLA,
      A.NUM_PROTO,
      @param1@ AS DATA,
      A.VAR_PROF_OGGETTO AS OGGETTO,
      A.ID_REGISTRO,
      A.CHA_DA_PROTO,
      @param4@ AS DATA_ANNULLAMENTO
      FROM 	PROFILE A
      WHERE 	A.CHA_TIPO_PROTO IN ('A','P','I')
      AND A.ID_REGISTRO = @param2@
      @param3@
      ORDER BY A.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>S_J_PROFILE__DPA_OGGETTARIO2</name>
    <value>
      SELECT
      DISTINCT
      A.SYSTEM_ID,
      A.DOCNUMBER,
      A.CHA_TIPO_PROTO,
      A.CHA_MOD_OGGETTO,
      A.CHA_MOD_MITT_DEST,
      A.CHA_MOD_MITT_INT,
      A.DTA_ANNULLA,
      A.NUM_PROTO,
      @param1@ AS DATA,
      A.VAR_PROF_OGGETTO AS OGGETTO,
      A.ID_REGISTRO,
      A.CHA_DA_PROTO,
      @session_user@.CountAllegati_BY_DocNumber(A.DOCNUMBER) AS N_ALLEGATI
      FROM PROFILE A WITH(NOLOCK)
      WHERE A.CHA_TIPO_PROTO IN ('A','P','I')
      AND A.NUM_ANNO_PROTO = @param2@
      AND A.NUM_PROTO @param3@
      AND A.ID_REGISTRO = @param4@
      AND A.CHA_CONGELATO = '1'
      AND (
      A.DTA_ANNULLA @param5@
      OR (
      A.CHA_MOD_OGGETTO = '1'
      AND A.SYSTEM_ID IN (
      SELECT ID_PROFILE
      FROM DPA_OGGETTI_STO
      WHERE DTA_MODIFICA @param5@
      )
      )
      OR (
      (A.CHA_MOD_MITT_DEST = '1' OR A.CHA_MOD_MITT_INT = '1')
      AND A.SYSTEM_ID IN (
      SELECT ID_PROFILE
      FROM DPA_CORR_STO
      WHERE DTA_MODIFICA @param5@
      )
      )
      or exists (
      select 'x'
      from versions v
      where V.DOCNUMBER = a.DOCNUMBER And v.DTA_CREAZIONE @param5@
      )
      or exists (
      select 'x'
      from components C
      where c.DOCNUMBER = a.DOCNUMBER And c.dta_file_acquired @param5@
      )
      )
      ORDER BY A.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>S_Profile4</name>
    <value>
      SELECT
      ID_REGISTRO
      FROM PROFILE WITH(NOLOCK)
      WHERE SYSTEM_ID=@param1@
    </value>
  </query>
  <query>
    <name>S_DPARagTrasm5</name>
    <value>
      SELECT
      a.SYSTEM_ID,
      a.VAR_DESC_RAGIONE,
      a.CHA_TIPO_RAGIONE,
      a.CHA_TIPO_DIRITTI,
      a.CHA_RISPOSTA,
      a.CHA_TIPO_DEST,
      a.VAR_NOTE,
      a.CHA_EREDITA,
      a.CHA_TIPO_RISPOSTA,
      a.VAR_NOTIFICA_TRASM,
      a.VAR_TESTO_MSG_NOTIFICA_DOC,
      a.VAR_TESTO_MSG_NOTIFICA_FASC,
      a.CHA_CEDE_DIRITTI
      FROM DPA_RAGIONE_TRASM a, DPA_AMMINISTRA b
      WHERE a.ID_AMM = @param1@
      AND a.ID_AMM = b.SYSTEM_ID
      AND a.SYSTEM_ID = b.ID_RAGIONE_@param2@
    </value>
  </query>
  <query>
    <name>S_DPARagTrasm6</name>
    <value>
      SELECT
      ID_RAGIONE_REFERENTE
      FROM
      DPA_AMMINISTRA A, DPA_RAGIONE_TRASM B
      WHERE
      A.SYSTEM_ID = @param1@
      AND A.SYSTEM_ID = B.ID_AMM
      AND (A.ID_RAGIONE_REFERENTE = B.SYSTEM_ID)
    </value>
  </query>
  <query>
    <name>S_DPARegProto</name>
    <value>
      SELECT NUM_RIF
      FROM DPA_REG_PROTO
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>S_DescRegistroBySystemId</name>
    <value>
      SELECT VAR_CODICE
      FROM DPA_EL_REGISTRI
      WHERE SYSTEM_ID = @param1@
    </value>
  </query>
  <query>
    <name>S_DPAServerPosta</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      A.VAR_SERVER_POP,
      A.NUM_PORTA_POP,
      A.VAR_SERVER_SMTP,
      A.NUM_PORTA_SMTP,
      A.VAR_DESCRIZIONE,
      A.VAR_DOMINIO
      FROM DPA_SERVER_POSTA A
      ORDER BY A.VAR_DESCRIZIONE
    </value>
  </query>
  <query>
    <name>S_DPAStampaReg</name>
    <value>
      SELECT
      SYSTEM_ID,
      ID_REGISTRO,
      NUM_PROTO_START,
      NUM_PROTO_END,
      NUM_ANNO,
      NUM_ORD_FILE,
      NUM_PAGINA_END,
      DOCNUMBER,
      @param1@ AS DTA_STAMPA
      FROM DPA_STAMPAREGISTRI
      WHERE ID_REGISTRO = @param2@
      ORDER BY NUM_ANNO DESC,
      NUM_PROTO_END DESC,
      DTA_STAMPA DESC
    </value>
  </query>
  <query>
    <name>S_DPAStatoinvio</name>
    <value>
      SELECT @param1@
      FROM DPA_STATO_INVIO
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>S_DPATCanaleCorr</name>
    <value>
      SELECT ID_DOCUMENTTYPE
      FROM DPA_T_CANALE_CORR
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>S_DPATCanaleCorr1</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      A.DESCRIPTION,
      A.TYPE_ID
      FROM DOCUMENTTYPES A, DPA_T_CANALE_CORR B
      WHERE A.SYSTEM_ID = B.ID_DOCUMENTTYPE
      AND B.ID_CORR_GLOBALE = @param1@
      AND B.CHA_PREFERITO = '1'
    </value>
  </query>
  <query>
    <name>S_DPATCanaleCorr2</name>
    <value>
      SELECT SYSTEM_ID
      FROM DPA_T_CANALE_CORR
      WHERE ID_CORR_GLOBALE = @param1@
      AND ID_DOCUMENTTYPE = @param2@
    </value>
  </query>
  <query>
    <name>S_J_DPA_T_CANALE_CORR__DOCUMENTTYPES</name>
    <value>
      SELECT
      A.SYSTEM_ID
      FROM DPA_T_CANALE_CORR A, DOCUMENTTYPES B
      WHERE A.ID_DOCUMENTTYPE = B.SYSTEM_ID
      AND B.CHA_TIPO_CANALE='F'
      AND A.ID_CORR_GLOBALE = @param1@
      AND A.CHA_PREFERITO = '1'
    </value>
  </query>
  <query>
    <name>S_J_DPA_T_CANALE_CORR__DOCUMENTTYPES2</name>
    <value>
      SELECT
      A.SYSTEM_ID
      FROM DPA_T_CANALE_CORR A, DOCUMENTTYPES B
      WHERE A.ID_DOCUMENTTYPE = B.SYSTEM_ID
      AND B.CHA_TIPO_CANALE  in ( 'M','I') <!--= 'M'-->
      AND A.ID_CORR_GLOBALE = @param1@
      AND A.CHA_PREFERITO = '1'
    </value>
  </query>
  <query>
    <name>S_DPATipoAtto</name>
    <value>
      SELECT SYSTEM_ID, VAR_DESC_ATTO
      FROM DPA_TIPO_ATTO
      WHERE SYSTEM_ID = @param1@
    </value>
  </query>
  <query>
    <name>S_DPATipoAtto2</name>
    <value>
      SELECT DISTINCT(DPA_TIPO_ATTO.SYSTEM_ID), VAR_DESC_ATTO
      FROM DPA_TIPO_ATTO
      WHERE
      DPA_TIPO_ATTO.SYSTEM_ID not in(select ID_TEMPLATE FROM DPA_ASSOCIAZIONE_TEMPLATES)
      AND
      (DPA_TIPO_ATTO.Abilitato_SI_NO = 1
      AND
      DPA_TIPO_ATTO.In_Esercizio = 'SI')
      OR
      DPA_TIPO_ATTO.ID_AMM is null
      ORDER BY @param1@
    </value>
  </query>
  <query>
    <name>S_DPATipoAtto3</name>
    <value>
      SELECT
      SYSTEM_ID
      FROM DPA_TIPO_ATTO
      WHERE VAR_DESC_ATTO = @param1@
    </value>
  </query>
  <query>
    <name>S_DPATipoAtto4</name>
    <value>
      SELECT SYSTEM_ID, VAR_DESC_ATTO
      FROM DPA_TIPO_ATTO
      WHERE
      (ID_AMM = @param2@ OR ID_AMM IS NULL) AND
      (In_Esercizio &lt;&gt; 'NO' OR In_Esercizio IS NULL) AND
      (Abilitato_SI_NO &lt;&gt; 0 OR Abilitato_SI_NO IS NULL)
      ORDER BY @param1@
    </value>
  </query>
  <query>
    <name>S_DPATipoFunzione</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      A.VAR_COD_TIPO,
      A.VAR_DESC_TIPO_FUN,
      A.CHA_VIS
      FROM DPA_TIPO_FUNZIONE A
      @param1@
    </value>
  </query>
  <query>
    <name>S_DPATipoRuolo</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      A.ID_AMM,
      A.ID_PARENT,
      A.NUM_LIVELLO,
      A.VAR_CODICE,
      A.VAR_DESC_RUOLO
      FROM DPA_TIPO_RUOLO A
      @param1@
    </value>
  </query>
  <query>
    <name>S_DPATrasmissione</name>
    <value>
      SELECT SYSTEM_ID
      FROM DPA_TRASMISSIONE
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>S_J_DPA_TRASMISSIONE__TRASM_SINGOLA__TRASM_UTENTE2</name>
    <value>
      SELECT /*+index(c) index (b) index (a)*/ @param1@
      FROM DPA_TRASMISSIONE A, DPA_TRASM_SINGOLA B, DPA_TRASM_UTENTE C @param2@
      WHERE @param3@
      ORDER BY A.DTA_INVIO DESC, B.ID_TRASMISSIONE DESC, C.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>S_J_DPA_TRASMISSIONE__TRASM_SINGOLA__RAGIONE_TRASM</name>
    <value>
      SELECT @param1@
      FROM DPA_TRASMISSIONE A, DPA_TRASM_SINGOLA B, DPA_RAGIONE_TRASM D
      WHERE A.SYSTEM_ID = B.ID_TRASMISSIONE
      AND B.ID_RAGIONE = D.SYSTEM_ID
      AND D.CHA_TIPO_RISPOSTA = 'C'
    </value>
  </query>
  <query>
    <name>S_DPATemplTrasm</name>
    <value>
      SELECT COUNT(*)
      FROM DPA_TEMPL_TRASM
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>S_J_DPA_TRASMISSIONE__TEMPL_TRASM</name>
    <value>
      SELECT A.SYSTEM_ID, A.ID_TRASMISSIONE, A.VAR_TEMPLATE
      FROM DPA_TEMPL_TRASM A, DPA_TRASMISSIONE B
      WHERE A.ID_TRASMISSIONE = B.SYSTEM_ID
      AND @param1@
      ORDER BY @param2@
    </value>
  </query>
  <query>
    <name>S_Apps</name>
    <value>
      SELECT
      @param1@
      FROM APPS
      @param2@
    </value>
  </query>
  <query>
    <name>S_Apps2</name>
    <value>
      SELECT
      SYSTEM_ID,
      DEFAULT_EXTENSION
      FROM APPS
      ORDER BY @param1@
    </value>
  </query>
  <query>
    <name>S_Apps2_new</name>
    <value>
		SELECT
		SYSTEM_ID,
		DEFAULT_EXTENSION
		FROM APPS
		where
		DEFAULT_EXTENSION = ltrim('@defaul_extension@')
		ORDER BY @system_id@
	</value>
  </query>
  <query>
    <name>S_Components</name>
    <value>
      SELECT
      @param1@
      FROM COMPONENTS
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>S_J_COMPONENTS__VERSIONS</name>
    <value>
      SELECT
      A.VAR_IMPRONTA,
      B.VERSION
      FROM COMPONENTS A, VERSIONS B
      WHERE A.VERSION_ID = B.VERSION_ID
      AND A.DOCNUMBER = @param1@
      ORDER BY B.VERSION DESC
    </value>
  </query>
  <query>
    <name>S_J_COMPONENTS__VERSIONS2</name>
    <value>
      SELECT @param1@
      FROM COMPONENTS A, VERSIONS B ,People P
      @param2@
    </value>
  </query>
  <query>
    <name>S_J_COMPONENTS__VERSIONS3</name>
    <value>
      SELECT @param1@
      FROM COMPONENTS A, VERSIONS B
      @param2@
    </value>
  </query>
  <query>
    <name>S_DocumentTypes</name>
    <value>
      SELECT
      DESCRIPTION
      FROM DOCUMENTTYPES
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>S_DocumentTypes1</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      A.TYPE_ID,
      A.DESCRIPTION,
      A.CHA_TIPO_CANALE
      FROM DOCUMENTTYPES A
      ORDER BY A.DESCRIPTION
    </value>
  </query>
  <query>
    <name>S_DocumentTypes2</name>
    <value>
      SELECT
      SYSTEM_ID
      FROM DOCUMENTTYPES
      WHERE CHA_TIPO_CANALE IN ('M', 'I')
    </value>
  </query>
  <query>
    <name>S_DocumentTypes3</name>
    <value>
      SELECT
      SYSTEM_ID,
      TYPE_ID,
      DESCRIPTION
      FROM DOCUMENTTYPES
      WHERE DISABLED IS NULL
    </value>
  </query>
  <query>
    <name>S_DocumentTypes4</name>
    <value>
      SELECT
      SYSTEM_ID
      FROM DOCUMENTTYPES
      WHERE TYPE_ID = @param1@
    </value>
  </query>
  <query>
    <name>S_DocumentTypes5</name>
    <value>
      SELECT
      CHA_TIPO_CANALE
      FROM DOCUMENTTYPES
      WHERE SYSTEM_ID = @param1@
    </value>
  </query>
  <query>
    <name>S_NetworkAliases</name>
    <value>
      SELECT NETWORK_ID
      FROM NETWORK_ALIASES
      WHERE PERSONORGROUP = @param1@
    </value>
  </query>
  <query>
    <name>S_Components1</name>
    <value>
      SELECT PATH
      FROM COMPONENTS
      WHERE VERSION_ID = @param1@
      AND DOCNUMBER=@param2@
    </value>
  </query>
  <query>
    <name>S_People</name>
    <value>
      SELECT @param1@
      FROM PEOPLE
      WHERE @param2@ AND NOT(DISABLED='Y')
    </value>
  </query>
  <query>
    <name>S_People1</name>
    <value>
      SELECT
      SYSTEM_ID
      FROM PEOPLE
      WHERE USER_PASSWORD = @param1@
      AND SYSTEM_ID = @param2@ AND NOT(DISABLED='Y')
    </value>
  </query>
  <query>
    <name>S_People_Disabled</name>
    <value>
      SELECT
      DISABLED
      FROM PEOPLE
      WHERE
      user_Id = '@param1@'
    </value>
  </query>
  <query>
    <name>S_People_all</name>
    <value>
      SELECT @param1@
      FROM PEOPLE
      WHERE @param2@
    </value>
  </query>

  <query>
    <name>S_LOGS</name>
    <value>
      SELECT @param1@
      FROM @param3@
      WHERE @param2@
    </value>
  </query>

  <query>
    <name>S_LOG_DISATTIVI</name>
    <value>
      SELECT VAR_CODICE as CODICE, VAR_DESCRIZIONE as DESCRIZIONE, VAR_OGGETTO as OGGETTO, VAR_METODO as METODO, 0 as ATTIVO
      FROM DPA_ANAGRAFICA_LOG
      WHERE VAR_CODICE not like 'AMM_%'
      ORDER BY VAR_OGGETTO
    </value>
  </query>

  <query>
    <name>S_Login</name>
    <value>
      SELECT
      SYSTEM_ID
      FROM PEOPLE
      WHERE
      user_Id = '@param1@'
      AND user_password = '@param2@'
      AND DISABLED = 'N' AND (ID_AMM=@param3@ OR ID_AMM IS NULL)
    </value>
  </query>
  <query>
    <name>S_Login_verificaUser</name>
    <value>
      SELECT
      SYSTEM_ID
      FROM PEOPLE
      WHERE
      user_Id = '@param1@'
      AND DISABLED = 'N'
      AND (ID_AMM=@param2@ OR ID_AMM IS NULL)
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__PEOPLE__SECURITY2</name>
    <value>
      SELECT DISTINCT A.SYSTEM_ID, C.ID_REGISTRO, C.ID_AMM, A.VAR_NOME,
      A.VAR_COGNOME, C.VAR_COD_RUBRICA, B.CHA_TIPO_DIRITTO, B.PERSONORGROUP, B.ACCESSRIGHTS, A.DISABLED
      FROM PEOPLE A, SECURITY  as B  WITH (nolock) , DPA_CORR_GLOBALI C
      WHERE B.THING= @param1@
      AND A.SYSTEM_ID=B.PERSONORGROUP AND C.ID_PEOPLE=A.SYSTEM_ID AND C.CHA_TIPO_URP &lt;&gt; 'L'
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__PEOPLE__DELETED_SECURITY_UTENTI</name>
    <value>
      SELECT DISTINCT A.SYSTEM_ID, C.ID_REGISTRO, C.ID_AMM, A.VAR_NOME,
      A.VAR_COGNOME, C.VAR_COD_RUBRICA, B.CHA_TIPO_DIRITTO, B.ACCESSRIGHTS, B.NOTE, B.PERSONORGROUP
      FROM PEOPLE A, DELETED_SECURITY B, DPA_CORR_GLOBALI C
      WHERE B.THING= @param1@
      AND A.SYSTEM_ID=B.PERSONORGROUP AND C.ID_PEOPLE=A.SYSTEM_ID AND C.CHA_TIPO_URP &lt;&gt; 'L'
    </value>
  </query>
  <query>
    <name>S_J_PEOPLE__PEOPLEGROUPS2</name>
    <value>
      SELECT DISTINCT
      A.SYSTEM_ID,
      A.USER_ID
      @param1@
      AND A.ID_AMM = @param2@
      ORDER BY A.USER_ID
    </value>
  </query>
  <query>
    <name>S_Profile0</name>
    <value>
      SELECT @param1@
      FROM PROFILE WITH(NOLOCK)
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>S_Profile1</name>
    <value>
      SELECT
      DISTINCT NUM_ANNO_PROTO
      FROM PROFILE WITH(NOLOCK)
      WHERE ID_REGISTRO = @param1@
      AND (CHA_TIPO_PROTO = 'P' OR CHA_TIPO_PROTO = 'I' OR CHA_TIPO_PROTO = 'A')
      AND NUM_ANNO_PROTO IS NOT NULL
      ORDER BY NUM_ANNO_PROTO
    </value>
  </query>
  <query>
    <name>S_Profile2</name>
    <value>
      SELECT
      DISTINCT A.SYSTEM_ID
      FROM PROFILE A WITH(NOLOCK)
      WHERE A.CHA_TIPO_PROTO IN ('A','P', 'I')
      AND A.NUM_ANNO_PROTO = @param1@
      AND A.NUM_PROTO @param2@
      AND A.NUM_PROTO @param3@
      AND A.ID_REGISTRO = @param4@
      ORDER BY A.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>S_J_PROFILE__COMPONENTS__VERSIONS</name>
    <value>
      SELECT  A.DOCNUMBER,
      A.DOCSERVER_LOC,
      A.VAR_PROF_OGGETTO AS OGGETTO,
      A.PATH,
      A.CHA_FIRMATO AS FIRMATO,
      B.PATH AS FILENAME,
      B.FILE_SIZE,
      B.ID_PEOPLE_PUTFILE,
      B.DTA_FILE_ACQUIRED,
      C.NUM_PAG_ALLEGATI,
      CONVERT(int, SUBSTRING(C.VERSION_LABEL,2,LEN(C.VERSION_LABEL))) AS VERSION_INDEX,
      C.VERSION,
      C.VERSION_ID,
      C.SUBVERSION,
      C.VERSION_LABEL,
      C.COMMENTS,
      C.AUTHOR,
      C.DTA_CREAZIONE,
      C.V_NAME_FN,
      C.CARTACEO
      FROM 	PROFILE A,
      COMPONENTS B,
      VERSIONS C
      WHERE A.DOCNUMBER = B.DOCNUMBER
      AND B.VERSION_ID = C.VERSION_ID
      AND (
      (A.DOCNUMBER =  @param1@ AND C.VERSION = 0)
      OR
      (A.ID_DOCUMENTO_PRINCIPALE = (SELECT SYSTEM_ID FROM PROFILE WHERE DOCNUMBER = @param1@) AND C.VERSION IN
      (
      SELECT MAX(VERSION)
      FROM VERSIONS
      WHERE DOCNUMBER = A.DOCNUMBER
      ))
      )
      ORDER BY C.DOCNUMBER ASC, C.VERSION_ID ASC
    </value>
  </query>
  <query>
    <name>S_J_PROFILE__DOCUMENTTYPES</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      A.DOCNUMBER,
      A.DOCSERVER_LOC,
      A.PATH,
      CONVERT(datetime,A.CREATION_DATE,109) as CREATION_DATE,
      CONVERT(datetime,A.CREATION_TIME,109) as CREATION_TIME,
      B.TYPE_ID,
      B.DESCRIPTION,
      A.ID_PEOPLE_DELEGATO,
      A.IN_LIBROFIRMA
      FROM PROFILE A WITH(NOLOCK), DOCUMENTTYPES B
      WHERE A.DOCUMENTTYPE = B.SYSTEM_ID
      AND @param1@
    </value>
  </query>
  <query>
    <name>S_J_PROFILE__DPA_OGGETTARIO</name>
    <value>
      SELECT
      DISTINCT
      A.SYSTEM_ID,
      A.DOCNUMBER,
      A.CHA_TIPO_PROTO,
      A.DTA_ANNULLA,
      A.NUM_PROTO,
      @param1@ AS DATA,
      A.VAR_PROF_OGGETTO AS OGGETTO,
      A.ID_REGISTRO,
      A.CHA_DA_PROTO
      FROM PROFILE A WITH(NOLOCK)
      WHERE A.CHA_TIPO_PROTO IN ('A','P','I')
      AND A.NUM_ANNO_PROTO = @param2@
      AND A.NUM_PROTO @param3@
      AND A.NUM_PROTO @param4@
      AND A.ID_REGISTRO = @param5@
      ORDER BY A.NUM_PROTO
    </value>
  </query>
  <query>
    <name>S_J_PROFILE__DPA_OGGETTARIO_WITH_FILTERS</name>
    <value>
      SELECT 	DISTINCT
      A.SYSTEM_ID,
      A.DOCNUMBER,
      A.CHA_TIPO_PROTO,
      A.DTA_ANNULLA,
      A.NUM_PROTO,
      @param1@ AS DATA,
      A.VAR_PROF_OGGETTO AS OGGETTO,
      A.ID_REGISTRO,
      A.CHA_DA_PROTO,
      @param4@ AS DATA_ANNULLAMENTO
      FROM 	PROFILE A
      WHERE 	A.CHA_TIPO_PROTO IN ('A','P','I')
      AND A.ID_REGISTRO = @param2@
      @param3@
      ORDER BY A.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>S_J_PROFILE__DPA_OGGETTARIO2</name>
    <value>
      SELECT
      DISTINCT
      A.SYSTEM_ID,
      A.DOCNUMBER,
      A.CHA_TIPO_PROTO,
      A.CHA_MOD_OGGETTO,
      A.CHA_MOD_MITT_DEST,
      A.CHA_MOD_MITT_INT,
      A.DTA_ANNULLA,
      A.NUM_PROTO,
      @param1@ AS DATA,
      A.VAR_PROF_OGGETTO AS OGGETTO,
      A.ID_REGISTRO,
      A.CHA_DA_PROTO,
      @session_user@.CountAllegati_BY_DocNumber(A.DOCNUMBER) AS N_ALLEGATI
      FROM PROFILE A WITH(NOLOCK)
      WHERE A.CHA_TIPO_PROTO IN ('A','P','I')
      AND A.NUM_ANNO_PROTO = @param2@
      AND A.NUM_PROTO @param3@
      AND A.ID_REGISTRO = @param4@
      AND A.CHA_CONGELATO = '1'
      AND (
      A.DTA_ANNULLA @param5@
      OR (
      A.CHA_MOD_OGGETTO = '1'
      AND A.SYSTEM_ID IN (
      SELECT ID_PROFILE
      FROM DPA_OGGETTI_STO
      WHERE DTA_MODIFICA @param5@
      )
      )
      OR (
      (A.CHA_MOD_MITT_DEST = '1' OR A.CHA_MOD_MITT_INT = '1')
      AND A.SYSTEM_ID IN (
      SELECT ID_PROFILE
      FROM DPA_CORR_STO
      WHERE DTA_MODIFICA @param5@
      )
      )
      )
      ORDER BY A.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>S_Profile4</name>
    <value>
      SELECT
      ID_REGISTRO
      FROM PROFILE WITH(NOLOCK)
      WHERE SYSTEM_ID=@param1@
    </value>
  </query>

  <query>
    <name>S_GET_COUNT_ROWS_RICERCA_DOCUMENTI_IN_FASCICOLO</name>
    <value>
      SELECT
      COUNT(B.LINK) FROM
      ( SELECT TOP @totalRows@
      B.LINK
      FROM  PROJECT_COMPONENTS B, PROFILE A @param6@
      WHERE  B.PROJECT_ID= @param2@
      AND  @security@
      AND B.LINK=A.SYSTEM_ID
      AND isnull(CHA_IN_CESTINO,'0')='0'
      @param5@
      ) as B
    </value>
  </query>
  <query>
    <name>S_J_PROFILE_SECURITY_PROJECT_COMPONENTS_DOCUMENTTYPES_NEW</name>
    <value>
      SELECT TOP @pageSize@ * FROM (
      SELECT TOP @pageSize@ * FROM (
      SELECT TOP @totalRows@
      A.SYSTEM_ID,
      A.DOCNUMBER, A.DOCNAME, A.STATUS, A.DOCSERVER_LOC, A.PATH,
      @param1@ AS CREATION_DATE,
      A.ID_REGISTRO, A.CHA_TIPO_PROTO, A.ID_OGGETTO, A.NUM_PROTO,
      A.NUM_ANNO_PROTO, A.VAR_PROTO_EME, A.DTA_PROTO_EME,
      A.VAR_COGNOME_EME, A.VAR_NOME_EME, A.ID_PARENT, A.DTA_PROTO,
      A.CHA_MOD_OGGETTO, A.CHA_MOD_MITT_DEST, A.CHA_MOD_MITT_INT,
      A.CHA_MOD_DEST_OCC, A.DTA_PROTO_IN, A.VAR_PROTO_IN,
      A.ID_ANNULLATORE, A.DTA_ANNULLA, A.VAR_AUT_ANNULLA,
      A.VAR_SEGNATURA,
      A.CHA_INVIO_CONFERMA,
      A.PROT_TIT,
      A.CREATION_TIME,
      A.ID_TIPO_ATTO, A.CHA_PRIVATO, A.CHA_PERSONALE, A.CHA_EVIDENZA, A.VAR_PROF_OGGETTO AS VAR_DESC_OGGETTO, B.PROJECT_ID, B.LINK, B.TYPE,
      D.TYPE_ID, D.DESCRIPTION, @dbuser@.getchaimg(A.docnumber) AS CHA_IMG,
      @dbuser@.getInADL(A.SYSTEM_ID,'D',@param3@,@param4@) AS IN_ADL, @dbuser@.GetContatoreDoc(a.system_id, @tipo_doc@) as CONTATORE,
      (select 	MAX(FC.DATA_ARCHIVIAZIONE)
      from 	DPA_FASCICOLAZIONE_CARTACEA FC
      where 	FC.ID_DOCUMENT = A.SYSTEM_ID) AS DATA_ARCHIVIAZIONE,
      A.ID_DOCUMENTO_PRINCIPALE, ti.VAR_DESC_ATTO AS desc_tipo_atto
      FROM PROJECT_COMPONENTS B,PROFILE A,  DOCUMENTTYPES D, PROFILE pi LEFT OUTER JOIN  dpa_tipo_atto ti ON pi.ID_TIPO_ATTO = ti.SYSTEM_ID @param6@
      WHERE B.PROJECT_ID= @param2@  AND B.LINK=A.SYSTEM_ID AND  B.TYPE = 'D' AND A.DOCUMENTTYPE=D.SYSTEM_ID
      AND pi.SYSTEM_ID = a.SYSTEM_ID
      AND @security@
      AND ISNULL(A.CHA_IN_CESTINO, '0') = '0'
      @param5@
      ORDER BY isnull(A.DTA_PROTO,A.CREATION_TIME) DESC
      ) AS A ORDER BY isnull(A.DTA_PROTO,A.CREATION_TIME) ASC
      ) AS A ORDER BY isnull(A.DTA_PROTO,A.CREATION_TIME) DESC
    </value>
  </query>

  <query>
    <name>S_J_PROFILE__SECURITY__PROJECT_COMPONENTS__OGGETTARIO__DOCUMENTTYPES</name>
    <value>
      SELECT DISTINCT A.SYSTEM_ID,
      A.DOCNUMBER, A.DOCNAME, A.STATUS, A.DOCSERVER_LOC, A.PATH,
      @param1@ AS CREATION_DATE,
      A.ID_REGISTRO, A.CHA_TIPO_PROTO, A.ID_OGGETTO, A.NUM_PROTO,
      A.NUM_ANNO_PROTO, A.VAR_PROTO_EME, A.DTA_PROTO_EME,
      A.VAR_COGNOME_EME, A.VAR_NOME_EME, A.ID_PARENT, A.DTA_PROTO,
      A.CHA_MOD_OGGETTO, A.CHA_MOD_MITT_DEST, A.CHA_MOD_MITT_INT,
      A.CHA_MOD_DEST_OCC, A.DTA_PROTO_IN, A.VAR_PROTO_IN,
      A.ID_ANNULLATORE, A.DTA_ANNULLA, A.VAR_AUT_ANNULLA,
      A.VAR_SEGNATURA,
      A.CHA_INVIO_CONFERMA,
      A.PROT_TIT,
      A.ID_TIPO_ATTO, A.CHA_PRIVATO, A.CHA_PERSONALE, A.CHA_EVIDENZA, A.VAR_PROF_OGGETTO AS VAR_DESC_OGGETTO, B.PROJECT_ID, B.LINK, B.TYPE, A.CHA_IN_ARCHIVIO,
      D.TYPE_ID, D.DESCRIPTION, @dbuser@.getchaimg(A.DOCNUMBER) AS CHA_IMG,
      @dbuser@.getInADL(A.SYSTEM_ID,'D',@param3@,@param4@) AS IN_ADL, @dbuser@.getInConservazione(A.SYSTEM_ID, @param7@,'D', @param4@, @param3@) AS IN_CONSERVAZIONE,
      @dbuser@.getchafirmato(A.DOCNUMBER) as CHA_FIRMATO, @param8@
      (select 	MAX(FC.DATA_ARCHIVIAZIONE)
      from 	DPA_FASCICOLAZIONE_CARTACEA FC
      where 	FC.ID_DOCUMENT = A.SYSTEM_ID) AS DATA_ARCHIVIAZIONE,
      ID_DOCUMENTO_PRINCIPALE
      FROM PROFILE A WITH(NOLOCK), SECURITY as E  , PROJECT_COMPONENTS B, DOCUMENTTYPES D @param6@
      WHERE B.TYPE = 'D' AND A.DOCUMENTTYPE=D.SYSTEM_ID
      AND A.SYSTEM_ID=E.THING AND A.SYSTEM_ID=B.LINK AND B.PROJECT_ID= @param2@ AND
      (E.PERSONORGROUP= @param3@ OR E.PERSONORGROUP= @param4@ ) AND E.ACCESSRIGHTS >= 0
      AND ISNULL(CHA_IN_CESTINO, '0') = '0'
      and (@dbuser@.checkVisibilitaArchivio('D', A.SYSTEM_ID, @param3@) > 0)
      @param5@
      @param9@
      ORDER BY A.NUM_ANNO_PROTO DESC, A.NUM_PROTO DESC, A.DOCNUMBER DESC
    </value>
  </query>
  <query>
    <name>S_CHA_TIPO_PROTO</name>
    <value>
      SELECT CHA_TIPO_PROTO
      FROM PROFILE WITH(NOLOCK)
      WHERE DOCNUMBER=@param1@
    </value>
  </query>
  <query>
    <name>S_J_PROFILE__SECURITY__OGGETTARIO</name>
    <value>
      SELECT @columns@
      FROM PROFILE A WITH(NOLOCK)
      WHERE A.SYSTEM_ID = @idProfile@ AND
      (@dbUser@.checkSecurityDocumento(A.SYSTEM_ID, @idPeople@, @idGroup@, @idRuoloPubblico@,'D') > 0)
    </value>
  </query>
  <query>
    <name>S_SECURITY_VISIBILITA_RUOLI</name>
    <value>
      SELECT DISTINCT PERSONORGROUP,ACCESSRIGHTS
      FROM SECURITY  WITH (nolock)
      WHERE (ACCESSRIGHTS > 0) AND (PERSONORGROUP IN @param1@) AND THING =
      (SELECT SYSTEM_ID
      FROM PROFILE WITH(NOLOCK)
      WHERE DOCNUMBER=@param2@) ORDER BY ACCESSRIGHTS DESC
    </value>
  </query>
  <query>
    <name>S_J_PROFILE__SECURITY__OGGETTARIO2</name>
    <value>
      SELECT DISTINCT @param1@
      FROM PROFILE A WITH(NOLOCK)
      @param2@
      WHERE
      (DOCSADM.checkSecurityDocumento(A.SYSTEM_ID, @idPeople@, @idGruppo@, @idRuoloPubblico@,'D') > 0)
      @param3@
      ORDER BY @param4@
    </value>
  </query>
  <query>
    <name>S_J_PROFILE__SECURITY__MFASC</name>
    <value>
      SELECT DISTINCT @param1@
      FROM SECURITY as C  WITH (nolock) , PROFILE A
      @param2@
      WHERE A.SYSTEM_ID = C.THING
      AND @param3@
      ORDER BY @param4@
    </value>
  </query>
  <query>
    <name>S_J_PROFILE__SECURITY__DAPROT</name>
    <value>
      SELECT DISTINCT @param1@
      FROM SECURITY as C  WITH (nolock) , PROFILE A
      @param2@
      WHERE A.SYSTEM_ID = C.THING
      AND @param3@
      ORDER BY @param4@
    </value>
  </query>
  <query>
    <name>S_J_PROFILE__SECURITY__MIMG</name>
    <value>
      SELECT DISTINCT @param1@
      FROM SECURITY as C  WITH (nolock) , PROFILE A
      @param2@
      WHERE A.SYSTEM_ID = C.THING
      AND @param3@
      ORDER BY @param4@
    </value>
  </query>
  <query>
    <name>S_J_PROFILE__SECURITY__MASS</name>
    <value>
      SELECT DISTINCT @param1@
      FROM SECURITY as C  WITH (nolock) , PROFILE A
      @param2@
      WHERE A.SYSTEM_ID = C.THING
      AND @param3@
      ORDER BY @param4@
    </value>
  </query>
  <query>
    <name>S_J_PROFILE__DPA_OGGETTARIO3</name>
    <value>
      SELECT DISTINCT @param1@
      FROM PROFILE A WITH(NOLOCK)
      @param2@
    </value>
  </query>
  <query>
    <name>S_J_PROFILE__DPA_OGGETTARIO4</name>
    <value>
      SELECT DISTINCT @param1@
      FROM PROFILE A WITH(NOLOCK)
      @param2@
      WHERE @param3@
      ORDER BY @param4@
    </value>
  </query>
  <query>
    <name>S_J_PROJECT__SECURITY</name>
    <value>
      SELECT DISTINCT
      A.SYSTEM_ID, A.VAR_COD_LIV1, A.DESCRIPTION, A.NUM_LIVELLO, A.VAR_CODICE
      FROM PROJECT A, SECURITY as B  WITH (nolock)
      WHERE A.SYSTEM_ID=B.THING AND A.CHA_TIPO_PROJ='T' AND
      (B.PERSONORGROUP= @param1@ OR B.PERSONORGROUP= @param2@ OR B.PERSONORGROUP=@idRuoloPubblico@)
      AND B.ACCESSRIGHTS > 0
      AND (A.ID_REGISTRO IS NULL OR A.ID_REGISTRO='@param3@')
      @param4@ ORDER BY A.NUM_LIVELLO, A.VAR_COD_LIV1
    </value>
  </query>
  <query>
    <name>S_Project0</name>
    <value>
      SELECT
      @param1@
      FROM PROJECT
      @param2@
    </value>
  </query>
  <query>
    <name>S_Project1</name>
    <value>
      SELECT
      A.DESCRIPTION, A.ID_PARENT, A.NUM_LIVELLO,
      A.VAR_CODICE,A.SYSTEM_ID,A.CHA_RW,A.ID_TITOLARIO, A.CHA_BLOCCA_FIGLI, A.CHA_CONTA_PROT_TIT, A.NUM_PROT_TIT
      FROM PROJECT A
      WHERE A.CHA_TIPO_PROJ='T' AND
      @param1@
      @param2@
    </value>
  </query>
  <query>
    <name>S_Project2</name>
    <value>
      SELECT
      DESCRIPTION, ID_PARENT, NUM_LIVELLO, VAR_CODICE, ID_TITOLARIO, CHA_BLOCCA_FIGLI, CHA_CONTA_PROT_TIT, NUM_PROT_TIT
      FROM PROJECT
      WHERE SYSTEM_ID= @param1@
    </value>
  </query>
  <query>
    <name>S_Project3</name>
    <value>
      SELECT DISTINCT
      A.SYSTEM_ID, A.DESCRIPTION, A.ID_PARENT,A.VAR_CODICE,A.NUM_LIVELLO, A.VAR_COD_ULTIMO,
      A.ID_REGISTRO,VAR_COD_LIV1,ID_TIPO_FASC, CHA_BLOCCA_FASC, ID_TITOLARIO, CHA_STATO, DTA_ATTIVAZIONE, DTA_CESSAZIONE, VAR_NOTE
      FROM PROJECT A
      @param1@
      A.ID_AMM=@param2@ AND
      CHA_TIPO_PROJ='T' @param3@
      @param4@
      @param5@
      @param6@
      ORDER BY NUM_LIVELLO, VAR_COD_LIV1
    </value>
  </query>
  <query>
    <name>S_Project4</name>
    <value>
      SELECT
      VAR_CODICE, NUM_LIVELLO
      FROM PROJECT
      WHERE SYSTEM_ID=@param1@
    </value>
  </query>
  <query>
    <name>S_Project5</name>
    <value>
      SELECT COUNT(*)
      FROM PROJECT
      WHERE CHA_TIPO_PROJ = 'T'
      AND VAR_CODICE = '@param1@'
      AND ID_AMM = @param2@
      AND (ID_REGISTRO IS NULL OR ID_REGISTRO= @param3@)
    </value>
  </query>
  <query>
    <name>S_Project6</name>
    <value>
      SELECT SYSTEM_ID FROM PROJECT
      WHERE CHA_TIPO_PROJ='F'
      AND ID_PARENT IN ( @param1@)
    </value>
  </query>
  <query>
    <name>SELECT_PROJECT_ID</name>
    <value>
      SELECT SYSTEM_ID FROM PROJECT
      WHERE CHA_TIPO_PROJ='@param1@' AND VAR_CODICE = '@param2@' AND ID_AMM=@param3@
    </value>
  </query>
  <query>
    <name>S_Project7</name>
    <value>
      SELECT SYSTEM_ID
      FROM PROJECT
      WHERE CHA_TIPO_PROJ='C'
      AND ID_FASCICOLO IN ( @param1@)
    </value>
  </query>
  <!-- attenzione la query S_J_PROJECT__SECURITY2 e' stata replicata per la versione ORACLE -->
  <!-- se si modifica tale query fare attenzione che il codice che poi usa la S_J_PROJECT__SECURITY2_BIS funzioni -->
  <query>
    <name>S_J_PROJECT__SECURITY2</name>
    <value>
      SELECT DISTINCT
      A.SYSTEM_ID, A.DESCRIPTION, A.CHA_TIPO_PROJ,
      A.VAR_CODICE, A.ID_AMM,A.NUM_LIVELLO, A.CHA_TIPO_FASCICOLO,
      A.ID_FASCICOLO, A.ID_PARENT, A.VAR_COD_ULTIMO,
      A.VAR_NOTE,@param1@ AS DTA_APERTURA,
      @param2@ AS DTA_CHIUSURA,A.CHA_STATO, A.ID_TIPO_PROC, A.ID_REGISTRO,@dbuser@.getcodreg(A.ID_REGISTRO) as CODREG,
      A.ID_UO_LF, A.DTA_UO_LF,
      A.DTA_CREAZIONE @param7@,
      B.ACCESSRIGHTS, A.CARTACEO, A.CHA_PRIVATO, A.CHA_PUBBLICO, A.ID_TITOLARIO, convert(nvarchar (10), a.dta_scadenza, 103) AS DTA_SCADENZA,
      A.AUTHOR, A.ID_RUOLO_CREATORE, A.ID_UO_CREATORE, A.NUM_FASCICOLO, A.ID_PEOPLE_DELEGATO,
      @dbuser@.getChaConsentiClass(a.id_parent, A.CHA_TIPO_PROJ, A.id_fascicolo) as CHA_CONSENTI_CLASS,
      @dbuser@.getChaConsentiFasc(a.id_parent, A.CHA_TIPO_PROJ, A.CHA_TIPO_FASCICOLO, A.id_fascicolo) as CHA_CONSENTI_FASC,
      @dbuser@.getinadl (a.system_id, 'F', @param4@, @param5@) AS in_adl
      FROM PROJECT A @profilazione@, SECURITY as B  WITH (nolock)
      WHERE A.SYSTEM_ID=B.THING AND (A.ID_AMM IS NULL OR A.ID_AMM = @param3@ )
      AND (B.PERSONORGROUP= @param4@ OR B.PERSONORGROUP= @param5@ OR B.PERSONORGROUP=@idRuoloPubblico@)
      AND B.ACCESSRIGHTS > 0 AND A.CHA_TIPO_PROJ = 'F'
      @param6@
      @param8@
    </value>
  </query>
  <!-- la query S_J_PROJECT__SECURITY2_BIS e' stata replicata per la versione ORACLE -->
  <!-- per aggiungere HINT, su SQL inevitabilmente coincidono -->
  <query>
    <name>S_J_PROJECT__SECURITY2_BIS</name>
    <value>
      SELECT DISTINCT
      A.SYSTEM_ID, A.DESCRIPTION, A.CHA_TIPO_PROJ,
      A.VAR_CODICE, A.ID_AMM,A.NUM_LIVELLO, A.CHA_TIPO_FASCICOLO,
      A.ID_FASCICOLO, A.ID_PARENT, A.VAR_COD_ULTIMO,
      A.VAR_NOTE,@param1@ AS DTA_APERTURA,
      @param2@ AS DTA_CHIUSURA,A.CHA_STATO, A.ID_TIPO_PROC, A.ID_REGISTRO,@dbuser@.getcodreg(A.ID_REGISTRO) as CODREG,
      A.ID_UO_LF, A.DTA_UO_LF,
      A.DTA_CREAZIONE @param7@,
      @dbuser@.getaccessrightsProject(@param4@,@param5@,@idRuoloPubblico@,A.system_id) AS ACCESSRIGHTS, A.CARTACEO, A.CHA_PRIVATO, A.CHA_PUBBLICO, A.ID_TITOLARIO,  convert(nvarchar (10), a.dta_scadenza, 103) AS DTA_SCADENZA, A.NUM_MESI_CONSERVAZIONE,
      A.AUTHOR, A.ID_RUOLO_CREATORE, A.ID_UO_CREATORE, A.ID_PEOPLE_DELEGATO,
      @dbuser@.getChaConsentiClass(a.id_parent, A.CHA_TIPO_PROJ, A.id_fascicolo) as CHA_CONSENTI_CLASS,
      @dbuser@.getChaConsentiFasc(a.id_parent, A.CHA_TIPO_PROJ, A.CHA_TIPO_FASCICOLO, A.id_fascicolo) as CHA_CONSENTI_FASC,
      @dbuser@.getinadl (a.system_id, 'F', @idGruppo@, @idPeople@) AS in_adl
      FROM PROJECT A @profilazione@
      WHERE  (A.ID_AMM IS NULL OR A.ID_AMM = @param3@ ) AND id_titolario in (select  system_id from project where id_titolario=0 and cha_stato!='D')
      AND @security@
      @condFasc@
      @param6@
    </value>
  </query>
  <!-- GET MODIFICHE ALLO STORICO DEI DOCUMENTI-->
  <query>
    <name>GET_STO_DOCUMENTO</name>
    <value>
      SELECT convert(varchar(10),dta_modifica,103)+' '+convert(varchar(8),dta_modifica,108) as dta_modifica,id_ogg_custom,id_people,id_ruolo_in_uo,var_desc_modifica
      FROM DPA_PROFIL_STO
      WHERE id_template=@id_template@
      AND id_profile=@id_profile@
      ORDER BY dta_modifica desc, id_ogg_custom asc
    </value>
  </query>
  <!--INSERT IN DPA_PROFIL_STO(storico documenti)-->
  <query>
    <name>I_DPA_PROFIL_STO</name>
    <value>
      INSERT INTO DPA_PROFIL_STO
      (id_template,dta_modifica,id_profile,id_ogg_custom,id_people,id_ruolo_in_uo,
      var_desc_modifica)
      VALUES
      (@param1@, @param2@, @param3@, @param4@, @param5@, @param6@, '@param7@')
    </value>
  </query>
  <!-- GET MODIFICHE ALLO STORICO DEI FASCICOLI-->
  <query>
    <name>GET_STO_FASCICOLO</name>
    <value>
      SELECT convert(varchar(10),dta_modifica,103)+' '+convert(varchar(8),dta_modifica,108) as dta_modifica,id_ogg_custom,id_people,id_ruolo_in_uo,var_desc_modifica
      FROM DPA_PROFIL_FASC_STO
      WHERE id_template=@id_template@
      AND id_project=@id_project@
      ORDER BY dta_modifica desc, id_ogg_custom asc
    </value>
  </query>
  <!--INSERT IN DPA_PROFIL_FASC_STO(storico fascicoli)-->
  <query>
    <name>I_DPA_PROFIL_FASC_STO</name>
    <value>
      INSERT INTO DPA_PROFIL_FASC_STO
      (id_template,dta_modifica,id_project,id_ogg_custom,id_people,id_ruolo_in_uo,
      var_desc_modifica)
      VALUES
      (@param1@, @param2@, @param3@, @param4@, @param5@, @param6@, '@param7@')
    </value>
  </query>
  <!-- S_J_PROJECT__SECURITY_CLASSIFICHE_DOCUMENTO: utilizzata nel link al fascicolo su doc Classifica -->
  <query>
    <name>S_J_PROJECT__SECURITY_CLASSIFICHE_DOCUMENTO</name>
    <value>
      SELECT DISTINCT
      A.SYSTEM_ID, A.DESCRIPTION, A.CHA_TIPO_PROJ,
      A.VAR_CODICE, A.ID_AMM,A.NUM_LIVELLO, A.CHA_TIPO_FASCICOLO,
      A.ID_FASCICOLO, A.ID_PARENT, A.VAR_COD_ULTIMO,
      A.VAR_NOTE,@param1@ AS DTA_APERTURA,
      @param2@ AS DTA_CHIUSURA,A.CHA_STATO, A.ID_TIPO_PROC, A.ID_REGISTRO,
      A.ID_UO_LF, A.DTA_UO_LF,
      A.DTA_CREAZIONE @param7@,
      B.ACCESSRIGHTS, A.CARTACEO, A.CHA_PRIVATO, ID_TITOLARIO,A.DTA_SCADENZA, A.NUM_FASCICOLO,
      A.AUTHOR, A.ID_RUOLO_CREATORE, A.ID_UO_CREATORE, A.CHA_CONTROLLATO
      FROM PROJECT A, SECURITY as B  WITH (nolock)
      WHERE A.SYSTEM_ID=B.THING AND (A.ID_AMM IS NULL OR A.ID_AMM = @param3@ )
      AND (B.PERSONORGROUP= @param4@ OR B.PERSONORGROUP= @param5@ OR B.PERSONORGROUP=@idRuoloPubblico@)
      AND B.ACCESSRIGHTS > 0 AND A.CHA_TIPO_PROJ = 'F'
      AND (A.ID_REGISTRO @param6@ ) AND A.VAR_CODICE = '@param8@'
      AND A.ID_TITOLARIO = @param9@
      and a.system_id=@param10@
    </value>
  </query>
  <query>
    <name>S_J_PROJECT__SECURITY3</name>
    <value>
      SELECT
      A.SYSTEM_ID, A.DESCRIPTION, A.CHA_TIPO_PROJ, A.VAR_CODICE,
      A.ID_AMM,A.NUM_LIVELLO, A.CHA_TIPO_FASCICOLO, A.ID_FASCICOLO, A.ID_PARENT,
      A.VAR_COD_ULTIMO,A.VAR_NOTE,@param1@ AS DTA_APERTURA,
      @param2@ AS DTA_CHIUSURA, A.CHA_STATO, ID_TIPO_PROC, A.ID_UO_LF, @param7@ AS DTA_UO_LF, A.ID_REGISTRO @param6@,B.ACCESSRIGHTS, A.CARTACEO,A.CHA_PRIVATO,A.ID_TITOLARIO, convert(nvarchar (10), a.dta_scadenza, 103) AS DTA_SCADENZA, A.NUM_FASCICOLO,
      A.AUTHOR, A.ID_RUOLO_CREATORE, A.ID_UO_CREATORE, A.CHA_CONTROLLATO, A.COD_EXT_APP
      FROM PROJECT A, SECURITY as B  WITH (nolock)
      WHERE A.SYSTEM_ID=B.THING AND A.SYSTEM_ID = @param3@
      AND (B.PERSONORGROUP=@param4@ or B.PERSONORGROUP=@param5@ or B.PERSONORGROUP=@idRuoloPubblico@) AND B.ACCESSRIGHTS > 0
    </value>
  </query>
  <query>
    <name>S_J_PROJECT__SECURITY4</name>
    <value>
      SELECT DISTINCT
      A.SYSTEM_ID, A.DESCRIPTION, A.CHA_TIPO_PROJ, A.VAR_CODICE,
      A.ID_AMM,A.NUM_LIVELLO, A.CHA_TIPO_FASCICOLO, A.ID_FASCICOLO, A.ID_PARENT,
      A.VAR_COD_ULTIMO,@param1@ AS DTA_APERTURA,@param2@ AS DTA_CHIUSURA,
      A.CHA_STATO, A.ID_TIPO_PROC, A.VAR_NOTE, A.ID_REGISTRO,
      DOCSADM.getAccessRightsProject(@param5@,@param4@, @idRuoloPubblico@,A.SYSTEM_ID) AS ACCESSRIGHTS, A.CARTACEO, ID_TITOLARIO, A.NUM_FASCICOLO,
      A.AUTHOR, A.ID_RUOLO_CREATORE, A.ID_UO_CREATORE, DOCSADM.getFascPrimaria(@param3@, A.SYSTEM_ID) as CHA_FASC_PRIMARIA, A.COD_EXT_APP
      FROM PROJECT A
      WHERE A.CHA_TIPO_PROJ = 'F'
      AND A.SYSTEM_ID IN
      (SELECT A.ID_FASCICOLO FROM PROJECT A, PROJECT_COMPONENTS B
      WHERE A.SYSTEM_ID=B.PROJECT_ID AND B.LINK=@param3@)
      AND EXISTS ( SELECT 'x' FROM SECURITY as C  WITH (nolock)  WHERE A.SYSTEM_ID=C.THING AND (C.PERSONORGROUP=@param4@
      OR C.PERSONORGROUP = @param5@ OR C.PERSONORGROUP = @idRuoloPubblico@)
      AND C.ACCESSRIGHTS > 0 )
      ORDER BY A.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>S_J_PROJECT__SECURITY6</name>
    <value>
      SELECT DISTINCT
      A.SYSTEM_ID, A.DESCRIPTION, A.CHA_TIPO_PROJ,
      A.VAR_CODICE, A.ID_AMM,A.NUM_LIVELLO, A.CHA_TIPO_FASCICOLO,
      A.ID_FASCICOLO, A.ID_PARENT, A.VAR_COD_ULTIMO,
      A.VAR_NOTE,@param1@ AS DTA_APERTURA,
      @param2@ AS DTA_CHIUSURA,A.CHA_STATO, A.ID_TIPO_PROC, A.ID_REGISTRO,
      A.ID_UO_LF, @param9@ AS DTA_UO_LF,
      A.DTA_CREAZIONE @param8@,B.ACCESSRIGHTS, A.CARTACEO, A.CHA_PRIVATO, convert(nvarchar (10), a.dta_scadenza, 103) AS DTA_SCADENZA,
      A.AUTHOR, A.ID_RUOLO_CREATORE, A.ID_UO_CREATORE,
      @dbuser@.getinadl (a.system_id, 'F', @param4@, @param5@) AS in_adl
      FROM PROJECT A, SECURITY as B  WITH (nolock) ,
      (SELECT A.SYSTEM_ID FROM PROJECT A, SECURITY as B  WITH (nolock)  WHERE
      (A.SYSTEM_ID = B.THING) AND (B.ACCESSRIGHTS) > 0 AND
      (B.PERSONORGROUP= @param4@ OR B.PERSONORGROUP= @param5@ or B.PERSONORGROUP=@idRuoloPubblico@)
      AND A.ID_AMM = @param3@ AND A.CHA_TIPO_PROJ = 'T'
      AND ((A.ID_REGISTRO IS NULL OR A.ID_REGISTRO @param6@ ) @param7@) C
      WHERE A.SYSTEM_ID=B.THING AND (A.ID_AMM IS NULL OR A.ID_AMM = @param3@ )
      AND (B.PERSONORGROUP= @param4@ OR B.PERSONORGROUP= @param5@ or B.PERSONORGROUP=@idRuoloPubblico@)
      AND B.ACCESSRIGHTS > 0 AND A.CHA_TIPO_PROJ = 'F'
      AND ((A.ID_REGISTRO IS NULL OR A.ID_REGISTRO @param6@ ) AND (A.ID_PARENT = C.SYSTEM_ID)
    </value>
  </query>
  <query>
    <name>S_J_PROJECT_COMPONENTS__SECURITY</name>
    <value>
      SELECT DISTINCT
      A.LINK
      FROM PROJECT_COMPONENTS A, SECURITY as B  WITH (nolock)
      WHERE A.PROJECT_ID IN (
      @param1@
      )
      AND B.CHA_TIPO_DIRITTO='@param2@' AND B.THING=A.LINK
    </value>
  </query>
  <query>
    <name>S_ProjectComponents</name>
    <value>
      SELECT COUNT(*)
      FROM PROJECT_COMPONENTS
      WHERE PROJECT_ID= @param1@
      AND LINK= @param2@
    </value>
  </query>
  <query>
    <name>S_ProjectComponents2</name>
    <value>
      SELECT PROJECT_ID
      FROM PROJECT_COMPONENTS
      WHERE LINK = @param1@
    </value>
  </query>
  <query>
    <name>S_Project8</name>
    <value>
      SELECT COUNT(*)
      FROM PROJECT
      WHERE ID_PARENT= @param1@
    </value>
  </query>
  <query>
    <name>S_J_PROJECT__SECURITY5</name>
    <value>
      SELECT DISTINCT A.*
      FROM PROJECT A, SECURITY as B  WITH (nolock)
      WHERE A.SYSTEM_ID=B.THING
      AND A.ID_FASCICOLO=@param1@
      AND ( B.PERSONORGROUP=@param2@
      OR B.PERSONORGROUP=@param3@ OR B.PERSONORGROUP=@idRuoloPubblico@)
      AND B.ACCESSRIGHTS > 0
      ORDER BY DESCRIPTION ASC
    </value>
  </query>
  <query>
    <name>S_J_PROJECT__SECURITY_BY_ID_FASCICOLO</name>
    <value>
      SELECT DISTINCT A.*,
      @dbuser@.getAccessRightsProject(@param3@,@param2@, @idRuoloPubblico@,a.system_id) as accessrights
      FROM PROJECT A
      WHERE A.ID_FASCICOLO=@param1@
      and (@dbuser@.checkSecurity(A.ID_FASCICOLO, @param2@, @param3@, @idRuoloPubblico@, 'F') > 0)
      ORDER BY DESCRIPTION ASC
    </value>
  </query>
  <query>
    <name>S_J_PROJECT_FOLDERByID</name>
    <value>
      SELECT DISTINCT A.*
      FROM PROJECT A, SECURITY  as B  WITH (nolock)
      WHERE A.SYSTEM_ID=B.THING
      AND A.SYSTEM_ID=@param1@
      AND ( B.PERSONORGROUP=@param2@
      OR B.PERSONORGROUP=@param3@ or B.PERSONORGROUP=@idRuoloPubblico@)
      AND B.ACCESSRIGHTS > 0
    </value>
  </query>
  <query>
    <name>S_J_PROJECT__FOLDERB_AND_CHILD</name>
    <value>
      SELECT DISTINCT A.*
      FROM PROJECT A, SECURITY as B  WITH (nolock)
      WHERE A.SYSTEM_ID=B.THING
      AND (A.ID_FASCICOLO=@param1@ OR A.SYSTEM_ID=@param2@)
      AND ( B.PERSONORGROUP=@param3@
      OR B.PERSONORGROUP=@param4@ OR B.PERSONORGROUP=@idRuoloPubblico@)
      AND B.ACCESSRIGHTS > 0
      ORDER BY ID_PARENT ASC
    </value>
  </query>
  <query>
    <name>S_J_PROJECT_FASCICOLOByID</name>
    <value>
      SELECT DISTINCT
      A.SYSTEM_ID, A.DESCRIPTION, A.CHA_TIPO_PROJ,
      A.VAR_CODICE, A.ID_AMM,A.NUM_LIVELLO, A.CHA_TIPO_FASCICOLO,
      A.ID_FASCICOLO, A.ID_PARENT, A.VAR_COD_ULTIMO,
      A.VAR_NOTE,@param1@ AS DTA_APERTURA,
      @param2@ AS DTA_CHIUSURA,A.CHA_STATO, A.ID_TIPO_PROC, A.ID_REGISTRO,
      A.ID_UO_LF, A.DTA_UO_LF,
      @param6@ AS DTA_CREAZIONE,
      <!--GIORDANO IACOZZILLI Gestione dell'icona della copia del docuemnto/fascicolo in deposito.-->
      A.CHA_IN_ARCHIVIO,
      <!--**************************************  FINE  ******************************************-->
      @dbuser@.getaccessrightsProject(@param5@,@param4@, @idRuoloPubblico@,A.system_id) AS ACCESSRIGHTS, A.CARTACEO,A.CHA_PRIVATO,ID_TITOLARIO, A.NUM_FASCICOLO,
      A.AUTHOR, A.ID_RUOLO_CREATORE, A.ID_UO_CREATORE, A.CHA_CONTROLLATO, A.CHA_COD_T_A, A.COD_EXT_APP,
      convert(nvarchar (10), a.dta_scadenza, 103) AS DTA_SCADENZA, CHA_PUBBLICO,
      @dbuser@.getChaConsentiFasc(a.id_parent, A.CHA_TIPO_PROJ, A.CHA_TIPO_FASCICOLO, A.id_fascicolo) as CHA_CONSENTI_FASC
      FROM PROJECT A
      WHERE A.SYSTEM_ID=@param3@
      AND  @dbuser@.checksecurity(A.system_id,@param4@,@param5@, @idRuoloPubblico@,'F')>0
      AND A.CHA_TIPO_PROJ = 'F'
    </value>
  </query>
  <query>
    <name>S_Project9</name>
    <value>
      SELECT
      CHA_TIPO_FASCICOLO
      FROM PROJECT
      WHERE SYSTEM_ID =
      (SELECT B.ID_FASCICOLO
      FROM PROJECT B
      WHERE B.SYSTEM_ID= @param1@)
    </value>
  </query>
  <query>
    <name>S_Project10</name>
    <value>
      SELECT
      SYSTEM_ID
      FROM PROJECT
      WHERE CHA_TIPO_PROJ='C'
      AND ID_FASCICOLO=@param1@
    </value>
  </query>
  <query>
    <name>S_ProjectComponents3</name>
    <value>
      SELECT
      LINK
      FROM PROJECT_COMPONENTS
      WHERE PROJECT_ID IN ( @param1@ )
    </value>
  </query>
  <query>
    <name>S_ProjectComponents4</name>
    <value>
      SELECT
      a.LINK,(case when b.num_proto is not null then b.num_proto when b.num_proto is null then b.docnumber end) AS CODICE
      FROM PROJECT_COMPONENTS a,PROFILE b
      WHERE a.LINK=b.SYSTEM_ID AND a.PROJECT_ID IN ( @param1@ )
    </value>
  </query>
  <query>
    <name>S_Project11</name>
    <value>
      SELECT COUNT(*)
      FROM PROJECT
      WHERE CHA_TIPO_PROJ = 'T'
      AND VAR_CODICE = '@param1@'
      AND ID_AMM = @param2@
    </value>
  </query>
  <query>
    <name>S_Project12</name>
    <value>
      SELECT COUNT(*)
      FROM PROJECT
      WHERE CHA_TIPO_PROJ = 'T'
      AND (NUM_LIVELLO = 0
      OR NUM_LIVELLO IS NULL)
      AND ID_AMM = @param1@
    </value>
  </query>
  <query>
    <name>S_Project13</name>
    <value>
      SELECT COUNT(*)
      FROM PROJECT
      WHERE ID_PARENT= @param1@
    </value>
  </query>
  <query>
    <name>S_ProjectComponents4</name>
    <value>
      SELECT COUNT(*)
      FROM PROJECT_COMPONENTS
      WHERE PROJECT_ID IN ( @param1@ )
    </value>
  </query>
  <query>
    <name>S_ProjectComponents5</name>
    <value>
      SELECT COUNT(*)
      FROM PROJECT_COMPONENTS
      WHERE PROJECT_ID = @param1@
    </value>
  </query>
  <query>
    <name>S_ProjectComponents6</name>
    <value>
      SELECT COUNT(*)
      FROM PROJECT_COMPONENTS
      WHERE LINK = @param1@
    </value>
  </query>
  <query>
    <name>S_ProjectComponentsAll</name>
    <value>
      SELECT COUNT(*) as DOCUMENTI from PROJECT_COMPONENTS
      INNER JOIN PROJECT ON PROJECT_COMPONENTS.PROJECT_ID = PROJECT.SYSTEM_ID
      WHERE PROJECT.SYSTEM_ID IN (SELECT SYSTEM_ID FROM PROJECT WHERE ID_FASCICOLO = @idFasc@)
    </value>
  </query>
  <query>
    <name>S_RemoteLibraries</name>
    <value>
      SELECT
      LIBRARY_NAME
      FROM REMOTE_LIBRARIES
    </value>
  </query>
  <query>
    <name>S_ID_UO_INTEROP</name>
    <value>
      SELECT SYSTEM_ID
      FROM DPA_CORR_GLOBALI
      WHERE  VAR_DESC_CORR = '@param1@'
      AND CHA_TIPO_IE = 'I' AND ((ID_AMM IS NULL) OR ( ID_AMM = @param2@))
    </value>
  </query>
  <query>
    <name>S_Security</name>
    <value>
      SELECT COUNT(*)
      FROM SECURITY
      WHERE PERSONORGROUP IN @param1@
      AND THING IN @param2@
    </value>
  </query>
  <query>
    <name>S_Security2</name>
    <value>
      SELECT
      CHA_TIPO_DIRITTO
      FROM SECURITY  WITH (nolock)
      WHERE THING=@param1@
      AND PERSONORGROUP=@param2@
    </value>
  </query>
  <query>
    <name>S_Security3</name>
    <value>
      SELECT
      COUNT(*)
      FROM
      SECURITY
      WHERE
      @param1@
    </value>
  </query>
  <query>
    <name>S_Versions</name>
    <value>
      SELECT @param1@
      FROM VERSIONS
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>S_ID_PROFILE</name>
    <value>
      SELECT SYSTEM_ID
      FROM PROFILE P WITH(NOLOCK)
      WHERE
      @param1@
    </value>
  </query>
  <query>
    <name>S_Versions2</name>
    <value>
      SELECT VERSION_LABEL
      FROM VERSIONS WHERE @param1@
      AND ( VERSION_LABEL NOT LIKE 'PR%' AND VERSION_LABEL NOT LIKE 'ATD')
      ORDER BY VERSION_LABEL DESC, VERSION_ID DESC
    </value>
  </query>
  <query>
    <name>S_VAR_COD_LIV1</name>
    <value>
      SELECT VAR_COD_LIV1
      FROM PROJECT WHERE
      ID_AMM='@param1@' AND CHA_TIPO_PROJ='T' AND @param2@
      @param3@
    </value>
  </query>

















  <!-- UPDATE -->

  <query>
    <name>UPD_SET_TODOLIST_GIA_VISTA</name>
    <value>
      UPDATE DPA_TRASM_UTENTE
      SET CHA_VISTA = '1', DTA_VISTA = @param4@
      WHERE DPA_TRASM_UTENTE.SYSTEM_ID IN
      (SELECT   DISTINCT    DPA_TRASM_UTENTE.SYSTEM_ID AS SYSTEM_ID
      FROM    DPA_TRASMISSIONE DPA_TRASMISSIONE,   DPA_TRASM_SINGOLA DPA_TRASM_SINGOLA,   DPA_TRASM_UTENTE DPA_TRASM_UTENTE,   DPA_RAGIONE_TRASM DPA_RAGIONE_TRASM
      WHERE	(
      DPA_TRASMISSIONE.SYSTEM_ID = DPA_TRASM_SINGOLA.ID_TRASMISSIONE
      AND DPA_TRASM_SINGOLA.SYSTEM_ID = DPA_TRASM_UTENTE.ID_TRASM_SINGOLA
      )
      AND (DPA_TRASMISSIONE.DTA_INVIO IS NOT NULL)
      AND (DPA_TRASM_UTENTE.CHA_VALIDA = '1')
      AND (DPA_RAGIONE_TRASM.CHA_TIPO_RAGIONE = 'N')
      AND (DPA_TRASM_UTENTE.CHA_VISTA = '0')
      AND (
      (DPA_TRASM_SINGOLA.ID_CORR_GLOBALE = @param1@ AND DPA_TRASM_UTENTE.ID_PEOPLE = @param2@)  OR DPA_TRASM_SINGOLA.ID_CORR_GLOBALE = @param3@
      )
      )
    </value>
  </query>
  <query>
    <name>UPDATE_TODOLIST</name>
    <value>
      UPDATE DPA_TRASM_SINGOLA
      SET ID_CORR_GLOBALE = @param1@ WHERE ID_CORR_GLOBALE=@param2@ AND ID_TRASMISSIONE
      @param2@
      WHERE SYSTEM_ID = @param3@ AND CHA_VALIDA='1'
    </value>
  </query>
  <query>
    <name>U_DPA_TRASM_UTENTE_DTA_ACCETTATA</name>
    <value>
      UPDATE DPA_TRASM_UTENTE
      SET DTA_ACCETTATA = @param1@, CHA_ACCETTATA='1', CHA_VISTA = '1', DTA_VISTA = @param1@
      @param2@
      WHERE SYSTEM_ID @param3@ AND CHA_VALIDA='1'
    </value>
  </query>
  <query>
    <name>U_DPA_TRASMISSIONE_DTA_INVIO</name>
    <value>
      UPDATE DPA_TRASMISSIONE
      SET DTA_INVIO = @param1@
      WHERE SYSTEM_ID=@param2@
    </value>
  </query>
  <query>
    <name>U_DPA_TRASM_UTENTE_CHA_VALIDA_0</name>
    <value>
      UPDATE DPA_TRASM_UTENTE
      SET CHA_VALIDA='0' , CHA_IN_TODOLIST = '0'
      WHERE ID_TRASM_SINGOLA IN
      (SELECT A.SYSTEM_ID
      FROM DPA_TRASM_SINGOLA A, DPA_TRASM_UTENTE B
      WHERE A.SYSTEM_ID=B.ID_TRASM_SINGOLA
      AND B.SYSTEM_ID IN (SELECT TU.SYSTEM_ID FROM
      DPA_TRASM_UTENTE TU,DPA_TRASMISSIONE TX,DPA_TRASM_SINGOLA TS WHERE TU.ID_PEOPLE=@param3@ AND
      TX.SYSTEM_ID=TS.ID_TRASMISSIONE AND TX.SYSTEM_ID=@param1@ AND TS.SYSTEM_ID=TU.ID_TRASM_SINGOLA
      and TS.SYSTEM_ID = (SELECT ID_TRASM_SINGOLA FROM DPA_TRASM_UTENTE WHERE SYSTEM_ID =@param2@)))
      AND SYSTEM_ID != @param2@
    </value>
  </query>
  <query>
    <name>U_DPA_TRASM_UTENTE_DTA_RIFIUTATA</name>
    <value>
      UPDATE DPA_TRASM_UTENTE
      SET  @param1@ CHA_RIFIUTATA='1'
      @param2@
      WHERE SYSTEM_ID @param3@
      AND CHA_VALIDA='1'
    </value>
  </query>
  <query>
    <name>U_SMISTADOC_SCARTA_TRASM_UTENTE</name>
    <value>
      UPDATE DPA_TRASM_UTENTE
      SET	DTA_VISTA = @param1@,
      CHA_VISTA = '1'
      @param2@
      WHERE SYSTEM_ID = @param3@
    </value>
  </query>
  <query>
    <name>U_DPA_TRASM_UTENTE_updateTrasmRispSing</name>
    <value>
      UPDATE DPA_TRASM_UTENTE
      SET ID_TRASM_RISP_SING = @param1@
      WHERE SYSTEM_ID = @param2@
    </value>
  </query>
  <query>
    <name>U_DPA_TRASM_UTENTE_updateTrasmUtente</name>
    <value>
      UPDATE DPA_TRASM_UTENTE
      SET ID_TRASM_SINGOLA = @param1@,
      DTA_VISTA = @param2@,
      DTA_ACCETTATA = @param3@,
      DTA_RIFIUTATA = @param4@,
      DTA_RISPOSTA = @param5@,
      VAR_NOTE_ACC = '@param6@',
      VAR_NOTE_RIF = '@param7@'
      @param8@
      @param9@
      @param10@
      WHERE SYSTEM_ID= @param11@
    </value>
  </query>
  <query>
    <name>U_DPA_TRASM_UTENTE_updateTrasmSingola</name>
    <value>
      UPDATE DPA_TRASM_SINGOLA
      SET ID_RAGIONE = @param1@,
      CHA_TIPO_DEST = '@param2@',
      ID_CORR_GLOBALE = @param3@,
      VAR_NOTE_SING = '@param4@',
      CHA_TIPO_TRASM = '@param5@',
      DTA_SCADENZA = @param6@,
      HIDE_DOC_VERSIONS = @param8@
      WHERE SYSTEM_ID = @param7@
    </value>
  </query>
  <query>
    <name>U_DPA_TRASMISSIONE_updateTrasmissione</name>
    <value>
      UPDATE DPA_TRASMISSIONE
      SET CHA_TIPO_OGGETTO = '@param1@',
      VAR_NOTE_GENERALI = '@param2@',
      CHA_SALVATA_CON_CESSIONE = '@cessione@'
      WHERE SYSTEM_ID = @param3@
    </value>
  </query>
  <query>
    <name>U_DPAAreaLavoro</name>
    <value>
      UPDATE DPA_AREA_LAVORO
      SET @param1@
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>U_DPACorrGlob</name>
    <value>
      UPDATE DPA_CORR_GLOBALI
      SET VAR_DESC_CORR = @param1@
      VAR_CODICE = @param2@
      ID_AMM = @param3@
      WHERE SYSTEM_ID = @param4@
      @param5@
    </value>
  </query>
  <query>
    <name>U_DPACorrGlob2</name>
    <value>
      UPDATE DPA_CORR_GLOBALI
      SET NUM_PORTA_SMTP = @param1@
      VAR_SMTP = @param2@
      WHERE SYSTEM_ID = @param3@
    </value>
  </query>
  <query>
    <name>U_DPACorrGlob3</name>
    <value>
      UPDATE DPA_CORR_GLOBALI
      SET DTA_FINE = @param1@,
      CHA_RIFERIMENTO = NULL
      WHERE SYSTEM_ID = @param2@
    </value>
  </query>
  <query>
    <name>U_DPACorrGlob4</name>
    <value>
      UPDATE DPA_CORR_GLOBALI
      SET ID_PARENT = @param1@
      WHERE ID_PARENT = @param2@
    </value>
  </query>
  <query>
    <name>U_DPACorrGlob5</name>
    <value>
      UPDATE DPA_CORR_GLOBALI
      SET VAR_COD_RUBRICA = '@param1@'
      WHERE SYSTEM_ID = @param2@
    </value>
  </query>
  <query>
    <name>U_DPACorrGlob6</name>
    <value>
      UPDATE DPA_CORR_GLOBALI
      SET VAR_COD_RUBRICA = '@param1@'
      WHERE SYSTEM_ID = @param2@
    </value>
  </query>
  <query>
    <name>U_DPACorrGlob7</name>
    <value>
      UPDATE DPA_CORR_GLOBALI
      SET
      VAR_EMAIL = '@param1@',
      CHA_PA='1'
      WHERE SYSTEM_ID = @param2@
    </value>
  </query>
  <query>
    <name>U_DPACorrGlobali</name>
    <value>
      UPDATE DPA_CORR_GLOBALI
      SET @param1@
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>U_DPACorrGlobali1</name>
    <value>
      UPDATE DPA_CORR_GLOBALI
      SET VAR_COD_RUBRICA = @param1@
      WHERE SYSTEM_ID = @param2@
      AND NOT EXISTS
      (SELECT SYSTEM_ID
      FROM DPA_CORR_GLOBALI
      WHERE ID_AMM = @param3@
      AND VAR_COD_RUBRICA = @param4@
      )
    </value>
  </query>
  <query>
    <name>U_DPACorrGlobali2</name>
    <value>
      UPDATE DPA_CORR_GLOBALI
      SET DTA_FINE = @param1@
      WHERE SYSTEM_ID = @param2@
    </value>
  </query>
  <query>
    <name>U_DPADettGlob</name>
    <value>
      UPDATE DPA_DETT_GLOBALI
      SET VAR_CAP = @param1@
      VAR_CITTA = @param2@
      VAR_COD_FISCALE = @param3@
      VAR_FAX = @param4@
      VAR_INDIRIZZO = @param5@
      VAR_NAZIONE = @param6@
      VAR_PROVINCIA = @param7@
      VAR_TELEFONO = @param8@
      VAR_TELEFONO2 = @param9@
      VAR_NOTE = @param10@
      WHERE SYSTEM_ID = @param11@
    </value>
  </query>
  <query>
    <name>U_DPADettGlob2</name>
    <value>
      UPDATE DPA_DETT_GLOBALI
      SET VAR_INDIRIZZO = @param1@
      VAR_CITTA = @param2@
      VAR_CAP = @param3@
      VAR_PROVINCIA = @param4@
      VAR_NAZIONE = @param5@
      VAR_TELEFONO = @param6@
      VAR_TELEFONO2 = @param7@
      VAR_FAX = @param8@
      VAR_NOTE = @var_note@
      WHERE ID_CORR_GLOBALI = @param9@
    </value>
  </query>
  <query>
    <name>U_DPAElregistri</name>
    <value>
      UPDATE DPA_EL_REGISTRI
      SET @param1@
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>U_DPARegproto</name>
    <value>
      UPDATE DPA_REG_PROTO
      SET @param1@
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>U_DPAStatoinvio</name>
    <value>
      UPDATE DPA_STATO_INVIO
      SET @param1@
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>U_DPAStatoInvio1</name>
    <value>
      UPDATE DPA_STATO_INVIO
      SET VAR_PROTO_DEST = upper(@param1@),
      DTA_PROTO_DEST = @param2@
      @statusmask@
      WHERE ID_PROFILE = @param3@
      AND VAR_CODICE_AOO = @param4@
      AND VAR_CODICE_AMM = @param5@
      AND DTA_SPEDIZIONE IS NOT NULL
    </value>
  </query>
  <query>
    <name>U_DPAStatoInvio2</name>
    <value>
      UPDATE DPA_STATO_INVIO
      SET
      VAR_MOTIVO_ANNULLA = @param5@,
      CHA_ANNULLATO = @param6@,
      VAR_PROVVEDIMENTO = @param7@
      @statusmask@
      WHERE
      VAR_PROTO_DEST = @param1@
      AND DTA_PROTO_DEST = @param2@
      AND VAR_CODICE_AOO = @param3@
      AND VAR_CODICE_AMM = @param4@
      AND DTA_SPEDIZIONE IS NOT NULL
    </value>
  </query>
  <query>
    <name>U_DPAStatoInvio3</name>
    <value>
      UPDATE DPA_STATO_INVIO
      SET
      VAR_MOTIVO_ANNULLA = @param5@,
      CHA_ANNULLATO = @param6@,
      VAR_PROVVEDIMENTO = @param7@
      @statusmask@
      WHERE
      VAR_PROTO_DEST = @param1@
      AND DTA_PROTO_DEST = @param2@
      AND VAR_CODICE_AOO = @param3@
      AND VAR_CODICE_AMM = @param4@
      AND DTA_SPEDIZIONE IS NOT NULL
      AND ID_PROFILE = @param8@
    </value>
  </query>
  <query>
    <name>U_DPATCanCorr</name>
    <value>
      UPDATE DPA_T_CANALE_CORR
      SET ID_DOCUMENTTYPE = @param1@
      WHERE ID_CORR_GLOBALE = @param2@
      AND CHA_PREFERITO = '1'
    </value>
  </query>
  <query>
    <name>U_DPATCanCorr2</name>
    <value>
      UPDATE DPA_T_CANALE_CORR
      SET CHA_PREFERITO = '0'
      WHERE ID_CORR_GLOBALE = @param1@
      AND CHA_PREFERITO = '1'
    </value>
  </query>
  <query>
    <name>U_DPATCanCorr3</name>
    <value>
      UPDATE DPA_T_CANALE_CORR
      SET CHA_PREFERITO = '1'
      WHERE ID_CORR_GLOBALE = @param1@
      AND ID_DOCUMENTTYPE = @param2@
    </value>
  </query>
  <query>
    <name>I_DPATempltrasm</name>
    <value>
      INSERT INTO DPA_TEMPL_TRASM
      (
      @param1@
      ) VALUES (
      @param2@
      )
    </value>
  </query>
  <query>
    <name>U_DPATipoFRuolo</name>
    <value>
      UPDATE DPA_TIPO_F_RUOLO
      SET ID_RUOLO_IN_UO = @param1@
      WHERE ID_RUOLO_IN_UO = @param2@
    </value>
  </query>
  <query>
    <name>U_DPATipoFRuolo2</name>
    <value>
      UPDATE DPA_TIPO_F_RUOLO
      SET ID_RUOLO_IN_UO = @param1@
      WHERE ID_RUOLO_IN_UO = @param2@
    </value>
  </query>
  <query>
    <name>U_DPATipologiaAtto</name>
    <value>
      UPDATE DPA_TIPO_ATTO
      SET VAR_DESC_ATTO = @param1@
      WHERE System_ID = @param2@
    </value>
  </query>
  <query>
    <name>U_DPATrasmUtente</name>
    <value>
      UPDATE DPA_TRASM_UTENTE
      SET @param1@
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>U_Components</name>
    <value>
      UPDATE COMPONENTS
      SET @param1@
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>U_NetworkAliases</name>
    <value>
      UPDATE NETWORK_ALIASES
      SET NETWORK_ID = @param1@
      WHERE PERSONORGROUP = @param2@
    </value>
  </query>
  <query>
    <name>U_NetworkAliases_domain</name>
    <value>
      UPDATE NETWORK_ALIASES
      SET NETWORK_ID = '@newdomain@' + SUBSTRING(network_id,PATINDEX('%\%',network_id),LEN(network_id))
      WHERE PERSONORGROUP IN
      (SELECT system_id FROM PEOPLE WHERE ID_AMM = @idAmm@) and network_id like '%\%'
    </value>
  </query>
  <query>
    <name>U_NetworkAliases_domain2</name>
    <value>
      UPDATE NETWORK_ALIASES
      SET NETWORK_ID = SUBSTRING(network_id,0,PATINDEX('%@%',network_id)) + '@newdomain@'
      WHERE PERSONORGROUP IN (SELECT system_id FROM PEOPLE WHERE ID_AMM = @idAmm@) and network_id like '%@%'
    </value>
  </query>
  <query>
    <name>D_NetworkAliases_domain</name>
    <value>
      DELETE FROM NETWORK_ALIASES
      WHERE PERSONORGROUP IN
      (SELECT system_id FROM PEOPLE WHERE ID_AMM = @idAmm@)
    </value>
  </query>
  <query>
    <name>U_People</name>
    <value>
      UPDATE PEOPLE
      SET @param1@
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>U_PEOPLE1</name>
    <value>
      UPDATE PEOPLE
      SET
      USER_ID = @param1@
      FULL_NAME = @param2@
      EMAIL_ADDRESS = @param3@
      CHA_NOTIFICA = @param4@
      ID_AMM = @param5@
      VAR_COGNOME = @param6@
      VAR_NOME = @param7@
      CHA_NOTIFICA_CON_ALLEGATO = @param8@
      WHERE SYSTEM_ID = @param9@
    </value>
  </query>
  <query>
    <name>U_PEOPLE2</name>
    <value>
      UPDATE PEOPLE
      SET USER_ID = @param1@
      WHERE SYSTEM_ID = @param2@
    </value>
  </query>
  <query>
    <name>U_Profile</name>
    <value>
      UPDATE PROFILE
      SET @param1@,
      LAST_EDIT_DATE = GETDATE()
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>U_Profile1</name>
    <value>
      UPDATE PROFILE
      SET ID_OGGETTO = @param1@,
      LAST_EDIT_DATE = GETDATE(),
      VAR_PROF_OGGETTO = @param4@,
      CHA_TIPO_PROTO = '@tipoProto@',
      CHA_MOD_OGGETTO = 0,
      DOCNAME = @param5@,
      ID_REGISTRO = @param2@
      WHERE DOCNUMBER = @param3@
    </value>
  </query>
  <query>
    <name>U_PROFILE_CHA_ASSEGNATO_1_NOT_CHA_ASSEGNATO</name>
    <value>
      UPDATE PROFILE
      SET CHA_ASSEGNATO='1',
      LAST_EDIT_DATE = GETDATE()
      WHERE NOT CHA_ASSEGNATO='1'
      AND SYSTEM_ID= @param1@
    </value>
  </query>
  <query>
    <name>U_PROFILE_CHA_FASCICOLATO</name>
    <value>
      UPDATE PROFILE SET CHA_FASCICOLATO = '1',
      LAST_EDIT_DATE = GETDATE()
      WHERE CHA_FASCICOLATO = '0' AND SYSTEM_ID = @param1@
    </value>
  </query>
  <query>
    <name>U_PROFILE_CHA_FASCICOLATO_ZERO</name>
    <value>
      UPDATE PROFILE SET CHA_FASCICOLATO = '0',
      LAST_EDIT_DATE = GETDATE()
      WHERE CHA_FASCICOLATO = '1' AND SYSTEM_ID = @param1@
    </value>
  </query>
  <query>
    <name>U_PROJECT</name>
    <value>
      UPDATE PROJECT SET CHA_TIPO_PROJ = 'F', ID_PARENT = @param1@,
      VAR_CODICE = '@param2@', ID_AMM = @param3@,
      CHA_STATO = 'A' , CHA_TIPO_FASCICOLO = '@param4@', DTA_APERTURA = @param5@,
      DTA_CHIUSURA = null , ID_REGISTRO = @param6@, ID_UO_LF = @param14@, DTA_UO_LF = @param15@,
      DTA_CREAZIONE=@param11@, NUM_FASCICOLO=@param12@, ANNO_CREAZIONE=@param13@, CARTACEO=@cartaceo@, CHA_PRIVATO=@privato@, CHA_PUBBLICO=@pubblico@,
      AUTHOR=@param17@, ID_RUOLO_CREATORE=@param18@, ID_UO_CREATORE=@param19@, COD_EXT_APP='@param20@'
      @tipoFascicolo@
      @controllato@
      @param16@
      @param8@
      @param9@
      @param10@
    </value>
  </query>
  <query>
    <name>U_PROJECT_1</name>
    <value>
      UPDATE PROJECT SET CHA_TIPO_PROJ = 'F', ID_PARENT = @param1@,
      VAR_CODICE = '@param2@', ID_AMM = @param3@,
      CHA_STATO = 'A' , CHA_TIPO_FASCICOLO = '@param4@', DTA_APERTURA = @param5@,
      DTA_CHIUSURA = null , ID_REGISTRO = @param6@,
      ID_UO_LF=@param14@, DTA_UO_LF=@param15@,
      DTA_CREAZIONE=@param11@, NUM_FASCICOLO=@param12@, ANNO_CREAZIONE=@param13@
      @param7@
      @param8@
      @param9@
      @param16@
      @param10@
    </value>
  </query>
  <query>
    <name>U_PROJECTRANDOM</name>
    <value>
      UPDATE PROJECT SET ETDOC_RANDOM_ID=0 WHERE ETDOC_RANDOM_ID=@param1@
    </value>
  </query>

  <query>
    <name>U_PROJECT_2</name>
    <value>
      UPDATE PROJECT SET CHA_TIPO_PROJ = 'C',
      ID_PARENT = @param1@,
      ID_AMM = @param2@,
      ID_REGISTRO = null,
      ID_FASCICOLO = @param3@,
      DTA_APERTURA = @param4@,
      CHA_PRIVATO = @param6@,
      CHA_PUBBLICO = @pubblico@,
      DTA_CHIUSURA = null
      WHERE SYSTEM_ID = @param5@
    </value>
  </query>
  <query>
    <name>U_PROJECT_2_PARAMS</name>
    <value>
      UPDATE PROJECT SET VAR_COD_ULTIMO = '@param1@'
      WHERE SYSTEM_ID = @param2@
    </value>
  </query>
  <query>
    <name>U_PROJECT_6_PARAMS</name>
    <value>
      UPDATE PROJECT
      SET CHA_STATO = @param1@,
      DTA_APERTURA = @param2@
      @param3@
      @param11@
      @param5@
      @param7@
      @param8@
      @param9@
      @param6@
      @controllato@
      @tipoFascicolo@
      @dataScadenza@
      @param10@
    </value>
  </query>
  <query>
    <name>U_PROJECT_CHA_TIPO_PROJ_T_WHERE_SYSTEMID</name>
    <value>
      UPDATE PROJECT SET CHA_TIPO_PROJ = 'T',
      DTA_APERTURA = @param1@,
      DTA_CHIUSURA = null ,
      ID_PARENT = @param2@,
      NUM_LIVELLO = @param3@,
      VAR_CODICE = '@param4@',
      VAR_COD_ULTIMO = '0',
      ID_AMM = @param5@,
      ID_REGISTRO = @param6@
      @param7@
      WHERE SYSTEM_ID = @param8@
    </value>
  </query>
  <query>
    <name>U_PROJECT_DESCRIPTION</name>
    <value>
      UPDATE PROJECT
      SET DESCRIPTION = '@param1@'
      WHERE SYSTEM_ID= @param2@
    </value>
  </query>
  <query>
    <name>U_PROJECT_DESCRIPTION_CHA_TIPO_PROJ_C</name>
    <value>
      UPDATE PROJECT
      SET DESCRIPTION='@param1@'
      WHERE CHA_TIPO_PROJ='C'
      AND SYSTEM_ID= @param2@
    </value>
  </query>
  <query>
    <name>U_SECURITY_ACCESSRIGHTS_0</name>
    <value>
      UPDATE SECURITY SET ACCESSRIGHTS = 0
      WHERE THING = @param1@
      AND (PERSONORGROUP = @param2@
      OR PERSONORGROUP = @param3@ )
    </value>
  </query>
  <query>
    <name>U_SECURITY_DPA_CORR_GLOBALI</name>
    <value>
      UPDATE SECURITY SET CHA_TIPO_DIRITTO='P'
      WHERE THING= @param1@
      AND PERSONORGROUP= @param2@
    </value>
  </query>
  <query>
    <name>U_SECURITY_2</name>
    <value>
      UPDATE SECURITY
      SET CHA_TIPO_DIRITTO = '@param1@',
      ACCESSRIGHTS = @param2@
      WHERE THING = @param3@
      AND PERSONORGROUP = @param4@
    </value>
  </query>
  <query>
    <name>U_Security</name>
    <value>
      UPDATE SECURITY
      SET CHA_TIPO_DIRITTO='P'
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>U_SecurityXml</name>
    <value>
      UPDATE SECURITY
      SET CHA_TIPO_DIRITTO='P', ACCESSRIGHTS=255
      WHERE THING = @param1@ AND PERSONORGROUP = @param2@
    </value>
  </query>
  <query>
    <name>U_Versions</name>
    <value>
      UPDATE VERSIONS
      SET @param1@
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>U_RispProt</name>
    <value>
      UPDATE PROFILE
      SET ID_PARENT=@param1@
      WHERE SYSTEM_ID=@param2@
    </value>
  </query>
  <query>
    <name>U_ProtMitt</name>
    <value>
      UPDATE PROFILE
      SET DTA_PROTO_IN=@param1@, VAR_PROTO_IN=@param2@
      WHERE SYSTEM_ID=@param3@
    </value>
  </query>

  <!-- INSERT -->



  <query>
    <name>I_DPA_TRASM_UTENTE_insertTrasmUtente</name>
    <value>
      INSERT INTO DPA_TRASM_UTENTE
      ( @param1@ID_PEOPLE,
      ID_TRASM_RISP_SING,
      ID_TRASM_SINGOLA,
      CHA_VISTA,
      CHA_ACCETTATA,
      CHA_RIFIUTATA,
      CHA_VALIDA)
      VALUES
      ( @param2@@param3@,@param4@,@param5@,'0','0','0','1')
    </value>
  </query>
  <query>
    <name>I_DPA_TRASM_SINGOLA_insertTrasmSingola</name>
    <value>
      INSERT INTO DPA_TRASM_SINGOLA
      ( @param1@ ID_RAGIONE, ID_TRASMISSIONE, CHA_TIPO_DEST,
      ID_CORR_GLOBALE,VAR_NOTE_SING,CHA_TIPO_TRASM,
      DTA_SCADENZA,ID_TRASM_UTENTE,CHA_SET_EREDITA,HIDE_DOC_VERSIONS)
      VALUES
      ( @param2@@param3@ , @param4@, '@param5@', @param6@, '@param7@' , '@param8@' , @param9@, @param10@, @param11@, '@param12@')
    </value>
  </query>
  <query>
    <name>I_DPA_TRASMISSIONE_insertTrasmissione</name>
    <value>
      INSERT INTO DPA_TRASMISSIONE ( @param1@ID_RUOLO_IN_UO,
      ID_PEOPLE,
      CHA_TIPO_OGGETTO,
      ID_PROFILE,
      ID_PROJECT,VAR_NOTE_GENERALI,
      CHA_SALVATA_CON_CESSIONE,
      ID_PEOPLE_DELEGATO)
      VALUES ( @param2@@param3@,@param4@,'@param5@',@param6@,@param7@,'@param8@','@cessione@', @delegato@)
    </value>
  </query>
  <query>
    <name>I_DPAAreaLavoro</name>
    <value>
      INSERT INTO DPA_AREA_LAVORO
      (
      @param1@
      ) VALUES (
      @param2@
      )
    </value>
  </query>
  <query>
    <name>I_DPATCanaleCorr</name>
    <value>
      INSERT INTO DPA_T_CANALE_CORR
      (
      @param1@
      ID_CORR_GLOBALE,
      ID_DOCUMENTTYPE,
      CHA_PREFERITO
      ) VALUES (
      @param2@
      )
    </value>
  </query>
  <query>
    <name>I_DPACorrglobali</name>
    <value>
      INSERT INTO DPA_CORR_GLOBALI
      (
      @param1@
      ) VALUES (
      @param2@
      )
    </value>
  </query>
  <query>
    <name>I_DPACorrSto</name>
    <value>
      INSERT INTO DPA_CORR_STO
      (
      @param1@
      )
      SELECT @param2@
      FROM DPA_DOC_ARRIVO_PAR
      WHERE @param3@
    </value>
  </query>
  <query>
    <name>I_DPACorrGlobali1</name>
    <value>
      INSERT INTO DPA_CORR_GLOBALI
      (
      @param1@
      NUM_LIVELLO,
      CHA_TIPO_IE,
      ID_AMM,
      VAR_DESC_CORR,
      ID_OLD,
      DTA_INIZIO,
      ID_PARENT,
      VAR_CODICE,
      CHA_TIPO_CORR,
      CHA_TIPO_URP,
      CHA_PA,
      VAR_CODICE_AOO,
      VAR_COD_RUBRICA,
      CHA_DETTAGLI,
      VAR_EMAIL,
      VAR_CODICE_AMM,
      VAR_CODICE_ISTAT
      ) VALUES (
      @param2@@param3@
      @param4@
      @param5@
      @param6@
      @param7@
      @param8@
      @param9@
      @param10@
      @param11@
      @param12@
      @param13@
      @param14@
      @param15@
      @param16@
      @param17@
      @param18@
      @param19@
      )
    </value>
  </query>
  <query>
    <name>I_DPACorrGlobali2</name>
    <value>
      INSERT INTO DPA_CORR_GLOBALI
      (
      @param1@
      CHA_TIPO_IE,
      ID_REGISTRO,
      ID_AMM,
      VAR_DESC_CORR,
      ID_OLD,
      DTA_INIZIO,
      VAR_CODICE,
      CHA_TIPO_CORR,
      CHA_TIPO_URP,
      VAR_COD_RUBRICA,
      CHA_DETTAGLI,
      VAR_EMAIL,
      ID_PEOPLE,
      VAR_COGNOME,
      VAR_NOME
      ) VALUES (
      @param2@
      @param3@
      @param4@
      @param5@
      @param6@
      @param7@
      @param8@
      @param9@
      @param10@
      @param11@
      @param12@
      @param13@
      @param14@
      @param15@
      @param16@
      @param17@
      )
    </value>
  </query>
  <query>
    <name>I_DPACorrGlobali3</name>
    <value>
      INSERT INTO DPA_CORR_GLOBALI
      (
      @param1@
      CHA_TIPO_IE,
      ID_REGISTRO,
      ID_AMM,
      VAR_DESC_CORR,
      ID_OLD,
      DTA_INIZIO,
      ID_UO,
      VAR_CODICE,
      CHA_TIPO_CORR,
      CHA_TIPO_URP,
      VAR_COD_RUBRICA,
      ID_GRUPPO,
      ID_TIPO_RUOLO,
      VAR_EMAIL,
      VAR_CODICE_ISTAT,
      CHA_DETTAGLI
      ) VALUES (
      @param2@
      @param3@
      @param4@
      @param5@
      @param6@
      @param7@
      @param8@
      @param9@
      @param10@
      @param11@
      @param12@
      @param13@
      @param14@
      @param15@
      @param16@
      @param17@
      @param18@
      )
    </value>
  </query>
  <query>
    <name>I_DPACorrGlobali4</name>
    <value>
      INSERT INTO DPA_CORR_GLOBALI
      (
      @param1@
      NUM_LIVELLO,
      CHA_TIPO_IE,
      ID_REGISTRO,
      ID_AMM,
      VAR_DESC_CORR,
      ID_OLD,
      DTA_INIZIO,
      ID_PARENT,
      VAR_CODICE_AMM,
      CHA_TIPO_CORR,
      CHA_TIPO_URP,
      CHA_PA,
      VAR_CODICE_AOO,
      VAR_COD_RUBRICA
      @param2@
      ) VALUES (
      @param3@
      0,
      @param4@
      @param5@
      @param6@
      @param7@
      0,
      @param8@
      0,
      @param9@
      @param10@
      'U',
      @param11@
      @param12@
      @param13@
      @param14@
      )
    </value>
  </query>
  <query>
    <name>I_DPACorrGlobali5</name>
    <value>
      INSERT INTO DPA_CORR_GLOBALI
      (
      @param1@
      NUM_LIVELLO,
      CHA_TIPO_IE,
      ID_REGISTRO,
      ID_AMM,
      VAR_CODICE_AMM,
      VAR_DESC_CORR,
      ID_OLD,
      DTA_INIZIO,
      ID_PARENT,
      CHA_TIPO_CORR,
      CHA_TIPO_URP,
      CHA_PA,
      VAR_CODICE_AOO,
      VAR_COD_RUBRICA
      @param2@
      ) VALUES (
      @param3@
      @param4@
      @param5@
      @param6@
      @param7@
      @param8@
      @param9@
      0,
      @param10@
      @param11@
      @param12@
      'U',
      @param13@
      @param14@
      @param15@
      @param16@
      )
    </value>
  </query>
  <!-- Lnr 26/03/2013 aggiunta colonna var_cod_pi mod x task 154 -->
  <query>
    <name>I_DPADettGlobali</name>
    <value>
      INSERT INTO DPA_DETT_GLOBALI
      (
      @param1@
      ID_CORR_GLOBALI,
      VAR_INDIRIZZO,
      VAR_CAP,
      VAR_CITTA,
      VAR_PROVINCIA,
      VAR_NAZIONE,
      VAR_TELEFONO,
      VAR_TELEFONO2,
      VAR_FAX,
      VAR_COD_FISCALE,
      VAR_NOTE,
      VAR_LOCALITA,
      VAR_LUOGO_NASCITA,
      DTA_NASCITA,
      VAR_TITOLO,
      VAR_COD_PI
      ) VALUES (
      @param2@
      )
    </value>
  </query>
  <query>
    <name>I_DPADettGlobali1</name>
    <value>
      INSERT INTO DPA_DETT_GLOBALI
      (
      @param1@
      ID_CORR_GLOBALI,
      VAR_INDIRIZZO,
      VAR_CAP,
      VAR_PROVINCIA,
      VAR_NAZIONE,
      VAR_COD_FISCALE,
      VAR_TELEFONO,
      VAR_TELEFONO2,
      VAR_FAX,
      VAR_CITTA,
      VAR_NOTE
      ) VALUES (
      @param2@
      @param3@
      @param4@
      @param5@
      @param6@
      @param7@
      @param8@
      @param9@
      @param10@
      @param11@
      @param12@
      @var_note@
      )
    </value>
  </query>
  <query>
    <name>I_DPADettGlobali2</name>
    <value>
      INSERT INTO DPA_DETT_GLOBALI
      (
      @colID@
      ID_CORR_GLOBALI
      ) VALUES (
      @id@
      @param3@
      )
    </value>
  </query>
  <query>
    <name>I_DPADocarrivopar</name>
    <value>
      INSERT INTO DPA_DOC_ARRIVO_PAR
      (
      @param1@
      ) VALUES (
      @param2@
      )
    </value>
  </query>
  <query>
    <name>I_DPADoccollegamenti</name>
    <value>
      INSERT INTO DPA_DOC_COLLEGAMENTI
      (
      ID_DOCUMENTO,
      ID_DOC_COLLEGATO,
      ID_TIPO_COLLEGAMENTO,
      ID_ROOT
      ) VALUES (
      @param1@
      )
    </value>
  </query>
  <query>
    <name>I_DPAELRegistri</name>
    <value>
      INSERT INTO DPA_EL_REGISTRI
      (SYSTEM_ID, ID_AMM, VAR_CODICE, VAR_DESC_REGISTRO, DTA_APERTURA, CHA_STATO)
      VALUES
      (
      @param1@
      @param2@
      @param3@
      @param4@
      @param5@
      @param6@
      )
    </value>
  </query>
  <query>
    <name>I_DPAFirmatari</name>
    <value>
      INSERT INTO DPA_FIRMATARI
      (
      @param1@
      ) VALUES (
      @param2@
      )
    </value>
  </query>
  <query>
    <name>I_DPAFirmavers</name>
    <value>
      INSERT INTO DPA_FIRMA_VERS
      (
      @param1@
      ) VALUES (
      @param2@
      )
    </value>
  </query>
  <query>
    <name>I_DPAOggettario</name>
    <value>
      INSERT INTO DPA_OGGETTARIO
      (
      @param1@
      ) VALUES (
      @param2@
      )
    </value>
  </query>
  <query>
    <name>I_DPAOggetti</name>
    <value>
      INSERT INTO DPA_OGGETTI_STO
      (
      @param1@
      )
      SELECT @param2@
      FROM PROFILE WITH(NOLOCK)
      WHERE @param3@
    </value>
  </query>
  <query>
    <name>I_DPALAooUo</name>
    <value>
      INSERT INTO DPA_L_AOO_UO
      (
      SYSTEM_ID,
      ID_REGISTRO,
      ID_UO
      ) VALUES
      @param1@
    </value>
  </query>
  <query>
    <name>I_DPALRuoloReg2</name>
    <value>
      INSERT INTO DPA_L_RUOLO_REG
      (
      SYSTEM_ID,
      ID_REGISTRO,
      ID_RUOLO_IN_UO,
      CHA_PREFERITO,
      CHA_RIFERIMENTO
      ) VALUES
      @param1@
    </value>
  </query>
  <query>
    <name>S_DPA_MAIL_ELABORATE</name>
    <value>
      SELECT VAR_EMAIL
      FROM DPA_MAIL_ELABORATE
      WHERE ID_PROFILE = @idProfile@
    </value>
  </query>
  <query>
    <name>I_DPAMailElab</name>
    <value>
      INSERT INTO DPA_MAIL_ELABORATE
      (
      @param1@
      VAR_MESSAGE,
      CHA_RAGIONE_ELAB,
      DTA_ELAB,
      ID_REGISTRO,
      ID_PROFILE,
      VAR_EMAIL
      ) VALUES (
      @param2@
      @param3@
      @param4@
      @param5@
      @id_registro@
      @docnumber@
      @email@
      )
    </value>
  </query>
  <query>
    <name>I_DPAParole</name>
    <value>
      INSERT INTO DPA_PAROLE
      (
      @param1@
      ) VALUES (
      @param2@
      )
    </value>
  </query>
  <query>
    <name>I_DPAProfparole</name>
    <value>
      INSERT INTO DPA_PROF_PAROLE
      (
      @param2@
      ID_PROFILE,
      ID_PAROLA
      ) VALUES (
      @param1@
      )
    </value>
  </query>
  <query>
    <name>I_DPARegistroSto</name>
    <value>
      INSERT INTO DPA_REGISTRO_STO
      (
      @param1@
      )
      SELECT @param2@
      FROM DPA_EL_REGISTRI
      WHERE @param3@
    </value>
  </query>
  <query>
    <name>I_DPARuoeUt</name>
    <value>
      INSERT INTO DPA_RUOE_UTENTE
      (
      ID_RUOE,
      ID_UTENTE_EST
      )
      (SELECT
      @param1@,
      ID_UTENTE_EST
      FROM DPA_RUOE_UTENTE
      WHERE ID_RUOE = @param2@
      )
    </value>
  </query>
  <query>
    <name>I_DPARuoeUtente</name>
    <value>
      INSERT INTO DPA_RUOE_UTENTE
      (
      ID_UTENTE_EST,
      ID_RUOE
      ) VALUES (
      @param1@
      )
    </value>
  </query>
  <query>
    <name>I_DPAStampaRegistri</name>
    <value>
      INSERT INTO DPA_STAMPAREGISTRI
      (
      @param1@
      ) VALUES (
      @param2@
      )
    </value>
  </query>
  <query>
    <name>I_DPAStatoinvio</name>
    <value>
      INSERT INTO DPA_STATO_INVIO
      (
      @param1@
      ) VALUES (
      @param2@
      )
    </value>
  </query>
  <query>
    <name>I_DPATCanCorr</name>
    <value>
      INSERT INTO DPA_T_CANALE_CORR
      (
      SYSTEM_ID,
      ID_CORR_GLOBALE,
      ID_DOCUMENTTYPE,
      CHA_PREFERITO
      )
      (SELECT
      1,
      @param1@,
      ID_DOCUMENTTYPE,
      CHA_PREFERITO
      FROM DPA_T_CANALE_CORR
      WHERE ID_CORR_GLOBALE = @param2@
      )
    </value>
  </query>
  <query>
    <name>I_DPATCanaleCorr1</name>
    <value>
      INSERT INTO DPA_T_CANALE_CORR
      (
      SYSTEM_ID,
      ID_CORR_GLOBALE,
      ID_DOCUMENTTYPE,
      CHA_PREFERITO
      ) VALUES (
      @param1@
      @param2@
      @param3@
      @param4@
      )
    </value>
  </query>
  <query>
    <name>I_DPATCanCorr2</name>
    <value>
      INSERT INTO DPA_T_CANALE_CORR
      (
      @param10@
      ID_CORR_GLOBALE,
      ID_DOCUMENTTYPE,
      CHA_PREFERITO
      ) VALUES (
      @param20@
      @param1@,
      @param2@,
      '1'
      )
    </value>
  </query>
  <query>
    <name>I_DPATipoFRuolo</name>
    <value>
      INSERT INTO DPA_TIPO_F_RUOLO
      (
      SYSTEM_ID,
      ID_TIPO_FUNZ,
      ID_RUOLO_IN_UO
      ) VALUES
      @param1@
    </value>
  </query>
  <query>
    <name>I_DPATipologiaAtto</name>
    <value>
      INSERT INTO DPA_TIPO_ATTO
      (
      @param1@
      VAR_DESC_ATTO
      ) VALUES (
      @param2@
      @param3@
      )
    </value>
  </query>
  <query>
    <name>I_Apps</name>
    <value>
      INSERT INTO APPS
      (
      APPLICATION,
      DESCRIPTION,
      FILING_SCHEME,
      DEFAULT_EXTENSION
      ) VALUES (
      @application@,
      @description@,
      @filing_scheme@,
      @default_extension@
      )
    </value>
  </query>
  <query>
    <name>I_Components</name>
    <value>
      INSERT INTO COMPONENTS
      (
      @param1@
      ) VALUES (
      @param2@
      )
    </value>
  </query>
  <query>
    <name>I_Groups</name>
    <value>
      INSERT INTO GROUPS
      (
      @param0@
      GROUP_ID,
      GROUP_NAME,
      DISABLED,
      ALLOW_LOGIN,
      UNIV_ACCESS
      ) VALUES (
      @param1@
      @param2@
      @param3@
      @param4@
      @param5@
      @param6@
      )
    </value>
  </query>
  <query>
    <name>I_NetworkAliases</name>
    <value>
      INSERT INTO NETWORK_ALIASES
      (
      NETWORK_ID,
      NETWORK_TYPE,
      PERSONORGROUP
      ) VALUES (
      @param2@
      @param3@
      @param4@
      )
    </value>
  </query>
  <query>
    <name>I_People</name>
    <value>
      INSERT INTO PEOPLE
      (
      SYSTEM_ID,
      USER_ID,
      USER_PASSWORD,
      FULL_NAME,
      DISABLED,
      ALLOW_LOGIN,
      TARGET_DOCSRVR,
      PRIMARY_GROUP,
      PRIMARY_LIB,
      PASS_EXP_DATE,
      LOGINS_REMAINING,
      PSWORD_VALID_FOR,
      NO_EXP_DATE,
      DR_USER,
      EMAIL_ADDRESS,
      CHA_NOTIFICA,
      ID_AMM,
      VAR_COGNOME,
      VAR_NOME,
      CHA_NOTIFICA_CON_ALLEGATO
      ) VALUES (
      @param1@
      @param2@
      @param3@
      @param4@
      @param5@
      @param6@
      @param7@
      @param8@
      @param9@
      @param10@
      @param11@
      @param12@
      @param13@
      @param14@
      @param15@
      @param16@
      @param17@
      @param18@
      @param19@
      @param20@
      )
    </value>
  </query>
  <query>
    <name>I_PeopleGroups</name>
    <value>
      INSERT INTO PEOPLEGROUPS
      (
      GROUPS_SYSTEM_ID,
      PEOPLE_SYSTEM_ID
      )
      VALUES
      @param1@
    </value>
  </query>
  <query>
    <name>I_Profile</name>
    <value>
      INSERT INTO Profile
      (
      @param0@
      TYPIST,
      AUTHOR,
      DOCUMENTTYPE,
      CREATION_DATE,
      CREATION_TIME,
      DOCNUMBER,
      LAST_EDIT_DATE
      )
      VALUES
      (
      @param1@
      @param2@,
      @param3@,
      @param4@,
      @param5@,
      @param6@,
      @param7@,
      GETDATE()
      )
    </value>
  </query>
  <query>
    <name>I_PROJECT</name>
    <value>
      INSERT INTO PROJECT
      (
      @param1@
      )
      VALUES
      (
      @param2@
      )
    </value>
  </query>
  <query>
    <name>I_PROJECT_1</name>
    <value>
      INSERT INTO PROJECT
      (
      @param1@
      )
      VALUES
      (
      @param2@
      )
    </value>
  </query>
  <query>
    <name>I_PROJECT_COMPONENTS</name>
    <value>
      INSERT INTO PROJECT_COMPONENTS
      (
      PROJECT_ID,
      LINK,
      TYPE,
      DTA_CLASS,
      CHA_FASC_PRIMARIA
      )
      VALUES
      (
      @param1@,
      @param2@,
      'D',
      @dataClassifica@,
      @fascPrimaria@
      )
    </value>
  </query>
  <query>
    <name>I_DELETED_SECURITY</name>
    <value>
      INSERT INTO DELETED_SECURITY
      (
      THING,
      PERSONORGROUP,
      ACCESSRIGHTS,
      ID_GRUPPO_TRASM,
      CHA_TIPO_DIRITTO,
      NOTE,
      DTA_REVOCA,
      ID_UTENTE_REV,
      ID_RUOLO_REV,
      HIDE_DOC_VERSIONS
      ) VALUES (
      @param1@
      )
    </value>
  </query>
  <query>
    <name>I_Security</name>
    <value>
      INSERT INTO SECURITY
      (
      THING,
      PERSONORGROUP,
      ACCESSRIGHTS,
      ID_GRUPPO_TRASM,
      CHA_TIPO_DIRITTO,
      HIDE_DOC_VERSIONS
      ) VALUES (
      @param1@
      )
    </value>
  </query>
  <query>
    <name>I_SECURITY_CHA_TIPO_DIRITTO_P</name>
    <value>
      INSERT INTO SECURITY
      (THING,PERSONORGROUP,ACCESSRIGHTS,ID_GRUPPO_TRASM,CHA_TIPO_DIRITTO)
      VALUES
      ( @param1@,@param2@,255,@param3@,'P')
    </value>
  </query>
  <query>
    <name>I_SECURITY_CHA_TIPO_DIRITTO_A</name>
    <value>
      INSERT INTO SECURITY
      (THING,PERSONORGROUP,ACCESSRIGHTS,ID_GRUPPO_TRASM,CHA_TIPO_DIRITTO)
      VALUES
      ( @param1@,@param2@,63,@param3@,'A')
    </value>
  </query>
  <query>
    <name>I_SECURITY_SELECT_FROM_SECURITY</name>
    <value>
      INSERT INTO SECURITY
      (THING, PERSONORGROUP, ACCESSRIGHTS, ID_GRUPPO_TRASM, CHA_TIPO_DIRITTO)
      (SELECT @param1@, PERSONORGROUP, ACCESSRIGHTS,
      ID_GRUPPO_TRASM, CHA_TIPO_DIRITTO
      FROM SECURITY  WITH (nolock)
      WHERE THING= @param2@ )
    </value>
  </query>
  <query>
    <name>I_SECURITY_TIPO_DIRITTO_P</name>
    <value>
      INSERT INTO SECURITY (THING, PERSONORGROUP, ACCESSRIGHTS, ID_GRUPPO_TRASM, CHA_TIPO_DIRITTO)
      VALUES ( @param1@, @param2@, 255, @param3@, 'P')";
    </value>
  </query>
  <query>
    <name>I_SECURITY_SELECT</name>
    <value>
      INSERT INTO SECURITY (THING, PERSONORGROUP, ACCESSRIGHTS, ID_GRUPPO_TRASM, CHA_TIPO_DIRITTO)
      (SELECT DISTINCT @param1@, PERSONORGROUP, ACCESSRIGHTS, @param2@, 'F'
      FROM SECURITY  WITH (nolock)  @param3@ WHERE @param4@ THING=@param5@ AND NOT PERSONORGROUP IN
      (SELECT PERSONORGROUP FROM SECURITY   WITH (nolock)  WHERE THING=@param6@) @param7@)
    </value>
  </query>
  <query>
    <name>I_SECURITY_SELECT_PROJECT</name>
    <value>
      INSERT INTO SECURITY (THING, PERSONORGROUP, ACCESSRIGHTS, ID_GRUPPO_TRASM, CHA_TIPO_DIRITTO)
      (SELECT DISTINCT '@param1@', PERSONORGROUP, ACCESSRIGHTS, '@param2@', 'F'
      FROM SECURITY   WITH (nolock)  WHERE THING=@param3@ AND NOT PERSONORGROUP IN
      (SELECT PERSONORGROUP FROM SECURITY  WITH (nolock)  WHERE THING='@param4@'))
    </value>
  </query>
  <query>
    <name>I_VERSIONS</name>
    <value>
      INSERT INTO VERSIONS
      (
      @param1@
      ) VALUES (
      @param2@
      )
    </value>
  </query>
  <query>
    <name>U_COMPONENTS_PEOPLE_DELEGATO</name>
    <value>
      UPDATE COMPONENTS
      SET ID_PEOPLE_DELEGATO_PUTFILE = @param1@
      WHERE VERSION_ID = @param2@
    </value>
  </query>
  <query>
    <name>I_DPALOG</name>
    <value>
      INSERT INTO DPA_LOG
      (
      @param1@
      )
      VALUES
      (
      @param2@
      )
    </value>
  </query>
  <!-- DOCUMENTI RIMOSSI-CESTINATI -->
  <query>
    <name>U_PROFILE__CHA_IN_CESTINO</name>
    <value>
      update profile set cha_in_cestino = @valore@, LAST_EDIT_DATE = GETDATE() where system_id = @param1@
    </value>
  </query>
  <query>
    <name>S_COUNT__PROFILE__CHA_IN_CESTINO</name>
    <value>
      SELECT COUNT(*)
      FROM PROFILE
      WHERE system_id = @idProfile@ AND ISNULL(CHA_IN_CESTINO, '0') = '1'
    </value>
  </query>
  <query>
    <name>S_DPA_EL_REGISTRI</name>
    <value>
      select system_id from dpa_el_registri where id_amm=@idAmm@ and cha_rf = '0'
    </value>
  </query>
  <query>
    <name>S_RICERCA_DOCUMENTI_IN_CESTINO</name>
    <value>
      SELECT
      A.SYSTEM_ID, A.DOCNUMBER, A.DTA_ANNULLA, A.VAR_PROF_OGGETTO AS VAR_DESC_OGGETTO,
      A.ID_REGISTRO, A.CHA_TIPO_PROTO, A.CHA_EVIDENZA, A.NUM_ANNO_PROTO,
      CONVERT(CHAR(11),A.CREATION_TIME,103) AS CREATION_DATE, A.NUM_PROTO,
      A.VAR_SEGNATURA, CONVERT(CHAR(11),A.DTA_PROTO,103)  AS DTA_PROTO,
      docsadm.getchaimg(A.DOCNUMBER) AS CHA_IMG, A.CHA_PRIVATO, A.CHA_PERSONALE, A.CHA_IN_CESTINO, A.VAR_NOTE_CESTINO, A.AUTHOR,
      A.ID_DOCUMENTO_PRINCIPALE
      FROM    PROFILE a @param1@
      WHERE
      (  (A.CHA_DA_PROTO='1' AND A.ID_REGISTRO IN (@registri@) ) OR A.CHA_TIPO_PROTO='G')
      AND ISNULL(CHA_IN_CESTINO, '0')='1' AND a.ID_DOCUMENTO_PRINCIPALE IS NULL
      AND docsadm.getIdAmm(A.AUTHOR) = @idAmm@ @param2@
      order by a.system_id desc
    </value>
  </query>
  <query>
    <name>S_DPA_TRASMISSIONE__DPA_TRASM_SING__DPA_TRASM_UTENTE__DPA_RAGIONE_TRASM</name>
    <value>
      select ut.id_people
      from dpa_trasmissione trasm, dpa_trasm_singola sing, dpa_trasm_utente ut, dpa_ragione_trasm rag, profile p
      where trasm.system_id = sing.id_trasmissione and sing.system_id = ut.id_trasm_singola and sing.id_ragione = rag.system_id
      and trasm.id_profile=p.system_id
      and p.CHA_DA_PROTO &lt;&gt; 0 and p.NUM_PROTO is null
      and trasm.id_profile = @idProfile@
      @ragione@
    </value>
  </query>
  <query>
    <name>S_PATH__COMPONENTS__VERSIONS</name>
    <value>
      select c.path from components c, versions v
      where c.version_id = v.version_id and  c.docnumber=@docNumber@
    </value>
  </query>
  <!-- FINE DOCUMENTI RIMOSSI-CESTINATI -->
  <!-- DELETE -->
  <query>
    <name>DELETE_ADL_UTENTE</name>
    <value>
      DELETE FROM DPA_AREA_LAVORO
      WHERE ID_PEOPLE=@param1@
    </value>
  </query>

  <query>
    <name>D_DEFAULT</name>
    <value>
      DELETE FROM @param1@
      @param2@
    </value>
  </query>
  <query>
    <name>D_DPA_TRASM_UTENTE_ID_TRASM_SINGOLA</name>
    <value>
      DELETE FROM DPA_TRASM_UTENTE
      WHERE ID_TRASM_SINGOLA= @param1@
    </value>
  </query>
  <query>
    <name>D_DPA_TRASM_SINGOLA_SYSTEM_ID</name>
    <value>
      DELETE FROM DPA_TRASM_SINGOLA
      WHERE SYSTEM_ID= @param1@
    </value>
  </query>
  <query>
    <name>D_DPA_TRASMISSIONE_WHERE_SYSTEMID</name>
    <value>
      DELETE FROM DPA_TRASMISSIONE
      WHERE SYSTEM_ID = @param1@
    </value>
  </query>
  <query>
    <name>D_DPAAreaLavoro</name>
    <value>
      DELETE FROM DPA_AREA_LAVORO
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>D_DPADocArrivo</name>
    <value>
      DELETE FROM DPA_DOC_ARRIVO_PAR
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>D_DPALAOOUO</name>
    <value>
      DELETE FROM DPA_L_AOO_UO WHERE ID_REGISTRI IN
      @param1@
    </value>
  </query>
  <query>
    <name>D_DPAProfParole</name>
    <value>
      DELETE FROM DPA_PROF_PAROLE
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>D_DPAStatoInvio</name>
    <value>
      DELETE FROM DPA_STATO_INVIO
      WHERE ID_DOC_ARRIVO_PAR IN
      (SELECT SYSTEM_ID
      FROM DPA_DOC_ARRIVO_PAR
      WHERE @param1@)
    </value>
  </query>
  <query>
    <name>D_LOG_ATTIVATI</name>
    <value>
      DELETE FROM DPA_LOG_ATTIVATI
      WHERE ID_AMM = @param1@
      AND SYSTEM_ID_ANAGRAFICA NOT IN
      (SELECT SYSTEM_ID FROM DPA_ANAGRAFICA_LOG WHERE VAR_CODICE LIKE 'AMM_%')
    </value>
  </query>
  <query>
    <name>D_ActivityLog</name>
    <value>
      DELETE FROM ACTIVITYLOG
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>D_Components</name>
    <value>
      DELETE FROM COMPONENTS
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>D_DPALRuoloReg</name>
    <value>
      DELETE FROM DPA_L_RUOLO_REG
      WHERE ID_REGISTRO IN
      @param1@
      AND ID_RUOLO_IN_UO = @param2@
    </value>
  </query>
  <query>
    <name>D_NetworkAliases</name>
    <value>
      DELETE NETWORK_ALIASES
      WHERE PERSONORGROUP = @param1@
    </value>
  </query>
  <query>
    <name>D_PeopleGroups</name>
    <value>
      DELETE FROM PEOPLEGROUPS
      WHERE PEOPLE_SYSTEM_ID IN
      @param1@
      AND GROUPS_SYSTEM_ID = @param2@
    </value>
  </query>
  <query>
    <name>D_PeopleGroups2</name>
    <value>
      DELETE FROM PEOPLEGROUPS
      WHERE GROUPS_SYSTEM_ID IN
      @param1@
      AND PEOPLE_SYSTEM_ID = @param2@
    </value>
  </query>
  <query>
    <name>D_Profile</name>
    <value>
      DELETE FROM PROFILE
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>D_PROJECT</name>
    <value>
      DELETE FROM PROJECT
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>D_PROJECT_AND_CHILD</name>
    <value>
      DELETE FROM PROJECT
      WHERE SYSTEM_ID IN (SELECT SYSTEM_ID FROM PROJECT WHERE ID_FASCICOLO = @idFasc@ OR SYSTEM_ID = @idFasc@)
    </value>
  </query>
  <query>
    <name>D_SECURITY_PROJECT_AND_CHILD</name>
    <value>
      DELETE FROM SECURITY
      WHERE THING IN (SELECT SYSTEM_ID FROM PROJECT WHERE ID_FASCICOLO = @idFasc@ OR SYSTEM_ID = @idFasc@)
    </value>
  </query>
  <query>
    <name>D_PROJECT_COMPONENT_WHERE_TYPE</name>
    <value>
      DELETE FROM PROJECT_COMPONENTS
      WHERE TYPE='D'
      AND LINK=@param1@
      AND PROJECT_ID=@param2@
    </value>
  </query>
  <query>
    <name>D_PROJECT_COMPONENT_WHERE_TYPE_2</name>
    <value>
      DELETE FROM PROJECT_COMPONENTS
      WHERE TYPE='D'
      AND LINK=@param1@
      AND PROJECT_ID IN (SELECT SYSTEM_ID FROM PROJECT WHERE ID_FASCICOLO = @param2@)
    </value>
  </query>
  <query>
    <name>D_DPATempltrasm</name>
    <value>
      DELETE FROM DPA_TEMPL_TRASM
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>U_DPATempltrasm</name>
    <value>
      UPDATE DPA_TEMPL_TRASM
      SET @param1@
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>D_DPATipoFRuolo</name>
    <value>
      DELETE FROM DPA_TIPO_F_RUOLO
      WHERE ID_TIPO_FUNZ IN
      @param1@
      AND ID_RUOLO_IN_UO = @param2@
    </value>
  </query>
  <query>
    <name>D_SECURITY</name>
    <value>
      DELETE FROM SECURITY
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>D_DELETED_SECURITY</name>
    <value>
      DELETE FROM DELETED_SECURITY
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>I_DELETED_SECURITY_3</name>
    <value>
      INSERT INTO DELETED_SECURITY
      (THING,
      PERSONORGROUP,
      ACCESSRIGHTS,
      ID_GRUPPO_TRASM,
      CHA_TIPO_DIRITTO,
      NOTE,
      DTA_REVOCA,
      ID_UTENTE_REV,
      ID_RUOLO_REV,
      HIDE_DOC_VERSIONS)
      SELECT
      THING,
      PERSONORGROUP,
      ACCESSRIGHTS,
      ID_GRUPPO_TRASM,
      CHA_TIPO_DIRITTO,
      'Visibilità rimossa a seguito di configurazione ruolo pubblico',
      getdate(),
      '',
      '',
      HIDE_DOC_VERSIONS
      FROM SECURITY
      WHERE personorgroup = @param1@
    </value>
  </query>
  <query>
    <name>D_SECURITY_PERSONGROUP</name>
    <value>
      DELETE FROM SECURITY
      WHERE THING IN ( @param1@ )
      AND PERSONORGROUP IN  @param2@
    </value>
  </query>
  <query>
    <name>D_Versions</name>
    <value>
      DELETE FROM VERSIONS
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>DELETE_LOGS</name>
    <value>
      DELETE FROM DPA_LOG
      WHERE @param1@
    </value>
  </query>

  <!-- Query per la gestione del path del documentale-->

  <query>
    <name>DOC_GET_CORR_BY_ID_PEOPLE</name>
    <value>
      SELECT DPA_CORR_GLOBALI.ID_UO AS ID_UO,DPA_AMMINISTRA.VAR_CODICE_AMM AS VAR_CODICE_AMM FROM DPA_CORR_GLOBALI,DPA_AMMINISTRA WHERE DPA_AMMINISTRA.SYSTEM_ID=DPA_CORR_GLOBALI.ID_AMM AND DPA_CORR_GLOBALI.ID_PEOPLE=@param1@
    </value>
  </query>

  <query>
    <name>DOC_GET_UO_BY_ID</name>
    <value>
      SELECT VAR_CODICE FROM DPA_CORR_GLOBALI WHERE SYSTEM_ID=@param1@
    </value>
  </query>

  <query>
    <name>DOC_GET_ID_UO_BY_SYSTEM_ID</name>
    <value>
      SELECT ID_UO FROM DPA_CORR_GLOBALI WHERE ID_GRUPPO=@param1@
    </value>
  </query>

  <query>
    <name>DOC_GET_DOC_BY_DOCNUMBER</name>
    <value>
      SELECT year(profile.creation_date)as CREATION_YEAR, PROFILE.* FROM PROFILE WITH(NOLOCK) WHERE DOCNUMBER=@param1@
    </value>
  </query>

  <query>
    <name>DOC_GET_REGISTRO_BY_ID</name>
    <value>
      SELECT VAR_CODICE FROM DPA_EL_REGISTRI WHERE SYSTEM_ID=@param1@
    </value>
  </query>

  <query>
    <name>GET_RUOLI_RIF_REGISTRO</name>
    <value>SELECT A.ID_GRUPPO FROM DPA_CORR_GLOBALI A WITH(NOLOCK), DPA_L_RUOLO_REG B WITH(NOLOCK) WHERE A.SYSTEM_ID = B.ID_RUOLO_IN_UO AND A.CHA_TIPO_URP = 'R' AND A.CHA_TIPO_IE = 'I' AND A.CHA_RIFERIMENTO = '1' AND @param1@ AND @param2@</value>
  </query>

  <query>
    <name>DK_PATH</name>
    <value>SELECT PATH FROM COMPONENTS WHERE DOCNUMBER=@param1@</value>
  </query>

  <query>
    <name>VERIFICA_UTENTE</name>
    <value>
      select p.user_id, p.user_password, p.id_amm from people p, dpa_corr_globali c
      where p.system_id=c.id_people and c.cha_tipo_urp='P'
      and c.cha_tipo_ie='I'
      and p.disabled='N'
      and p.user_id = '@param1@'

    </value>
  </query>
  <query>
    <name>CHECK_DOCUMENTO_ACQUISITO</name>
    <value>
      SELECT C.VAR_IMPRONTA
      FROM COMPONENTS c, VERSIONS v
      WHERE c.VERSION_ID = v.VERSION_ID
      AND v.VERSION = 1
      AND c.DOCNUMBER=@param1@
    </value>
  </query>

  <query>
    <name>CHECK_PROTO_ACQUISITO</name>
    <value>
      SELECT P.VAR_SEGNATURA
      FROM COMPONENTS c, VERSIONS v, PROFILE p
      WHERE c.VERSION_ID = v.VERSION_ID
      AND c.DOCNUMBER=p.DOCNUMBER
      AND v.VERSION = 1
      AND c.DOCNUMBER=@param1@
    </value>
  </query>

  <!-- gestione TITOLARIO diretto al db (gadamo) -->
  <query>
    <name>S_NODO_TITOLARIO</name>
    <value>
      SELECT DISTINCT
      a.system_id as IDRECORD,
      a.var_codice as CODICE,
      a.description as DESCRIZIONE,
      a.num_livello as LIVELLO,
      a.id_registro as REGISTRO,
      a.id_parent as IDPARENT,
      a.var_cod_liv1 as CODLIV,
      cha_rw as RW,(SELECT count(b.system_id)
      FROM PROJECT b
      WHERE b.cha_tipo_proj = 'T'
      AND b.id_amm = @param1@
      AND b.id_parent = a.system_id
      ) as FIGLIO
      FROM PROJECT a
      WHERE a.cha_tipo_proj = 'T'
      AND a.id_amm = @param1@
      AND a.id_parent = @param2@
      ORDER BY a.var_cod_liv1
    </value>
  </query>

  <query>
    <name>S_NODO_TITOLARIO_SECURITY</name>
    <value>
      SELECT DISTINCT
      a.system_id as IDRECORD,a.var_codice as CODICE,a.description as DESCRIZIONE,a.num_livello as LIVELLO,a.id_registro as REGISTRO,a.id_parent as IDPARENT,a.var_cod_liv1 as CODLIV, isnull(a.num_mesi_conservazione,0) as NUMMESICONSERVAZIONE,
      (SELECT count(b.system_id)
      FROM PROJECT b
      WHERE b.cha_tipo_proj = 'T'
      AND b.id_amm = @param1@
      AND b.id_parent = a.system_id
      ) as FIGLIO
      FROM PROJECT a, SECURITY as s  WITH (nolock)
      WHERE a.cha_tipo_proj = 'T'
      AND a.id_amm = @param1@
      AND a.id_parent = @param2@
      AND a.system_id = s.thing
      AND s.accessrights > 0
      AND s.personorgroup = @param3@
      AND (a.id_registro is null or a.id_registro = @param4@)
      ORDER BY a.var_cod_liv1
    </value>
  </query>

  <query>
    <name>S_REGISTRI_IN_AMMINISTRAZIONE</name>
    <value>
      SELECT
      system_id as IDRECORD,var_desc_registro as DESCRIZIONE
      FROM DPA_EL_REGISTRI
      WHERE id_amm = @param1@ AND CHA_RF = '0'
      ORDER BY var_desc_registro
    </value>
  </query>

  <query>
    <name>S_REGISTRI_IN_AMM_RESTRICTED</name>
    <value>
      SELECT
      a.SYSTEM_ID as IDRECORD, a.VAR_DESC_REGISTRO as DESCRIZIONE
      FROM   PEOPLE e INNER JOIN
      DPA_LOGIN d ON e.USER_ID = d.USER_ID INNER JOIN
      DPA_CORR_GLOBALI c ON e.SYSTEM_ID = c.ID_PEOPLE INNER JOIN
      DPA_USERADMIN_REGISTRI b ON c.SYSTEM_ID = b.SYSTEM_ID_CORR_GLOB INNER JOIN
      DPA_EL_REGISTRI a ON b.SYSTEM_ID_REGISTRO = a.SYSTEM_ID
      WHERE (d.SESSION_ID = '@param1@')
    </value>
  </query>

  <query>
    <name>S_VISIBILITA_NODO_RUOLI</name>
    <value>
      SELECT
      c.id_gruppo AS IDGRUPPO, c.var_desc_corr AS RUOLO, s.personorgroup AS GRUPPOASSOCIATO
      FROM
      DPA_CORR_GLOBALI c LEFT OUTER JOIN
      (SELECT personorgroup FROM SECURITY  WITH (nolock)  WHERE thing = @param1@ AND accessrights IN(255,47,63)) s
      ON c.id_gruppo = s.personorgroup
      WHERE c.cha_tipo_urp = 'R'
      AND c.id_amm = @param2@
      AND c.cha_tipo_ie = 'I'
    </value>
  </query>

  <query>
    <name>S_TOT_CODICE_TIT</name>
    <value>
      SELECT
      COUNT(*) AS TOT
      FROM PROJECT
      WHERE var_codice = '@param1@'
      AND id_amm = @param2@
      AND cha_tipo_proj = 'T'
    </value>
  </query>

  <query>
    <name>U_NODO_TITOLARIO1</name>
    <value>
      UPDATE
      PROJECT
      SET description = '@param1@'
      WHERE system_id = @param2@
    </value>
  </query>

  <query>
    <name>U_NODO_TIT_REG</name>
    <value>
      UPDATE
      PROJECT
      SET id_registro = @param1@
      WHERE system_id = @param2@
      OR
      (id_parent = @param2@ AND cha_tipo_fascicolo = 'G')
    </value>
  </query>

  <query>
    <name>S_CONTA_FASC_PROC_TIT</name>
    <value>
      SELECT
      COUNT(*) as TOT
      FROM PROJECT
      WHERE id_parent = @param1@
      AND cha_tipo_fascicolo = 'P'
    </value>
  </query>

  <query>
    <name>S_CONTA_DOC_IN_ROOT</name>
    <value>
      SELECT
      COUNT(*) AS TOT
      FROM
      PROJECT p, PROJECT_COMPONENTS pc
      WHERE p.id_parent =
      (SELECT
      system_id
      FROM PROJECT
      WHERE id_parent = @param1@
      AND cha_tipo_proj = 'F'
      AND cha_tipo_fascicolo = 'G'
      )
      AND p.cha_tipo_proj = 'C'
      AND p.system_id = pc.project_id
    </value>
  </query>

  <query>
    <name>S_FILTRO_RIC_TIT</name>
    <value>
      SELECT
      system_id as ID, var_codice as CODICE, description as DESCRIZIONE, num_livello as LIVELLO, id_parent as IDPARENT, id_titolario as IDTITOLARIO
      FROM PROJECT
      WHERE
      cha_tipo_proj = 'T'
      @param1@
      @param2@
      AND id_amm = @param3@
      @param4@
      ORDER BY num_livello,var_cod_liv1
    </value>
  </query>

  <query>
    <name>S_FILTRO_RIC_TIT_DOCSPA</name>
    <value>
      SELECT
      DISTINCT A.system_id as ID, A.var_codice as CODICE, A.description as DESCRIZIONE, A.num_livello as LIVELLO, A.id_parent as IDPARENT
      FROM PROJECT A, SECURITY as B  WITH (nolock)  @paramFrom@
      WHERE
      A.cha_tipo_proj = 'T'
      @param1@
      @param2@
      AND A.id_amm = @param3@
      AND A.system_id = B.thing
      AND B.accessrights > 0
      AND B.personorgroup = @param4@
      AND (A.id_registro is null or A.id_registro = @param5@)
      AND ID_TITOLARIO = @param6@
      @paramNote@
      @paramIndice@
      ORDER BY num_livello
    </value>
  </query>
  <query>
    <name>S_NODO_BY_COD</name>
    <value>
      SELECT
      SYSTEM_ID, ID_PARENT, NUM_LIVELLO
      FROM PROJECT
      WHERE VAR_CODICE = '@param1@'
      AND ID_AMM = @param2@
      AND CHA_TIPO_PROJ = 'T' AND (ID_REGISTRO is null or ID_REGISTRO = @param3@)
      AND ID_TITOLARIO = @param4@
    </value>
  </query>

  <query>
    <name>S_NODO_PADRE</name>
    <value>
      SELECT
      id_parent as PADRE
      FROM PROJECT
      WHERE system_id = @param1@
    </value>
  </query>

  <query>
    <name>D_SECURITY_NODO</name>
    <value>
      DELETE FROM SECURITY
      WHERE THING IN
      (
      SELECT system_id
      FROM PROJECT WHERE
      system_id = @param1@
      OR (id_parent = @param1@ AND cha_tipo_proj = 'F' AND cha_tipo_fascicolo = 'G')
      OR (id_parent =
      (SELECT system_id
      FROM PROJECT
      WHERE id_parent = @param1@ AND cha_tipo_proj = 'F' AND cha_tipo_fascicolo = 'G'))
      )
    </value>
  </query>

  <query>
    <name>D_NODO_TITOLARIO</name>
    <value>
      DELETE FROM PROJECT
      WHERE system_id = @param1@
      OR (id_parent = @param1@ AND cha_tipo_proj = 'F' AND cha_tipo_fascicolo = 'G')
      OR (id_parent =
      (SELECT system_id
      FROM PROJECT
      WHERE id_parent = @param1@ AND cha_tipo_proj = 'F' AND cha_tipo_fascicolo = 'G'))
    </value>
  </query>

  <query>
    <name>I_NODO_TITOLARIO</name>
    <value>
      INSERT INTO PROJECT
      (
      @param1@
      DESCRIPTION,
      ICONIZED,
      CHA_TIPO_PROJ,
      VAR_CODICE,
      ID_AMM,
      ID_REGISTRO,
      NUM_LIVELLO,
      CHA_TIPO_FASCICOLO,
      ID_PARENT,
      VAR_COD_LIV1,
      ETDOC_RANDOM_ID,
      DTA_APERTURA,
      CHA_STATO,
      ID_FASCICOLO,
      CHA_RW
      )
      VALUES
      (
      @param2@
      @param3@,
      @param4@,
      @param5@,
      @param6@,
      @param7@,
      @param8@,
      @param9@,
      @param10@,
      @param11@,
      @param12@,
      @param13@,
      @param14@,
      @param15@,
      @param16@,
      @param17@
      )
    </value>
  </query>

  <query>
    <name>AMM_I_VISIBILITA_NODO_RUOLI</name>
    <value>
      INSERT INTO SECURITY
      (THING, PERSONORGROUP, ACCESSRIGHTS, CHA_TIPO_DIRITTO)
      VALUES
      (@param1@, @param2@, 255, 'P')
    </value>
  </query>
  <query>
    <name>S_COD_LIV</name>
    <value>
      SELECT ( case
      when MAX(CONVERT(int,LTRIM(SUBSTRING (CAST(var_cod_liv1 as varchar),LEN(var_cod_liv1)-3, LEN(var_cod_liv1))))) is null
      then 1
      else MAX(CONVERT(int,LTRIM(SUBSTRING (CAST(var_cod_liv1 as varchar),LEN(var_cod_liv1)-3, LEN(var_cod_liv1))))) + 1
      end )as TOT
      FROM PROJECT
      WHERE var_cod_liv1 LIKE '@param1@%'
      AND cha_tipo_proj = 'T'
      AND id_amm = @param2@
      AND num_livello = @param3@
      @param4@
    </value>
  </query>

  <query>
    <name>U_PROJECT_CODLIV1</name>
    <value>
      UPDATE PROJECT
      SET VAR_COD_LIV1 = '@param1@'
      WHERE SYSTEM_ID = @param2@
    </value>
  </query>

  <query>
    <name>U_PROJECT_CODLIV2</name>
    <value>
      UPDATE PROJECT
      SET VAR_COD_LIV1 = @param1@
      WHERE VAR_COD_LIV1 like '@param2@%'
      AND ID_AMM = @param3@
      @param4@
    </value>
  </query>

  <query>
    <name>U_PROJECT_CODLIV3</name>
    <value>
      UPDATE PROJECT
      SET @param1@
      WHERE @param2@
    </value>
  </query>
  <!-- FINE gestione TITOLARIO diretto al db (gadamo) -->

  <!-- QUERY UTILIZZATE PER IL DOCUMENTALE FILENET -->
  <query>
    <name>FILENET_U_VERSION</name>
    <value>
      UPDATE VERSION
      SET  @param1@
      WHERE @param2@
    </value>
  </query>
  <!--
	<query>
		<name>FILENET_S_GET_NUM_VERSIONE</name>
		<value>SELECT MAX (NUM_VERSIONE) FROM VERSION
			   WHERE V_E_NAME='@param1@' AND CHA_ALLEGATO='@param2@'
		</value>
	</query>
	-->

  <query>
    <name>FILENET_S_GET_NUM_VERSIONE</name>
    <value>
      SELECT MAX (VERSION) FROM VERSIONS
      WHERE DOCNUMBER='@param1@'
    </value>
  </query>

  <query>
    <name>FILENET_D_VERSION</name>
    <value>
      DELETE FROM VERSION WHERE V_NAME + V_E_NAME='@param1@'
    </value>
  </query>

  <query>
    <name>FILENET_S_GET_NUM_VERSIONE_2</name>
    <value>
      SELECT VERSION_ID
      FROM VERSIONS
      WHERE
      DOCNUMBER='@param1@' AND VERSION='@param2@'
    </value>
  </query>

  <query>
    <name>FILENET_S_GET_NUM_VERSIONE_3</name>
    <value>
      SELECT V_NAME_FN
      FROM VERSIONS
      WHERE
      DOCNUMBER='@param1@' AND VERSION_ID='@param2@'
    </value>
  </query>
  <query>
    <name>FILENET_S_GET_PROFILE_SYSTEM_ID</name>
    <value>
      SELECT SYSTEM_ID
      FROM PROFILE WITH(NOLOCK)
      WHERE
      DOCNUMBER='@param1@'
    </value>
  </query>
  <query>
    <name>FILENET_I_ADD_USER</name>
    <value>
      INSERT INTO USR (
      U_NAME,
      U_CREATE_DATE,
      U_PWD,
      U_ACT_GRP,
      U_FILE_CREATOR,
      U_USER_CREATOR,
      U_GROUP_CREATOR,
      U_CHKOUT_F_NAME,
      U_OWNER_NAME,
      U_STATUS,
      U_DEF_RUN_APP,
      U_CSINDEX_DEFAULT,
      U_SEARCH_DOMAIN,
      U_FULL_NAME,
      U_SYNC
      ) VALUES (
      '@param1@',
      GETDATE(),
      '',
      '@param2@',
      1,
      1,
      1,
      2,
      'Admin',
      1,
      1,
      2,
      2,
      '@param4@',
      '0'
      )
    </value>
  </query>
  <query>
    <name>FILENET_I_ADD_USERGROUP</name>
    <value>
      INSERT INTO GRP_USR (
      GU_G_NAME,
      GU_U_NAME
      ) VALUES (
      '@param1@',
      '@param2@'
      )
    </value>
  </query>
  <query>
    <name>FILENET_D_USER</name>
    <value>
      DELETE FROM USR WHERE U_NAME='@param1@'
    </value>
  </query>
  <query>
    <name>FILENET_D_GRP_USR</name>
    <value>
      DELETE FROM GRP_USR WHERE GU_U_NAME='@param1@'
    </value>
  </query>
  <query>
    <name>FILENET_M_USER</name>
    <value>
      UPDATE USR SET U_NAME='@param1@', U_FULL_NAME='@param2@' WHERE U_NAME='@param3@'
    </value>
  </query>
  <query>
    <name>FILENET_VERSION_IS_ACQUISITO</name>
    <value>
      SELECT VAR_IMPRONTA FROM COMPONENTS WHERE DOCNUMBER='@param1@' AND VERSION_ID='@param2@'
    </value>
  </query>
  <query>
    <name>FILENET_U_VERSIONS</name>
    <value>
      UPDATE VERSIONS
      SET @param1@
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>FILENET_S_PEOPLE</name>
    <value>
      SELECT USER_PASSWORD FROM PEOPLE WHERE USER_ID='@param1@'
    </value>
  </query>
  <query>
    <name>FILENET_DISABLE_PEOPLE</name>
    <value>
      UPDATE USR SET U_STATUS=0 WHERE U_NAME='@param1@'
    </value>
  </query>
  <query>
    <name>FILENET_S_PEOPLE_2</name>
    <value>
      SELECT USER_PASSWORD FROM PEOPLE WHERE SYSTEM_ID=@param1@
    </value>
  </query>
  <query>
    <name>FILENET_S_VERSION</name>
    <value>
      SELECT V_STACK_ID, V_STACK_FILE_ID
      FROM VERSION
      WHERE V_E_NAME='@param1@' AND V_NAME='@param2@'
    </value>
  </query>
  <query>
    <name>FILENET_S_STACK</name>
    <value>
      SELECT ST_NODE, ST_PATH
      FROM STACK
      WHERE ST_ID=@param1@
    </value>
  </query>
  <query>
    <name>FILENET_GET_VERSIONID</name>
    <value>
      SELECT VERSION_ID
      FROM VERSIONS
      WHERE DOCNUMBER=@param1@ AND V_NAME_FN='@param2@'
    </value>
  </query>
  <query>
    <name>FILENET_UPDATE_COMPONENTS</name>
    <value>
      UPDATE COMPONENTS
      SET PATH='@param1@'
      WHERE DOCNUMBER=@param2@ AND VERSION_ID=@param3@
    </value>
  </query>

  <query>
    <name>FILENET_GET_ORIGINAL_FILE_NAME</name>
    <value>
      SELECT
      V_FILE_NAME
      FROM
      VERSION
      WHERE
      V_E_NAME='@param1@' AND V_NAME='@param2@'
    </value>
  </query>

  <!-- FINE  QUERY UTILIZZATE PER IL DOCUMENTALE FILENET -->

  <query>
    <name>S_J_PROJECT__PROJECT_COMPONENTS__GET_FOLDERS_DOCUMENT</name>
    <value>
      SELECT  P.SYSTEM_ID AS ID_FOLDER,
      P.ID_PARENT AS ID_PARENT_FOLDER,
      P.ID_FASCICOLO ID_FASCICOLO,
      P.DESCRIPTION FOLDER_DESCRIPTION,
      P.cha_tipo_fascicolo,
      P.dta_apertura APERTURA,
      P.num_livello,
      P.var_cod_liv1

      FROM    PROJECT P,
      PROJECT_COMPONENTS PC

      WHERE   PC.PROJECT_ID = P.SYSTEM_ID AND
      PC.LINK=@param1@ AND
      PC.TYPE='D' AND
      P.id_fascicolo != P.id_parent
      @param2@

      ORDER BY P.SYSTEM_ID ASC
    </value>
  </query>

  <!-- QUERY UTILIZZATE PER LO SMISTAMENTO  -->
  <query>
    <name>S_SMISTADOC_VER_RAG_TRASM</name>
    <value>
      SELECT
      B.*
      FROM
      DPA_AMMINISTRA A, DPA_RAGIONE_TRASM B
      WHERE
      A.SYSTEM_ID = @param1@
      AND A.SYSTEM_ID = B.ID_AMM
      AND ((A.ID_RAGIONE_COMPETENZA = B.SYSTEM_ID)
      OR (A.ID_RAGIONE_CONOSCENZA = B.SYSTEM_ID))
    </value>
  </query>
  <query>
    <name>S_SMISTADOC_GET_LIST_DOCUMENTI_TRASMESSI</name>
    <value>
      SELECT
      E.SYSTEM_ID AS SYSTEM_ID,
      D.CHA_TIPO_RAGIONE AS TIPO_RAGIONE,
      A.SYSTEM_ID AS ID_TRASMISSIONE,
      B.SYSTEM_ID AS ID_TRASMISSIONE_SINGOLA,
      C.SYSTEM_ID AS ID_TRASMISSIONE_UTENTE,
      A.VAR_NOTE_GENERALI AS NOTE_GENERALI
      FROM
      DPA_TRASMISSIONE A,
      DPA_TRASM_SINGOLA B,
      DPA_TRASM_UTENTE C,
      DPA_RAGIONE_TRASM D,
      PROFILE E
      WHERE
      A.ID_PROFILE=E.SYSTEM_ID and
      A.SYSTEM_ID=B.ID_TRASMISSIONE AND
      B.SYSTEM_ID=C.ID_TRASM_SINGOLA AND
      B.ID_RAGIONE=D.SYSTEM_ID AND
      C.CHA_VALIDA='1' AND
      A.DTA_INVIO IS NOT NULL AND
      ((B.ID_CORR_GLOBALE = @param1@ AND C.ID_PEOPLE=@param2@) OR B.ID_CORR_GLOBALE=
      (SELECT SYSTEM_ID
      FROM DPA_CORR_GLOBALI
      WHERE ID_PEOPLE=@param2@ AND CHA_TIPO_URP = 'P')) AND
      A.CHA_TIPO_OGGETTO = 'D' AND
      C.CHA_IN_TODOLIST = '1' AND
      (E.ID_REGISTRO IN (@param3@) OR E.ID_REGISTRO IS NULL)
      ORDER BY
      A.DTA_INVIO DESC,B.ID_TRASMISSIONE DESC, B.CHA_TIPO_DEST ASC
    </value>
  </query>
  <query>
    <name>S_SMISTADOC_GET_DOCUMENTO</name>
    <value>
      SELECT
      E.SYSTEM_ID as IDDocumento,
      E.DOCNUMBER as DocNumber,
      E.cha_tipo_proto as TipoDocumento,
      @param1@ AS DataCreazione,
      E.var_prof_oggetto as Oggetto,
      E.var_segnatura as Segnatura,
      E.id_registro as IDRegistro,
      (SELECT MAX(v.version) FROM VERSIONS v WHERE v.docnumber = E.docnumber) AS Versioni,
      (@param3@.COUNTALLEGATI_BY_DOCNUMBER(E.docnumber)) AS Allegati
      FROM
      PROFILE E
      WHERE
      E.SYSTEM_ID=@param2@
    </value>
  </query>
  <query>
    <name>S_SMISTADOC_GET_MITT_DEST_DOCUMENTO</name>
    <value>
      SELECT  AP.ID_MITT_DEST AS MITTENTE_DOCUMENTO,
      AP.CHA_TIPO_MITT_DEST AS TIPO,
      CG.VAR_COD_RUBRICA,
      CG.VAR_DESC_CORR
      FROM 	DPA_DOC_ARRIVO_PAR AP,
      DPA_CORR_GLOBALI CG,
      PROFILE P
      WHERE 	AP.ID_MITT_DEST=CG.SYSTEM_ID AND
      P.SYSTEM_ID=@param1@ AND
      P.SYSTEM_ID=AP.ID_PROFILE AND
      AP.CHA_TIPO_MITT_DEST IN ('M','D')
    </value>
  </query>
  <query>
    <name>S_SMISTADOC_GET_COMPONENT_DATA</name>
    <value>
      SELECT 	C.PATH,
      C.FILE_SIZE,
      C.VAR_IMPRONTA,
      C.VERSION_ID,
      C.DOCNUMBER,
      V.VERSION_LABEL,
      V.VERSION,
      C.CHA_FIRMATO
      FROM 	COMPONENTS C,VERSIONS V
      WHERE 	C.VERSION_ID =
      (
      SELECT MAX(VERSION_ID)
      FROM VERSIONS
      WHERE DOCNUMBER =(SELECT P.DOCNUMBER FROM PROFILE P WITH(NOLOCK) WHERE P.SYSTEM_ID = @param1@)
      AND VERSION NOT IN (0)
      )
      AND C.VERSION_ID =V.VERSION_ID
    </value>
  </query>
  <query>
    <name>S_SMISTADOC_GET_UO_APPARTENENZA</name>
    <value>
      SELECT 	CG.SYSTEM_ID AS ID,
      CG.VAR_COD_RUBRICA AS CODICE_UO,
      CG.VAR_DESC_CORR AS DESCRIZIONE_UO
      FROM 	DPA_CORR_GLOBALI CG
      WHERE 	SYSTEM_ID=
      (SELECT ID_UO
      FROM DPA_CORR_GLOBALI
      WHERE SYSTEM_ID=@param1@
      )
    </value>
  </query>
  <query>
    <name>S_SMISTADOC_GET_RUOLI_UO_APPARTENENZA</name>
    <value>
      SELECT DISTINCT    CG.SYSTEM_ID AS ID,
      CG.ID_UO AS ID_UO,
      CG.ID_GRUPPO AS ID_GRUPPO,
      CG.VAR_CODICE AS CODICE_RUOLO,
      CG.VAR_DESC_CORR AS DESCRIZIONE_RUOLO,
      CG.CHA_RIFERIMENTO AS RUOLO_RIFERIMENTO,
      (case
      when TR.NUM_LIVELLO &gt; @param2@ then 0
      when TR.NUM_LIVELLO = @param2@ then 2
      when TR.NUM_LIVELLO &lt; @param2@ then 1
      end
      ) AS GERARCHIA,tr.num_livello,
      CG.CHA_DISABLED_TRASM
      FROM DPA_CORR_GLOBALI CG,
      DPA_TIPO_RUOLO TR,
      DPA_L_RUOLO_REG RR
      WHERE    CG.SYSTEM_ID = RR.ID_RUOLO_IN_UO AND
      CG.ID_TIPO_RUOLO = TR.SYSTEM_ID     AND
      RR.ID_REGISTRO IN (@param3@) AND
      RR.DTA_FINE IS NULL AND
      CG.ID_UO = @param1@ AND
      CG.CHA_TIPO_URP='R' AND
      CG.DTA_FINE IS NULL
      order by tr.num_livello asc
    </value>
  </query>
  <query>
    <name>S_SMISTADOC_GET_RUOLI_UO_APP_NAV</name>
    <value>
      SELECT DISTINCT	CG.SYSTEM_ID AS ID,
      CG.ID_UO AS ID_UO,
      CG.ID_GRUPPO AS ID_GRUPPO,
      CG.VAR_CODICE AS CODICE_RUOLO,
      CG.VAR_DESC_CORR AS DESCRIZIONE_RUOLO,
      CG.CHA_RIFERIMENTO AS RUOLO_RIFERIMENTO,
      (case
      when TR.NUM_LIVELLO &gt; @param2@ then 0
      when TR.NUM_LIVELLO = @param2@ then 2
      when TR.NUM_LIVELLO &lt; @param2@ then 1
      end
      ) AS GERARCHIA,
      CG.CHA_DISABLED_TRASM
      FROM DPA_CORR_GLOBALI CG,
      DPA_TIPO_RUOLO TR,
      DPA_L_RUOLO_REG RR
      WHERE	CG.SYSTEM_ID = RR.ID_RUOLO_IN_UO AND
      CG.ID_TIPO_RUOLO = TR.SYSTEM_ID	 AND
      RR.ID_REGISTRO IN (@param3@) AND
      RR.DTA_FINE IS NULL AND
      CG.ID_UO = @param1@ AND
      CG.CHA_TIPO_URP='R' AND
      CG.DTA_FINE IS NULL
    </value>
  </query>
  <query>
    <name>S_SMISTADOC_GET_RUOLI_UO_SOTTOSTANTI</name>
    <value>
      SELECT DISTINCT CG.SYSTEM_ID AS ID,
      CG.ID_UO AS ID_UO,
      CG.ID_GRUPPO AS ID_GRUPPO,
      CG.VAR_CODICE AS CODICE_RUOLO,
      CG.VAR_DESC_CORR AS DESCRIZIONE_RUOLO,
      CG.CHA_RIFERIMENTO AS RUOLO_RIFERIMENTO,
      (case
      when TR.NUM_LIVELLO &gt; @livello@ then 0
      when TR.NUM_LIVELLO = @livello@ then 2
      when TR.NUM_LIVELLO &lt; @livello@ then 1
      end ) AS GERARCHIA
      FROM DPA_CORR_GLOBALI CG,
      DPA_TIPO_RUOLO TR,
      DPA_L_RUOLO_REG RR
      WHERE CG.ID_TIPO_RUOLO = TR.SYSTEM_ID AND
      CG.ID_TIPO_RUOLO = TR.SYSTEM_ID AND
      RR.ID_REGISTRO IN (@param2@) AND
      RR.DTA_FINE IS NULL AND
      CG.ID_UO = @param1@ AND
      CG.CHA_TIPO_URP='R' AND
      CG.DTA_FINE IS NULL
    </value>
  </query>
  <query>
    <name>S_SMISTADOC_COUNT_UO_SOTTOSTANTI</name>
    <value>
      SELECT COUNT(DISTINCT CG.SYSTEM_ID) AS TOTALI
      FROM DPA_CORR_GLOBALI CG, DPA_CORR_GLOBALI CGG, DPA_UO_REG UOR
      WHERE CG.ID_PARENT = @param1@
      AND CG.SYSTEM_ID = UOR.ID_UO
      AND UOR.ID_REGISTRO IN (@param2@)
      AND CGG.ID_UO > 0
      AND CG.SYSTEM_ID > 0
      --  AND CG.ID_OLD = 0
      AND CG.DTA_FINE IS NULL
      AND CGG.DTA_FINE IS NULL
      AND CG.SYSTEM_ID = CGG.ID_UO
      AND CGG.CHA_RIFERIMENTO = '1'
    </value>
  </query>
  <query>
    <name>S_SMISTADOC_GET_UTENTI_RUOLI_UO_APPARTENENZA</name>
    <value>
      SELECT 	P.SYSTEM_ID AS ID,
      CG.SYSTEM_ID AS ID_CORR_GLOBALI,
      G.SYSTEM_ID AS ID_GRUPPO,
      P.USER_ID AS CODICE_UTENTE,
      P.FULL_NAME AS DESCRIZIONE_UTENTE,
      P.EMAIL_ADDRESS AS EMAIL_UTENTE,
      P.CHA_NOTIFICA,
      P.CHA_NOTIFICA_CON_ALLEGATO
      FROM 	GROUPS G,
      PEOPLEGROUPS PG,
      PEOPLE P,
      DPA_CORR_GLOBALI CG
      WHERE 	PG.GROUPS_SYSTEM_ID=G.SYSTEM_ID AND
      PG.PEOPLE_SYSTEM_ID=P.SYSTEM_ID AND
      G.SYSTEM_ID IN (@param1@) AND
      P.DISABLED NOT IN ('Y') AND
      P.SYSTEM_ID=CG.ID_PEOPLE
      AND PG.DTA_FINE IS NULL
      AND	CG.CHA_TIPO_URP!='L'
      ORDER BY P.VAR_COGNOME ASC
    </value>
  </query>
  <query>
    <name>S_SMISTADOC_GET_UO_SOTTOSTANTI</name>
    <value>
      SELECT 	DISTINCT
      CG.SYSTEM_ID AS ID,
      CG.VAR_COD_RUBRICA AS CODICE_UO,
      CG.VAR_DESC_CORR AS DESCRIZIONE_UO, CG.ID_PESO_ORG
      FROM 	DPA_CORR_GLOBALI CG, DPA_CORR_GLOBALI CGG, DPA_UO_REG UOR
      WHERE	CG.ID_PARENT = @param1@
      AND
      CG.SYSTEM_ID = UOR.ID_UO AND UOR.ID_REGISTRO IN (@param2@)
      --((CG.ID_AMM IS NULL) OR
      --	(CG.ID_REGISTRO IS NULL AND CG.ID_AMM=@param3@) OR
      --	((CG.ID_REGISTRO IN (@param2@)) AND CG.ID_AMM=@param3@))
      AND CGG.ID_UO &gt; 0
      AND CG.SYSTEM_ID &gt; 0
      -- AND CG.ID_OLD = 0
      AND CG.SYSTEM_ID = CGG.ID_UO
      AND CG.DTA_FINE IS NULL
      AND CGG.DTA_FINE IS NULL
      AND CGG.CHA_RIFERIMENTO = '1'
      ORDER BY CG.ID_PESO_ORG, CG.VAR_DESC_CORR
    </value>
  </query>
  <query>
    <name>S_SMISTADOC_GET_UO_CORRENTE</name>
    <value>
      SELECT 	CG.SYSTEM_ID AS ID,
      CG.VAR_COD_RUBRICA AS CODICE_UO,
      CG.VAR_DESC_CORR AS DESCRIZIONE_UO
      FROM 	DPA_CORR_GLOBALI CG
      WHERE 	SYSTEM_ID=@param1@
    </value>
  </query>
  <!-- QUERY UTILIZZATE PER LO SMISTAMENTO  -->

  <!-- QUERY UTILIZZATE PER L'AMMINISTRAZIONE -->
  <query>
    <name>S_AMM_GET_LIST_UO</name>
    <value>
      SELECT
      system_id AS IDCorrGlobale,
      var_codice AS Codice,
      var_cod_rubrica AS CodiceRubrica,
      var_desc_corr AS Descrizione,
      id_amm AS IDAmministrazione,
      num_livello AS Livello,
      var_codice_aoo AS CodiceRegistroInterop,
      (SELECT
      COUNT(*)
      FROM
      DPA_CORR_GLOBALI c
      WHERE
      c.cha_tipo_urp = 'R'
      AND c.cha_tipo_ie = 'I'
      AND c.dta_fine IS NULL
      AND c.id_uo = a.system_id) AS Ruoli,
      (SELECT
      COUNT(*)
      FROM
      DPA_CORR_GLOBALI b
      WHERE b.cha_tipo_urp = 'U'
      AND b.cha_tipo_ie = 'I'
      AND b.id_amm = @param3@
      AND b.id_parent = a.system_id
      AND b.dta_fine IS NULL
      ) AS SottoUo,
      a.id_peso_org AS IDPESO,
      classifica_uo AS ClassificaUO,
      a.InteropRegistryId,
      a.InteropRfId,
      a.CDC_CODICE
      FROM
      DPA_CORR_GLOBALI a
      WHERE a.cha_tipo_urp = 'U'
      AND a.cha_tipo_ie = 'I'
      AND a.dta_fine IS NULL
      @param1@
      @param2@
      AND a.id_amm = @param3@
      ORDER BY a.id_peso_org, a.var_desc_corr asc
    </value>
  </query>
  <query>
    <name>S_AMM_GET_LIST_RUOLI</name>
    <value>
      SELECT
      a.system_id AS IDCORRGLOBALE,
      a.id_gruppo AS IDGRUPPO,
      a.id_tipo_ruolo AS IDTIPORUOLO,
      b.var_codice as CODICETIPORUOLO,
      a.var_codice AS CODICE,
      a.var_cod_rubrica AS CODICERUBRICA,
      a.var_desc_corr AS DESCRIZIONE,
      a.cha_riferimento AS DIRIFERIMENTO,
      a.id_amm AS IDAMMINISTRAZIONE,
      a.cha_responsabile as RESPONSABILE,
      a.id_peso_org as IDPESO,
      a.CHA_SEGRETARIO as SEGRETARIO,
      b.NUM_LIVELLO as NUM_LIVELLO,
      a.CHA_DISABLED_TRASM
      FROM
      DPA_CORR_GLOBALI a, DPA_TIPO_RUOLO b
      WHERE
      a.cha_tipo_urp = 'R'
      AND a.cha_tipo_ie = 'I'
      AND a.dta_fine is null
      AND a.id_uo in ( @param1@ )
      AND a.ID_TIPO_RUOLO = b.SYSTEM_ID
      ORDER BY NUM_LIVELLO ASC, DESCRIZIONE ASC
    </value>
  </query>
  <query>
    <name>S_AMM_GET_LIST_TIPORUOLO_UT</name>
    <value>
      SELECT
      a.system_id AS IDCORRGLOBALE,
      a.id_gruppo AS IDGRUPPO,
      a.id_tipo_ruolo AS IDTIPORUOLO,
      a.var_codice AS CODICE,
      a.var_cod_rubrica AS CODICERUBRICA,
      a.var_desc_corr AS DESCRIZIONE
      FROM
      DPA_CORR_GLOBALI a, DPA_TIPO_RUOLO b
      WHERE
      a.id_tipo_ruolo = b.system_id
      AND b.id_amm = @param1@
      AND b.var_codice = '@param2@'
      AND a.cha_tipo_urp = 'R'
      AND a.cha_tipo_ie = 'I'
      AND a.dta_fine IS NULL
      ORDER BY DESCRIZIONE ASC
    </value>
  </query>
  <query>
    <name>S_AMM_GET_LIST_RUOLI_UT</name>
    <value>
      SELECT
      a.system_id AS IDGRUPPO,
      a.group_id AS CODICE,
      a.group_name AS DESCRIZIONE,
      b.cha_preferito AS PREFERITO
      FROM
      GROUPS a, PEOPLEGROUPS b
      WHERE
      b.groups_system_id = a.system_id
      AND b.dta_fine IS NULL
      AND	b.people_system_id = @param1@
      ORDER BY DESCRIZIONE ASC
    </value>
  </query>
  <query>
    <name>S_AMM_GET_LIST_UTENTI</name>
    <value>
      SELECT
      a.system_id AS IDCORRGLOBALE,
      a.id_people AS IDPEOPLE,
      a.var_codice AS CODICE,
      a.var_cod_rubrica AS CODICERUBRICA,
      a.var_nome AS NOME,
      a.var_cognome AS COGNOME,
      a.id_amm AS IDAMMINISTRAZIONE,
      c.matricola as MATRICOLA,
      c.email_address AS EMAIL,
      d.ID_UO as IDUO
      FROM
      DPA_CORR_GLOBALI a, PEOPLEGROUPS b, PEOPLE c, DPA_CORR_GLOBALI d
      WHERE
      a.id_people = b.people_system_id
      AND b.people_system_id = c.system_id
      AND b.GROUPS_SYSTEM_ID = d.ID_GRUPPO
      AND c.disabled = 'N'
      AND a.dta_fine is NULL
      AND b.dta_fine is NULL
      AND a.cha_tipo_urp = 'P'
      AND a.cha_tipo_ie = 'I'
      AND b.groups_system_id = @param1@
    </value>
  </query>
  <query>
    <name>S_AMM_GET_LIST_REGISTRI</name>
    <value>
      SELECT
      SYSTEM_ID AS IDREGISTRO,
      VAR_CODICE AS CODICE,
      VAR_DESC_REGISTRO AS DESCRIZIONE,
      ID_AMM AS IDAMMINISTRAZIONE,
      CHA_RF AS RF,
      CHA_DISABILITATO AS RFDISABILITATO,
      ID_AOO_COLLEGATA AS AOOCOLLEGATA,
      CHA_STATO AS STATO
      FROM
      DPA_EL_REGISTRI
      WHERE
      ID_AMM = @param1@ AND CHA_RF = '0'
      ORDER BY
      @order@
    </value>
  </query>
  <query>
    <name>S_AMM_GET_LIST_REGISTRI_RF_ASS_RUOLO</name>
    <value>
      SELECT
      SYSTEM_ID AS IDREGISTRO,
      VAR_CODICE AS CODICE,
      VAR_DESC_REGISTRO AS DESCRIZIONE,
      ID_AMM AS IDAMMINISTRAZIONE,
      (SELECT
      SYSTEM_ID
      FROM
      DPA_L_RUOLO_REG
      WHERE
      DPA_EL_REGISTRI.SYSTEM_ID = DPA_L_RUOLO_REG.ID_REGISTRO
      AND
      DPA_L_RUOLO_REG.ID_RUOLO_IN_UO = @param2@
      )
      AS ASSOCIATO,
      CHA_RF AS RF,
      CHA_DISABILITATO AS RFDISABILITATO,
      ID_AOO_COLLEGATA AS AOOCOLLEGATA,
      CHA_STATO AS STATO
      FROM
      DPA_EL_REGISTRI
      WHERE
      ID_AMM = @param1@ @param3@
    </value>
  </query>
  <query>
    <name>S_AMM_GET_LIST_REGISTRI_ASS_RUOLO2</name>
    <value>
      SELECT
      a.SYSTEM_ID AS IDREGISTRO,
      a.VAR_CODICE AS CODICE,
      a.VAR_DESC_REGISTRO AS DESCRIZIONE,
      a.ID_AMM AS IDAMMINISTRAZIONE,
      b.DTA_INIZIO AS DATA_ASSOCIAZIONE,
      b.DTA_ASS_VISIBILITA AS DATA_VISIBILITA,
      a.CHA_RF AS RF,
      a.CHA_STATO AS STATO
      FROM
      DPA_EL_REGISTRI a, DPA_L_RUOLO_REG b
      WHERE
      a.ID_AMM = @param1@
      AND	b.ID_RUOLO_IN_UO = @param2@ AND A.CHA_RF = '0'
      AND a.SYSTEM_ID = B.ID_REGISTRO
    </value>
  </query>
  <query>
    <name>S_AMM_GET_LIST_REGISTRI_ASS_UTENTE</name>
    <value>
      SELECT
      SYSTEM_ID AS IDREGISTRO,
      VAR_CODICE AS CODICE,
      CHA_STATO AS STATO,
      VAR_DESC_REGISTRO AS DESCRIZIONE,
      (SELECT
      SYSTEM_ID_CORR_GLOB
      FROM
      DPA_USERADMIN_REGISTRI
      WHERE
      DPA_EL_REGISTRI.SYSTEM_ID = DPA_USERADMIN_REGISTRI.SYSTEM_ID_REGISTRO
      AND
      DPA_USERADMIN_REGISTRI.SYSTEM_ID_CORR_GLOB = @idCorrGlob@
      )
      AS ASSOCIATO
      FROM
      DPA_EL_REGISTRI
      WHERE
      ID_AMM = @idAmm@
    </value>
  </query>
  <query>
    <name>S_REGISTRI_ASS_UTENTE</name>
    <value>
      select system_id_registro from dpa_useradmin_registri where system_id_corr_glob = @idCorrGlob@
    </value>
  </query>
  <query>
    <name>D_REGISTRI_ASS_UTENTE</name>
    <value>
      delete from dpa_useradmin_registri where system_id_corr_glob = @idCorrGlob@
    </value>
  </query>
  <query>
    <name>I_REGISTRI_ASS_UTENTE</name>
    <value>
      insert into dpa_useradmin_registri (system_id_corr_glob, system_id_registro) values (@idCorrGlob@,@idRegistro@)
    </value>
  </query>
  <query>
    <name>S_AMM_GET_LIST_FUNZIONI_ASS_RUOLO</name>
    <value>
      SELECT
      SYSTEM_ID AS IDTIPOFUNZIONE,
      VAR_COD_TIPO AS CODICE,
      VAR_DESC_TIPO_FUN AS DESCRIZIONE,
      (SELECT
      SYSTEM_ID
      FROM
      DPA_TIPO_F_RUOLO
      WHERE
      DPA_TIPO_F_RUOLO.ID_TIPO_FUNZ = DPA_TIPO_FUNZIONE.SYSTEM_ID
      AND
      DPA_TIPO_F_RUOLO.ID_RUOLO_IN_UO = @param1@
      )
      AS ASSOCIATO
      FROM
      DPA_TIPO_FUNZIONE
      WHERE
      CHA_VIS = '1'
      AND ID_AMM = @idAmm@
    </value>
  </query>
  <query>
    <name>S_AMM_GET_DATI_UTENTE</name>
    <value>
      SELECT
      a.system_id AS IDCORRGLOBALE,
      b.system_id AS IDPEOPLE,
      b.user_id AS USERID,
      a.var_codice AS CODICE,
      a.var_cod_rubrica AS CODICERUBRICA,
      a.var_nome AS NOME,
      a.var_cognome AS COGNOME,
      a.var_email AS EMAIL,
      b.var_sede AS SEDE,
      b.user_password AS PASSWORD,
      b.disabled AS ABILITATO,
      b.cha_amministratore AS AMMINISTRATORE,
      b.cha_notifica AS NOTIFICA,
      b.cha_notifica_con_allegato AS ALLEGATO_NOTIFICA,
      a.id_amm AS IDAMMINISTRAZIONE,
      b.matricola as MATRICOLA,
      b.abilitato_chiavi_config
      FROM
      DPA_CORR_GLOBALI a, PEOPLE b
      WHERE
      a.id_people = b.system_id
      AND a.system_id = @param1@
    </value>
  </query>
  <query>
    <name>I_AMM_NUOVO_RUOLO_IN_UO</name>
    <value>
      INSERT INTO DPA_CORR_GLOBALI
      (
      @param1@
      id_amm,
      var_cod_rubrica,
      var_desc_corr,
      dta_inizio,
      var_codice,
      id_tipo_ruolo,
      id_gruppo,
      cha_tipo_corr,
      cha_tipo_ie,
      cha_tipo_urp,
      cha_riferimento,
      id_uo,
      id_old,
      cha_responsabile,
      cha_segretario,
      cha_disabled_trasm,
      var_original_code,
      original_id
      )
      VALUES
      (
      @param2@
      @param3@,
      '@param4@',
      '@param5@',
      @param6@,
      '@param7@',
      @param8@,
      @param9@,
      'S',
      'I',
      'R',
      @param10@,
      @param11@,
      0,
      @param12@,
      @param13@,
      @param14@,
      '@param4@',scope_identity()
      )
    </value>
  </query>
  <query>
    <name>U_AMM_RUOLO_IN_UO_GROUPS</name>
    <value>
      UPDATE
      GROUPS
      SET GROUP_ID = '@param1@',
      GROUP_NAME = '@param2@'
      WHERE
      SYSTEM_ID = @param3@
    </value>
  </query>
  <query>
    <name>U_AMM_RUOLO_IN_UO_CORRGLOB</name>
    <value>
      UPDATE
      DPA_CORR_GLOBALI
      SET
      var_codice = '@param1@',
      var_cod_rubrica = '@param1@',
      var_desc_corr = '@param2@',
      cha_riferimento = @param3@,
      ID_TIPO_RUOLO = '@param5@',
      cha_responsabile = @param6@,
      cha_segretario=@param7@,
      cha_disabled_trasm=@param8@,
      id_uo=@idUo@
      WHERE system_id = @param4@
    </value>
  </query>
  <query>
    <name>S_RECORD_TRASM_SINGOLA</name>
    <value>
      SELECT COUNT(*) AS TOT
      FROM DPA_TRASM_SINGOLA
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>S_RECORD_PROFILE</name>
    <value>
      SELECT COUNT (*) AS tot
      FROM (SELECT
      system_id
      FROM PROFILE
      WHERE id_ruolo_prot = @param1@
      UNION
      SELECT thing
      FROM security
      WHERE personorgroup IN (SELECT id_gruppo
      FROM dpa_corr_globali
      WHERE system_id = @param1@)) AS PROFILE
    </value>
  </query>
  <query>
    <name>D_RUOLO_CORR_GLOBALI</name>
    <value>
      DELETE FROM DPA_CORR_GLOBALI
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>D_REGISTRI_RUOLO_IN_UO</name>
    <value>
      DELETE FROM DPA_L_RUOLO_REG
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>D_FUNZIONI_RUOLO_IN_UO</name>
    <value>
      DELETE FROM DPA_TIPO_F_RUOLO
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>S_RISULTATO_RICERCA_ORG_U</name>
    <value>
      SELECT
      a.system_id AS IDCORRGLOB,
      a.VAR_COD_RUBRICA AS CODICE,
      a.var_desc_corr AS DESCRIZIONE,
      a.id_parent AS IDPARENT,
      (SELECT var_desc_corr FROM DPA_CORR_GLOBALI WHERE system_id = a.id_parent) AS DESCPARENT
      FROM
      DPA_CORR_GLOBALI a
      WHERE
      a.cha_tipo_urp='U'
      AND a.cha_tipo_ie = 'I'
      AND a.id_amm = @param1@
      AND a.dta_fine IS NULL
      @param2@
      @param3@
    </value>
  </query>
  <query>
    <name>S_RISULTATO_RICERCA_ORG_R</name>
    <value>
      SELECT
      a.original_id AS IDCORRGLOB,
      a.VAR_COD_RUBRICA AS CODICE,
      a.var_desc_corr AS DESCRIZIONE,
      a.id_uo AS IDPARENT,
      a.id_gruppo AS IDGRUPPO,
      (SELECT var_desc_corr FROM DPA_CORR_GLOBALI WHERE system_id = a.id_uo) AS DESCPARENT,
      dta_fine as DATAFINE
      FROM
      DPA_CORR_GLOBALI a
      WHERE
      a.cha_tipo_urp='R'
      AND a.cha_tipo_ie = 'I'
      AND a.id_amm = @param1@
      @dtaFineCond@
      @param2@
      @param3@
      order by a.dta_inizio desc
    </value>
  </query>
  <query>
    <name>S_RISULTATO_RICERCA_ORG_PNOME</name>
    <value>
      SELECT
      a.system_id AS IDCORRGLOB,
      a.VAR_COD_RUBRICA AS CODICE,
      (a.var_nome + ' ' + a.var_cognome) AS DESCRIZIONE,
      (SELECT system_id FROM DPA_CORR_GLOBALI WHERE id_gruppo = d.system_id) AS IDPARENT,
      d.group_name AS DESCPARENT,
      a.ID_PEOPLE AS IDPEOPLE,
      b.MATRICOLA
      FROM
      DPA_CORR_GLOBALI a, PEOPLE b, PEOPLEGROUPS c, GROUPS d
      WHERE
      a.id_people = b.system_id
      AND b.system_id = c.PEOPLE_SYSTEM_ID
      AND c.GROUPS_SYSTEM_ID = d.system_id
      AND a.cha_tipo_urp='P'
      AND a.cha_tipo_ie = 'I'
      AND a.id_amm = @param1@
      AND a.dta_fine IS NULL
      AND c.dta_fine IS NULL
      @param2@
      @param3@
    </value>
  </query>
  <query>
    <name>S_RISULTATO_RICERCA_ORG_PCOGNOME</name>
    <value>
      SELECT
      a.system_id AS IDCORRGLOB,
      a.VAR_COD_RUBRICA AS CODICE,
      (a.var_cognome + ' ' + a.var_nome) AS DESCRIZIONE,
      (SELECT system_id FROM DPA_CORR_GLOBALI WHERE id_gruppo = d.system_id) AS IDPARENT,
      d.group_name AS DESCPARENT,
      a.ID_PEOPLE AS IDPEOPLE,
      b.MATRICOLA
      FROM
      DPA_CORR_GLOBALI a, PEOPLE b, PEOPLEGROUPS c, GROUPS d
      WHERE
      a.id_people = b.system_id
      AND b.system_id = c.PEOPLE_SYSTEM_ID
      AND c.GROUPS_SYSTEM_ID = d.system_id
      AND a.cha_tipo_urp='P'
      AND a.cha_tipo_ie = 'I'
      AND a.id_amm = @param1@
      AND a.dta_fine IS NULL
      AND c.dta_fine IS NULL
      @param2@
      @param3@
    </value>
  </query>
  <query>
    <name>S_AMM_GET_LIST_IDPARENT_UO</name>
    <value>
      SELECT
      id_parent
      FROM
      DPA_CORR_GLOBALI
      WHERE system_id = @param1@
    </value>
  </query>
  <query>
    <name>S_AMM_GET_LIST_IDPARENT_UORUOLO</name>
    <value>
      SELECT
      id_uo
      FROM
      DPA_CORR_GLOBALI
      WHERE system_id = @param1@
    </value>
  </query>
  <query>
    <name>U_DISABILITA_GRUPPO</name>
    <value>
      UPDATE
      GROUPS
      SET
      DISABLED = 'Y',
      GROUP_ID = GROUP_ID + '_' + convert(varchar,SYSTEM_ID)
      WHERE SYSTEM_ID = @param1@
    </value>
  </query>
  <query>
    <name>U_DPA_TRASM_UTENTE_DTA_RIFIUTATA2</name>
    <value>
      UPDATE DPA_TRASM_UTENTE
      SET DTA_RIFIUTATA = @param1@,
      CHA_RIFIUTATA='1',
      VAR_NOTE_RIF='Trasmissione rifiutata per mancanza di utenti nel ruolo',
      CHA_IN_TODOLIST = '0'
      WHERE SYSTEM_ID IN
      (
      SELECT C.SYSTEM_ID
      FROM DPA_TRASMISSIONE A, DPA_TRASM_SINGOLA B, DPA_TRASM_UTENTE C WITH (nolock), DPA_RAGIONE_TRASM D
      WHERE A.SYSTEM_ID = B.ID_TRASMISSIONE
      AND B.SYSTEM_ID = C.ID_TRASM_SINGOLA
      AND C.CHA_VALIDA = '1'
      AND A.DTA_INVIO IS NOT NULL
      AND B.ID_CORR_GLOBALE = @param2@
      AND (A.CHA_TIPO_OGGETTO = 'D' OR A.CHA_TIPO_OGGETTO = 'F')
      AND B.ID_RAGIONE = D.SYSTEM_ID
      AND ((D.CHA_TIPO_RAGIONE = 'W' AND C.CHA_ACCETTATA='0' AND C.CHA_RIFIUTATA = '0' AND C.CHA_VALIDA = '1') OR ((D.CHA_TIPO_RAGIONE = 'N' OR D.CHA_TIPO_RAGIONE = 'I') AND C.CHA_VISTA = '0'))
      )
    </value>
  </query>
  <query>
    <name>U_DPA_TRASM_UTENTE_SOSTIT</name>
    <value>
      UPDATE DPA_TRASM_UTENTE
      SET ID_PEOPLE = @param1@
      WHERE SYSTEM_ID IN
      (
      SELECT C.SYSTEM_ID
      FROM DPA_TRASMISSIONE A, DPA_TRASM_SINGOLA B, DPA_TRASM_UTENTE C, DPA_RAGIONE_TRASM D
      WHERE A.SYSTEM_ID = B.ID_TRASMISSIONE
      AND B.SYSTEM_ID = C.ID_TRASM_SINGOLA
      AND C.CHA_VALIDA = '1'
      AND A.DTA_INVIO IS NOT NULL
      AND B.ID_CORR_GLOBALE = @param2@
      AND (A.CHA_TIPO_OGGETTO = 'D' OR A.CHA_TIPO_OGGETTO = 'F')
      AND B.ID_RAGIONE = D.SYSTEM_ID
      AND ((D.CHA_TIPO_RAGIONE = 'W' AND C.CHA_ACCETTATA='0' AND C.CHA_RIFIUTATA = '0' AND C.CHA_VALIDA = '1') OR ((D.CHA_TIPO_RAGIONE = 'N' OR D.CHA_TIPO_RAGIONE = 'I') AND C.CHA_VISTA = '0'))
      )
    </value>
  </query>
  <query>
    <name>S_AMM_GET_LIST_TIPI_RUOLO</name>
    <value>
      SELECT
      system_id AS IDTIPORUOLO,
      var_codice AS CODICE,
      var_desc_ruolo AS DESCRIZIONE,
      num_livello AS LIVELLO
      FROM
      DPA_TIPO_RUOLO
      WHERE
      id_amm = @param1@
      ORDER BY
      var_desc_ruolo
    </value>
  </query>
  <query>
    <name>S_AMM_GET_LIST_UTENTI_RICERCA</name>
    <value>
      SELECT DISTINCT
      a.system_id AS IDCORRGLOBALE,
      a.id_people AS IDPEOPLE,
      a.var_codice AS CODICE,
      a.var_cod_rubrica AS CODICERUBRICA,
      a.var_nome AS NOME,
      a.var_cognome AS COGNOME,
      a.id_amm AS IDAMMINISTRAZIONE,
      c.ldap_never_sync,
      c.ldap_id_sync,
      c.ldap_authenticated,
      c.ID_CLIENT_MODEL_PROCESSOR,
      c.is_enabled_smart_client,
      c.CHA_TIPO_COMPONENTI,
      c.smart_client_pdf_conv_on_scan,
      c.matricola as MATRICOLA,
      c.email_address AS EMAIL
      FROM
      DPA_CORR_GLOBALI a, PEOPLE c
      WHERE
      a.cha_tipo_urp = 'P'
      AND a.cha_tipo_ie = 'I'
      AND a.id_people = c.system_id
      AND c.disabled = 'N'
      AND a.dta_fine is NULL
      AND c.cha_system_user != '1'
      @param10@ AND a.@param1@ LIKE '@param2@%'
      AND a.id_amm = @param3@
      @param4@
    </value>
  </query>
  <query>
    <name>S_AMM_GET_LIST_UTENTI_IN_AMM</name>
    <value>
      SELECT
      a.system_id AS IDCORRGLOBALE,
      c.system_id AS IDPEOPLE,
      c.user_id AS USERID,
      a.var_nome AS NOME,
      a.var_cognome AS COGNOME,
      a.var_codice AS CODICE,
      a.var_cod_rubrica AS CODICERUBRICA,
      c.cha_amministratore AS AMMINISTRATORE,
      a.var_email AS EMAIL,
      c.from_email_address AS FROM_EMAIL,
      c.disabled AS ABILITATO,
      (SELECT b.network_id FROM NETWORK_ALIASES b WHERE b.personorgroup = c.system_id) AS DOMINIO,
      c.var_sede AS SEDE,
      c.cha_notifica AS NOTIFICA,
      c.cha_notifica_con_allegato AS ALLEGATO_NOTIFICA,
      a.id_amm AS IDAMMINISTRAZIONE,
      c.password_never_expire as NESSUNA_SCADENZA_PASSWORD,
      c.ldap_never_sync,
      c.ldap_id_sync,
      c.ldap_authenticated,
      c.ID_CLIENT_MODEL_PROCESSOR,
      c.is_enabled_smart_client,
      c.CHA_TIPO_COMPONENTI,
      c.smart_client_pdf_conv_on_scan,
      c.ID_DISPOSITIVO_STAMPA,
      c.ABILITATO_CENTRO_SERVIZI,
      c.matricola,
      c.ABILITATO_CHIAVI_CONFIG,
      c.ABILITATO_ESIBIZIONE
      FROM
      DPA_CORR_GLOBALI a, PEOPLE c
      WHERE
      a.cha_tipo_urp = 'P'
      AND a.cha_tipo_ie = 'I'
      AND a.id_people = c.system_id
      AND a.id_amm = c.id_amm
      AND a.id_amm = @param1@
      @param2@
      AND c.cha_system_user != '1'
      order by a.var_cognome asc, a.var_nome asc
    </value>
  </query>
  <query>
    <name>S_AMM_GET_UTENTI_X_USERID</name>
    <value>
      SELECT
      COUNT(SYSTEM_ID) AS TOT
      FROM PEOPLE
      WHERE
      USER_ID = '@param1@'
      @param2@
      AND ID_AMM = @param3@
    </value>
  </query>
  <query>
    <name>S_AMM_GET_UTENTI_X_COD_RUBRICA</name>
    <value>
      SELECT
      COUNT(SYSTEM_ID) AS TOT
      FROM DPA_CORR_GLOBALI
      WHERE
      VAR_COD_RUBRICA = '@param1@'
      @param2@
      AND ID_AMM = @param3@
    </value>
  </query>

  <query>
    <name>GET_USER_BY_NAME_AMM</name>
    <value>
      SELECT system_id FROM PEOPLE WHERE user_id = '@param1@' AND id_amm = @param2@
    </value>
  </query>


  <query>
    <name>S_DTA_FINE_PEOPLEGROUPS</name>
    <value>
      SELECT
      DTA_FINE
      FROM
      PEOPLEGROUPS
      WHERE
      people_system_id = @param1@
      AND groups_system_id = @param2@
    </value>
  </query>
  <query>
    <name>U_DTA_FINE_PEOPLEGROUPS</name>
    <value>
      UPDATE
      PEOPLEGROUPS
      SET
      DTA_FINE = @param1@
      WHERE
      people_system_id = @param2@
      @param3@
    </value>
  </query>
  <query>
    <name>S_AMM_GET_REGISTRO_RUOLO</name>
    <value>
      SELECT
      COUNT(SYSTEM_ID)
      FROM
      DPA_L_RUOLO_REG
      WHERE
      ID_REGISTRO = @param1@
      AND ID_RUOLO_IN_UO = @param2@
    </value>
  </query>
  <query>
    <name>I_RUOLO_REGISTRO</name>
    <value>
      INSERT INTO DPA_L_RUOLO_REG
      (@param1@ ID_REGISTRO, ID_RUOLO_IN_UO, DTA_INIZIO)
      VALUES
      (@param2@ @param3@, @param4@, @param5@)
    </value>
  </query>
  <query>
    <name>D_RUOLO_REGISTRO</name>
    <value>
      DELETE FROM DPA_L_RUOLO_REG
      WHERE ID_RUOLO_IN_UO = @param1@
      AND ID_REGISTRO @param2@
    </value>
  </query>
  <query>
    <name>S_LIVELLO_RUOLO</name>
    <value>
      SELECT
      a.NUM_LIVELLO
      FROM
      DPA_TIPO_RUOLO a, DPA_CORR_GLOBALI b
      WHERE
      b.SYSTEM_ID = @param1@
      AND a.SYSTEM_ID = b.ID_TIPO_RUOLO
    </value>
  </query>
  <query>
    <name>U_DTA_ASS_VISIB_RUOLO_REGISTRO</name>
    <value>
      UPDATE
      DPA_L_RUOLO_REG
      SET
      dta_ass_visibilita = @param1@
      WHERE
      id_ruolo_in_uo = @param2@
      AND
      id_registro = @param3@
    </value>
  </query>
  <!-- FINE QUERY UTILIZZATE PER L'AMMINISTRAZIONE -->

  <query>
    <name>S_RICERCA_ELEMENTI_RUBRICA</name>
    <value>
      SELECT a.var_cod_rubrica, a.var_desc_corr,
      (case when a.CHA_TIPO_IE='I' then 1 else 0 end) AS interno,
      a.cha_tipo_urp, a.system_id, docsadm.getcodreg(a.ID_REGISTRO) cod_reg_rf, a.ID_REGISTRO, a.CHA_DISABLED_TRASM, a.DTA_FINE, a.VAR_NOME, a.VAR_COGNOME, dett.VAR_COD_FISCALE as COD_FISC, dett.var_cod_pi as VAR_COD_PI, a.ID_PEOPLE
      FROM dpa_corr_globali a WITH(NOLOCK) LEFT JOIN DPA_DETT_GLOBALI DETT WITH(NOLOCK) ON DETT.ID_CORR_GLOBALI=a.SYSTEM_ID @param2@  WHERE
      @param1@
    </value>
  </query>
  <query>
    <name>S_RICERCA_CORR_GLOBAL_BY_EMAIL</name>
    <value>
      SELECT
      SYSTEM_ID,ID_AMM,
      VAR_COD_RUBRICA, VAR_DESC_CORR,VAR_CODICE,
      VAR_INSERT_BY_INTEROP,
      ID_REGISTRO
      FROM DPA_CORR_GLOBALI
      Where VAR_EMAIL = '@param1@'
      AND (ID_REGISTRO IS NULL OR ID_REGISTRO IN ('@param2@'))
      AND DTA_FINE IS NULL AND (VAR_COD_RUBRICA not like '%@%' AND VAR_COD_RUBRICA not like 'INTEROP%')
    </value>
  </query>
  <query>
    <name>S_RICERCA_CORR_GLOBAL_BY_EMAIL_AND_DESCR</name>
    <value>
      SELECT
      C.SYSTEM_ID,
      C.ID_AMM,
      C.VAR_COD_RUBRICA,
      C.VAR_DESC_CORR,
      C.VAR_CODICE,
      C.VAR_INSERT_BY_INTEROP,
      R.VAR_CODICE AS VAR_COD_REGISTRO
      FROM DPA_CORR_GLOBALI C, DPA_EL_REGISTRI R
      Where VAR_EMAIL = '@param1@'
      AND VAR_DESC_CORR_OLD like '%@param2@%'
      AND (ID_REGISTRO IS NULL OR ID_REGISTRO IN ('@param3@'))
      AND DTA_FINE IS NULL AND (VAR_COD_RUBRICA not like 'INTEROP%')
      AND C.ID_REGISTRO=R.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>U_DOC_ARRIVO_MITTENTE_INTEROP</name>
    <value>
      update
      dpa_doc_arrivo_par
      set dpa_doc_arrivo_par.id_mitt_dest='@param1@'
      WHERE EXISTS (
      SELECT 'x'
      FROM PROFILE p WITH(NOLOCK)
      WHERE dpa_doc_arrivo_par.id_profile = p.system_id
      AND p.num_proto IS NULL
      AND cha_tipo_proto = 'A'
      AND cha_da_proto = '1'
      AND dpa_doc_arrivo_par.id_mitt_dest = '@param2@')
      AND id_mitt_dest='@param2@'
    </value>
  </query>
  <query>
    <name>S_RICERCA_ELEMENTO_RUBRICA</name>
    <value>
      SELECT system_id, var_cod_rubrica, var_desc_corr,
      (case when cha_tipo_ie='I' then 1 else 0 end) AS interno,
      cha_tipo_urp, dta_fine,
      (select case when count(*) > 0 then 1 else 0 end from
      dpa_corr_globali b WITH(NOLOCK) where (a.cha_tipo_urp='U' and
      (b.id_parent = a.system_id or b.id_uo = a.system_id)) or
      (
      (a.cha_tipo_urp='R')
      )
      ) as has_children,
      a.CHA_DISABLED_TRASM
      FROM dpa_corr_globali a WITH(NOLOCK)
      WHERE
      @param1@
    </value>
  </query>
  <query>
    <name>S_RICERCA_ELEMENTO_RUBRICA_SIMPLE</name>
    <value>
      SELECT system_id, var_cod_rubrica, var_desc_corr,
      (case when cha_tipo_ie='I' then 1 else 0 end) AS interno,
      (select b.var_codice from dpa_el_registri b WITH(NOLOCK) where b.system_id=a.id_registro) as cod_reg,
      cha_tipo_urp
      FROM dpa_corr_globali a WITH(NOLOCK)
      WHERE
      @param1@
    </value>
  </query>
  <query>
    <name>S_RICERCA_ELEMENTI_RUBRICA_MOBILE</name>
    <value>
      SELECT
      system_id,
      var_cod_rubrica,
      var_desc_corr,
      id_people
      FROM dpa_corr_globali a
      WHERE
      cha_tipo_urp='P'
      and cha_tipo_ie='I'
      and id_amm=  @param2@
      and DTA_FINE is null
      and VAR_COD_RUBRICA !=  '@param1@'
      and a.var_desc_corr like '%@param3@%'
      and @docsadm@.iscorrispondenteinterno(SYSTEM_ID, @param4@) > 0
    </value>
  </query>
  <query>
    <name>S_RICERCA_ELEMENTI_RUBRICA_MOBILE_2</name>
    <value>
      -- UTENTI
      SELECT distinct TOP @param4@
      cg_utenti.var_desc_corr AS VAR_DESC_CORR,
      cg_uo.system_id AS ID_UO,
      cg_ruoli.SYSTEM_ID AS ID_RUOLO,
      cg_utenti.CHA_TIPO_URP,
      cg_utenti.ID_PEOPLE
      FROM dpa_corr_globali cg_utenti,
      people p,
      GROUPS g,
      peoplegroups pg,
      dpa_corr_globali cg_ruoli,
      dpa_corr_globali cg_uo
      WHERE
      cg_utenti.var_desc_corr LIKE '%@param2@%'
      AND cg_ruoli.id_gruppo = g.system_id
      and cg_ruoli.DTA_FINE is null
      AND cg_utenti.cha_tipo_urp = 'P'
      AND cg_utenti.DTA_FINE is null
      AND cg_utenti.id_people = p.system_id
      AND g.system_id = pg.groups_system_id
      AND p.system_id = pg.people_system_id
      AND cg_uo.system_id = cg_ruoli.id_uo
      and cg_uo.DTA_FINE is null
      AND cg_utenti.ID_AMM =  @param1@
      AND cg_utenti.CHA_TIPO_IE ='I'
      AND cg_utenti.VAR_COD_RUBRICA !=  '@param5@'
      and @docsadm@.iscorrispondenteinterno(cg_utenti.system_id, @param3@) > 0
      UNION ALL
      -- RUOLI
      SELECT TOP @param4@
      cg_ruoli.VAR_DESC_CORR AS VAR_DESC_CORR,
      cg_uo.system_id AS ID_UO,
      cg_ruoli.SYSTEM_ID as ID_RUOLO,
      cg_ruoli.CHA_TIPO_URP,
      0
      FROM GROUPS g, dpa_corr_globali cg_ruoli, dpa_corr_globali cg_uo
      WHERE cg_ruoli.var_desc_corr LIKE '%@param2@%'
      AND cg_ruoli.id_gruppo = g.system_id
      AND cg_ruoli.cha_tipo_urp = 'R'
      and cg_ruoli.DTA_FINE is null
      AND cg_uo.system_id = cg_ruoli.id_uo
      and cg_uo.DTA_FINE is null
      AND cg_ruoli.ID_AMM =  @param1@
      AND cg_ruoli.CHA_TIPO_IE ='I'
      and @docsadm@.iscorrispondenteinterno(cg_ruoli.SYSTEM_ID, @param3@) > 0
      UNION ALL
      -- Unità organizzative UO
      SELECT TOP @param4@
      cg_uo.VAR_DESC_CORR AS VAR_DESC_CORR,
      cg_uo.SYSTEM_ID as ID_UO,
      0 as ID_RUOLO,
      cg_uo.CHA_TIPO_URP,
      0
      FROM dpa_corr_globali cg_uo
      WHERE cg_uo.var_desc_corr LIKE '%@param2@%'
      AND cg_uo.cha_tipo_urp = 'U'
      AND cg_uo.ID_AMM  =  @param1@
      AND cg_uo.CHA_TIPO_IE ='I'
      and cg_uo.DTA_FINE is null
      and @docsadm@.iscorrispondenteinterno(cg_uo.SYSTEM_ID, @param3@) > 0
    </value>
  </query>
  <query>
    <name>S_CHECK_CHILDREN_EXISTENCE</name>
    <value>
      SELECT a.var_cod_rubrica,(
      select case when count(*) > 0 then 1 else 0 end
      from dpa_corr_globali b WITH(NOLOCK)
      where
      ((b.cha_tipo_urp='U' and b.id_parent = a.system_id)
      or (b.cha_tipo_urp='R' and b.id_uo = a.system_id))
      or (b.cha_tipo_urp='R' and exists (
      select * from peoplegroups WITH(NOLOCK) where groups_system_id = a.id_gruppo and dta_fine is null))
      ) as has_children FROM dpa_corr_globali a WITH(NOLOCK)
      where a.var_cod_rubrica in
      (@param1@)
      @idAmm@
    </value>
  </query>
  <query>
    <name>S_GET_ROOT_ITEMS</name>
    <value>
      SELECT var_cod_rubrica, var_desc_corr,
      (case when CHA_TIPO_IE='I' then 1 else 0 end) AS interno,
      cha_tipo_urp,system_id
      from
      dpa_corr_globali
      where
      id_amm = @id_amm@ and
      @tipo_ie@
      cha_tipo_urp='U' and
      (id_parent is null or id_parent=0) and
      dta_fine is null
    </value>
  </query>
  <!--elisa query per dettaglio utente interno-->
  <query>
    <name>S_Ruoli_Utente_Interno</name>
    <value>
      SELECT
      @param1@
      FROM
      dpa_corr_globali u,
      dpa_corr_globali p,
      dpa_corr_globali r,
      dpa_tipo_ruolo b,
      peoplegroups pg,
      people e
      WHERE
      r.id_tipo_ruolo = b.system_id
      AND p.cha_tipo_urp = 'P'
      AND p.cha_tipo_ie = 'I'
      AND p.cha_tipo_corr = 'S'
      AND r.cha_tipo_urp = 'R'
      AND r.cha_tipo_ie = 'I'
      AND r.cha_tipo_corr = 'S'
      and u.cha_tipo_ie='I'
      AND u.cha_tipo_urp = 'U'
      AND e.system_id = p.id_people
      AND pg.groups_system_id = r.id_gruppo
      AND pg.people_system_id = p.id_people
      and r.id_uo=u.system_id
      and pg.dta_fine is null
      and @param2@
      @param3@
    </value>
  </query>
  <query>
    <name>S_SMISTAMENTO_GET_UO</name>
    <value>
      SELECT		CG.SYSTEM_ID ID,
      CG.VAR_COD_RUBRICA CODICE_UO,
      CG.VAR_DESC_CORR DESCRIZIONE_UO
      FROM		DPA_CORR_GLOBALI CG
      WHERE		CG.SYSTEM_ID IN
      (
      SELECT 	S.ID_UO
      FROM	DPA_UO_SMISTAMENTO S
      WHERE	S.ID_REGISTRO=@IDRegistro@
      AND CG.DTA_FINE is null
      )
    </value>
  </query>
  <query>
    <name>STAMPA_REGISTRI_01</name>
    <value>
      select DISTINCT
      (cast(p.num_proto as nvarchar) + ' '  + coalesce(VAR_PROTO_EME,'')) as NUM_PROTO ,
      p.num_proto as protocollo,
      convert(datetime,dta_proto,103) DATA,
      (cast(day(p.dta_annulla) as varchar)+'/'+cast(month(p.dta_annulla) as varchar)+'/'+cast(year(p.dta_annulla) as varchar)) DATA_ANNULLAMENTO,
      p.cha_tipo_proto CHA_TIPO_PROTO,
      p.var_prof_oggetto OGGETTO,
      @param5@.corrcat(p.system_id, p.cha_tipo_proto) as MITT_DEST,
      @param5@.classcat(p.system_id) as FASCICOLI,
      c.var_impronta as IMPRONTA,
      ca.VAR_IMPRONTA as IMPRONTA_CACHE,
      @param5@.CountAllegati_BY_DocNumber(p.docnumber) as N_ALLEGATI
      FROM 	profile p
      LEFT JOIN components c on c.docnumber=p.docnumber
      LEFT JOIN versions v on c.version_id=v.version_id
      LEFT JOIN DPA_CACHE ca on ca.docnumber=p.docnumber
      WHERE p.id_registro= @param1@
      and p.cha_tipo_proto in ('A','P','I')
      and v.version=(select max(version) from versions where docnumber=p.docnumber and version &lt;&gt; 0)
      and (p.num_proto &gt;= @param2@ and p.num_proto &lt;= @param3@)
      and p.num_anno_proto= @param4@
      <!--diventera @cache@
      and c.docnumber not in
      (select docnumber from dpa_cache where aggiornato= 0)
      -->
      order by protocollo
    </value>
  </query>
  <query>
    <name>STAMPA_RAPPORTI_01</name>
    <value>
      SELECT DISTINCT
      p.num_proto NUM_PROTO,
      convert(datetime,dta_proto,103) DATA,
      (cast(day(p.dta_annulla) as varchar)+'/'+cast(month(p.dta_annulla) as varchar)+'/'+cast(year(p.dta_annulla) as varchar)) DATA_ANNULLAMENTO,
      p.cha_tipo_proto CHA_TIPO_PROTO,
      p.var_prof_oggetto OGGETTO,
      @param5@.DESCUO(p.id_uo_prot) as DESC_UO,
      @param5@.corrcat(p.system_id, p.cha_tipo_proto) as MITT_DEST,
      @param5@.classcat(p.system_id) as FASCICOLI,
      c.var_impronta as IMPRONTA,
      ca.VAR_IMPRONTA as IMPRONTA_CACHE,
      @param5@.CountAllegati_BY_DocNumber(p.docnumber) as N_ALLEGATI
      FROM profile p WITH(NOLOCK)
      LEFT JOIN components c on c.docnumber=p.docnumber
      LEFT JOIN versions v on c.version_id=v.version_id
      LEFT JOIN DPA_CACHE ca on ca.docnumber=p.docnumber
      WHERE p.id_registro= @param1@
      and v.version=(select max(version) from versions where docnumber=p.docnumber and version &lt;&gt; 0)
      and p.cha_tipo_proto in ('A','P','I')
      @param2@
      order by NUM_PROTO
    </value>
  </query>
  <query>
    <name>S_STAMPA_BUSTE</name>
    <value>
      SELECT c.VAR_DESC_CORR,dap.CHA_TIPO_MITT_DEST,ddg.VAR_INDIRIZZO,ddg.VAR_CAP,ddg.VAR_CITTA,ddg.VAR_PROVINCIA,P.ID_REGISTRO, dr.VAR_DESC_REGISTRO
      FROM PROFILE P WITH(NOLOCK),DPA_DOC_ARRIVO_PAR dap,DPA_EL_REGISTRI dr,DPA_CORR_GLOBALI c LEFT OUTER JOIN DPA_DETT_GLOBALI ddg ON ddg.ID_CORR_GLOBALI=c.SYSTEM_ID
      WHERE dap.ID_MITT_DEST=c.SYSTEM_ID
      AND dr.SYSTEM_ID = P.ID_REGISTRO
      AND p.SYSTEM_ID=dap.ID_PROFILE
      AND dap.CHA_TIPO_MITT_DEST IN ('D','C')
      and P.CHA_TIPO_PROTO='P'
      and P.CHA_DA_PROTO='0'
      and P.DTA_ANNULLA is null
      and P.ID_REGISTRO=@param1@
      @param2@
    </value>
  </query>
  <query>
    <name>S_DB_TIME</name>
    <value>
      SELECT SUBSTRING(CONVERT(varchar, GETDATE(), 113), 13, 8)
    </value>
  </query>
  <query>
    <name>S_DB_DATE_TIME</name>
    <value>
      SELECT FORMAT (getDate(), '@format@') as date
    </value>
  </query>
  <query>
    <name>S_RUOLI_BY_UO</name>
    <value>
      select
      u.var_cod_rubrica as COD_UO, r.var_cod_rubrica as COD_RUOLO
      from
      dpa_corr_globali u,
      dpa_corr_globali r
      where
      r.id_uo = u.system_id and
      u.cha_tipo_urp='U' and
      u.id_amm = @id_amm@ and
      r.id_amm = @id_amm@ and
      u.dta_fine is null and
      r.dta_fine is null and
      r.cha_riferimento = '1'
      order by
      u.var_cod_rubrica
    </value>
  </query>
  <query>
    <name>S_RUOLI_BY_UTENTE</name>
    <value>
      select
      u.var_cod_rubrica as COD_UTENTE,
      r.var_cod_rubrica as COD_RUOLO,
      r.var_desc_corr as DESC_RUOLO
      from
      dpa_corr_globali u,
      dpa_corr_globali r,
      people p,
      peoplegroups pg
      where
      r.id_gruppo = pg.groups_system_id and
      u.id_people = p.system_id and
      p.system_id = pg.people_system_id and
      u.cha_tipo_urp='P' and
      u.dta_fine is null and
      r.dta_fine is null and
      pg.dta_fine is null
      order by
      u.var_cod_rubrica COLLATE SQL_Latin1_General_CP850_CS_AS
    </value>
  </query>
  <query>
    <name>S_REGISTRI_BY_RUOLO</name>
    <value>
      select
      r.var_cod_rubrica as COD_RUOLO, rr.id_registro as ID_REGISTRO
      from
      dpa_corr_globali r,
      dpa_l_ruolo_reg rr
      where
      r.id_amm = @id_amm@ and
      r.dta_fine is null and
      rr.id_ruolo_in_uo = r.system_id
      order by
      r.var_cod_rubrica,
      rr.id_registro
    </value>
  </query>
  <query>
    <name>AMM_S_GET_NODI_RUOLO_TITOLARIO</name>
    <value>
      SELECT DISTINCT
      C.id_gruppo AS ID_RUOLO,
      C.var_codice AS CODICE_RUOLO,
      C.var_desc_corr AS DESCRIZIONE_RUOLO,
      S.personorgroup AS GRUPPOASSOCIATO

      FROM 	   	DPA_CORR_GLOBALI C LEFT OUTER JOIN
      (SELECT personorgroup FROM SECURITY  WITH (nolock)  WHERE thing = @idNodoTitolario@ AND accessrights IN(255,47,63)) S
      ON C.id_gruppo = S.personorgroup,
      DPA_L_RUOLO_REG RR

      WHERE 		RR.ID_RUOLO_IN_UO=C.system_id AND
      RR.ID_REGISTRO @idRegistro@ AND
      C.DTA_FINE IS NULL

      ORDER BY	C.var_desc_corr
    </value>
  </query>
  <query>
    <name>AMM_D_VISIBILITA_NODO_RUOLI</name>
    <value>
      DELETE
      FROM SECURITY
      WHERE (THING=@param1@ AND PERSONORGROUP=@param2@)
    </value>
  </query>

  <query>
    <name>AMM_S_GET_INFO_NODO_TITOLARIO_WITH_CHILDS</name>
    <value>
      SELECT 	*
      FROM 	PROJECT P
      WHERE	P.SYSTEM_ID=@idTitolario@ OR
      P.ID_PARENT IN
      (
      SELECT 	P.SYSTEM_ID
      FROM 	PROJECT P
      WHERE	P.SYSTEM_ID=@idTitolario@ OR
      P.ID_PARENT=@idTitolario@
      ) OR
      (P.SYSTEM_ID=@idParentTitolario@ AND P.CHA_TIPO_PROJ='T')
    </value>
  </query>
  <query>
    <name>AMM_S_GET_COUNT_DOCUMENTI</name>
    <value>
      SELECT	COUNT(*)
      FROM 	PROJECT_COMPONENTS PC
      WHERE	PC.PROJECT_ID=@idTitolario@
    </value>
  </query>
  <query>
    <name>AMM_U_NODO_TITOLARIO</name>
    <value>
      UPDATE	PROJECT
      SET 	DESCRIPTION=@Descrizione@,
      CHA_RW=@CreazioneFascicoliAbilitata@,
      ID_REGISTRO=@IDRegistro@,
      NUM_MESI_CONSERVAZIONE=@NumeroMesiConservazione@,
      ID_TIPO_FASC=@idTipoFascicolo@,
      CHA_BLOCCA_FASC = '@bloccaFascicolo@',
      VAR_NOTE = '@note@',
      CHA_BLOCCA_FIGLI = '@bloccaFigli@',
      CHA_CONTA_PROT_TIT = '@contatoreAttivo@',
      CHA_CONSENTI_CLASS = '@bloccaClass@',
      CHA_CONSENTI_FASC = '@consentiFasc@'
      @numProtTit@
      WHERE	SYSTEM_ID=@IDTitolario@
    </value>
  </query>
  <query>
    <name>AMM_U_NODO_TITOLARIO_FASCICOLO_GENERALE</name>
    <value>
      UPDATE	PROJECT
      SET 	DESCRIPTION=@Descrizione@,
      CHA_RW=@CreazioneFascicoliAbilitata@,
      ID_REGISTRO=@IDRegistro@,
      NUM_MESI_CONSERVAZIONE=@NumeroMesiConservazione@,
      ID_TIPO_FASC=@idTipoFascicolo@,
      CHA_BLOCCA_FASC = '@bloccaFascicolo@',
      CHA_BLOCCA_FIGLI = '@bloccaFigli@',
      CHA_CONTA_PROT_TIT = '@contatoreAttivo@',
      CHA_CONSENTI_CLASS = '@bloccaClass@',
      CHA_CONSENTI_FASC = '@consentiFasc@'
      @numProtTit@
      WHERE	ID_PARENT=@IDTitolario@ AND	CHA_TIPO_PROJ='F' AND CHA_TIPO_FASCICOLO='G'
    </value>
  </query>
  <query>
    <name>AMM_S_GET_ID_TITOLARIO_PADRE</name>
    <value>
      SELECT P.ID_PARENT, P.NUM_LIVELLO
      FROM   PROJECT P
      WHERE  P.SYSTEM_ID=@idTitolario@
    </value>
  </query>
  <query>
    <name>AMM_EXIST_RUOLO_IN_TITOLARIO</name>
    <value>
      SELECT  COUNT(S.THING)
      FROM 	SECURITY as S
      WHERE	S.THING=@idTitolario@ AND
      PERSONORGROUP=@idGruppo@
    </value>
  </query>
  <query>
    <name>AMM_EXIST_RUOLO_IN_TITOLARIO_FIGLIO</name>
    <value>
      SELECT  COUNT(S.THING)
      FROM 	SECURITY as S
      WHERE	S.THING IN
      (
      SELECT P.SYSTEM_ID
      FROM   PROJECT P
      WHERE  P.ID_PARENT=@idTitolario@ AND P.CHA_TIPO_PROJ='T'
      ) AND PERSONORGROUP=@idGruppo@
    </value>
  </query>
  <query>
    <name>AMM_G_GET_SYSTEM_ID_FASCICOLI_PROCEDIMENTALI_TITOLARIO</name>
    <value>
      SELECT	P.SYSTEM_ID
      FROM 	PROJECT P
      WHERE	P.ID_PARENT=@idTitolario@ AND
      P.CHA_TIPO_FASCICOLO='P'
    </value>
  </query>
  <query>
    <name>AMM_S_IS_RUOLO_OWNER_FASCICOLI_PROCEDIMENTALI</name>
    <value>
      SELECT COUNT(*)
      FROM   SECURITY as S
      WHERE  S.THING=@idFascicoloProc@ AND
      S.PERSONORGROUP=@idRuolo@ AND
      S.ACCESSRIGHTS=255
    </value>
  </query>
  <query>
    <name>AMM_D_DELETE_TITOLARIO_IN_SECURITY</name>
    <value>
      DELETE
      FROM	SECURITY
      WHERE	THING=@idTitolario@
    </value>
  </query>
  <query>
    <name>AMM_D_DELETE_NODO_TITOLARIO</name>
    <value>
      DELETE
      FROM  	PROJECT
      WHERE	SYSTEM_ID=@idTitolario@
    </value>
  </query>
  <query>
    <name>AMM_S_GET_COUNT_RUOLI_IN_TITOLARIO</name>
    <value>
      SELECT 	COUNT(S.THING)
      FROM 	SECURITY as S  , GROUPS G
      WHERE	S.THING=@idTitolario@ AND
      S.PERSONORGROUP=G.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>AMM_S_CHECK_ALTRI_NODI_SU_ALTRI_REGISTRI</name>
    <value>
      SELECT system_id
      FROM PROJECT
      WHERE cha_tipo_proj = 'T'
      AND var_codice = '@param1@'
      AND id_registro &lt;&gt;
      (SELECT id_registro FROM PROJECT WHERE system_id = @param2@)
      AND id_amm =
      (SELECT id_amm FROM PROJECT WHERE system_id = @param2@)
    </value>
  </query>
  <query>
    <name>AMM_S_CHECK_ALTRI_NODI_SU_TUTTI_REGISTRI</name>
    <value>
      SELECT system_id
      FROM PROJECT
      WHERE cha_tipo_proj = 'T'
      AND var_codice = '@param1@'
      AND id_amm = (select system_id from dpa_amministra where var_codice_amm = '@param2@')
      AND ID_TITOLARIO = @idTitolario@
    </value>
  </query>
  <query>
    <name>AMM_S_GET_RUOLI_IN_TITOLARIO</name>
    <value>
      SELECT 	S.THING,
      S.PERSONORGROUP,
      S.ACCESSRIGHTS,
      S.CHA_TIPO_DIRITTO
      FROM 	SECURITY  as S  WITH (nolock) , GROUPS G
      WHERE	S.THING=@idTitolario@ AND
      S.PERSONORGROUP=G.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>AMM_I_NODO_TITOLARIO</name>
    <value>
      INSERT INTO PROJECT
      (
      @param1@
      DESCRIPTION,
      ICONIZED,
      CHA_TIPO_PROJ,
      VAR_CODICE,
      ID_AMM,
      ID_REGISTRO,
      NUM_LIVELLO,
      CHA_TIPO_FASCICOLO,
      ID_PARENT,
      VAR_COD_LIV1,
      ETDOC_RANDOM_ID,
      DTA_APERTURA,
      CHA_STATO,
      ID_FASCICOLO,
      CHA_RW,
      NUM_MESI_CONSERVAZIONE,
      VAR_CHIAVE_FASC
      )
      VALUES
      (
      @param2@
      @param3@,
      @param4@,
      @param5@,
      @param6@,
      @param7@,
      @param8@,
      @param9@,
      @param10@,
      @param11@,
      @param12@,
      @param13@,
      @param14@,
      @param15@,
      @param16@,
      @param17@,
      @param18@,
      @param19@
      )
    </value>
  </query>
  <query>
    <name>AMM_S_GET_ID_REGISTRO_TITOLARIO</name>
    <value>
      SELECT	P.ID_REGISTRO
      FROM	PROJECT P
      WHERE	P.SYSTEM_ID=@idTitolario@
    </value>
  </query>
  <query>
    <name>AMM_S_NODO_TITOLARIO</name>
    <value>
      SELECT DISTINCT
      a.system_id as IDRECORD,
      a.var_codice as CODICE,
      a.description as DESCRIZIONE,
      a.num_livello as LIVELLO,
      a.id_registro as REGISTRO,
      a.id_parent as IDPARENT,
      a.var_cod_liv1 as CODLIV,
      cha_rw as RW,(SELECT count(b.system_id)
      FROM PROJECT b
      WHERE b.cha_tipo_proj = 'T'
      AND b.id_amm = @idAmministrazione@
      AND b.id_parent = a.system_id
      ) as FIGLIO,
      a.NUM_MESI_CONSERVAZIONE as NUMMESICONSERVAZIONE,
      a.ID_TIPO_FASC,
      a.CHA_BLOCCA_FASC,
      a.ID_TITOLARIO,
      a.CHA_STATO,
      a.DTA_ATTIVAZIONE,
      a.DTA_CESSAZIONE,
      a.VAR_NOTE,
      a.CHA_BLOCCA_FIGLI,
      a.CHA_CONTA_PROT_TIT,
      a.NUM_PROT_TIT,
      a.CHA_CONSENTI_CLASS,
      a.CHA_CONSENTI_FASC
      FROM  PROJECT a
      WHERE a.cha_tipo_proj = 'T'
      AND a.id_amm = @idAmministrazione@
      AND a.id_parent = @idParentTitolario@
      @param1@
      ORDER BY a.var_cod_liv1
    </value>
  </query>
  <query>
    <name>AMM_S_EXIST_CODICE_TITOLARIO</name>
    <value>
      SELECT	SYSTEM_ID
      FROM	PROJECT
      WHERE	VAR_CODICE = '@codiceTitolario@'
      AND ID_AMM = @idAmministrazione@
      AND CHA_TIPO_PROJ='T'
      AND (ID_REGISTRO IS NULL OR ID_REGISTRO = @idRegistro@)
      AND ID_TITOLARIO = @idTitolario@
    </value>
  </query>
  <!--Emilio 20 Settembre-->
  <query>
    <name>AMM_S_IS_RUOLO_OWNER_DOCUMENTI</name>
    <value>
      SELECT COUNT(S.THING)
      FROM   SECURITY as S   ,
      PROJECT_COMPONENTS PC
      WHERE  S.THING=PC.LINK AND
      S.PERSONORGROUP IN
      (
      SELECT PEOPLE_SYSTEM_ID
      FROM   PEOPLEGROUPS
      WHERE  GROUPS_SYSTEM_ID=@idRuolo@
      ) AND
      PC.PROJECT_ID=
      (
      SELECT SYSTEM_ID
      FROM PROJECT
      WHERE ID_PARENT=
      (SELECT SYSTEM_ID
      FROM PROJECT
      WHERE ID_PARENT=@idTitolario@ AND
      CHA_TIPO_PROJ='F' AND
      CHA_TIPO_FASCICOLO='G') AND
      CHA_TIPO_PROJ='C'
      ) AND
      PC.TYPE='D'
      AND S.THING IN
      (SELECT DISTINCT PR.SYSTEM_ID FROM PROFILE PR WITH(NOLOCK),
      SECURITY as SE  WITH (nolock)  WHERE SE.PERSONORGROUP = PR.ID_PEOPLE_PROT
      AND PR.ID_RUOLO_CREATORE = (SELECT SYSTEM_ID FROM DPA_CORR_GLOBALI WHERE VAR_COD_RUBRICA = '@idRuoloCreatore@'))
    </value>
  </query>
  <query>
    <name>AMM_S_GET_ID_FASCICOLO_FOLDER_FROM_TITOLARIO</name>
    <value>
      SELECT 	P.SYSTEM_ID,
      P.CHA_TIPO_PROJ
      FROM	PROJECT P
      WHERE  (P.ID_PARENT=
      (
      SELECT P.SYSTEM_ID
      FROM 	PROJECT P
      WHERE	P.ID_PARENT=@idTitolario@ AND
      P.CHA_TIPO_PROJ='F' AND
      P.CHA_TIPO_FASCICOLO='G'
      ) AND P.CHA_TIPO_PROJ='C'
      )
      OR
      P.SYSTEM_ID =
      (
      SELECT 	P.SYSTEM_ID
      FROM 	PROJECT P
      WHERE	P.ID_PARENT=@idTitolario@ AND
      P.CHA_TIPO_PROJ='F' AND
      P.CHA_TIPO_FASCICOLO='G'
      )
    </value>
  </query>
  <query>
    <name>AMM_S_GET_COUNT_SOTTOFASCICOLI_GENERALE</name>
    <value>
      SELECT 	COUNT(P.SYSTEM_ID)
      FROM 	PROJECT P
      WHERE	P.ID_PARENT=
      (
      SELECT  P.SYSTEM_ID
      FROM 	PROJECT P
      WHERE	P.ID_PARENT=
      (
      SELECT  P.SYSTEM_ID
      FROM 	PROJECT P
      WHERE	P.ID_PARENT=@idTitolario@	AND
      P.CHA_TIPO_PROJ='F' AND
      P.CHA_TIPO_FASCICOLO='G'
      )	AND P.CHA_TIPO_PROJ='C'
      )
    </value>
  </query>
  <query>
    <name>AMM_S_IS_RUOLO_OWNER_SOTTOFASCICOLI_GENERALE</name>
    <value>
      SELECT COUNT(S.THING)
      FROM   SECURITY as S
      WHERE  S.THING IN
      (
      SELECT 	P.SYSTEM_ID
      FROM 	PROJECT P
      WHERE 	P.CHA_TIPO_PROJ='C' AND
      P.ID_FASCICOLO=
      (
      SELECT  P.SYSTEM_ID
      FROM 	PROJECT P
      WHERE	P.ID_PARENT=@idTitolario@ AND
      P.CHA_TIPO_PROJ='F' AND
      P.CHA_TIPO_FASCICOLO='G'
      ) AND
      P.DESCRIPTION!='Root Folder'
      ) AND
      S.PERSONORGROUP=@idRuolo@ AND
      S.ACCESSRIGHTS=255 AND
      S.CHA_TIPO_DIRITTO='P'
    </value>
  </query>
  <query>
    <name>S_GET_DPA_UO_REG</name>
    <value>
      select id_uo from dpa_uo_reg where
      id_registro=@id_reg@ and
      id_uo = (select system_id from dpa_corr_globali where
      var_cod_rubrica = '@cod_uo@' and
      cha_tipo_urp='U' and id_amm=@id_amm@)
    </value>
  </query>
  <query>
    <name>S_GET_UO_IN_AOO</name>
    <value>
      select dpa_corr_globali.var_cod_rubrica as CODICE,
      dpa_corr_globali.system_id as IDCORRGLOBALE,
      dpa_corr_globali.var_desc_corr as DESCRIZIONE
      from dpa_corr_globali, dpa_uo_reg
      where
      dpa_uo_reg.id_registro = @id_reg@ and
      dpa_uo_reg.id_uo = dpa_corr_globali.system_id
      order by var_cod_rubrica, var_desc_corr asc
    </value>
  </query>
  <query>
    <name>S_DPA_L_RUOLO_REG</name>
    <value>
      SELECT SYSTEM_ID FROM DPA_L_RUOLO_REG
      WHERE ID_REGISTRO =@id_reg@  and ID_RUOLO_IN_UO =@id_ruolo@
    </value>
  </query>
  <query>
    <name>S_GET_SYSTEMID_TRASMISSIONI_DOCUMENTO</name>
    <value>
      select	count(t.system_id)
      from	dpa_trasmissione t,
      profile p
      where	p.system_id=t.id_profile and
      t.id_profile=@idProfile@
      and t.dta_invio is not null
    </value>
  </query>
  <query>
    <name>S_DOCUMENTO_CHECK_USER_VISIBILITY</name>
    <value>
      SELECT 	COUNT(A.SYSTEM_ID)
      FROM 	PROFILE A,
      SECURITY as B
      WHERE 	A.SYSTEM_ID=B.THING AND
      B.ACCESSRIGHTS >= 0 AND
      (B.PERSONORGROUP=@idPeople@ OR B.PERSONORGROUP=@idGroup@)
      AND A.DOCNUMBER=@docNumber@
    </value>
  </query>
  <query>
    <name>AMM_S_GET_REGISTRI_AMMINISTRAZIONE</name>
    <value>
      SELECT 		R.SYSTEM_ID AS ID_REGISTRO,
      R.VAR_CODICE AS CODICE,
      R.VAR_DESC_REGISTRO AS DESCRIZIONE,
      R.ID_AMM AS ID_AMMINISTRAZIONE,
      A.VAR_CODICE_AMM AS CODICE_AMMINISTRAZIONE,
      R.VAR_EMAIL_REGISTRO AS EMAIL,
      R.VAR_USER_MAIL AS USER_EMAIL,
      R.VAR_PWD_MAIL AS PWD_EMAIL,
      R.VAR_SERVER_SMTP AS SERVER_SMTP,
      R.NUM_PORTA_SMTP AS PORTA_SMTP,
      R.VAR_SERVER_POP AS SERVER_POP,
      R.NUM_PORTA_POP AS PORTA_POP,
      R.CHA_AUTOMATICO AS APERTURA_AUTOMATICA,
      R.VAR_USER_SMTP AS USER_SMTP,
      R.VAR_PWD_SMTP AS PWD_SMTP,
      R.ID_PEOPLE_AOO,
      R.ID_RUOLO_AOO, R.CHA_SMTP_SSL,R.CHA_POP_SSL, R.CHA_SMTP_STA, R.CHA_AUTO_INTEROP,
      R.CHA_RF,R.ID_AOO_COLLEGATA, R.CHA_DISABILITATO,
      R.DIRITTO_RUOLO_AOO,
      R.CHA_STATO AS STATO,
      R.ID_RUOLO_RESP,
      R.VAR_SERVER_IMAP,
      R.NUM_PORTA_IMAP,
      R.VAR_TIPO_CONNESSIONE,
      R.VAR_INBOX_IMAP,
      R.VAR_BOX_MAIL_ELABORATE,
      R.VAR_MAIL_NON_ELABORATE,
      R.CHA_IMAP_SSL,
      R.VAR_SOLO_MAIL_PEC,
      R.CHA_RICEVUTA_PEC,
      R.INVIO_RICEVUTA_MANUALE,
      R.VAR_PREG,
      R.ANNO_PREG,
      R.VAR_MAIL_RIC_PENDENTE
      FROM   		DPA_EL_REGISTRI R,
      DPA_AMMINISTRA A
      WHERE		R.ID_AMM=A.SYSTEM_ID AND
      R.ID_AMM=@idAmministrazione@ @chaRF@
      ORDER BY	R.VAR_CODICE ASC
    </value>
  </query>
  <query>
    <name>AMM_S_GET_REGISTRO</name>
    <value>
      SELECT 		R.SYSTEM_ID AS ID_REGISTRO,
      R.VAR_CODICE AS CODICE,
      R.VAR_DESC_REGISTRO AS DESCRIZIONE,
      R.ID_AMM AS ID_AMMINISTRAZIONE,
      A.VAR_CODICE_AMM AS CODICE_AMMINISTRAZIONE,
      R.VAR_EMAIL_REGISTRO AS EMAIL,
      R.VAR_USER_MAIL AS USER_EMAIL,
      R.VAR_PWD_MAIL AS PWD_EMAIL,
      R.VAR_SERVER_SMTP AS SERVER_SMTP,
      R.NUM_PORTA_SMTP AS PORTA_SMTP,
      R.VAR_SERVER_POP AS SERVER_POP,
      R.NUM_PORTA_POP AS PORTA_POP,
      R.CHA_AUTOMATICO AS APERTURA_AUTOMATICA,
      R.VAR_USER_SMTP AS USER_SMTP,
      R.VAR_PWD_SMTP AS PWD_SMTP,
      R.ID_PEOPLE_AOO,
      R.ID_RUOLO_AOO,R.CHA_SMTP_SSL,R.CHA_POP_SSL,R.cha_smtp_sta,r.cha_auto_interop,
      R.CHA_RF, R.ID_AOO_COLLEGATA, R.CHA_DISABILITATO,
      R.DIRITTO_RUOLO_AOO,
      R.CHA_STATO AS STATO,
      R.ID_RUOLO_RESP,
      R.VAR_SERVER_IMAP,
      R.NUM_PORTA_IMAP,
      R.VAR_TIPO_CONNESSIONE,
      R.VAR_INBOX_IMAP,
      R.VAR_BOX_MAIL_ELABORATE,
      R.VAR_MAIL_NON_ELABORATE,
      R.CHA_IMAP_SSL,
      R.VAR_SOLO_MAIL_PEC,
      R.CHA_RICEVUTA_PEC,
      R.INVIO_RICEVUTA_MANUALE,
      R.VAR_PREG,
      R.ANNO_PREG,
      R.VAR_MAIL_RIC_PENDENTE,
      R.ID_UTENTE_RESP
      FROM
      DPA_EL_REGISTRI R,
      DPA_AMMINISTRA A
      WHERE
      R.ID_AMM=A.SYSTEM_ID AND
      R.SYSTEM_ID=@idRegistro@
      ORDER BY	R.VAR_CODICE ASC
    </value>
  </query>
  <query>
    <name>AMM_I_INSERT_REGISTRO</name>
    <value>
      INSERT INTO DPA_EL_REGISTRI
      (
      @colID@
      VAR_CODICE,
      VAR_DESC_REGISTRO,
      ID_AMM,
      VAR_EMAIL_REGISTRO,
      VAR_USER_MAIL,
      VAR_PWD_MAIL,
      DTA_OPEN,
      DTA_CLOSE,
      NUM_RIF,
      CHA_STATO,
      VAR_SERVER_SMTP,
      NUM_PORTA_SMTP,
      DTA_ULTIMO_PROTO,
      VAR_SERVER_POP,
      NUM_PORTA_POP,
      CHA_AUTOMATICO,
      VAR_USER_SMTP,
      VAR_PWD_SMTP,
      CHA_AUTO_INTEROP,
      CHA_RF,
      ID_AOO_COLLEGATA,
      CHA_DISABILITATO,
      ID_RUOLO_RESP,
      VAR_SERVER_IMAP,
      NUM_PORTA_IMAP,
      VAR_TIPO_CONNESSIONE,
      VAR_INBOX_IMAP,
      VAR_BOX_MAIL_ELABORATE,
      VAR_MAIL_NON_ELABORATE,
      CHA_IMAP_SSL,
      VAR_SOLO_MAIL_PEC,
      INVIO_RICEVUTA_MANUALE,
      CHA_SMTP_STA,
      CHA_POP_SSL,
      CHA_RICEVUTA_PEC,
      VAR_PREG,
      ANNO_PREG,
      ID_UTENTE_RESP
      )
      VALUES
      (
      @ID@
      @codice@,
      @descrizione@,
      @idAmministrazione@,
      @email@,
      @emailUserID@,
      @emailPassword@,
      @dataApertura@,
      @dataChiusura@,
      @numRif@,
      @stato@,
      @serverSMTP@,
      @portaSMTP@,
      @dataUltimoProtocollo@,
      @serverPOP@,
      @portaPOP@,
      @aperturaAutomatica@,
      @userSMTP@,
      @passwordSMTP@,
      @autoInterop@,
      @chaRF@,
      @idAooCollegata@,
      @chaDisabilitato@,
      @idRuoloResp@,
      @VAR_SERVER_IMAP@,
      @NUM_PORTA_IMAP@,
      @VAR_TIPO_CONNESSIONE@,
      @VAR_INBOX_IMAP@,
      @VAR_BOX_MAIL_ELABORATE@,
      @VAR_MAIL_NON_ELABORATE@,
      @CHA_IMAP_SSL@,
      @VAR_SOLO_MAIL_PEC@,
      @invioRicevutaManuale@,
      @SMTPsslSTA@,
      @cha_pop_ssl@,
      @CHA_RICEVUTA_PEC@,
      @VAR_PREG@,
      @ANNO_PREG@,
      @idUtenteResp@
      )
    </value>
  </query>
  <query>
    <name>AMM_I_INSERT_LINK_REGISTRO_PROTOCOLLO</name>
    <value>
      INSERT INTO DPA_REG_PROTO
      (
      @colID@
      NUM_RIF,
      ID_REGISTRO
      )
      VALUES
      (
      @id@
      1,
      @idRegistro@
      )
    </value>
  </query>
  <query>
    <name>AMM_S_CHECK_UNIQUE_CODICE_REGISTRO</name>
    <value>
      SELECT	COUNT(R.SYSTEM_ID)
      FROM	DPA_EL_REGISTRI R
      WHERE	R.VAR_CODICE = @codiceRegistro@ AND
      R.ID_AMM=@idAmministrazione@
    </value>
  </query>
  <query>
    <name>AMM_U_UPDATE_REGISTRO</name>
    <value>
      UPDATE  DPA_EL_REGISTRI
      SET    	VAR_DESC_REGISTRO=@descrizione@,
      VAR_EMAIL_REGISTRO=@emailRegistro@,
      VAR_USER_MAIL=@emailUserID@,
      VAR_PWD_MAIL=@emailPassword@,
      VAR_SERVER_SMTP=@serverSMTP@,
      NUM_PORTA_SMTP=@portaSMTP@,
      VAR_SERVER_POP=@serverPOP@,
      NUM_PORTA_POP=@portaPOP@,
      CHA_AUTOMATICO=@aperturaAutomatica@,
      VAR_USER_SMTP=@userSMTP@,
      VAR_PWD_SMTP=@passwordSMTP@,
      ID_RUOLO_AOO=@id_ruolo_aoo@,
      ID_PEOPLE_AOO=@id_people_aoo@,
      CHA_SMTP_SSL=@cha_smtp_ssl@,
      CHA_SMTP_STA=@cha_smtp_sta@,
      CHA_POP_SSL=@cha_pop_ssl@,
      CHA_AUTO_INTEROP = @autoInterop@,
      CHA_RF = @chaRF@,
      ID_AOO_COLLEGATA = @idAooCollegata@,
      ID_RUOLO_RESP = @idRuoloResp@,
      VAR_SERVER_IMAP = @VAR_SERVER_IMAP@,
      NUM_PORTA_IMAP = @NUM_PORTA_IMAP@,
      VAR_TIPO_CONNESSIONE = @VAR_TIPO_CONNESSIONE@,
      VAR_INBOX_IMAP = @VAR_INBOX_IMAP@,
      VAR_BOX_MAIL_ELABORATE = @VAR_BOX_MAIL_ELABORATE@,
      VAR_MAIL_NON_ELABORATE = @VAR_MAIL_NON_ELABORATE@,
      CHA_IMAP_SSL = @CHA_IMAP_SSL@,
      INVIO_RICEVUTA_MANUALE = @invioRicevutaManuale@,
      VAR_SOLO_MAIL_PEC = @VAR_SOLO_MAIL_PEC@,
      CHA_RICEVUTA_PEC = @CHA_RICEVUTA_PEC@,
      VAR_PREG = @VAR_PREG@,
      ANNO_PREG = @ANNO_PREG@,
      VAR_MAIL_RIC_PENDENTE = @VAR_MAIL_RIC_PENDENTE@,
      ID_UTENTE_RESP = @idUtenteResp@
      @chaDisabilitato@
      @chaStato@
      @dirittoRuoloAOO@
      WHERE	SYSTEM_ID=@systemID@
    </value>
  </query>
  <query>
    <name>AMM_D_DELETE_REGISTRO</name>
    <value>
      DELETE
      FROM	DPA_EL_REGISTRI
      WHERE	SYSTEM_ID=@systemID@
    </value>
  </query>
  <query>
    <name>AMM_S_GET_COUNT_PROTOCOLLI_REGISTRO</name>
    <value>
      SELECT	COUNT(SYSTEM_ID)
      FROM	PROFILE
      WHERE	ID_REGISTRO=@idRegistro@
    </value>
  </query>
  <query>
    <name>AMM_S_GET_COUNT_RUOLI_REGISTRO</name>
    <value>
      SELECT COUNT(SYSTEM_ID)
      FROM   DPA_L_RUOLO_REG
      WHERE  ID_REGISTRO=@idRegistro@
    </value>
  </query>
  <query>
    <name>AMM_S_GET_COUNT_FASCICOLI_REGISTRO</name>
    <value>
      SELECT	COUNT(SYSTEM_ID)
      FROM	PROJECT
      WHERE	ID_REGISTRO=@idRegistro@
    </value>
  </query>
  <query>
    <name>AMM_S_GET_CODICE_REGISTRO</name>
    <value>
      SELECT	R.VAR_CODICE AS CODICE
      FROM	DPA_EL_REGISTRI R
      WHERE	R.SYSTEM_ID=@idRegistro@
    </value>
  </query>
  <query>
    <name>AMM_D_DELETE_REGISTRO_REG_PROTO</name>
    <value>
      DELETE
      FROM	DPA_REG_PROTO
      WHERE	ID_REGISTRO=@idRegistro@
    </value>
  </query>
  <query>
    <name>AMM_D_DELETE_REGISTRO_RUOLO_REG</name>
    <value>
      DELETE
      FROM	DPA_L_RUOLO_REG
      WHERE	ID_REGISTRO=@idRegistro@
    </value>
  </query>
  <query>
    <name>AMM_S_GET_TIPO_RUOLO</name>
    <value>
      SELECT	TR.SYSTEM_ID AS ID_TIPO_RUOLO,
      TR.ID_AMM AS ID_AMMINISTRAZIONE,
      TR.VAR_CODICE AS CODICE,
      TR.VAR_DESC_RUOLO AS DESCRIZIONE,
      TR.NUM_LIVELLO AS LIVELLO
      FROM	DPA_TIPO_RUOLO TR
      WHERE	TR.SYSTEM_ID=@systemID@
    </value>
  </query>
  <query>
    <name>AMM_I_INSERT_TIPO_RUOLO</name>
    <value>
      INSERT INTO DPA_TIPO_RUOLO
      (
      @colSystemID@
      ID_AMM,
      VAR_CODICE,
      NUM_LIVELLO,
      VAR_DESC_RUOLO
      )
      VALUES
      (
      @systemID@
      @idAmministrazione@,
      @codice@,
      @livello@,
      @descrizione@
      )
    </value>
  </query>
  <query>
    <name>AMM_U_UPDATE_TIPO_RUOLO</name>
    <value>
      UPDATE	DPA_TIPO_RUOLO
      SET		VAR_DESC_RUOLO=@descrizione@,
      NUM_LIVELLO=@livello@
      WHERE	SYSTEM_ID=@systemID@
    </value>
  </query>
  <query>
    <name>AMM_D_DELETE_TIPO_RUOLO</name>
    <value>
      DELETE
      FROM   DPA_TIPO_RUOLO
      WHERE  SYSTEM_ID=@systemID@
    </value>
  </query>
  <query>
    <name>AMM_S_CHECK_UNIQUE_TIPO_RUOLO</name>
    <value>
      SELECT	COUNT(SYSTEM_ID)
      FROM	DPA_TIPO_RUOLO TR
      WHERE	VAR_CODICE=@codice@ AND
      TR.ID_AMM=@idAmministrazione@
    </value>
  </query>
  <query>
    <name>AMM_S_GET_COUNT_RUOLI_IN_TIPO_RUOLO</name>
    <value>
      SELECT COUNT(CG.SYSTEM_ID)
      FROM   DPA_CORR_GLOBALI CG
      WHERE  CG.CHA_TIPO_URP='R' AND
      ID_TIPO_RUOLO=@idTipoRuolo@
    </value>
  </query>
  <query>
    <name>AMM_S_GET_CODICE_TIPO_RUOLO</name>
    <value>
      SELECT	TR.VAR_CODICE AS CODICE
      FROM	DPA_TIPO_RUOLO TR
      WHERE	TR.SYSTEM_ID=@idTipoRuolo@
    </value>
  </query>
  <query>
    <name>AMM_S_GET_TIPI_FUNZIONE</name>
    <value>
      SELECT		TF.SYSTEM_ID AS ID,
      TF.VAR_COD_TIPO AS CODICE,
      TF.VAR_DESC_TIPO_FUN AS DESCRIZIONE,
      TF.CHA_VIS AS CHA_VIS
      FROM		DPA_TIPO_FUNZIONE TF
      WHERE TF.ID_AMM = @idAmm@
      ORDER BY	TF.VAR_COD_TIPO
    </value>
  </query>
  <query>
    <name>AMM_S_GET_TIPO_FUNZIONE</name>
    <value>
      SELECT	TF.SYSTEM_ID AS ID,
      TF.VAR_COD_TIPO AS CODICE,
      TF.VAR_DESC_TIPO_FUN AS DESCRIZIONE,
      TF.CHA_VIS AS CHA_VIS
      FROM	DPA_TIPO_FUNZIONE TF
      WHERE	TF.SYSTEM_ID=@idTipoFunzione@
    </value>
  </query>
  <query>
    <name>AMM_S_GET_ANAGRAFICA_FUNZIONI_ELEMENTARI</name>
    <value>
      SELECT 		COD_FUNZIONE AS CODICE,
      VAR_DESC_FUNZIONE AS DESCRIZIONE,
      CHA_TIPO_FUNZ AS TIPO_FUNZIONE
      FROM 		DPA_ANAGRAFICA_FUNZIONI
      WHERE
      (CHA_TIPO_FUNZ NOT IN ('E') OR CHA_TIPO_FUNZ IS NULL) AND
      DISABLED = 'N'
    </value>
  </query>
  <query>
    <name>AMM_S_GET_FUNZIONI_ELEMENTARI_TIPO_FUNZIONE</name>
    <value>
      SELECT 		AF.COD_FUNZIONE AS CODICE,
      AF.VAR_DESC_FUNZIONE AS DESCRIZIONE,
      AF.CHA_TIPO_FUNZ AS TIPO_FUNZIONE,
      FA.ID AS ID_ASSOCIAZIONE,
      FA.ID_TIPO_FUNZIONE AS ID_TIPO_FUNZIONE,
      CASE
      WHEN FA.CODICE_ASSOCIATO IS NULL THEN 'false'
      ELSE 'true'
      END AS ASSOCIATO
      FROM 		DPA_ANAGRAFICA_FUNZIONI AF
      LEFT JOIN
      (
      SELECT 	F.SYSTEM_ID AS ID,
      F.ID_TIPO_FUNZIONE AS ID_TIPO_FUNZIONE,
      F.COD_FUNZIONE AS CODICE_ASSOCIATO
      FROM 	DPA_TIPO_FUNZIONE TF,
      DPA_FUNZIONI F,
      DPA_ANAGRAFICA_FUNZIONI AF2
      WHERE	TF.SYSTEM_ID=F.ID_TIPO_FUNZIONE AND
      F.COD_FUNZIONE=AF2.COD_FUNZIONE AND
      TF.SYSTEM_ID=@idTipoFunzione@
      ) AS FA ON AF.COD_FUNZIONE=FA.CODICE_ASSOCIATO
      WHERE
      (AF.CHA_TIPO_FUNZ NOT IN ('E') OR AF.CHA_TIPO_FUNZ IS NULL) AND
      AF.DISABLED = 'N'
      ORDER BY	AF.COD_FUNZIONE
    </value>
  </query>
  <query>
    <name>AMM_S_GET_FUNZIONE_ELEMENTARE</name>
    <value>
      SELECT 	F.SYSTEM_ID AS ID,
      F.ID_TIPO_FUNZIONE AS ID_TIPO_FUNZIONE,
      AF.COD_FUNZIONE AS CODICE,
      AF.VAR_DESC_FUNZIONE,
      AF.CHA_TIPO_FUNZ AS TIPO_FUNZIONE
      FROM 	DPA_FUNZIONI F,
      DPA_ANAGRAFICA_FUNZIONI AF
      WHERE	F.COD_FUNZIONE=AF.COD_FUNZIONE AND
      F.SYSTEM_ID=@idFunzione@ AND
      AF.DISABLED = 'N'
    </value>
  </query>
  <query>
    <name>AMM_S_GET_FUNZIONE_ELEMENTARE_DA_CODICE</name>
    <value>
      SELECT 	F.SYSTEM_ID AS ID,
      F.ID_TIPO_FUNZIONE AS ID_TIPO_FUNZIONE,
      AF.COD_FUNZIONE AS CODICE,
      AF.VAR_DESC_FUNZIONE,
      AF.CHA_TIPO_FUNZ AS TIPO_FUNZIONE
      FROM 	DPA_TIPO_FUNZIONE TF,
      DPA_FUNZIONI F,
      DPA_ANAGRAFICA_FUNZIONI AF
      WHERE	TF.SYSTEM_ID=F.ID_TIPO_FUNZIONE AND
      F.COD_FUNZIONE=AF.COD_FUNZIONE AND
      TF.SYSTEM_ID=@idTipoFunzione@ AND
      AF.COD_FUNZIONE=@codiceFunzione@ AND
      AF.DISABLED = 'N'
      ORDER BY F.COD_FUNZIONE ASC
    </value>
  </query>
  <query>
    <name>AMM_I_INSERT_FUNZIONE_ELEMENTARE</name>
    <value>
      INSERT INTO DPA_Funzioni
      (
      @colSystemID@
      COD_FUNZIONE,
      ID_TIPO_FUNZIONE,
      CHA_TIPO_FUNZ,
      VAR_DESC_FUNZIONE,
      ID_AMM
      )
      VALUES
      (
      @systemID@
      @codiceFunzione@,
      @idTipoFunzione@,
      @chaTipoFunz@,
      @descrizioneFunzione@,
      @idAmm@
      )
    </value>
  </query>
  <query>
    <name>AMM_D_DELETE_FUNZIONE_ELEMENTARE</name>
    <value>
      DELETE
      FROM 	DPA_FUNZIONI
      WHERE	SYSTEM_ID=@systemID@
    </value>
  </query>
  <query>
    <name>AMM_I_INSERT_TIPO_FUNZIONE</name>
    <value>
      INSERT INTO DPA_Tipo_Funzione
      (
      @colSystemID@
      VAR_COD_TIPO,
      VAR_DESC_TIPO_FUN,
      CHA_VIS,
      ID_AMM
      )
      VALUES
      (
      @systemID@
      '@codice@',
      '@descrizione@',
      1,
      @idAmm@
      )
    </value>
  </query>
  <query>
    <name>AMM_S_COUNT_FUNZ_TIPO_FUNZIONE</name>
    <value>
      select count(*) from dpa_funzioni f
      where f.ID_TIPO_FUNZIONE = (
      select system_id from dpa_tipo_funzione tf
      where tf.ID_AMM = @idAmm@
      and tf.VAR_COD_TIPO = '@nomeTipo@')
    </value>
  </query>
  <query>
    <name>AMM_U_UPDATE_TIPO_FUNZIONE</name>
    <value>
      UPDATE 	DPA_TIPO_FUNZIONE
      SET 	VAR_DESC_TIPO_FUN='@descrizione@'
      WHERE 	SYSTEM_ID=@systemID@
    </value>
  </query>
  <query>
    <name>AMM_D_DELETE_TIPO_FUNZIONE</name>
    <value>
      DELETE
      FROM 	DPA_TIPO_FUNZIONE
      WHERE 	SYSTEM_ID=@systemID@
    </value>
  </query>
  <query>
    <name>AMM_D_DELETE_FUNZIONI_TIPO_FUNZIONE</name>
    <value>
      DELETE
      FROM	DPA_FUNZIONI
      WHERE	ID_TIPO_FUNZIONE=@idTipoFunzione@
    </value>
  </query>
  <query>
    <name>AMM_S_GET_COUNT_RUOLI_TIPO_FUNZIONE</name>
    <value>
      SELECT  COUNT(R.SYSTEM_ID)
      FROM 	DPA_TIPO_F_RUOLO R
      WHERE	ID_TIPO_FUNZ=@idTipoFunzione@
    </value>
  </query>
  <query>
    <name>AMM_S_CONTAINS_CODICE_TIPO_FUNZIONE</name>
    <value>
      SELECT 	COUNT(F.SYSTEM_ID)
      FROM	DPA_TIPO_FUNZIONE F
      WHERE	F.VAR_COD_TIPO = '@codiceTipoFunzione@'
      AND ID_AMM = @idAmm@
    </value>
  </query>
  <query>
    <name>AMM_S_GET_RAGIONI_TRASMISSIONE_AMMINISTRAZIONE</name>
    <value>
      SELECT 		RT.SYSTEM_ID AS ID,
      RT.VAR_DESC_RAGIONE AS CODICE,
      RT.CHA_TIPO_RAGIONE AS TIPO,
      RT.CHA_VIS AS VISIBILITA,
      RT.CHA_TIPO_DIRITTI AS TIPO_DIRITTO,
      RT.CHA_TIPO_DEST AS TIPO_DESTINATARIO,
      RT.CHA_RISPOSTA AS RISPOSTA,
      RT.VAR_NOTE AS DESCRIZIONE,
      RT.CHA_EREDITA AS EREDITA,
      RT.ID_AMM AS ID_AMMINISTRAZIONE,
      RT.CHA_TIPO_RISPOSTA AS TIPO_RISPOSTA,
      RT.VAR_NOTIFICA_TRASM AS NOTIFICA,
      A1.SYSTEM_ID AS ID_AMMINISTRAZIONE_TO,
      A2.SYSTEM_ID AS ID_AMMINISTRAZIONE_CC,
      RT.VAR_TESTO_MSG_NOTIFICA_DOC,
      RT.VAR_TESTO_MSG_NOTIFICA_FASC,
      RT.CHA_CEDE_DIRITTI,
      RT.CHA_RAG_SISTEMA,
      RT.CHA_MANTIENI_LETT,
      RT.CHA_MANTIENI_SCRITT,
      RT.CHA_FASC_OBBLIGATORIA
      FROM		DPA_RAGIONE_TRASM RT
      LEFT OUTER JOIN DPA_AMMINISTRA A1
      ON RT.SYSTEM_ID=A1.ID_RAGIONE_TO
      LEFT OUTER JOIN DPA_AMMINISTRA A2
      ON RT.SYSTEM_ID=A2.ID_RAGIONE_CC
      WHERE		RT.ID_AMM=@idAmministrazione@
      ORDER BY	RT.VAR_DESC_RAGIONE ASC
    </value>
  </query>
  <query>
    <name>AMM_S_GET_RAGIONI_TRASMISSIONE_ANAGRAFICA</name>
    <value>
      SELECT 		RT.SYSTEM_ID AS ID,
      RT.VAR_DESC_RAGIONE AS CODICE,
      RT.CHA_TIPO_RAGIONE AS TIPO,
      RT.CHA_VIS AS VISIBILITA,
      RT.CHA_TIPO_DIRITTI AS TIPO_DIRITTO,
      RT.CHA_TIPO_DEST AS TIPO_DESTINATARIO,
      RT.CHA_RISPOSTA AS RISPOSTA,
      RT.VAR_NOTE AS DESCRIZIONE,
      RT.CHA_EREDITA AS EREDITA,
      RT.ID_AMM AS ID_AMMINISTRAZIONE,
      RT.CHA_TIPO_RISPOSTA AS TIPO_RISPOSTA,
      RT.VAR_NOTIFICA_TRASM AS NOTIFICA,
      '' AS ID_AMMINISTRAZIONE_TO,
      '' AS ID_AMMINISTRAZIONE_CC,
      RT.CHA_CEDE_DIRITTI,
      RT.CHA_RAG_SISTEMA,
      RT.CHA_MANTIENI_LETT,
      RT.CHA_MANTIENI_SCRITT,
      RT.CHA_FASC_OBBLIGATORIA
      FROM		DPA_RAGIONE_TRASM RT
      WHERE		RT.ID_AMM IS NULL
      ORDER BY	RT.VAR_DESC_RAGIONE ASC
    </value>
  </query>
  <query>
    <name>AMM_S_GET_RAGIONE_TRASMISSIONE</name>
    <value>
      SELECT 		RT.SYSTEM_ID AS ID,
      RT.VAR_DESC_RAGIONE AS CODICE,
      RT.CHA_TIPO_RAGIONE AS TIPO,
      RT.CHA_VIS AS VISIBILITA,
      RT.CHA_TIPO_DIRITTI AS TIPO_DIRITTO,
      RT.CHA_TIPO_DEST AS TIPO_DESTINATARIO,
      RT.CHA_RISPOSTA AS RISPOSTA,
      RT.VAR_NOTE AS DESCRIZIONE,
      RT.CHA_EREDITA AS EREDITA,
      RT.ID_AMM AS ID_AMMINISTRAZIONE,
      RT.CHA_TIPO_RISPOSTA AS TIPO_RISPOSTA,
      RT.VAR_NOTIFICA_TRASM AS NOTIFICA,
      A1.SYSTEM_ID AS ID_AMMINISTRAZIONE_TO,
      A2.SYSTEM_ID AS ID_AMMINISTRAZIONE_CC,
      RT.VAR_TESTO_MSG_NOTIFICA_DOC,
      RT.VAR_TESTO_MSG_NOTIFICA_FASC,
      RT.CHA_CEDE_DIRITTI,
      RT.CHA_RAG_SISTEMA,
      RT.CHA_MANTIENI_LETT,
      RT.CHA_MANTIENI_SCRITT,
      RT.CHA_FASC_OBBLIGATORIA,
      T.CHA_TIPO_TASK,
      T.ID_TIPO_ATTO,
      T.CHA_CONTRIBUTO_OBBLIGATORIO
      FROM		DPA_RAGIONE_TRASM RT
      LEFT OUTER JOIN DPA_AMMINISTRA A1
      ON RT.SYSTEM_ID=A1.ID_RAGIONE_TO
      LEFT OUTER JOIN DPA_AMMINISTRA A2
      ON RT.SYSTEM_ID=A2.ID_RAGIONE_CC
      LEFT OUTER JOIN DPA_TIPO_RAGIONE T
      ON RT.SYSTEM_ID = T.ID_RAGIONE_TRASM
      WHERE		RT.SYSTEM_ID=@idRagione@
    </value>
  </query>
  <query>
    <name>AMM_I_INSERT_RAGIONE_TRASMISSIONE</name>
    <value>
      INSERT INTO DPA_RAGIONE_TRASM
      (
      @colSystemID@
      VAR_DESC_RAGIONE,
      CHA_TIPO_RAGIONE,
      CHA_VIS,
      CHA_TIPO_DIRITTI,
      CHA_TIPO_DEST,
      CHA_RISPOSTA,
      VAR_NOTE,
      CHA_EREDITA,
      CHA_TIPO_RISPOSTA,
      ID_AMM,
      VAR_NOTIFICA_TRASM,
      CHA_CEDE_DIRITTI,
      CHA_MANTIENI_LETT,
      CHA_MANTIENI_SCRITT,
      CHA_FASC_OBBLIGATORIA
      )
      VALUES
      (
      @systemID@
      '@codiceRagione@',
      '@tipoRagione@',
      '@visibile@',
      '@tipoDiritto@',
      '@tipoDestinatario@',
      '@risposta@',
      '@descrizione@',
      '@eredita@',
      '@tipoRisposta@',
      @idAmministrazione@,
      @notifica@,
      '@cedeDiritti@',
      @mantieniLettura@,
      @mantieniScrittura@,
      @fascicolazioneObbligatoria@
      )
    </value>
  </query>
  <query>
    <name>AMM_U_UPDATE_RAGIONE_TRASMISSIONE</name>
    <value>
      UPDATE 	DPA_RAGIONE_TRASM
      SET 	CHA_TIPO_RAGIONE='@tipoRagione@',
      CHA_VIS='@visibile@',
      CHA_TIPO_DIRITTI='@tipoDiritto@',
      CHA_TIPO_DEST='@tipoDestinatario@',
      CHA_RISPOSTA='@risposta@',
      VAR_NOTE='@descrizione@',
      CHA_EREDITA='@eredita@',
      CHA_TIPO_RISPOSTA='@tipoRisposta@',
      VAR_NOTIFICA_TRASM=@notifica@,
      CHA_CEDE_DIRITTI='@cedeDiritti@',
      CHA_MANTIENI_LETT = @mantieniLettura@,
      CHA_MANTIENI_SCRITT = @mantieniScrittura@,
      CHA_FASC_OBBLIGATORIA = @fascicolazioneObbligatoria@
      WHERE 	VAR_DESC_RAGIONE='@codiceRagione@' AND
      ID_AMM=@idAmministrazione@
    </value>
  </query>
  <query>
    <name>AMM_D_DELETE_RAGIONE_TRASMISSIONE</name>
    <value>
      DELETE
      FROM 	DPA_RAGIONE_TRASM
      WHERE 	SYSTEM_ID=@idRagione@
    </value>
  </query>
  <query>
    <name>AMM_S_GET_COUNT_RAGIONI_TRASMISSE</name>
    <value>
      SELECT	COUNT(T.SYSTEM_ID)
      FROM	DPA_TRASM_SINGOLA T
      WHERE	T.ID_RAGIONE=@idRagione@
    </value>
  </query>
  <query>
    <name>AMM_S_CONTAINS_CODICE_RAGIONE_TRASMISSIONE</name>
    <value>
      SELECT	COUNT(RT.SYSTEM_ID)
      FROM	DPA_RAGIONE_TRASM RT
      WHERE	RT.VAR_DESC_RAGIONE = '@codiceRagione@' AND
      RT.ID_AMM=@idAmministrazione@
    </value>
  </query>
  <query>
    <name>AMM_S_IS_RAGIONE_TRASMISSIONE_DEFAULT</name>
    <value>
      SELECT		COUNT(A.SYSTEM_ID)
      FROM  		DPA_AMMINISTRA A
      WHERE		A.ID_RAGIONE_TO=@idRagione@ OR
      A.ID_RAGIONE_CC=@idRagione@ OR
      A.ID_RAGIONE_REFERENTE=@idRagione@
      OR  A.ID_RAGIONE_COMPETENZA=@idRagione@
      OR A.ID_RAGIONE_CONOSCENZA=@idRagione@
    </value>
  </query>
  <query>
    <name>I_NEW_AMMINISTRAZIONE</name>
    <value>
      INSERT INTO DPA_AMMINISTRA
      (@param1@
      VAR_CODICE_AMM,
      VAR_DESC_AMM,
      VAR_LIBRERIA,
      VAR_SMTP,
      NUM_PORTA_SMTP,
      VAR_FORMATO_SEGNATURA,
      VAR_FORMATO_FASCICOLATURA,
      VAR_DOMINIO,
      VAR_USER_SMTP,
      VAR_PWD_SMTP,
      NUM_GG_PERM_TODOLIST,
      CHA_ATTIVA_GG_PERM_TODOLIST,
      ID_RAGIONE_TO,
      ID_RAGIONE_CC,CHA_SMTP_SSL,CHA_SMTP_STA,FROM_EMAIL_ADDRESS,
      ID_RAGIONE_COMPETENZA, ID_RAGIONE_CONOSCENZA,
      VAR_FORMATO_TIMBRO,
      ID_CARAT_DF,
      ID_COLORE_DF,
      ID_POS_DF,
      ORIENTAMENTO,
      TIPO_ROTAZ,
      VAR_FORMATO_DOMINIO,
      FONTCOLOR,
      PULS_COLOR,
      NUM_RECORD,
      ID_CLIENT_MODEL_PROCESSOR,
      CSS,
      VAR_FORMATO_PROT_TIT,
      SPEDIZIONE_AUTO_DOC,
      AVVISA_SPEDIZIONE_DOC,
      TIPO_DOC_OBBL,
      IS_ENABLED_SMART_CLIENT,
      CHA_TIPO_COMPONENTI,
      SMART_CLIENT_PDF_CONV_ON_SCAN,
      ID_DISPOSITIVO_STAMPA,
      TRASMISSIONE_AUTO_DOC,
      VAR_DETTAGLIO_FIRMA,
      VAR_MSG_BANNER
      )
      VALUES
      (@param2@)
    </value>
  </query>
  <query>
    <name>U_AMMINISTRAZIONE</name>
    <value>
      UPDATE DPA_AMMINISTRA
      SET	VAR_DESC_AMM = @param1@,
      VAR_SMTP = @param2@,
      NUM_PORTA_SMTP = @param3@,
      VAR_FORMATO_SEGNATURA = @param4@,
      VAR_FORMATO_FASCICOLATURA = @param5@,
      VAR_DOMINIO = @param6@,
      VAR_USER_SMTP = @param7@,
      VAR_PWD_SMTP = @param8@,
      ID_RAGIONE_TO = @param9@,
      ID_RAGIONE_CC = @param10@,
      NUM_GG_PERM_TODOLIST = @param11@,
      CHA_ATTIVA_GG_PERM_TODOLIST = @param12@ ,
      CHA_SMTP_SSL =  @param14@,
      CHA_SMTP_STA =  @param15@,
      ID_RAGIONE_COMPETENZA = @param17@,
      ID_RAGIONE_CONOSCENZA = @param18@,
      FROM_EMAIL_ADDRESS = @param16@,
      VAR_FORMATO_TIMBRO = @param19@,
      ID_CARAT_DF = @param20@,
      ID_COLORE_DF = @param21@,
      ID_POS_DF = @param22@,
      ORIENTAMENTO = @param23@,
      TIPO_ROTAZ = @param24@,
      VAR_FORMATO_DOMINIO = @param25@,
      ID_CLIENT_MODEL_PROCESSOR = @param26@,
      VAR_FORMATO_PROT_TIT = @param27@,
      SPEDIZIONE_AUTO_DOC=@spedizioneAutoDoc@,
      AVVISA_SPEDIZIONE_DOC=@avvisaSpedizioneDoc@,
      TIPO_DOC_OBBL=@tipoDocObbl@,
      CHA_TIPO_COMPONENTI='@cha_tipo_componenti@',
      IS_ENABLED_SMART_CLIENT='@isEnabledSmartClient@',
      SMART_CLIENT_PDF_CONV_ON_SCAN='@smartClientPdfConvOnScan@',
      ID_DISPOSITIVO_STAMPA='@ID_DISPOSITIVO_STAMPA@',
      VAR_MSG_BANNER='@VAR_MSG_BANNER@',
      VAR_FORMATO_SEGNATURA_NP = '@param28@',
      CHA_SEGN_PERM_PROT = '@param29@',
      CHA_SEGN_PERM_NP= '@param30@'
      WHERE SYSTEM_ID = @sys_id@
    </value>
  </query>
  <query>
    <name>I_RAG_TRASM_NEW_AMM</name>
    <value>
      INSERT INTO DPA_RAGIONE_TRASM
      (@param1@
      VAR_DESC_RAGIONE,
      CHA_TIPO_RAGIONE,
      CHA_VIS,
      CHA_TIPO_DIRITTI,
      CHA_TIPO_DEST,
      CHA_RISPOSTA,
      VAR_NOTE,
      CHA_EREDITA,
      ID_AMM,
      CHA_TIPO_RISPOSTA,
      VAR_NOTIFICA_TRASM,
      CHA_CEDE_DIRITTI,
      CHA_RAG_SISTEMA,
      CHA_PROC_RES)
      SELECT @param2@
      VAR_DESC_RAGIONE,
      CHA_TIPO_RAGIONE,
      CHA_VIS,
      CHA_TIPO_DIRITTI,
      CHA_TIPO_DEST,
      CHA_RISPOSTA,
      VAR_NOTE,
      CHA_EREDITA,
      @param3@,
      CHA_TIPO_RISPOSTA,
      VAR_NOTIFICA_TRASM,
      'N',
      CHA_RAG_SISTEMA,
      CHA_PROC_RES
      FROM DPA_RAGIONE_TRASM
      WHERE @param4@
    </value>
  </query>
  <query>
    <name>U_RAG_TRASM_NEW_AMM</name>
    <value>
      UPDATE DPA_AMMINISTRA
      SET @nomecampo@ =
      (SELECT system_id
      FROM DPA_RAGIONE_TRASM
      WHERE ID_AMM = @idamm@
      AND VAR_DESC_RAGIONE =
      (SELECT var_desc_ragione
      FROM DPA_RAGIONE_TRASM
      WHERE system_id = @idToCc@))
      WHERE system_id = @idamm@
    </value>
  </query>
  <query>
    <name>AMM_CAN_DELETE_AMM</name>
    <value>
      select count(system_id)
      from profile
      where id_people_prot in
      (select system_id from people where id_amm = @idAmm@)
    </value>
  </query>
  <query>
    <name>PD_SALVA_TEMPLATES_GFD</name>
    <value>
      INSERT INTO DPA_TIPO_ATTO
      (
      @colID@
      VAR_DESC_ATTO,
      ID_AMM,
      Abilitato_SI_NO,
      In_Esercizio,
      CHA_PRIVATO,
      CHA_INVIO_CONSERVAZIONE,
      SISTEMA_PROPRIETARIO
      )
      VALUES
      (
      @id@
      '@Descrizione@',
      @id_amm@,
      @Abilitato_SI_NO@,
      '@In_Esercizio@',
      '@CHA_PRIVATO@',
      '@CHA_CONSERVAZIONE@',
      @SISTEMA_PROPRIETARIO@
      )
    </value>
  </query>
  <query>
    <name>PD_SALVA_TEMPLATES</name>
    <value>
      INSERT INTO DPA_TIPO_ATTO
      (
      @colID@
      VAR_DESC_ATTO,
      ID_AMM,
      Abilitato_SI_NO,
      In_Esercizio,
      CHA_PRIVATO,
      NUM_MESI_CONSERVAZIONE
      )
      VALUES
      (
      @id@
      '@Descrizione@',
      @id_amm@,
      @Abilitato_SI_NO@,
      '@In_Esercizio@',
      '@CHA_PRIVATO@',
      '@NUM_MESI_CONSERVAZIONE@'
      )
    </value>
  </query>
  <!--
  <query>
		<name>PD_SALVA_TEMPLATES_COMPONENT</name>
		<value>
		INSERT INTO DPA_TEMPLATES_COMPONENT
			(
				@colID@
				ID_TEMPLATE,
				Tipo_Atto,
				ID_AMM
			)
			VALUES
			(
				@id@
				@ID_TEMPLATE@,
				'@Tipo_Atto@',
				@ID_AMM@
			)	
		</value>
	</query>
  -->
  <query>
    <name>PD_GET_TIPO_OGGETTO</name>
    <value>
      SELECT SYSTEM_ID FROM DPA_TIPO_OGGETTO
      WHERE Descrizione = '@Descrizione@'
    </value>
  </query>
  <query>
    <name>PD_SALVA_OGGETTO_CUSTOM</name>
    <value>
      INSERT INTO DPA_OGGETTI_CUSTOM
      (
      @colID@
      Descrizione,
      Orizzontale_Verticale,
      Campo_Obbligatorio,
      Multilinea,
      Numero_Di_Linee,
      Numero_Di_Caratteri,
      Campo_Di_Ricerca,
      ID_TIPO_OGGETTO,
      Reset_Anno,
      Formato_Contatore,
      ID_R_DEFAULT,
      RICERCA_CORR,
      CAMPO_COMUNE,
      CHA_TIPO_TAR,
      CONTA_DOPO,
      REPERTORIO,
      DA_VISUALIZZARE_RICERCA,
      FORMATO_ORA,
      TIPO_LINK,
      TIPO_OBJ_LINK,
      CONFIG_OBJ_EST,
      MODULO_SOTTOCONTATORE,
      CHA_CONSOLIDAMENTO,
      CHA_CONSERVAZIONE,
      CHA_CONS_REPERTORIO,
      CHA_PERMANENTE,
      CHA_PERMANENTE_ONNICOMPRENSIVA
      )
      VALUES
      (
      @id@
      '@Descrizione@',
      '@Orizzontale_Verticale@',
      '@Campo_Obbligatorio@',
      '@Multilinea@',
      '@Numero_Di_Linee@',
      '@Numero_Di_Caratteri@',
      '@Campo_Di_Ricerca@',
      @ID_TIPO_OGGETTO@,
      '@Reset_Anno@',
      '@Formato_Contatore@',
      @ID_R_DEFAULT@,
      '@RICERCA_CORR@',
      @CAMPO_COMUNE@,
      '@tipoContatore@',
      @contaDopo@,
      @repertorio@,
      @da_visualizzare_ricerca@,
      '@formatoOra@',
      '@TIPO_LINK@',
      '@TIPO_OBJ_LINK@',
      NULL,
      @moduloSottocontatore@,
      @consolidamento@,
      @conservazione@,
      @cons_repertorio@,
      '@is_segnatura_permanente@',
      '@is_segnatura_permanente_onnicomprensiva@'
      )
    </value>
  </query>
  <query>
    <name>PD_U_ASS_TEMPLATES_FASC_DEFAULT</name>
    <value>
      UPDATE DPA_ASS_TEMPLATES_FASC
      SET VALORE_OGGETTO_DB = '@valore_default@'
      WHERE ID_TEMPLATE = @idtemplate@
      AND ID_OGGETTO = @idoggetto@
      AND (ID_PROJECT IS NULL OR ID_PROJECT ='')
    </value>
  </query>
  <query>
    <name>PD_U_ASSOCIAZIONE_TEMPLATES_DEFAULT</name>
    <value>
      UPDATE DPA_ASSOCIAZIONE_TEMPLATES
      SET VALORE_OGGETTO_DB = '@valore_default@'
      WHERE ID_TEMPLATE = @idtemplate@
      AND ID_OGGETTO = @idoggetto@
      AND (DOC_NUMBER = '' OR DOC_NUMBER IS NULL)
    </value>
  </query>
  <query>
    <name>PD_SALVA_ASSOCIAZIONE_TEMPLATES</name>
    <value>
      INSERT INTO DPA_ASSOCIAZIONE_TEMPLATES
      (
      @colID@
      ID_OGGETTO,
      ID_TEMPLATE,
      Doc_Number,
      Valore_Oggetto_Db,
      Anno,
      ID_AOO_RF,
      CODICE_DB,
      MANUAL_INSERT,
      VALORE_SC,
      DTA_INS
      )
      VALUES
      (
      @id@
      @ID_OGGETTO@,
      @ID_TEMPLATE@,
      '@Doc_Number@',
      '@Valore_Oggetto_Db@',
      @Anno@,
      @idAooRf@,
      '@CODICE_DB@',
      @MANUAL_INSERT@,
      @valoreSc@,
      @dtaIns@

      )
    </value>
  </query>
  <query>
    <name>PD_SALVA_ASSOCIAZIONE_VALORI</name>
    <value>
      INSERT INTO DPA_ASSOCIAZIONE_VALORI
      (
      @colID@
      Descrizione_Valore,
      Valore,
      Valore_Di_Default,
      ID_OGGETTO_CUSTOM,
      ABILITATO,
      COLOR_BG
      )
      VALUES
      (
      @id@
      '@Descrizione_Valore@',
      '@Valore@',
      '@Valore_Di_Default@',
      @ID_OGGETTO_CUSTOM@,
      @abilitato@,
      '@colorBg@'
      )
    </value>
  </query>
  <query>
    <name>PD_GET_ID_AMM_BY_COD</name>
    <value>
      SELECT SYSTEM_ID
      FROM DPA_AMMINISTRA
      WHERE VAR_CODICE_AMM = '@codiceAmministrazione@'
    </value>
  </query>
  <query>
    <name>PD_GET_TIPI_OGGETTO</name>
    <value>
      SELECT TIPO from DPA_TIPO_OGGETTO
    </value>
  </query>
  <query>
    <name>PD_GET_TIPI_OGGETTO_1</name>
    <value>
      SELECT * FROM DPA_TIPO_OGGETTO
      WHERE SYSTEM_ID = @idOggettoCustom@
    </value>
  </query>
  <query>
    <name>PD_GET_TIPI_DOCUMENTO</name>
    <value>
      SELECT VAR_DESC_ATTO FROM DPA_TIPO_ATTO
      WHERE ID_AMM = @idAmministrazione@
    </value>
  </query>
  <query>
    <name>PD_DELETE_OGGETTI_CUSTOM_DA_DB</name>
    <value>
      DELETE FROM DPA_ASSOCIAZIONE_TEMPLATES
      WHERE ID_OGGETTO = @idOggettoCustom@ AND Doc_Number = ''
    </value>
  </query>
  <query>
    <name>PD_AGGIORNA_POSIZIONE</name>
    <value>
      UPDATE DPA_OGG_CUSTOM_COMP
      SET POSIZIONE = @posizione@
      WHERE
      ID_TEMPLATE = @idTemplate@
      AND
      ID_OGG_CUSTOM = @idOggettoCustom@
    </value>
  </query>
  <query>
    <name>PD_INSERT_DPA_TIPO_ATTO</name>
    <value>
      INSERT INTO DPA_TIPO_ATTO
      (
      @colID@
      VAR_DESC_ATTO,
      ID_AMM
      )
      VALUES
      (
      @id@
      '@DescrizioneAtto@',
      @idAmministrazione@
      )
    </value>
  </query>
  <query>
    <name>PD_MESSA_IN_ESERCIZIO</name>
    <value>
      <!--UPDATE DPA_TIPO_ATTO SET In_Esercizio = 'SI'-->UPDATE DPA_TIPO_ATTO SET In_Esercizio = '@paramInEsercizio@'
      WHERE SYSTEM_ID = @idTemplate@
    </value>
  </query>
  <!--
	<query>
		<name>PD_DELETE_DPA_TEMPLATES_COMPONENT</name>
		<value>
			DELETE FROM DPA_TEMPLATES_COMPONENT 
			WHERE ID_TEMPLATE = @idTemplate@
		</value>		
	</query>
  -->
  <query>
    <name>PD_DELETE_DPA_ASSOCIAZIONE_TEMPLATES</name>
    <value>
      DELETE FROM DPA_ASSOCIAZIONE_TEMPLATES
      WHERE ID_TEMPLATE = @idTemplate@
    </value>
  </query>
  <query>
    <name>PD_DELETE_DPA_OGGETTI_CUSTOM</name>
    <value>
      DELETE FROM DPA_OGGETTI_CUSTOM
      WHERE SYSTEM_ID = @idOggettoCustom@
    </value>
  </query>
  <query>
    <name>PD_UPDATE_DPA_ASSOCIAZIONE_VALORI</name>
    <value>
      UPDATE DPA_ASSOCIAZIONE_VALORI
      SET Descrizione_Valore = '@descrizione@', VALORE_DI_DEFAULT = '@valoreDiDefault@', ABILITATO = @abilitato@, COLOR_BG= '@colorBg@'
      WHERE
      ID_OGGETTO_CUSTOM = @idOggettoCustom@
      AND
      VALORE = '@valore@'
    </value>
  </query>
  <query>
    <name>PD_DELETE_DPA_ASSOCIAZIONE_VALORI</name>
    <value>
      DELETE FROM DPA_ASSOCIAZIONE_VALORI
      WHERE ID_OGGETTO_CUSTOM = @idOggettoCustom@
    </value>
  </query>
  <query>
    <name>PD_DELETE_DPA_ASSOCIAZIONE_VALORI_1</name>
    <value>
      DELETE FROM DPA_ASSOCIAZIONE_VALORI
      WHERE
      ID_OGGETTO_CUSTOM = @idOggettoCustom@
      AND
      VALORE = '@valore@'
    </value>
  </query>
  <query>
    <name>PD_DELETE_DPA_TEMPLATE</name>
    <value>
      DELETE FROM DPA_TIPO_ATTO
      WHERE SYSTEM_ID = @idTemplate@
    </value>
  </query>
  <query>
    <name>PD_DISABILITA_TEMPLATE</name>
    <value>
      UPDATE DPA_TIPO_ATTO SET Abilitato_SI_NO = 0
      WHERE SYSTEM_ID = @idTemplate@
    </value>
  </query>
  <query>
    <name>PD_DELETE_TIPO_ATTO</name>
    <value>
      DELETE FROM DPA_TIPO_ATTO
      WHERE VAR_DESC_ATTO = '@descrizioneTemplate@' AND
      ID_AMM = @idAmministrazione@ AND SYSTEM_ID = '@idTipoAtto@'
    </value>
  </query>
  <query>
    <name>PD_AGGIORNA_DPA_OGGETTI_CUSTOM</name>
    <value>
      UPDATE DPA_OGGETTI_CUSTOM
      SET Descrizione = '@descrizioneOggettoCustom@',
      Orizzontale_Verticale = '@orizzontaleVerticaleOggettoCustom@',
      Campo_Obbligatorio = '@campoObbligatorioOggettoCustom@',
      Multilinea = '@multilineaOggettoCustom@',
      Numero_Di_Linee ='@numeroLineeOggettoCustom@',
      Numero_Di_Caratteri ='@numeroCaratteriOggettoCustom@',
      Campo_Di_Ricerca ='@campoRicercaOggettoCustom@',
      Reset_Anno = '@Reset_Anno@',
      Formato_Contatore = '@Formato_Contatore@',
      ID_R_DEFAULT = @ID_R_DEFAULT@,
      RICERCA_CORR = '@RICERCA_CORR@',
      CAMPO_COMUNE = @CAMPO_COMUNE@,
      CHA_TIPO_TAR = '@tipoContatore@',
      CONTA_DOPO = @contaDopo@,
      REPERTORIO = @repertorio@,
      DA_VISUALIZZARE_RICERCA = @da_visualizzare_ricerca@,
      FORMATO_ORA = '@formatoOra@',
      TIPO_LINK = '@TIPO_LINK@',
      TIPO_OBJ_LINK = '@TIPO_OBJ_LINK@',
      MODULO_SOTTOCONTATORE = @moduloSottocontatore@,
      CHA_CONSOLIDAMENTO = @consolidamento@,
      CHA_CONSERVAZIONE = @conservazione@,
      CHA_CONS_REPERTORIO = @cons_repertorio@,
      CHA_PERMANENTE = '@is_segnatura_permanente@',
      CHA_PERMANENTE_ONNICOMPRENSIVA = '@is_segnatura_permanente_onnicomprensiva@'
      WHERE SYSTEM_ID = @idOggettoCustom@
    </value>
  </query>
  <query>
    <name>PD_GET_DPA_TEMPLATE_GFD</name>
    <value>
      <!--SELECT *
      FROM DPA_TIPO_ATTO -->
      <!--//ADP-->
      SELECT DPA_TIPO_ATTO.SYSTEM_ID
      ,VAR_DESC_ATTO
      ,ID_AMM
      ,Abilitato_SI_NO
      ,In_Esercizio
      ,Path_Mod_1
      ,Ext_Mod_1
      ,Path_Mod_2
      ,Ext_mod_2
      ,GG_SCADENZA
      ,GG_PRE_SCADENZA
      ,CHA_PRIVATO
      ,IPERDOCUMENTO
      ,PATH_ALL_1
      ,EXT_ALL_1
      ,COD_MOD_TRASM
      ,COD_CLASS
      ,PATH_MOD_SU
      ,Path_Mod_Exc
      ,DPA_EXT_APPS.VAR_CODE as SISTEMA_PROPRIETARIO
      FROM DPA_TIPO_ATTO
      LEFT JOIN DPA_EXT_APPS ON DPA_EXT_APPS.SYSTEM_ID = DPA_TIPO_ATTO.SISTEMA_PROPRIETARIO
      WHERE
      ID_AMM = @idAmministrazione@ AND
      Abilitato_SI_NO = 1 ORDER BY DPA_TIPO_ATTO.VAR_DESC_ATTO
    </value>
  </query>

  <query>
    <name>PD_GET_DPA_TEMPLATE</name>
    <value>
      SELECT *
      FROM DPA_TIPO_ATTO
      WHERE
      ID_AMM = @idAmministrazione@ AND
      Abilitato_SI_NO = 1 ORDER BY DPA_TIPO_ATTO.VAR_DESC_ATTO
    </value>
  </query>
  <!--ADP inizio-->
  <query>
    <name>PD_GET_DPA_TEMPLATE_SIS_PROP</name>
    <value>
      SELECT distinct DPA_EXT_APPS.VAR_CODE as SITEMA_PROPRIETARIO,DPA_EXT_APPS.SYSTEM_ID as SISTEMA_ID
      FROM DPA_EXT_APPS
      WHERE DPA_EXT_APPS.VAR_CODE is not null
    </value>
  </query>
  <query>
    <name>PD_SALVA_TEMPLATES_NULLABLE</name>
    <value>
      INSERT INTO DPA_TIPO_ATTO
      (
      @colID@
      VAR_DESC_ATTO,
      ID_AMM,
      Abilitato_SI_NO,
      In_Esercizio,
      CHA_PRIVATO
      )
      VALUES
      (
      @id@
      '@Descrizione@',
      @id_amm@,
      @Abilitato_SI_NO@,
      '@In_Esercizio@',
      '@CHA_PRIVATO@'
      )
    </value>
  </query>

  <query>
    <name>PD_GET_DPA_TEMPLATE_SIS_PROP_BY_APPSETTING</name>
    <value>
      SELECT distinct DPA_EXT_APPS.SYSTEM_ID as SISTEMA_ID
      FROM DPA_EXT_APPS
      WHERE DPA_EXT_APPS.VAR_CODE='@SISTEMA_PROPRIETARIO@'
    </value>
  </query>
  <!--ADP fine-->
  <query>
    <name>PD_GET_DPA_TEMPLATE_1</name>
    <value>
      SELECT SYSTEM_ID, VAR_DESC_ATTO, GG_SCADENZA, GG_PRE_SCADENZA, CHA_PRIVATO
      FROM DPA_TIPO_ATTO
      WHERE
      VAR_DESC_ATTO = '@tipoAtto@' AND
      ID_AMM = @idAmministrazione@ <!--AND
      Abilitato_SI_NO = 1 AND
      In_Esercizio = 'SI'-->
    </value>
  </query>
  <query>
    <name>PD_UPDATE_SCADENZE</name>
    <value>
      UPDATE DPA_TIPO_ATTO
      SET GG_SCADENZA = @scadenza@,
      GG_PRE_SCADENZA = @preScadenza@
      WHERE
      SYSTEM_ID = @idTemplate@
    </value>
  </query>
  <query>
    <name>PD_UPDATE_PRIVATO_DOC</name>
    <value>
      UPDATE DPA_TIPO_ATTO
      SET CHA_PRIVATO = @privato@
      WHERE
      SYSTEM_ID = @idTemplate@
    </value>
  </query>
  <query>
    <name>PD_UPDATE_PRIVATO_FASC</name>
    <value>
      UPDATE DPA_TIPO_FASC
      SET CHA_PRIVATO = @privato@
      WHERE
      SYSTEM_ID = @idTemplate@
    </value>
  </query>
  <query>
    <name>PD_GET_DPA_TEMPLATE_2</name>
    <value>
      SELECT *
      FROM DPA_TIPO_ATTO
      WHERE
      SYSTEM_ID = @idTemplate@
    </value>
  </query>
  <query>
    <name>PD_SYSTEM_ID_OGGETTI_CUSTOM</name>
    <value>
      SELECT DISTINCT(ID_OGGETTO), DPA_OGG_CUSTOM_COMP.POSIZIONE
      FROM DPA_ASSOCIAZIONE_TEMPLATES, DPA_OGGETTI_CUSTOM, DPA_OGG_CUSTOM_COMP
      WHERE
      DPA_ASSOCIAZIONE_TEMPLATES.ID_OGGETTO = DPA_OGGETTI_CUSTOM.SYSTEM_ID
      AND
      DPA_OGGETTI_CUSTOM.SYSTEM_ID = DPA_OGG_CUSTOM_COMP.ID_OGG_CUSTOM
      AND
      DPA_OGG_CUSTOM_COMP.ID_TEMPLATE = @idTemplate@
      AND
      DPA_ASSOCIAZIONE_TEMPLATES.DOC_NUMBER  = ''
      ORDER BY DPA_OGG_CUSTOM_COMP.POSIZIONE
    </value>
  </query>
  <query>
    <name>PD_SYSTEM_ID_OGGETTI_CUSTOM_1</name>
    <value>
      SELECT DISTINCT(ID_OGGETTO), DPA_OGG_CUSTOM_COMP.POSIZIONE
      FROM DPA_ASSOCIAZIONE_TEMPLATES, DPA_OGGETTI_CUSTOM, DPA_OGG_CUSTOM_COMP
      WHERE
      DPA_ASSOCIAZIONE_TEMPLATES.ID_OGGETTO = DPA_OGGETTI_CUSTOM.SYSTEM_ID
      AND
      DPA_OGGETTI_CUSTOM.SYSTEM_ID = DPA_OGG_CUSTOM_COMP.ID_OGG_CUSTOM
      AND
      DPA_OGG_CUSTOM_COMP.ID_TEMPLATE = @idTemplate@
      AND
      DPA_ASSOCIAZIONE_TEMPLATES.DOC_NUMBER = '@docNumber@'
      ORDER BY DPA_OGG_CUSTOM_COMP.POSIZIONE
    </value>
  </query>
  <query>
    <name>PD_SYSTEM_ID_OGGETTI_CUSTOM_2</name>
    <value>
      SELECT DISTINCT(ID_OGGETTO), DPA_OGG_CUSTOM_COMP.POSIZIONE
      FROM DPA_ASSOCIAZIONE_TEMPLATES, DPA_OGGETTI_CUSTOM, DPA_OGG_CUSTOM_COMP
      WHERE
      DPA_ASSOCIAZIONE_TEMPLATES.ID_OGGETTO = DPA_OGGETTI_CUSTOM.SYSTEM_ID
      AND
      DPA_OGGETTI_CUSTOM.SYSTEM_ID = DPA_OGG_CUSTOM_COMP.ID_OGG_CUSTOM
      AND
      DPA_OGG_CUSTOM_COMP.ID_TEMPLATE = @idTemplate@
      AND
      (
      DPA_ASSOCIAZIONE_TEMPLATES.DOC_NUMBER is null
      OR
      DPA_ASSOCIAZIONE_TEMPLATES.DOC_NUMBER = ''
      )
      ORDER BY DPA_OGG_CUSTOM_COMP.POSIZIONE
    </value>
  </query>
  <query>
    <name>PD_GET_OGGETTI_CUSTOM</name>
    <value>
      SELECT * FROM DPA_OGGETTI_CUSTOM, DPA_OGG_CUSTOM_COMP
      WHERE
      DPA_OGGETTI_CUSTOM.SYSTEM_ID = DPA_OGG_CUSTOM_COMP.ID_OGG_CUSTOM
      AND
      DPA_OGG_CUSTOM_COMP.ID_TEMPLATE = @idTemplate@
      AND
      DPA_OGG_CUSTOM_COMP.ID_OGG_CUSTOM = @idOggettoCustom@
    </value>
  </query>
  <query>
    <name>PD_GET_VALORE_DB_OGGETTO_CUSTOM_1</name>
    <value>
      SELECT Valore_Oggetto_Db, Anno, ID_AOO_RF,CODICE_DB,MANUAL_INSERT FROM DPA_ASSOCIAZIONE_TEMPLATES
      WHERE ID_OGGETTO = @idOggettoCustom@
      AND Doc_Number = '@docNumber@'
    </value>
  </query>
  <query>
    <name>PD_GET_DPA_ASSOCIAZIONE_VALORI</name>
    <value>
      SELECT * FROM DPA_ASSOCIAZIONE_VALORI
      WHERE ID_OGGETTO_CUSTOM = @idOggettoCustom@ order by system_id
    </value>
  </query>
  <query>
    <name>PD_GET_DPA_ASSOCIAZIONE_VALORI_1</name>
    <value>
      SELECT * FROM DPA_ASSOCIAZIONE_VALORI
      WHERE
      ID_OGGETTO_CUSTOM = @idOggettoCustom@
      AND
      VALORE = '@valore@'
    </value>
  </query>
  <query>
    <name>PD_GET_ID_TEMPLATE_FROM_DOC_NUMBER</name>
    <value>
      SELECT ID_TEMPLATE FROM DPA_ASSOCIAZIONE_TEMPLATES
      WHERE Doc_Number = '@docNumber@'
    </value>
  </query>
  <query>
    <name>PD_GET_ID_TEMPLATE_FROM_PROFILE</name>
    <value>
      SELECT ID_TIPO_ATTO AS ID_TEMPLATE FROM PROFILE WITH(NOLOCK)
      WHERE DOCNUMBER = '@docNumber@' AND ID_TIPO_ATTO IS NOT NULL
    </value>
  </query>
  <query>
    <name>PD_GET_DESCRIZIONE_TEMPLATE</name>
    <value>
      SELECT * FROM DPA_TIPO_ATTO
      WHERE SYSTEM_ID = @idTemplate@
    </value>
  </query>
  <query>
    <name>PD_GET_DOCNUMBER</name>
    <value>
      SELECT  DPA_ASSOCIAZIONE_TEMPLATES.Doc_Number,
      DPA_ASSOCIAZIONE_TEMPLATES.SYSTEM_ID,
      DPA_ASSOCIAZIONE_TEMPLATES.ID_OGGETTO
      FROM
      DPA_ASSOCIAZIONE_TEMPLATES WITH(NOLOCK), DPA_OGG_CUSTOM_COMP WITH(NOLOCK)
      WHERE
      DPA_ASSOCIAZIONE_TEMPLATES.ID_OGGETTO = DPA_OGG_CUSTOM_COMP.ID_OGG_CUSTOM
      AND Doc_Number = '@docNumber@'
      AND DPA_OGG_CUSTOM_COMP.ID_TEMPLATE = DPA_ASSOCIAZIONE_TEMPLATES.ID_TEMPLATE
      ORDER BY  DPA_OGG_CUSTOM_COMP.POSIZIONE
    </value>
  </query>
  <query>
    <name>PD_GET_TIPO_ATTO</name>
    <value>
      SELECT SYSTEM_ID,ID_AMM FROM DPA_TIPO_ATTO
      WHERE VAR_DESC_ATTO = '@descrizioneTemplate@'
    </value>
  </query>
  <query>
    <name>PD_GET_CONTATORE</name>
    <value>
      SELECT count(PROFILE.SYSTEM_ID) As Contatore
      FROM PROFILE, PEOPLE, DPA_AMMINISTRA
      WHERE PROFILE.AUTHOR = PEOPLE.SYSTEM_ID AND
      PEOPLE.ID_AMM = DPA_AMMINISTRA.SYSTEM_ID AND
      DPA_AMMINISTRA.SYSTEM_ID = @idAmministrazione@ AND
      PROFILE.ID_TIPO_ATTO = @idTipoAtto@
    </value>
  </query>
  <query>
    <name>PD_GET_CONTATORE_1</name>
    <value>
      SELECT MAX(CAST(Valore_Oggetto_Db AS INT)) as VALORE_OGGETTO_DB
      FROM DPA_ASSOCIAZIONE_TEMPLATES
      WITH(UPDLOCK)
      WHERE
      ID_OGGETTO = @idOggetto@
      AND
      ID_TEMPLATE = @idTemplate@
    </value>
  </query>
  <query>
    <name>PD_GET_MAX_ANNO</name>
    <value>
      SELECT MAX(ANNO) AS ANNO FROM DPA_ASSOCIAZIONE_TEMPLATES
    </value>
  </query>
  <query>
    <name>PD_REMOVE_DOC</name>
    <value>
      DELETE FROM DPA_ASSOCIAZIONE_TEMPLATES
      WHERE
      DOC_NUMBER = @doc_number@
    </value>
  </query>
  <query>
    <name>PD_IS_DOC_PROFILATO</name>
    <value>
      SELECT * FROM DPA_ASSOCIAZIONE_TEMPLATES
      WHERE DOC_NUMBER = @docNumber@
    </value>
  </query>
  <query>
    <name>PD_UPDATE_DPA_ASSOCIAZIONE_TEMPLATES</name>
    <value>
      UPDATE DPA_ASSOCIAZIONE_TEMPLATES
      SET Valore_Oggetto_Db = '@valoreDbOggettoCustom@', ID_AOO_RF = @idAooRf@, CODICE_DB = '@CODICE_DB@', MANUAL_INSERT=@MANUAL_INSERT@, VALORE_SC = @valoreSc@, DTA_INS = @dtaIns@, ANNO = @anno@
      WHERE Doc_Number = '@docNumber@' AND
      ID_TEMPLATE = @idTemplate@ AND
      ID_OGGETTO = @idOggettoCustom@ AND
      SYSTEM_ID = @system_id@ AND
      (Valore_Oggetto_Db != '@valoreDbOggettoCustom@' OR Valore_Oggetto_Db is null)
    </value>
  </query>
  <query>
    <name>PD_GET_OGGETTI_CUSTOM_PER_RICERCA</name>
    <value>
      SELECT * FROM DPA_OGGETTI_CUSTOM, DPA_OGG_CUSTOM_COMP
      WHERE
      DPA_OGGETTI_CUSTOM.SYSTEM_ID = DPA_OGG_CUSTOM_COMP.ID_OGG_CUSTOM
      AND
      DPA_OGGETTI_CUSTOM.SYSTEM_ID = @idOggettoCustom@
      AND
      DPA_OGGETTI_CUSTOM.CAMPO_DI_RICERCA = 'SI'
    </value>
  </query>
  <query>
    <name>PD_IS_VALUE_IN_USE</name>
    <value>
      SELECT Valore_Oggetto_db FROM DPA_ASSOCIAZIONE_TEMPLATES
      WHERE ID_OGGETTO = @idOggetto@
      AND ID_TEMPLATE = @idTemplate@
    </value>
  </query>
  <query>
    <name>PD_UPDATE_PATH_MODELLI</name>
    <value>
      UPDATE DPA_TIPO_ATTO
      SET
      PATH_MOD_1 = '@pathModUno@',
      EXT_MOD_1 = '@extModUno@',
      PATH_MOD_2 = '@pathModDue@',
      EXT_MOD_2 = '@extModDue@',
      PATH_MOD_SU = '@pathModSU@',
      PATH_ALL_1 = '@pathAllUno@',
      EXT_ALL_1 = '@extAllUno@',
      PATH_MOD_EXC = '@pathmodexc@'
      WHERE SYSTEM_ID = @idTemplate@
    </value>
  </query>
  <query>
    <name>PD_GET_OGGETTO_BY_ID</name>
    <value>
      select oc.SYSTEM_ID system_id,
      oc.Descrizione descrizione,
      oc.Orizzontale_Verticale orizzontale_verticale,
      oc.Campo_Obbligatorio campo_obbligatorio,
      oc.Multilinea multilinea,
      oc.Numero_Di_Linee numero_di_linee,
      oc.Numero_Di_Caratteri numero_di_caratteri,
      oc.Campo_Di_Ricerca campo_di_ricerca,
      ogc.Posizione posizione,
      oc.id_tipo_oggetto id_tipo,
      ot.Tipo tipo,
      ot.Descrizione descr_tipo,
      oc.Reset_anno reset_anno,
      oc.Formato_Contatore formato_Contatore,
      oc.CHA_PERMANENTE CHA_PERMANENTE,
      oc.CHA_PERMANENTE_ONNICOMPRENSIVA,
      oc.ricerca_corr,
      oc.id_r_default,
      oc.campo_comune,
      oc.cha_tipo_tar,
      oc.conta_dopo,
      oc.repertorio,
      oc.modulo_sottocontatore,
      oc.cha_cons_repertorio
      from dpa_oggetti_custom oc, dpa_tipo_oggetto ot, dpa_ogg_custom_comp ogc
      where oc.system_id = @param1@
      and oc.id_tipo_oggetto = ot.system_id
      and oc.system_id = ogc.id_ogg_custom
    </value>
  </query>
  <query>
    <name>PD_GET_OGGETTO_FASC_BY_ID</name>
    <value>
      select oc.SYSTEM_ID system_id,
      oc.Descrizione descrizione,
      oc.Orizzontale_Verticale orizzontale_verticale,
      oc.Campo_Obbligatorio campo_obbligatorio,
      oc.Multilinea multilinea,
      oc.Numero_Di_Linee numero_di_linee,
      oc.Numero_Di_Caratteri numero_di_caratteri,
      oc.Campo_Di_Ricerca campo_di_ricerca,
      ogc.Posizione posizione,
      oc.id_tipo_oggetto id_tipo,
      ot.Tipo tipo,
      ot.Descrizione descr_tipo,
      oc.Reset_anno reset_anno,
      oc.Formato_Contatore formato_Contatore,
      oc.CHA_PERMANENTE CHA_PERMANENTE,
      oc.ricerca_corr,
      oc.id_r_default,
      oc.campo_comune,
      oc.cha_tipo_tar,
      oc.conta_dopo,
      oc.repertorio
      from dpa_oggetti_custom_fasc oc, dpa_tipo_oggetto_fasc ot, dpa_ogg_custom_comp_fasc ogc
      where oc.system_id = @param1@
      and oc.id_tipo_oggetto = ot.system_id
      and oc.system_id = ogc.id_ogg_custom
    </value>
  </query>
  <query>
    <name>DS_IS_UNIQUE_NOME_DIAGRAMMA</name>
    <value>
      SELECT SYSTEM_ID FROM DPA_DIAGRAMMI_STATO
      WHERE VAR_DESCRIZIONE = '@nomeDiagramma@'
    </value>
  </query>
  <query>
    <name>DS_GET_STATO_DOC_STORICO</name>
    <value>
      SELECT * FROM DPA_DIAGRAMMI_STO
      WHERE DOC_NUMBER = @docNumber@ ORDER BY SYSTEM_ID
    </value>
  </query>
  <query>
    <name>DS_GET_DIAGRAMMA_STORICO_DOC</name>
    <value>
      SELECT  ID_USER, DTA_DATE, VAR_DESC_OLD_STATO, VAR_DESC_NEW_STATO, ID_PEOPLE, ID_RUOLO, ID_PEOPLE_DELEGATO
      FROM DPA_DIAGRAMMI_STO
      WHERE DOC_NUMBER = @docNumber@ ORDER BY DTA_DATE DESC
    </value>
  </query>
  <query>
    <name>DS_GET_DOC_FASC_IN_STATO</name>
    <value>
      SELECT DPA_DIAGRAMMI.SYSTEM_ID
      FROM DPA_DIAGRAMMI, PROFILE
      WHERE
      DPA_DIAGRAMMI.DOC_NUMBER = PROFILE.DOCNUMBER
      AND
      ID_STATO = @idStato@
      UNION
      SELECT DPA_DIAGRAMMI.SYSTEM_ID
      FROM DPA_DIAGRAMMI, PROJECT
      WHERE
      DPA_DIAGRAMMI.ID_PROJECT = PROJECT.SYSTEM_ID
      AND
      ID_STATO = @idStato@
    </value>
  </query>
  <query>
    <name>DS_DISASSOCIA_TIPO_DOC_DIAGRAMMA</name>
    <value>
      DELETE FROM DPA_ASS_DIAGRAMMI
      WHERE ID_TIPO_DOC = @idTipoDoc@
    </value>
  </query>
  <query>
    <name>DS_GET_DIAGRAMMA_ASSOCIATO</name>
    <value>
      SELECT ID_DIAGRAMMA FROM DPA_ASS_DIAGRAMMI
      WHERE ID_TIPO_DOC = @idTipoDoc@ AND ID_DIAGRAMMA IS NOT NULL
    </value>
  </query>
  <query>
    <name>DS_IS_MODIFICABILE</name>
    <value>
      SELECT * FROM DPA_ASS_DIAGRAMMI
      WHERE ID_DIAGRAMMA = @systemIdDiagramma@
    </value>
  </query>
  <query>
    <name>DS_GET_STATO_DOC_1</name>
    <value>
      SELECT * FROM DPA_DIAGRAMMI
      WHERE DOC_NUMBER = @docNumber@
    </value>
  </query>
  <query>
    <name>DS_GET_STATO_BY_ID</name>
    <value>
      SELECT * FROM DPA_STATI WHERE
      SYSTEM_ID = @system_id@
    </value>
  </query>
  <query>
    <name>DS_DELETE_DPA_PASSI</name>
    <value>
      DELETE FROM DPA_PASSI
      WHERE ID_STATO = @id_passo@
    </value>
  </query>
  <query>
    <name>DS_DELETE_DPA_STATI</name>
    <value>
      DELETE FROM DPA_STATI
      WHERE SYSTEM_ID = @id_stato@
    </value>
  </query>
  <query>
    <name>DS_DELETE_DPA_DIAGRAMMI_DOC</name>
    <value>
      DELETE FROM DPA_DIAGRAMMI
      WHERE ID_STATO = @id_stato@
    </value>
  </query>
  <query>
    <name>DS_DELETE_DPA_DIAGRAMMI_STATO</name>
    <value>
      DELETE FROM DPA_DIAGRAMMI_STATO WHERE
      SYSTEM_ID = @system_id@
    </value>
  </query>
  <query>
    <name>DS_GET_BY_ID_TIPO_DOC</name>
    <value>
      SELECT DPA_ASS_DIAGRAMMI.ID_DIAGRAMMA
      FROM DPA_TIPO_ATTO, DPA_ASS_DIAGRAMMI
      WHERE
      DPA_TIPO_ATTO.SYSTEM_ID = @id_tipo_atto@
      AND
      DPA_TIPO_ATTO.SYSTEM_ID = DPA_ASS_DIAGRAMMI.ID_TIPO_DOC
      AND
      DPA_TIPO_ATTO.ID_AMM = @id_amm@ AND ID_DIAGRAMMA IS NOT NULL
    </value>
  </query>
  <query>
    <name>DS_GET_DIAGRAMMI_STATO</name>
    <value>
      SELECT * FROM DPA_DIAGRAMMI_STATO
      WHERE SYSTEM_ID = @system_id@
    </value>
  </query>
  <query>
    <name>DS_GET_STATI</name>
    <value>
      SELECT * FROM DPA_STATI
      WHERE ID_DIAGRAMMA = @id_diagramma@
    </value>
  </query>
  <query>
    <name>DS_GET_PASSI</name>
    <value>
      SELECT
      DPA_PASSI.SYSTEM_ID AS ID_PASSO,
      DPA_PASSI.ID_STATO AS ID_STATO_PASSO,
      DPA_PASSI.ID_NEXT_STATO AS ID_NEXT_STATO_PASSO,
      DPA_PASSI.ID_DIAGRAMMA AS ID_DIAGRAMMA_PASSO,
      DPA_PASSI.ID_STATO_AUTO AS ID_STATO_AUTO_PASSO,
      DPA_PASSI.DESC_STATO_AUTO AS DESC_STATO_AUTO_PASSO,
      DPA_S1.SYSTEM_ID AS ID_STATO_PADRE,
      DPA_S1.ID_DIAGRAMMA AS ID_DIAGRAMMA_STATO_PADRE,
      DPA_S1.VAR_DESCRIZIONE AS VAR_DESCRIZIONE_STATO_PADRE,
      DPA_S1.STATO_INIZIALE AS STATO_INIZIALE_STATO_PADRE,
      DPA_S1.STATO_FINALE AS STATO_FINALE_STATO_PADRE,
      DPA_S1.CONV_PDF AS CONV_PDF_STATO_PADRE,
      DPA_S1.STATO_CONSOLIDAMENTO AS STATO_CONS_STATO_PADRE,
      DPA_S2.SYSTEM_ID AS ID_STATO_SUCC,
      DPA_S2.ID_DIAGRAMMA AS ID_DIAGRAMMA_STATO_SUCC,
      DPA_S2.VAR_DESCRIZIONE AS VAR_DESCRIZIONE_STATO_SUCC,
      DPA_S2.STATO_INIZIALE AS STATO_INIZIALE_STATO_SUCC,
      DPA_S2.STATO_FINALE AS STATO_FINALE_STATO_SUCC,
      DPA_S2.CONV_PDF AS CONV_PDF_STATO_SUCC,
      DPA_S2.STATO_CONSOLIDAMENTO AS STATO_CONS_STATO_SUCC,
      DPA_S2.CHA_STATO_SISTEMA AS STATO_SISTEMA_STATO_SUCC
      FROM
      DPA_PASSI, DPA_STATI DPA_S1, DPA_STATI DPA_S2
      WHERE
      DPA_PASSI.ID_STATO = @id_stato@
      AND
      DPA_PASSI.ID_STATO = DPA_S1.SYSTEM_ID
      AND
      DPA_PASSI.ID_NEXT_STATO = DPA_S2.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>DS_GET_DIAGRAMMI_BY_ID_AMM</name>
    <value>
      SELECT * FROM DPA_DIAGRAMMI_STATO
      WHERE ID_AMM = @idAmm@
    </value>
  </query>
  <query>
    <name>DS_ASSOCIA_TIPO_DOC_DIAGRAMMA</name>
    <value>
      SELECT * FROM DPA_ASS_DIAGRAMMI
      WHERE ID_TIPO_DOC = @idTipoDoc@
      AND
      ID_DIAGRAMMA = @idDiagramma@
      AND
      ID_MOD_TRASM IS NULL AND ID_STATO IS NULL
    </value>
  </query>
  <query>
    <name>DS_INS_ASSOCIA_TIPO_DOC_DIAGRAMMA</name>
    <value>
      INSERT INTO DPA_ASS_DIAGRAMMI
      (
      @colID@
      ID_TIPO_DOC,
      ID_DIAGRAMMA
      )
      VALUES
      (
      @id@
      @idTipoDoc@,
      @idDiagramma@
      )
    </value>
  </query>
  <query>
    <name>DS_UPDATE_DPA_DIAGRAMMI_DOC</name>
    <value>
      UPDATE DPA_DIAGRAMMI
      SET ID_STATO = @idStato@
      WHERE
      DOC_NUMBER = @docNumber@
    </value>
  </query>
  <query>
    <name>DS_UPDATE_DPA_DIAGRAMMI_STATO</name>
    <value>
      UPDATE DPA_DIAGRAMMI_STATO
      SET Var_descrizione = '@descrizione@'
      WHERE
      SYSTEM_ID = @system_id@
    </value>
  </query>
  <query>
    <name>DS_INS_DPA_DIAGRAMMI_STO</name>
    <value>
      INSERT INTO DPA_DIAGRAMMI_STO
      (
      @colID@
      Id_user,
      Doc_number,
      Dta_date,
      Var_desc_old_stato,
      Var_desc_new_stato,
      Id_people,
      Id_ruolo,
      Id_people_delegato
      )
      VALUES
      (
      @id@
      '@idUtente@',
      @docNumber@,
      GETDATE(),
      '@oldStato@',
      '@newStato@',
      @idPeople@,
      @idRuolo@,
      @idPeopleDelegato@
      )
    </value>
  </query>
  <query>
    <name>DS_INS_DPA_DIAGRAMMI_DOC</name>
    <value>
      INSERT INTO DPA_DIAGRAMMI
      (
      @colID@
      Doc_number,
      Id_stato,
      Id_diagramma
      )
      VALUES
      (
      @id@
      @docNumber@,
      @idStato@,
      @idDiagramma@
      )
    </value>
  </query>
  <query>
    <name>DS_INS_DPA_DIAGRAMMI_STATO</name>
    <value>
      INSERT INTO DPA_DIAGRAMMI_STATO
      (
      @colID@
      Id_amm,
      Var_descrizione
      )
      VALUES
      (
      @id@
      @idAmm@,
      '@descrizione@'
      )
    </value>
  </query>
  <query>
    <name>DS_INS_DPA_STATI</name>
    <value>
      INSERT INTO DPA_STATI
      (
      @colID@
      ID_DIAGRAMMA,
      Var_descrizione,
      Stato_iniziale,
      Stato_finale,
      Conv_PDF,
      Stato_consolidamento,
      NON_RICERCABILE,
      CHA_STATO_SISTEMA
      )
      VALUES
      (
      @id@
      @ID_DIAGRAMMA@,
      '@Var_descrizione@',
      @Stato_iniziale@,
      @Stato_finale@,
      @conversionePdf@,
      '@statoConsolidamento@',
      @nonRicercabile@,
      '@statoSistema@'
      )
    </value>
  </query>
  <query>
    <name>DS_GET_SYSTEM_ID_DPA_STATI</name>
    <value>
      SELECT SYSTEM_ID FROM DPA_STATI
      WHERE
      ID_DIAGRAMMA = @idDiagramma@
      AND
      VAR_DESCRIZIONE = '@descrizione@'
    </value>
  </query>
  <query>
    <name>DS_INS_DPA_PASSI</name>
    <value>
      INSERT INTO DPA_PASSI
      (
      @colID@
      ID_STATO,
      Id_next_stato,
      Id_diagramma
      )
      VALUES
      (
      @id@
      @id_stato@,
      @next_stato@,
      @id_diagramma@
      )
    </value>
  </query>
  <query>
    <name>DS_GET_SYSTEM_ID_DPA_STATI_1</name>
    <value>
      SELECT SYSTEM_ID FROM DPA_STATI
      WHERE
      SYSTEM_ID = @system_id@
    </value>
  </query>
  <query>
    <name>DS_UPDATE_DPA_STATI</name>
    <value>
      UPDATE DPA_STATI
      SET VAR_DESCRIZIONE = '@descrizione@',
      STATO_INIZIALE = @stato_iniziale@,
      STATO_FINALE = @stato_finale@,
      CONV_PDF = @conversionePdf@,
      STATO_CONSOLIDAMENTO = '@statoConsolidamento@',
      NON_RICERCABILE = @nonRicercabile@
      WHERE SYSTEM_ID = @system_id@
    </value>
  </query>
  <query>
    <name>DS_DELETE_DPA_PASSI_1</name>
    <value>
      DELETE FROM DPA_PASSI
      WHERE ID_DIAGRAMMA = @idDiagramma@
    </value>
  </query>
  <query>
    <name>DS_GET_ID_MODELLO_TIPODOC_DS</name>
    <value>
      SELECT * FROM DPA_ASS_DIAGRAMMI
      WHERE ID_TIPO_DOC = @idTipoDoc@
      AND
      ID_DIAGRAMMA = @idDiagramma@
      AND
      ID_STATO = @idStato@
    </value>
  </query>
  <query>
    <name>DS_GET_ID_MODELLO_TIPODOC_DS_1</name>
    <value>
      SELECT * FROM DPA_ASS_DIAGRAMMI
      WHERE ID_TIPO_DOC = @idTipoDoc@
      AND
      (ID_DIAGRAMMA = @idDiagramma@ OR ID_DIAGRAMMA IS NULL)
      AND
      ID_STATO IS NULL
    </value>
  </query>
  <query>
    <name>DS_DISASSOCIA_TIPO_DOC_DIAGRAMMA_1</name>
    <value>
      DELETE FROM DPA_ASS_DIAGRAMMI
      WHERE
      ID_STATO IS NULL
      AND
      ID_DIAGRAMMA IS NULL
      AND
      ID_TIPO_DOC = @idTipoDoc@
    </value>
  </query>
  <query>
    <name>DS_DISASSOCIA_TIPO_DOC_DIAGRAMMA_2</name>
    <value>
      DELETE FROM DPA_ASS_DIAGRAMMI
      WHERE
      ID_STATO IS NULL
      AND
      ID_MOD_TRASM IS NOT NULL
      AND
      ID_DIAGRAMMA = @idDiagramma@
      AND
      ID_TIPO_DOC = @idTipoDoc@
    </value>
  </query>
  <query>
    <name>DS_INS_ASSOCIA_TIPO_DOC_DIAGRAMMA_1</name>
    <value>
      INSERT INTO DPA_ASS_DIAGRAMMI
      (
      @colID@
      ID_TIPO_DOC,
      ID_MOD_TRASM
      )
      VALUES
      (
      @id@
      @idTipoDoc@,
      @idTemplate@
      )
    </value>
  </query>
  <query>
    <name>DS_INS_ASSOCIA_TIPO_DOC_DIAGRAMMA_2</name>
    <value>
      INSERT INTO DPA_ASS_DIAGRAMMI
      (
      @colID@
      ID_TIPO_DOC,
      ID_DIAGRAMMA,
      ID_MOD_TRASM
      )
      VALUES
      (
      @id@
      @idTipoDoc@,
      @idDiagramma@,
      @idTemplate@
      )
    </value>
  </query>
  <query>
    <name>DS_DISASSOCIA_TIPO_DOC_DIAGRAMMA_3</name>
    <value>
      DELETE FROM DPA_ASS_DIAGRAMMI
      WHERE
      ID_DIAGRAMMA = @idDiagramma@
      AND
      ID_TIPO_DOC = @idTipoDoc@
      AND
      ID_STATO = @idStato@
    </value>
  </query>
  <query>
    <name>DS_INS_ASSOCIA_TIPO_DOC_DIAGRAMMA_3</name>
    <value>
      INSERT INTO DPA_ASS_DIAGRAMMI
      (
      @colID@
      ID_TIPO_DOC,
      ID_DIAGRAMMA,
      ID_MOD_TRASM,
      ID_STATO,
      TRASM_AUT
      )
      VALUES
      (
      @id@
      @idTipoDoc@,
      @idDiagramma@,
      @idTemplate@,
      @idStato@,
      @trasmAut@
      )
    </value>
  </query>
  <query>
    <name>DS_IS_STATO_TRASM_AUTO</name>
    <value>
      SELECT ID_MOD_TRASM, TRASM_AUT
      FROM DPA_ASS_DIAGRAMMI
      WHERE ID_STATO = @idStato@
      AND
      ID_TIPO_DOC = @idTemplate@
    </value>
  </query>
  <query>
    <name>DS_UPDATE_STATI_AUTOMATICI</name>
    <value>
      UPDATE DPA_PASSI SET
      ID_STATO_AUTO = @id_stato_automatico@,
      DESC_STATO_AUTO = '@desc_stato_automatico@'
      WHERE ID_STATO = @id_stato_padre@
    </value>
  </query>
  <query>
    <name>DS_DEL_TRASM_STORICO</name>
    <value>
      DELETE FROM DPA_TRASM_DIAGR WHERE ID_STATO = @idStato@ AND DOC_NUMBER = @docNumber@
    </value>
  </query>
  <query>
    <name>DS_GET_DPA_DIAGRAMMI_DOC</name>
    <value>
      SELECT DISTINCT(ID_STATO)
      FROM DPA_DIAGRAMMI, DPA_ASSOCIAZIONE_TEMPLATES, DPA_STATI
      WHERE
      DPA_DIAGRAMMI.DOC_NUMBER = DPA_ASSOCIAZIONE_TEMPLATES.DOC_NUMBER
      AND
      DPA_STATI.SYSTEM_ID = DPA_DIAGRAMMI.ID_STATO
      AND
      DPA_STATI.STATO_FINALE &lt;&gt; 1
      AND
      DPA_ASSOCIAZIONE_TEMPLATES.ID_TEMPLATE = @idTemplate@
      AND
      DPA_DIAGRAMMI.ID_DIAGRAMMA = @idDiagramma@
    </value>
  </query>
  <query>
    <name>DS_INS_TRASM_STORICO</name>
    <value>
      INSERT INTO DPA_TRASM_DIAGR
      (
      @colID@
      ID_TRASM,
      DOC_NUMBER,
      ID_STATO
      )
      VALUES
      (
      @id@
      @idTrasm@,
      @docNumber@,
      @idStato@
      )
    </value>
  </query>
  <query>
    <name>DS_GET_ID_TRASM_DIAGR</name>
    <value>
      SELECT ID_TRASM FROM DPA_TRASM_DIAGR WHERE DOC_NUMBER = @docNumber@ AND ID_STATO = @idStato@
    </value>
  </query>
  <query>
    <name>DS_GET_TRASM_DIAGR_AR</name>
    <value>
      SELECT DPA_TRASM_UTENTE.CHA_ACCETTATA AS ACCETTATA
      FROM
      DPA_TRASMISSIONE,
      DPA_TRASM_SINGOLA,
      DPA_TRASM_UTENTE,
      DPA_RAGIONE_TRASM
      WHERE
      DPA_TRASM_SINGOLA.ID_RAGIONE = DPA_RAGIONE_TRASM.SYSTEM_ID
      AND
      DPA_TRASMISSIONE.system_id = DPA_TRASM_SINGOLA.ID_TRASMISSIONE
      AND
      DPA_TRASM_SINGOLA.system_id = DPA_TRASM_UTENTE.ID_TRASM_SINGOLA
      AND
      DPA_RAGIONE_TRASM.CHA_TIPO_RAGIONE = 'W'
      AND
      DPA_TRASMISSIONE.SYSTEM_ID = @idTrasmissione@
    </value>
  </query>
  <query>
    <name>DS_GET_TRASM_DIAGR_AR_1</name>
    <value>
      SELECT DPA_TRASM_UTENTE.CHA_ACCETTATA AS ACCETTATA
      FROM
      DPA_TRASMISSIONE,
      DPA_TRASM_SINGOLA,
      DPA_TRASM_UTENTE,
      DPA_RAGIONE_TRASM
      WHERE
      DPA_TRASM_SINGOLA.ID_RAGIONE = DPA_RAGIONE_TRASM.SYSTEM_ID
      AND
      DPA_TRASMISSIONE.system_id = DPA_TRASM_SINGOLA.ID_TRASMISSIONE
      AND
      DPA_TRASM_SINGOLA.system_id = DPA_TRASM_UTENTE.ID_TRASM_SINGOLA
      AND
      DPA_RAGIONE_TRASM.CHA_TIPO_RAGIONE = 'W'
      AND
      DPA_TRASMISSIONE.SYSTEM_ID = @idTrasmissione@
      AND (CHA_ACCETTATA = '0' AND CHA_VALIDA='1')
      GROUP BY DPA_TRASM_SINGOLA.system_id, DPA_TRASM_UTENTE.CHA_ACCETTATA
    </value>
  </query>
  <query>
    <name>MT_GET_MODELLI_PER_TRASM</name>
    <value>
      select *
      from dpa_modelli_trasm as mod
      where
      mod.id_amm = @idAmm@
      @paramRegistri@
      and
      mod.single = '1'
      and
      mod.cha_tipo_oggetto = '@cha_tipo_oggetto@'
      and
      not exists (select DPA_ASS_DIAGRAMMI.id_mod_trasm FROM DPA_ASS_DIAGRAMMI where mod.system_id=DPA_ASS_DIAGRAMMI.id_mod_trasm)
      ORDER BY mod.NOME
    </value>
  </query>
  <query>
    <name>MT_GET_MODELLI_PER_TRASM_1</name>
    <value>
      select mod.*
      from dpa_modelli_trasm as mod, dpa_modelli_mitt_dest as mittDest
      where
      mod.system_id = mittDest.id_modello
      and
      (mod.id_people = @idPeople@ or mod.id_people is null)
      and
      (mittDest.id_corr_globali =0
      or mittDest.id_corr_globali = @idCorrGlobali@)
      and
      mittDest.CHA_TIPO_MITT_DEST = 'M'
      and
      mod.id_amm = @idAmm@
      @paramRegistri@
      and
      mod.single = '0'
      and
      mod.cha_tipo_oggetto = '@cha_tipo_oggetto@'
      and
      not exists (select DPA_ASS_DIAGRAMMI.id_mod_trasm FROM DPA_ASS_DIAGRAMMI where mod.system_id=DPA_ASS_DIAGRAMMI.id_mod_trasm)
      ORDER BY mod.NOME
    </value>
  </query>
  <query>
    <name>MT_GET_MODELLI_PER_TRASM_2</name>
    <value>
      select *
      from dpa_modelli_trasm as mod
      where
      mod.id_amm = @idAmm@
      @paramRegistri@
      and
      mod.single = '1'
      and
      mod.cha_tipo_oggetto = '@cha_tipo_oggetto@'
      and
      exists (select DPA_ASS_DIAGRAMMI.id_mod_trasm FROM DPA_ASS_DIAGRAMMI where mod.system_id=DPA_ASS_DIAGRAMMI.id_mod_trasm
      and
      DPA_ASS_DIAGRAMMI.id_tipo_doc=@idTipoDoc@
      @condizione@
      ORDER BY mod.NOME
    </value>
  </query>
  <query>
    <name>MT_GET_MODELLI_PER_TRASM_3</name>
    <value>
      select mod.*
      from dpa_modelli_trasm as mod, dpa_modelli_mitt_dest as mittDest
      where
      mod.system_id = mittDest.id_modello
      and
      (mod.id_people = @idPeople@ or mittDest.id_corr_globali = @idCorrGlobali@)
      and
      mittDest.CHA_TIPO_MITT_DEST = 'M'
      and
      mod.id_amm = @idAmm@
      @paramRegistri@
      and
      mod.single = '0'
      and
      mod.cha_tipo_oggetto = '@cha_tipo_oggetto@'
      and
      exists (select DPA_ASS_DIAGRAMMI.id_mod_trasm FROM DPA_ASS_DIAGRAMMI where mod.system_id=DPA_ASS_DIAGRAMMI.id_mod_trasm
      and
      DPA_ASS_DIAGRAMMI.id_tipo_doc=@idTipoDoc@
      @condizione@
      ORDER BY mod.NOME
    </value>
  </query>
  <query>
    <name>MT_NEXT_VAL</name>
    <value>
      select max(system_id) from dpa_modelli_trasm
    </value>
  </query>
  <query>
    <name>MT_SALVA_MODELLO</name>
    <value>
      INSERT INTO DPA_MODELLI_TRASM
      (
      ID_AMM,
      NOME,
      CHA_TIPO_OGGETTO,
      ID_REGISTRO,
      VAR_NOTE_GENERALI,
      SINGLE,
      ID_PEOPLE,
      CHA_CEDE_DIRITTI,
      ID_PEOPLE_NEW_OWNER,
      ID_GROUP_NEW_OWNER,
      NO_NOTIFY,
      CHA_MANTIENI_LETTURA,
      CHA_MANTIENI_SCRITTURA
      )
      VALUES
      (
      @param0@,
      '@param1@',
      '@param2@',
      @param3@,
      '@param4@',
      '@param5@',
      @param6@,
      '@cedeDir@',
      @idpeople_new_owner@,
      @idgroup_new_owner@,
      '@no_notify@',
      '@mantieniLettura@',
      '@mantieniScrittura@'
      )
    </value>
  </query>
  <query>
    <name>LS_IS_UNIQUE_COD_MODELLO_TRASM</name>
    <value>
      SELECT SYSTEM_ID
      FROM DPA_MODELLI_TRASM
      WHERE
      @parametri@
    </value>
  </query>
  <query>
    <name>MT_UPDATE_MODELLO</name>
    <value>
      UPDATE DPA_MODELLI_TRASM SET
      ID_AMM=@param0@,
      NOME='@param1@',
      CHA_TIPO_OGGETTO='@param2@',
      ID_REGISTRO=@param3@,
      VAR_NOTE_GENERALI='@param4@',
      SINGLE='@param5@',
      ID_PEOPLE = @param7@,
      CHA_CEDE_DIRITTI = '@cedeDir@',
      ID_PEOPLE_NEW_OWNER = @idpeople_new_owner@,
      ID_GROUP_NEW_OWNER = @idgroup_new_owner@,
      NO_NOTIFY = '@no_notify@',
      CHA_MANTIENI_LETTURA = '@mantieniLettura@',
      CHA_MANTIENI_SCRITTURA = '@mantieniScrittura@'
      WHERE SYSTEM_ID= @param6@
    </value>
  </query>
  <query>
    <name>MT_SALVA_MODELLI_MITT_DEST</name>
    <value>
      INSERT INTO DPA_MODELLI_MITT_DEST
      (
      @colID@
      ID_MODELLO,
      CHA_TIPO_MITT_DEST,
      ID_CORR_GLOBALI,
      ID_RAGIONE,
      CHA_TIPO_TRASM,
      VAR_NOTE_SING,
      CHA_TIPO_URP,
      SCADENZA,
      HIDE_DOC_VERSIONS
      )
      VALUES
      (
      @id@
      @param0@,
      '@param1@',
      @param2@,
      @param3@,
      '@param4@',
      '@param5@',
      '@param6@',
      @param7@,
      @param8@
      )
    </value>
  </query>
  <query>
    <name>MT_GET_MODELLI_BY_NAME</name>
    <value>
      SELECT
      DPA_MODELLI_TRASM.SYSTEM_ID,
      DPA_MODELLI_TRASM.NOME,
      DPA_MODELLI_TRASM.CHA_TIPO_OGGETTO,
      DPA_MODELLI_TRASM.ID_REGISTRO,
      DPA_MODELLI_TRASM.VAR_NOTE_GENERALI,
      DPA_MODELLI_TRASM.ID_PEOPLE,
      DPA_MODELLI_TRASM.SINGLE,
      DPA_MODELLI_TRASM.ID_AMM,
      DPA_MODELLI_TRASM.CHA_CEDE_DIRITTI,
      DPA_MODELLI_TRASM.ID_PEOPLE_NEW_OWNER,
      DPA_MODELLI_TRASM.ID_GROUP_NEW_OWNER,
      DPA_MODELLI_TRASM.NO_NOTIFY
      FROM DPA_MODELLI_TRASM, DPA_MODELLI_MITT_DEST
      WHERE NOME = '@nome@'
      AND ID_AMM = @idAmm@
      AND CHA_TIPO_OGGETTO = '@tipoOggetto@'
      AND DPA_MODELLI_TRASM.system_id = DPA_MODELLI_MITT_DEST.id_modello
      AND cha_tipo_mitt_dest = 'M'
      @idCorrGlob@
      @idRegistro@
    </value>
  </query>
  <query>
    <name>MT_GET_MODELLI</name>
    <value>
      SELECT DPA_MODELLI_TRASM.SYSTEM_ID,NOME,CHA_TIPO_OGGETTO,ID_REGISTRO,VAR_NOTE_GENERALI,ID_PEOPLE,SINGLE,ID_AMM,CHA_CEDE_DIRITTI,ID_PEOPLE_NEW_OWNER,ID_GROUP_NEW_OWNER, NO_NOTIFY, CHA_MANTIENI_LETTURA,
      ID_GROUP_NEW_OWNER, NO_NOTIFY, @dbUser@.isvalidmodellotrasmissione(dpa_modelli_trasm.SYSTEM_ID) AS invalid, CHA_MANTIENI_SCRITTURA
      FROM DPA_MODELLI_TRASM WHERE ID_AMM = @param1@
      @param2@
      order by id_registro,single,nome
    </value>
  </query>
  <query>
    <name>MT_GET_MODELLI_1</name>
    <value>
      SELECT dpa_modelli_trasm.*, m.*, @dbUser@.isvalidmodellotrasmissione(dpa_modelli_trasm.SYSTEM_ID) AS invalid,
      @dbUser@.GetNumMittentiModelliTrasm(dpa_modelli_trasm.SYSTEM_ID) AS mittNum
      FROM dpa_modelli_trasm, dpa_modelli_mitt_dest m
      WHERE dpa_modelli_trasm.system_id=m.id_modello
      AND id_amm = @idAmm@
      AND (dpa_modelli_trasm.id_people=@idPeople@ OR dpa_modelli_trasm.id_people IS NULL)
      AND m.cha_tipo_mitt_dest = 'M'
      AND dpa_modelli_trasm.single = '0'
      AND (id_corr_globali = @idCorrGlobali@ OR id_corr_globali = 0)
      AND NOT EXISTS (SELECT dpa_ass_diagrammi.id_mod_trasm FROM dpa_ass_diagrammi WHERE m.id_modello=dpa_ass_diagrammi.id_mod_trasm)
      @param1@
      ORDER BY nome
    </value>
  </query>
  <query>
    <name>MT_GET_MITTENTE</name>
    <value>
      SELECT DPA_MODELLI_MITT_DEST.SYSTEM_ID,ID_MODELLO,CHA_TIPO_MITT_DEST,docsadm.getCodRubricacorr(DPA_MODELLI_MITT_DEST.id_corr_globali) VAR_COD_RUBRICA,ID_RAGIONE,CHA_TIPO_TRASM,VAR_NOTE_SING, docsadm.getdesccorr(dpa_modelli_mitt_dest.id_corr_globali) VAR_DESC_CORR,DPA_MODELLI_MITT_DEST.CHA_TIPO_URP,DPA_MODELLI_MITT_DEST.ID_CORR_GLOBALI,DPA_MODELLI_MITT_DEST.HIDE_DOC_VERSIONS
      FROM DPA_MODELLI_MITT_DEST WHERE ID_MODELLO = @param1@ AND CHA_TIPO_MITT_DEST = 'M'
    </value>
  </query>
  <query>
    <name>MT_GET_DESTINATARI</name>
    <value>
      SELECT   rt.var_desc_ragione, md.system_id, md.id_modello,
      md.cha_tipo_mitt_dest,
      @dbuser@.getcodrubricacorr (md.id_corr_globali) var_cod_rubrica,
      md.id_ragione, md.cha_tipo_trasm, md.var_note_sing,
      @dbuser@.getdesccorr (md.id_corr_globali) var_desc_corr, md.cha_tipo_urp,
      rt.cha_tipo_ragione, md.id_corr_globali, md.scadenza,
      md.hide_doc_versions, cg.dta_fine, cg.cha_disabled_trasm
      FROM dpa_modelli_mitt_dest md INNER JOIN dpa_ragione_trasm rt
      ON md.id_ragione = rt.system_id
      LEFT JOIN dpa_corr_globali cg ON md.id_corr_globali = cg.system_id
      WHERE id_modello = @param1@
      AND cha_tipo_mitt_dest IN
      ('D', 'UT_P', 'R_P', 'RSP_P', 'UO_P', 'R_S', 'RSP_M', 'S_M')
      ORDER BY id_ragione
    </value>
  </query>
  <query>
    <name>MT_DELETE_MODELLO</name>
    <value>
      DELETE DPA_MODELLI_TRASM
      WHERE SYSTEM_ID = @param1@ AND ID_AMM = @param2@
    </value>
  </query>
  <query>
    <name>MT_DELETE_MODELLI_MITT_DEST</name>
    <value>
      DELETE DPA_MODELLI_MITT_DEST
      WHERE ID_MODELLO = @param1@
    </value>
  </query>
  <query>
    <name>MT_DELETE_DEST_MODELLI</name>
    <value>
      DELETE DPA_MODELLI_MITT_DEST
      WHERE ID_MODELLO = @param1@
      AND VAR_COD_RUBRICA = '@param2@'
      AND ID_RAGIONE = '@param3@'
    </value>
  </query>
  <query>
    <name>MT_DELETE_DPA_MODELLI_MITT_DEST</name>
    <value>
      DELETE DPA_MODELLI_MITT_DEST
      WHERE ID_MODELLO = @idModTrasmissione@
    </value>
  </query>

  <query>
    <name>S_PROJECT_COMPONENTS_4</name>
    <value>
      SELECT
      LINK
      FROM PROJECT_COMPONENTS PC,PROFILE P
      WHERE PC.PROJECT_ID IN ( @param1@ )
      AND PC.LINK=P.SYSTEM_ID @param2@
    </value>
  </query>
  <query>
    <name>UPDATE_GROUPS_SPOSTA_RUOLO</name>
    <value>
      UPDATE GROUPS
      SET GROUP_ID = '@param1@',
      GROUP_NAME = '@param2@'
      WHERE SYSTEM_ID = @param3@
    </value>
  </query>
  <query>
    <name>UPDATE_CORR_GLOB_SPOSTA_RUOLO</name>
    <value>
      UPDATE DPA_CORR_GLOBALI
      SET VAR_CODICE = '@param1@',
      VAR_COD_RUBRICA = '@param1@',
      VAR_DESC_CORR = '@param2@',
      ID_UO = @param3@,
      CHA_RIFERIMENTO = NULL
      WHERE SYSTEM_ID = @param4@
    </value>
  </query>
  <query>
    <name>S_GET_DETTAGLIO_DOCUMENTO_NO_SECURITY</name>
    <value>
      SELECT   /*+ NO_INDEX(A INDX_PROFILE41) */
      a.system_id,
      a.docnumber,
      a.docname,
      a.status,
      a.docserver_loc,
      a.PATH,
      @creationDate@ AS creation_date,
      @creationTime@ as creation_time,
      a.id_registro,
      a.cha_tipo_proto,
      a.id_oggetto,
      a.num_proto,
      a.num_anno_proto,
      a.var_proto_eme,
      @dta_proto_eme@ as dta_proto_eme,
      a.cha_assegnato,
      a.var_cognome_eme,
      a.var_nome_eme,
      a.id_parent,
      @dta_proto@ as dta_proto,
      a.cha_mod_oggetto,
      a.cha_mod_mitt_dest,
      a.cha_mod_mitt_int,
      a.var_proto_in,
      a.id_annullatore,
      a.var_aut_annulla,
      a.cha_invio_conferma,
      @dta_proto_in@ as dta_proto_in,
      @dta_annulla@ as dta_annulla,
      a.var_segnatura,
      a.cha_da_proto,
      a.var_note,
      a.cha_fascicolato,
      a.id_tipo_atto,
      a.cha_privato,
      a.cha_evidenza,
      a.var_prof_oggetto AS var_desc_oggetto,
      a.id_people_prot,
      a.id_ruolo_prot,
      a.id_uo_prot,
      '255' as accessrights,
      d.type_id,
      d.description,
      d.system_id AS sys_doctypes,
      a.author,
      a.id_ruolo_creatore,
      a.id_uo_creatore,
      a.cha_interop,
      a.dta_scadenza,
      a.cha_personale,
      a.cha_in_cestino,
      a.id_documento_principale,
      a.prot_tit,
      a.num_in_fasc,
      a.id_fasc_prot_tit,
      a.num_prot_tit,
      a.id_titolario,
      a.cha_riff_mitt,
      a.id_people_delegato,
      a.CHA_DOCUMENTO_DA_PEC,
      a.LAST_FORWARD,
      a.PRINTS_NUM,
      a.CHA_COD_T_A,
      a.COD_EXT_APP,
      A.MIS_OBIETTIVO,
      A.ID_OBIETTIVO,
      A.FASE,
      A.ID_TIPO_COMUNICAZIONE,
      <!--GIORDANO IACOZZILLI Gestione dell'icona della copia del docuemnto/fascicolo in deposito.-->
      A.CHA_IN_ARCHIVIO,
      <!--**************************************  FINE  ******************************************-->
      A.ID_CENTRO_DI_COSTO,
      a.IN_LIBROFIRMA
      FROM PROFILE a WITH(NOLOCK),
      DOCUMENTTYPES d
      WHERE @docNumber@ and
      a.documenttype=d.system_id
    </value>
  </query>
  <query>
    <name>RDE_UNLOCK_USER_LOGIN</name>
    <value>
      DELETE FROM DPA_LOGIN WHERE USER_ID = '@param1@'
    </value>
  </query>
  <query>
    <name>S_DOCACQUISITO</name>
    <value>
      SELECT VAR_IMPRONTA, VERSION_ID FROM COMPONENTS WHERE DOCNUMBER=@param1@ AND VERSION_ID=@param2@
    </value>
  </query>
  <query>
    <name>AMM_S_UO_SMISTAMENTO</name>
    <value>
      SELECT
      a.system_id as idCorrGlob, a.num_livello as livello, a.var_desc_corr as descrizione,
      (select case when count(*) > 0 then 1 else 0 end from DPA_UO_SMISTAMENTO c where c.id_uo = a.system_id AND c.id_registro = @param1@) AS attivo
      FROM DPA_CORR_GLOBALI a, DPA_UO_REG b
      WHERE b.id_uo = a.system_id
      AND b.id_registro = @param1@
    </value>
  </query>
  <query>
    <name>AMM_D_UO_SMISTAMENTO</name>
    <value>
      DELETE FROM DPA_UO_SMISTAMENTO
      WHERE id_uo = @param1@ AND
      id_registro = @param2@
    </value>
  </query>
  <query>
    <name>AMM_I_UO_SMISTAMENTO</name>
    <value>
      INSERT INTO DPA_UO_SMISTAMENTO
      (@param1@ ID_UO, ID_REGISTRO)
      VALUES
      (@param2@ @param3@, @param4@)
    </value>
  </query>
  <query>
    <name>AMM_S_COUNT_UO_SMISTAMENTO</name>
    <value>
      SELECT COUNT(*) AS TOT
      FROM DPA_UO_SMISTAMENTO
      WHERE ID_UO = @param1@ AND
      ID_REGISTRO = @param2@
    </value>
  </query>
  <query>
    <name>S_GET_UO_IN_AOO_WITH_REG</name>
    <value>
      SELECT DISTINCT VAR_COD_RUBRICA FROM DPA_CORR_GLOBALI A, DPA_UO_REG B
      WHERE B.ID_UO = A.SYSTEM_ID AND A.ID_AMM = @param1@
      ORDER BY VAR_COD_RUBRICA
    </value>
  </query>
  <query>
    <name>DOC_DELETE_VERSION_COMPONENTS</name>
    <value>
      DELETE FROM COMPONENTS
      WHERE
      VERSION_ID = @version_id@
      AND
      DOCNUMBER = @docNumber@
    </value>
  </query>
  <query>
    <name>DOC_DELETE_VERSION_VERSIONS</name>
    <value>
      DELETE FROM VERSIONS
      WHERE
      VERSION_ID = @version_id@
      AND
      DOCNUMBER = @docNumber@
    </value>
  </query>
  <query>
    <name>S_AMM_GET_CURRENT_UO</name>
    <value>
      SELECT
      var_codice AS Codice,
      var_cod_rubrica AS CodiceRubrica,
      var_desc_corr AS Descrizione,
      id_amm AS IDAmministrazione,
      num_livello AS Livello,
      id_parent AS IDParent,
      var_codice_aoo AS CodiceRegistroInterop,
      (SELECT
      COUNT(*)
      FROM
      DPA_CORR_GLOBALI c
      WHERE
      c.cha_tipo_urp = 'R'
      AND c.cha_tipo_ie = 'I'
      AND c.dta_fine IS NULL
      AND c.id_uo = a.system_id) AS Ruoli,
      (SELECT
      COUNT(*)
      FROM
      DPA_CORR_GLOBALI b
      WHERE b.cha_tipo_urp = 'U'
      AND b.cha_tipo_ie = 'I'
      AND b.id_parent = a.system_id
      AND b.dta_fine IS NULL
      ) AS SottoUo,
      classifica_uo AS ClassificaUo
      FROM
      DPA_CORR_GLOBALI a
      WHERE a.cha_tipo_urp = 'U'
      AND a.cha_tipo_ie = 'I'
      AND a.dta_fine IS NULL
      AND a.system_id = @param1@
      ORDER BY var_desc_corr asc
    </value>
  </query>
  <query>
    <name>S_GET_FASCICOLO_BY_SYSTEM_ID</name>
    <value>
      SELECT DISTINCT
      A.SYSTEM_ID,
      A.DESCRIPTION,
      A.CHA_TIPO_PROJ,
      A.VAR_CODICE,
      A.ID_AMM,
      A.NUM_LIVELLO,
      A.CHA_TIPO_FASCICOLO,
      A.ID_FASCICOLO,
      A.ID_PARENT,
      A.VAR_COD_ULTIMO,
      A.VAR_NOTE,
      @dataApertura@ AS DTA_APERTURA,
      @dataChiusura@ AS DTA_CHIUSURA,
      A.CHA_STATO,
      A.ID_TIPO_PROC,
      A.ID_REGISTRO,
      A.ID_UO_LF,
      A.DTA_UO_LF,
      A.DTA_CREAZIONE,
      B.ACCESSRIGHTS,
      A.CARTACEO,
      A.NUM_FASCICOLO,
      A.ID_TITOLARIO,
      A.AUTHOR, A.ID_RUOLO_CREATORE, A.ID_UO_CREATORE,
      A.DTA_SCADENZA
      FROM	PROJECT A,
      SECURITY as B  WITH (nolock)
      WHERE	A.SYSTEM_ID=@systemID@ AND
      A.SYSTEM_ID=B.THING AND
      (A.ID_AMM IS NULL OR A.ID_AMM = @idAmministrazione@ ) AND
      (B.PERSONORGROUP=@idGruppo@ OR B.PERSONORGROUP=@idPeople@ ) AND
      B.ACCESSRIGHTS > 0 AND A.CHA_TIPO_PROJ = 'F'
      and (@dbuser@.checkVisibilitaArchivio('F', A.SYSTEM_ID, @idGruppo@) > 0)
    </value>
  </query>
  <query>
    <name>S_PROFILE_DATI_PROTO</name>
    <value>
      SELECT
      A.NUM_PROTO,
      A.DTA_PROTO,
      A.NUM_ANNO_PROTO,
      A.ID_REGISTRO,
      A.DTA_ANNULLA,
      A.VAR_AUT_ANNULLA
      FROM PROFILE A WITH(NOLOCK)
      WHERE A.SYSTEM_ID = @param1@
    </value>
  </query>
  <query>
    <name>S_PeopleP</name>
    <value>
      SELECT @param1@
      FROM PEOPLE
      WHERE SYSTEM_ID = @param2@
    </value>
  </query>
  <query>
    <name>S_DPA_TRASM_SyIDTrRic</name>
    <value>
      SELECT /*+index(c) index(b) index(a) */
      @param1@
      FROM @param2@
      WHERE @param3@
      ORDER BY @orderCondition@, c.system_id desc
    </value>
  </query>
  <query>
    <name>S_DPA_LOGIN_D</name>
    <value>
      SELECT @param2@
      FROM DPA_LOGIN
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>S_SECURITY_GENERIC</name>
    <value>
      SELECT @param1@
      FROM SECURITY  WITH (nolock)
      @param2@
    </value>
  </query>
  <query>
    <name>S_DELETED_SECURITY</name>
    <value>
      SELECT @param1@
      FROM DELETED_SECURITY
      @param2@
    </value>
  </query>
  <query>
    <name>U_PROJECT_3_PARAMS</name>
    <value>
      UPDATE PROJECT
      SET VAR_COD_ULTIMO = '@param1@',
      VAR_CHIAVE_FASC = '@params2@'
      WHERE SYSTEM_ID = @param3@
    </value>
  </query>
  <query>
    <name>CHECKINOUT_GET_LAST_VERSION_DATA</name>
    <value>
      SELECT 	C.PATH,
      C.FILE_SIZE,
      C.VAR_IMPRONTA,
      C.VERSION_ID,
      C.DOCNUMBER,
      V.VERSION,
      V.SUBVERSION,
      V.VERSION_LABEL
      FROM 	COMPONENTS C,
      VERSIONS V
      WHERE 	C.VERSION_ID =
      (
      SELECT MAX(VERSION_ID)
      FROM VERSIONS
      WHERE DOCNUMBER =(SELECT P.DOCNUMBER FROM PROFILE P WITH(NOLOCK) WHERE P.SYSTEM_ID = @idDocument@)
      AND VERSION NOT IN (0)
      )
      AND C.VERSION_ID=V.VERSION_ID
    </value>
  </query>
  <query>
    <name>CHECKINOUT_GET_DOCUMENT_STATUS</name>
    <value>
      SELECT  C.SYSTEM_ID,
      C.ID_DOCUMENT,
      C.DOCUMENT_NUMBER,
      PR.VAR_SEGNATURA,
      C.ID_USER,
      P.USER_ID AS USER_NAME,
      C.ID_ROLE,
      PR.ID_DOCUMENTO_PRINCIPALE,
      CG.VAR_DESC_CORR AS ROLE_NAME,
      C.CHECK_OUT_DATE,
      C.DOCUMENT_LOCATION,
      C.MACHINE_NAME
      FROM     DPA_CHECKIN_CHECKOUT C
      LEFT JOIN PEOPLE P ON C.ID_USER=P.SYSTEM_ID
      LEFT JOIN DPA_CORR_GLOBALI CG ON CG.SYSTEM_ID=C.ID_ROLE
      LEFT JOIN PROFILE PR ON C.ID_DOCUMENT=PR.SYSTEM_ID
      WHERE	C.ID_DOCUMENT=@idDocument@ AND C.ID_USER=P.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>CHECKINOUT_CHECKOUT_DOCUMENT</name>
    <value>
      INSERT INTO DPA_CHECKIN_CHECKOUT
      (
      @colId@
      ID_DOCUMENT,
      DOCUMENT_NUMBER,
      ID_USER,
      ID_ROLE,
      CHECK_OUT_DATE,
      DOCUMENT_LOCATION,
      MACHINE_NAME
      )
      VALUES
      (
      @id@
      @idDocument@,
      @documentNumber@,
      @idUser@,
      @idRole@,
      @checkOutDate@,
      '@documentLocation@',
      '@machineName@'
      )
    </value>
  </query>
  <query>
    <name>CHECKINOUT_CHECKIN_DOCUMENT</name>
    <value>
      DELETE
      FROM DPA_CHECKIN_CHECKOUT
      WHERE SYSTEM_ID=@id@
    </value>
  </query>
  <query>
    <name>CHECKINOUT_UNDO_CHECKOUT_DOCUMENT</name>
    <value>
      DELETE
      FROM DPA_CHECKIN_CHECKOUT
      WHERE SYSTEM_ID=@id@
    </value>
  </query>
  <query>
    <name>CHECKINOUT_IS_CHECKOUT_DOCUMENT</name>
    <value>
      SELECT  C.SYSTEM_ID,
      C.ID_DOCUMENT,
      C.DOCUMENT_NUMBER,
      PR.VAR_SEGNATURA,
      C.ID_USER,
      P.USER_ID AS USER_NAME,
      C.ID_ROLE,
      PR.ID_DOCUMENTO_PRINCIPALE,
      CG.VAR_DESC_CORR AS ROLE_NAME,
      C.CHECK_OUT_DATE,
      C.DOCUMENT_LOCATION,
      C.MACHINE_NAME
      FROM     DPA_CHECKIN_CHECKOUT C WITH(NOLOCK)
      LEFT JOIN PEOPLE P WITH(NOLOCK) ON C.ID_USER=P.SYSTEM_ID
      LEFT JOIN DPA_CORR_GLOBALI CG WITH(NOLOCK) ON CG.SYSTEM_ID=C.ID_ROLE
      LEFT JOIN PROFILE PR WITH(NOLOCK) ON C.ID_DOCUMENT=PR.SYSTEM_ID
      WHERE	C.ID_DOCUMENT=@idDocument@ AND C.DOCUMENT_NUMBER=@documentNumber@
    </value>
  </query>
  <query>
    <name>CHECKINOUT_IS_OWNER_CHECKED_OUT</name>
    <value>
      SELECT	COUNT(SYSTEM_ID)
      FROM	DPA_CHECKIN_CHECKOUT
      WHERE	ID_DOCUMENT=@idDocument@ AND
      DOCUMENT_NUMBER=@documentNumber@ AND
      ID_USER='@idUser@'
    </value>
  </query>
  <query>
    <name>CHECKINOUT_GET_CHECKED_OUT_DOCUMENTS</name>
    <value>
      SELECT  	C.SYSTEM_ID AS ID_STATUS,
      C.ID_DOCUMENT AS ID_DOCUMENT,
      C.DOCUMENT_NUMBER AS DOCUMENT_NUMBER,
      PR.VAR_SEGNATURA,
      C.ID_USER,
      P.USER_ID AS USER_NAME,
      C.ID_ROLE,
      PR.ID_DOCUMENTO_PRINCIPALE,
      CG.VAR_DESC_CORR AS ROLE_NAME,
      C.CHECK_OUT_DATE AS CHECK_OUT_DATE,
      C.DOCUMENT_LOCATION AS DOCUMENT_LOCATION,
      C.MACHINE_NAME AS MACHINE_NAME
      FROM     DPA_CHECKIN_CHECKOUT C
      LEFT JOIN PEOPLE P ON C.ID_USER=P.SYSTEM_ID
      LEFT JOIN DPA_CORR_GLOBALI CG ON CG.SYSTEM_ID=C.ID_ROLE
      LEFT JOIN PROFILE PR ON C.ID_DOCUMENT=PR.SYSTEM_ID
      WHERE	 P.ID_AMM=@idAmm@
      ORDER BY	C.CHECK_OUT_DATE DESC
    </value>
  </query>
  <query>
    <name>CHECKINOUT_GET_CHECKED_OUT_DOCUMENTS_USER</name>
    <value>
      SELECT  	C.SYSTEM_ID AS ID_STATUS,
      C.ID_DOCUMENT AS ID_DOCUMENT,
      C.DOCUMENT_NUMBER AS DOCUMENT_NUMBER,
      PR.VAR_SEGNATURA,
      C.ID_USER,
      P.USER_ID AS USER_NAME,
      C.ID_ROLE,
      PR.ID_DOCUMENTO_PRINCIPALE,
      CG.VAR_DESC_CORR AS ROLE_NAME,
      C.CHECK_OUT_DATE AS CHECK_OUT_DATE,
      C.DOCUMENT_LOCATION AS DOCUMENT_LOCATION,
      C.MACHINE_NAME AS MACHINE_NAME
      FROM     DPA_CHECKIN_CHECKOUT C
      LEFT JOIN PEOPLE P ON C.ID_USER=P.SYSTEM_ID
      LEFT JOIN DPA_CORR_GLOBALI CG ON CG.SYSTEM_ID=C.ID_ROLE
      LEFT JOIN PROFILE PR ON C.ID_DOCUMENT=PR.SYSTEM_ID
      WHERE		C.ID_USER=@idUser@ AND
      P.ID_AMM=@idAmm@
      ORDER BY	C.CHECK_OUT_DATE DESC
    </value>
  </query>
  <query>
    <name>CHECKINOUT_IS_ADMIN_USER</name>
    <value>
      SELECT COUNT(SYSTEM_ID)
      FROM PEOPLE
      WHERE CHA_AMMINISTRATORE='1' AND SYSTEM_ID='@idUser@'
    </value>
  </query>
  <query>
    <name>CHECKINOUT_FORCE_UNDO_CHECKOUT_DOCUMENT</name>
    <value>
      DELETE
      FROM DPA_CHECKIN_CHECKOUT
      WHERE SYSTEM_ID=@id@
    </value>
  </query>
  <query>
    <name>CHECKINOUT_HUMMY_GET_DOCUMENT_STATUS</name>
    <value>
      SELECT 		C.SYSTEM_ID AS SYSTEM_ID,
      C.DOCNUMBER AS DOCUMENT_NUMBER,
      PR.VAR_SEGNATURA,
      C.TYPIST AS ID_USER,
      P.USER_ID AS USER_NAME,
      C.CHECKOUT_TIME AS CHECK_OUT_DATE,
      LOCATION AS DOCUMENT_LOCATION
      FROM		CHECKOUT C,
      PEOPLE P,
      PROFILE PR
      WHERE		C.DOCNUMBER=@documentNumber@ AND
      C.TYPIST=P.SYSTEM_ID AND
      C.DOCNUMBER=PR.DOCNUMBER
    </value>
  </query>
  <query>
    <name>CHECKINOUT_HUMMY_IS_OWNER_CHECKED_OUT</name>
    <value>
      SELECT	COUNT(SYSTEM_ID)
      FROM	CHECKOUT
      WHERE	DOCNUMBER=@documentNumber@ AND
      TYPIST=@idUser@
    </value>
  </query>
  <query>
    <name>CHECKINOUT_HUMMY_IS_CHECKED_OUT</name>
    <value>
      SELECT 		C.SYSTEM_ID AS SYSTEM_ID,
      C.DOCNUMBER AS DOCUMENT_NUMBER,
      PR.VAR_SEGNATURA,
      C.TYPIST AS ID_USER,
      P.USER_ID AS USER_NAME,
      C.CHECKOUT_TIME AS CHECK_OUT_DATE,
      C.LOCATION AS DOCUMENT_LOCATION
      FROM		CHECKOUT C,
      PEOPLE P,
      PROFILE PR
      WHERE		C.DOCNUMBER=@documentNumber@ AND
      C.TYPIST=P.SYSTEM_ID AND
      C.DOCNUMBER=PR.DOCNUMBER
    </value>
  </query>
  <query>
    <name>S_DPA_SALVA_RICERCHE_LIST</name>
    <value>
      select sr.SYSTEM_ID, sr.VAR_DESCRIZIONE
      from DPA_SALVA_RICERCHE sr, PEOPLE p
      where sr.VAR_PAGINA_RIC=@param1@
      and sr.ID_PEOPLE=@param2@
      and sr.ID_PEOPLE=p.SYSTEM_ID
      @param4@
      @param5@
      union
      select sr.SYSTEM_ID, sr.VAR_DESCRIZIONE
      from DPA_SALVA_RICERCHE sr, GROUPS g
      where sr.VAR_PAGINA_RIC=@param1@
      and sr.ID_GRUPPO=@param3@
      and sr.ID_GRUPPO=g.SYSTEM_ID
      @param4@
      @param5@
      order by VAR_DESCRIZIONE
    </value>
  </query>
  <query>
    <name>S_DPA_SALVA_RICERCHE_LIST_NOPAGE</name>
    <value>
      select sr.SYSTEM_ID, sr.VAR_DESCRIZIONE
      from DPA_SALVA_RICERCHE sr, PEOPLE p
      where sr.ID_PEOPLE=@param2@
      and sr.ID_PEOPLE=p.SYSTEM_ID
      @param4@
      @param5@
      union
      select sr.SYSTEM_ID, sr.VAR_DESCRIZIONE
      from DPA_SALVA_RICERCHE sr, GROUPS g
      where sr.ID_GRUPPO=@param3@
      and sr.ID_GRUPPO=g.SYSTEM_ID
      @param4@
      @param5@
      order by VAR_DESCRIZIONE
    </value>
  </query>
  <query>
    <name>S_DPA_SALVA_RICERCHE_ID</name>
    <value>
      select SYSTEM_ID, VAR_DESCRIZIONE, ID_PEOPLE, ID_GRUPPO, VAR_PAGINA_RIC, TIPO, GRID_ID
      from DPA_SALVA_RICERCHE
      where SYSTEM_ID=@param1@
    </value>
  </query>
  <query>
    <name>S_DPA_SALVA_RICERCHE_COUNT</name>
    <value>
      select count(*)
      from DPA_SALVA_RICERCHE
      where VAR_DESCRIZIONE=@param1@
      and (ID_PEOPLE=@param2@ OR ID_GRUPPO=@param3@)
      and TIPO = '@param4@'
    </value>
  </query>
  <query>
    <name>D_DPA_SALVA_RICERCHE_ID</name>
    <value>
      delete from DPA_SALVA_RICERCHE
      where SYSTEM_ID=@param1@
    </value>
  </query>
  <query>
    <name>I_DPA_SALVA_RICERCHE</name>
    <value>
      insert into DPA_SALVA_RICERCHE (VAR_DESCRIZIONE, ID_PEOPLE, ID_GRUPPO, VAR_PAGINA_RIC, VAR_FILTRI_RIC,CHA_IN_ADL,TIPO,GRID_ID)
      values (@param2@, @param3@, @param4@, @param5@, null,@param6@,'@param7@',@param8@)
    </value>
  </query>
  <query>
    <name>CHECKINOUT_HUMMY_GET_CHECKED_OUT_DOCUMENTS</name>
    <value>
      SELECT  	C.SYSTEM_ID AS ID_STATUS,
      PR.SYSTEM_ID AS ID_DOCUMENT,
      C.DOCNUMBER AS DOCUMENT_NUMBER,
      PR.VAR_SEGNATURA,
      P.USER_ID AS USER_ID,
      C.CHECKOUT_TIME AS CHECK_OUT_DATE,
      C.LOCATION AS DOCUMENT_LOCATION
      FROM		CHECKOUT C,
      PEOPLE P,
      PROFILE PR
      WHERE		C.TYPIST=P.SYSTEM_ID AND
      PR.DOCNUMBER=C.DOCNUMBER AND
      P.ID_AMM=@idAmm@
      ORDER BY	C.CHECKOUT_DATE DESC
    </value>
  </query>
  <query>
    <name>CHECKINOUT_HUMMY_GET_CHECKED_OUT_DOCUMENTS_USER</name>
    <value>
      SELECT  	C.SYSTEM_ID AS ID_STATUS,
      PR.SYSTEM_ID AS ID_DOCUMENT,
      C.DOCNUMBER AS DOCUMENT_NUMBER,
      PR.VAR_SEGNATURA,
      P.USER_ID AS USER_ID,
      C.CHECKOUT_TIME AS CHECK_OUT_DATE,
      C.LOCATION AS DOCUMENT_LOCATION
      FROM		CHECKOUT C,
      PEOPLE P,
      PROFILE PR
      WHERE		C.TYPIST=P.SYSTEM_ID AND
      PR.DOCNUMBER=C.DOCNUMBER AND
      C.TYPIST=@idUser@  AND
      P.ID_AMM=@idAmm@
      ORDER BY	C.CHECKOUT_DATE DESC
    </value>
  </query>
  <query>
    <name>S_PATH_MODELLO</name>
    <value>
      SELECT
      PATH_MOD_@numeroModello@ as PATH
      FROM DPA_TIPO_ATTO
      WHERE SYSTEM_ID IN
      (SELECT ID_TIPO_ATTO
      FROM PROFILE WITH(NOLOCK)
      WHERE DOCNUMBER = @docNumber@)
    </value>
  </query>
  <query>
    <name>S_PATH_MODELLO_ALLEGATO</name>
    <value>
      SELECT
      PATH_ALL_@numeroModello@ as PATH
      FROM DPA_TIPO_ATTO
      WHERE SYSTEM_ID IN
      (SELECT ID_TIPO_ATTO
      FROM PROFILE WITH(NOLOCK)
      WHERE DOCNUMBER = @docNumber@)
    </value>
  </query>
  <query>
    <name>I_PROJECT_ET</name>
    <value>
      INSERT INTO PROJECT
      (
      @colID@
      @param1@
      )
      VALUES
      (
      @id@
      @param2@
      )
    </value>
  </query>
  <query>
    <name>S_OGGETTI_MODELLO</name>
    <value>
      SELECT
      b.descrizione AS chiave, a.VALORE_OGGETTO_DB AS valore, e.descrizione,
      b.FORMATO_CONTATORE as FORMATO_CONTATORE
      ,a.anno as ANNO,a.id_aoo_rf as AOO_RF
      FROM
      DPA_ASSOCIAZIONE_TEMPLATES a, DPA_OGGETTI_CUSTOM b, DPA_TIPO_ATTO c,
      DPA_OGGETTI_CUSTOM d, DPA_TIPO_OGGETTO e
      WHERE
      a.DOC_NUMBER = @docNumber@
      AND a.id_template = c.system_id
      AND a.id_oggetto = b.system_id
      AND c.ABILITATO_SI_NO = 1
      AND a.id_oggetto = d.system_id
      AND d.id_tipo_oggetto = e.system_id
      AND c.IN_ESERCIZIO = 'si'
    </value>
  </query>
  <query>
    <name>VIS_RUOLO_NODO_TIT</name>
    <value>
      SELECT COUNT(*) FROM SECURITY   WHERE
      (ACCESSRIGHTS) > 0 AND
      (PERSONORGROUP= @param1@ OR PERSONORGROUP= @param2@)
      AND THING = @param3@
    </value>
  </query>
  <query>
    <name>PD_GET_SCADENZE</name>
    <value>
      SELECT * FROM DPA_TIPO_ATTO
      WHERE
      DPA_TIPO_ATTO.SYSTEM_ID = @idTipoAtto@
    </value>
  </query>
  <query>
    <name>PD_GET_ID_TEMPLATE</name>
    <value>
      SELECT ID_TIPO_ATTO as ID_TEMPLATE FROM PROFILE WITH(NOLOCK)
      WHERE DOCNUMBER = @docNumber@
    </value>
  </query>
  <query>
    <name>S_GET_COUNT_CLASSIFICAZIONI_DOCUMENTO</name>
    <value>
      SELECT  COUNT(DISTINCT(A.SYSTEM_ID))
      FROM 	PROJECT A,
      SECURITY as C
      WHERE 	A.CHA_TIPO_PROJ = 'F'
      AND A.SYSTEM_ID IN
      (SELECT A.ID_FASCICOLO
      FROM PROJECT A, PROJECT_COMPONENTS B
      WHERE A.SYSTEM_ID=B.PROJECT_ID AND B.LINK=@idProfile@)
      AND A.SYSTEM_ID=C.THING AND (C.PERSONORGROUP=@idPeople@
      OR C.PERSONORGROUP = @idGroup@ OR C.PERSONORGROUP =@idRuoloPubblico@)
      AND C.ACCESSRIGHTS >= 0
    </value>
  </query>
  <query>
    <name>S_FN_GET_FOLDER_CUSTOM</name>
    <value>
      select top 1 (co_key) from custom where co_string1 =
      (select top 1 (co_key) from custom
      where datepart (year,co_date) = YEAR(getdate())
      and co_string2 =  cast (YEAR(getdate()) as varchar) order by (co_key) asc)
      and (datepart (MONTH,co_date) = MONTH(getdate()))
      and co_string2 = cast(MONTH(getdate()) as varchar)
      order by (co_key) asc
    </value>
  </query>
  <query>
    <name>S_FN_GET_YEAR_FOLDER_CUSTOM</name>
    <value>
      select top 1 (co_key) from custom
      where datepart (year,co_date) = YEAR(getdate())
      and co_string2 =  cast (YEAR(getdate()) as varchar) order by (co_key) asc
    </value>
  </query>
  <query>
    <name>S_FN_GET_MONTH_FOLDER_CUSTOM</name>
    <VALUE>
      select top 1 (co_key) from custom
      WHERE CO_STRING1 = '@yearFolderKey@'
      and (datepart (MONTH,co_date) = MONTH(getdate()))
      and co_string2 = cast(MONTH(getdate()) as varchar)
      order by (co_key) asc
    </VALUE>
  </query>
  <query>
    <name>S_FN_GET_ORIGINAL_FILE_NAME</name>
    <value>
      select v_file_name from version where v_stack_file_id = '@FN_NAME@'
    </value>
  </query>
  <query>
    <name>S_GET_DOCNUMBER</name>
    <value>
      SELECT	P.DOCNUMBER
      FROM	PROFILE P,
      DPA_EL_REGISTRI R
      WHERE	P.ID_REGISTRO=R.SYSTEM_ID AND
      R.ID_AMM = @idAmministrazione@ AND
      R.VAR_CODICE='@registroProtocollo@' AND
      P.NUM_PROTO=@protocollo@ AND
      P.NUM_ANNO_PROTO=@annoProtocollo@
    </value>
  </query>
  <query>
    <name>GET_LAST_VERSION_ALLEGATO</name>
    <value>
      SELECT  MAX	( CONVERT(int, SUBSTRING(C.VERSION_LABEL,2,LEN(C.VERSION_LABEL))) ) AS VERSION_INDEX
      FROM 	PROFILE A,
      COMPONENTS B,
      VERSIONS C
      WHERE	A.DOCNUMBER = B.DOCNUMBER
      AND B.VERSION_ID = C.VERSION_ID
      AND C.VERSION = 0
      AND A.DOCNUMBER = @docNumber@
      ORDER BY VERSION_INDEX DESC
    </value>
  </query>
  <query>
    <name>S_NOME_AMM_DA_PEOPLE</name>
    <value>
      SELECT a.var_desc_amm
      FROM DPA_AMMINISTRA a, PEOPLE b
      WHERE a.system_id = b.id_amm
      AND b.system_id = @param1@
    </value>
  </query>
  <query>
    <name>PR_DO_GET_AMMINISTRAZIONI</name>
    <value>SELECT SYSTEM_ID,VAR_CODICE_AMM,VAR_DESC_AMM,VAR_LIBRERIA FROM DPA_AMMINISTRA</value>
  </query>
  <query>
    <name>PR_DO_GET_REGISTRI_BY_AMM</name>
    <value>
      SELECT SYSTEM_ID,VAR_CODICE,VAR_DESC_REGISTRO FROM DPA_EL_REGISTRI
      WHERE ID_AMM = @IDAMM@
    </value>
  </query>
  <query>
    <name>PR_DO_GET_DATI_AMMINSTRAZIONE_BY_COD</name>
    <value>SELECT VAR_DESC_AMM,VAR_CODICE_AMM FROM DPA_AMMINISTRA WHERE SYSTEM_ID = @IDAMM@</value>
  </query>
  <query>
    <name>PR_DO_GET_COD_AMM_BY_DESC_AMM</name>
    <value>SELECT SYSTEM_ID FROM DPA_AMMINISTRA WHERE VAR_CODICE_AMM='@CODAMM@'</value>
  </query>
  <query>
    <name>PR_DO_GET_ANNI_PROFILAZIONE_BY_REG</name>
    <value>select distinct(year(CREATION_DATE)) AS Anno from profile WITH(NOLOCK) where id_registro = @IDREG@</value>
  </query>
  <query>
    <name>PR_DO_GET_SEDI</name>
    <value>SELECT DISTINCT (VAR_SEDE) AS SEDE FROM PROFILE WITH(NOLOCK) WHERE VAR_SEDE IS NOT NULL AND VAR_SEDE &lt;&gt; ' '</value>
  </query>
  <query>
    <name>PR_DO_GET_DATI_REGISTRO_BY_ID_REG</name>
    <value>SELECT VAR_DESC_REGISTRO FROM DPA_EL_REGISTRI WHERE SYSTEM_ID=@IDREG@</value>
  </query>
  <query>
    <name>S_CONTA_TRASM_TDL_OLTRE_GG_AVVISO</name>
    <value>
      SELECT
      COUNT(d.ID_TRASMISSIONE)
      FROM dpa_todolist d
      WHERE (
      (   d.id_people_dest = @param2@ AND d.id_ruolo_dest = 0
      OR d.id_ruolo_dest = @param1@ AND d.id_people_dest = @param2@
      )
      AND
      DATEDIFF(DAY,d.DTA_INVIO,GETDATE()) &gt; @param5@
      )
    </value>
  </query>
  <query>
    <name>U_TDL_OLTRE_GG_AVVISO</name>
    <value>
      UPDATE DPA_TRASM_UTENTE SET CHA_IN_TODOLIST = '0', DTA_RIMOZIONE_TODOLIST = GETDATE()
      WHERE ID_TRASM_SINGOLA IN (
      SELECT B.SYSTEM_ID
      FROM DPA_TRASMISSIONE A, DPA_TRASM_SINGOLA B, DPA_TRASM_UTENTE C
      WHERE A.SYSTEM_ID=B.ID_TRASMISSIONE AND
      B.SYSTEM_ID=C.ID_TRASM_SINGOLA AND
      A.DTA_INVIO IS NOT NULL AND
      ((B.ID_CORR_GLOBALE = @param1@ AND C.ID_PEOPLE = @param2@) OR B.ID_CORR_GLOBALE = @param3@) AND
      C.CHA_IN_TODOLIST = '1' AND
      A.DTA_INVIO &lt; @param5@
      ) AND ID_PEOPLE = @param2@ @paramTrasm@
    </value>
  </query>
  <query>
    <name>U_TDL_OLTRE_GG_AVVISO_NO_WF</name>
    <value>
      UPDATE DPA_TRASM_UTENTE SET CHA_IN_TODOLIST = '0', DTA_RIMOZIONE_TODOLIST = GETDATE()
      WHERE ID_TRASM_SINGOLA IN (
      SELECT B.SYSTEM_ID
      FROM DPA_TRASMISSIONE A, DPA_TRASM_SINGOLA B, DPA_TRASM_UTENTE C, DPA_RAGIONE_TRASM D
      WHERE A.SYSTEM_ID=B.ID_TRASMISSIONE AND
      B.SYSTEM_ID=C.ID_TRASM_SINGOLA AND
      B.ID_RAGIONE=D.SYSTEM_ID AND
      D.CHA_TIPO_RAGIONE NOT IN ('W') AND
      A.DTA_INVIO IS NOT NULL AND
      ((B.ID_CORR_GLOBALE = @param1@ AND C.ID_PEOPLE = @param2@) OR B.ID_CORR_GLOBALE = @param3@) AND
      C.CHA_IN_TODOLIST = '1' AND
      A.DTA_INVIO &lt; @param5@
      ) AND ID_PEOPLE = @param2@ @paramTrasm@
    </value>
  </query>
  <query>
    <name>S_DATEDIFF_FROM_DUAL</name>
    <value>
      SELECT DATEADD(DAY,-@param1@,GETDATE())
    </value>
  </query>
  <query>
    <name>S_DPA_TRASM_SyIDTrEff</name>
    <value>
      SELECT DISTINCT A.SYSTEM_ID AS ID_TRASM, ISNULL(A.DTA_INVIO,'25000101') AS DTA_INVIO, B.ID_TRASMISSIONE AS ID_TRASM_SINGOLA, B.ID_RAGIONE, G.VAR_DESC_RAGIONE as var_desc_ragione
      FROM @param2@ , DPA_RAGIONE_TRASM G
      WHERE @param3@ AND B.ID_RAGIONE = g.SYSTEM_ID
      ORDER BY @orderCondition@
    </value>
  </query>
  <query>
    <name>DO_GET_IDPROFILE_BY_DATA</name>
    <value>
      SELECT SYSTEM_ID FROM PROFILE P WITH(NOLOCK) WHERE P.ID_REGISTRO = @IDREGISTRO@
      AND P.NUM_ANNO_PROTO = @ANNOPROTO@ AND P.NUM_PROTO = @NUMPROTO@
      --and (@dbuser@.checkSecurityDocumento(P.SYSTEM_ID, @idPeople@, @idGruppo@, @idRuoloPubblico@,'D') > 0)
    </value>
  </query>
  <query>
    <name>S_DPA_STATO_INVIO_ELENCO</name>
    <value>
      SELECT a.VAR_INDIRIZZO, a.VAR_CODICE_AOO, a.VAR_CODICE_AMM,
      CONVERT(datetime,a.DTA_SPEDIZIONE,109) as DTA_SPEDIZIONE,
      b.VAR_DESC_CORR, a.ID_CORR_GLOBALE
      FROM DPA_STATO_INVIO a, DPA_CORR_GLOBALI b
      WHERE a.ID_PROFILE = @param1@
      AND a.DTA_SPEDIZIONE IS NOT NULL
      AND a.ID_CORR_GLOBALE = b.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>U_DPA_REG_FASC</name>
    <value>
      UPDATE DPA_REG_FASC SET NUM_RIF = @param1@
      WHERE ID_TITOLARIO = @param2@ AND ID_REGISTRO @param3@
    </value>
  </query>
  <query>
    <name>S_DPA_REG_FASC</name>
    <value>
      SELECT NUM_RIF FROM DPA_REG_FASC
      WITH(UPDLOCK)
      WHERE ID_TITOLARIO = @param1@ AND ID_REGISTRO @param2@

    </value>
  </query>
  <query>
    <name>U_DPATrasmUtente_setDataVista</name>
    <value>
      UPDATE DPA_TRASM_UTENTE SET
      DPA_TRASM_UTENTE.CHA_VISTA = '1',
      DPA_TRASM_UTENTE.DTA_VISTA = @dataOdierna@,
      DPA_TRASM_UTENTE.CHA_IN_TODOLIST =
      (SELECT (CASE WHEN COUNT(C.SYSTEM_ID)>0 THEN '0' ELSE ''+DPA_TRASM_UTENTE.CHA_IN_TODOLIST+'' END) AS RTN
      FROM DPA_TRASMISSIONE A,DPA_TRASM_SINGOLA B,DPA_TRASM_UTENTE C,DPA_RAGIONE_TRASM D
      WHERE A.SYSTEM_ID = B.ID_TRASMISSIONE AND
      B.SYSTEM_ID = C.ID_TRASM_SINGOLA AND
      C.CHA_VALIDA = '1' AND
      A.DTA_INVIO IS NOT NULL AND
      C.ID_PEOPLE = @idPeople@ AND
      A.@tipoObj@ = @idObj@ AND
      B.ID_RAGIONE = D.SYSTEM_ID AND
      (D.CHA_TIPO_RAGIONE = 'N' OR D.CHA_TIPO_RAGIONE = 'I') AND
      C.CHA_VISTA='0')
      WHERE DPA_TRASM_UTENTE.CHA_VISTA = '0' AND
      DPA_TRASM_UTENTE.ID_PEOPLE = @idPeople@ AND
      DPA_TRASM_UTENTE.ID_TRASM_SINGOLA IN
      (SELECT A.SYSTEM_ID
      FROM DPA_TRASM_SINGOLA A, DPA_TRASMISSIONE B
      WHERE A.ID_TRASMISSIONE = B.SYSTEM_ID AND B.@tipoObj@ = @idObj@)
    </value>
  </query>
  <query>
    <name>S_DPARegProtoForUpdate</name>
    <value>
      SELECT NUM_RIF
      FROM DPA_REG_PROTO
      WITH(UPDLOCK)
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>UPDATE_SCADENZA_PROFILE</name>
    <value>
      UPDATE PROFILE SET DTA_SCADENZA = DATEADD(DAY, @scadenza_gg@, GETDATE()) WHERE DOCNUMBER = @docNumber@
    </value>
  </query>
  <query>
    <name>UPDATE_SCADENZA_PROFILE_1</name>
    <value>
      UPDATE PROFILE SET DTA_SCADENZA = convert(datetime,'@data@',103) WHERE DOCNUMBER = @docNumber@
    </value>
  </query>
  <query>
    <name>TRASM_SCADENZE_DOC</name>
    <value>
      SELECT distinct(thing),personorgroup,profile.system_id as P_SYSTEM_ID,docnumber
      FROM
      profile,
      dpa_tipo_atto,
      security  WITH (nolock),
      people,
      dpa_stati,
      dpa_diagrammi
      WHERE
      profile.id_tipo_atto = dpa_tipo_atto.system_id
      AND
      profile.dta_scadenza = @param1@
      AND
      profile.system_id = security.thing
      AND
      people.system_id = security.personorgroup
      AND
      security.accessrights=0
      AND
      security.cha_tipo_diritto &lt;&gt; 'A'
      AND
      profile.docnumber = dpa_diagrammi.doc_number
      AND
      dpa_diagrammi.id_diagramma = dpa_stati.id_diagramma
      AND
      dpa_stati.stato_finale &lt;&gt; 1
    </value>
  </query>
  <query>
    <name>TRASM_SCADENZE_MITT</name>
    <value>
      SELECT distinct(personorgroup),thing,profile.system_id as P_SYSTEM_ID,docnumber
      FROM
      profile,
      dpa_tipo_atto,
      security  WITH (nolock) ,
      people
      WHERE
      profile.id_tipo_atto = dpa_tipo_atto.system_id
      AND
      profile.dta_scadenza = @param1@
      AND
      profile.system_id = security.thing
      AND
      security.accessrights=255
      AND
      docnumber = @docNumber@
      AND
      security.cha_tipo_diritto &lt;&gt; 'A'
    </value>
  </query>
  <query>
    <name>TRASM_SCADENZE_DEST</name>
    <value>
      select
      personorgroup,
      accessrights,
      docnumber, thing,
      cha_tipo_diritto,
      'R' as tipo
      from
      profile,
      dpa_tipo_atto,
      security  WITH (nolock),
      groups
      where
      profile.id_tipo_atto = dpa_tipo_atto.system_id
      and
      profile.dta_scadenza = @param1@
      and
      profile.system_id = security.thing
      and
      security.accessrights > 0
      and
      docnumber = @docNumber@
      and
      groups.system_id = security.personorgroup
      and
      security.cha_tipo_diritto &lt;&gt; 'A'
      union
      select
      personorgroup,
      accessrights,
      docnumber, thing,
      cha_tipo_diritto,
      'P' as tipo
      from
      profile,
      dpa_tipo_atto,
      security  WITH (nolock) ,
      people
      where
      profile.id_tipo_atto = dpa_tipo_atto.system_id
      and
      profile.dta_scadenza = @param1@
      and
      profile.system_id = security.thing
      and
      security.accessrights > 0
      and
      docnumber = @docNumber@
      and
      people.system_id = security.personorgroup
      and
      security.cha_tipo_diritto &lt;&gt; 'A'
    </value>
  </query>
  <query>
    <name>AMM_D_DELETE_REGISTRO_DPA_REG_FASC</name>
    <value>
      DELETE
      FROM	DPA_REG_FASC
      WHERE	ID_REGISTRO=@idRegistro@
    </value>
  </query>
  <query>
    <name>S_GET_COUNT_ROWS_RICERCA_DOCUMENTI</name>
    <value>
      SELECT COUNT(A.SYSTEM_ID)
      FROM
      (
      SELECT distinct top @rowCount@
      A.SYSTEM_ID
      FROM    PROFILE a
      @from@
      WHERE @security@
      @filters@
      @unionStampe@
      ) as a
    </value>
  </query>
  <query>
    <name>S_RICERCA_DOCUMENTI</name>
    <value>
      SELECT TOP @pageSize@ *
      FROM
      (
      SELECT TOP @pageSize@ *
      FROM
      (
      SELECT TOP @totalRows@
      A.SYSTEM_ID,
      A.DOCNUMBER,
      A.DTA_ANNULLA,
      A.VAR_PROF_OGGETTO AS VAR_DESC_OGGETTO,
      A.ID_REGISTRO,
      A.CHA_TIPO_PROTO,
      A.CHA_EVIDENZA,
      A.NUM_ANNO_PROTO,
      convert(nvarchar (10), A.CREATION_TIME, 103) AS CREATION_DATE,
      A.NUM_PROTO,
      A.VAR_SEGNATURA,
      convert(nvarchar (10), A.DTA_PROTO, 103) AS DTA_PROTO,
      @dbuser@.getchaimg(A.DOCNUMBER) AS CHA_IMG ,
      A.CHA_PRIVATO,
      A.CHA_PERSONALE,
      @dbuser@.getInADL(A.SYSTEM_ID,'D',@idGruppo@,@idPeople@) AS IN_ADL,
      A.ID_DOCUMENTO_PRINCIPALE,
      a.id_tipo_atto as ID_TIPO_ATTO, ta.var_desc_atto as DESC_TIPO_ATTO, @dbuser@.getPeopleUserId (a.AUTHOR) as AUTHOR,
      @dbuser@.getchafirmato(A.DOCNUMBER) as CHA_FIRMATO,
      @dbuser@.getchatipofirma(A.DOCNUMBER) as CHA_TIPO_FIRMA
      FROM    PROFILE a
      LEFT JOIN dpa_tipo_atto ta on a.id_tipo_atto = ta.system_id
      @from@
      WHERE @security@
      @filters@
      ORDER BY  @order@
      ) AS A
      ORDER BY  @reverseOrder@
      ) AS A
      ORDER BY  @order@
    </value>
  </query>
  <query>
    <name>S_GET_COUNT_ROWS_RICERCA_DOCUMENTI_VELOCE</name>
    <value>
      SELECT a.SYSTEM_ID, a.codice
      FROM
      (
      SELECT distinct TOP @rowCount@
      A.SYSTEM_ID, (case when a.num_proto is not null then a.num_proto when a.num_proto is null then a.docnumber end) as codice
      FROM    PROFILE a
      WHERE @security@
      @filters@
      and isnull(dta_proto,creation_date) between    convert(datetime,'@dataInizioAnno@',103) and getdate()
      @unionStampe@
      ORDER BY A.SYSTEM_ID DESC
      ) AS A
    </value>
  </query>
  <query>
    <name>S_RICERCA_DOCUMENTI_VELOCE</name>
    <value>
      SELECT TOP @pageSize@ * FROM (
      SELECT TOP @pageSize@ * FROM (
      SELECT TOP @totalRows@
      A.SYSTEM_ID, A.DOCNUMBER, A.DTA_ANNULLA, A.VAR_PROF_OGGETTO AS VAR_DESC_OGGETTO, A.ID_REGISTRO,
      A.CHA_TIPO_PROTO, A.CHA_EVIDENZA, A.NUM_ANNO_PROTO, ISNULL(A.DTA_PROTO,A.CREATION_TIME) AS DATA,
      convert(nvarchar (10), A.CREATION_TIME, 103) AS CREATION_DATE,
      A.NUM_PROTO, A.VAR_SEGNATURA, convert(nvarchar (10), A.DTA_PROTO, 103) AS DTA_PROTO,
      docsadm.getchaimg(A.DOCNUMBER) AS CHA_IMG , A.CHA_PRIVATO, A.CHA_PERSONALE, @dbuser@.getInADL(A.SYSTEM_ID,'D',@idGruppo@,@idPeople@) AS IN_ADL,
      a.id_tipo_atto as ID_TIPO_ATTO, ta.var_desc_atto as DESC_TIPO_ATTO, @dbuser@.getPeopleUserId (a.AUTHOR) as AUTHOR, @dbuser@.getchafirmato(A.DOCNUMBER) as CHA_FIRMATO,
      @dbuser@.getchatipofirma(A.DOCNUMBER) as CHA_TIPO_FIRMA
      FROM PROFILE a WITH(NOLOCK)
      LEFT JOIN dpa_tipo_atto ta on a.id_tipo_atto = ta.system_id
      WHERE @security@
      @filters@
      isnull(dta_proto,creation_date) between    DATEADD(mm, -1,getdate()) and getdate()
      ORDER BY @order@
      ) AS A ORDER BY @reverseOrder@
      ) AS A ORDER BY @order@
    </value>
  </query>
  <query>
    <name>S_REGISTRO_RUOLO</name>
    <value>
      SELECT id_registro FROM DPA_L_RUOLO_REG WHERE ID_RUOLO_IN_UO = @param1@ AND dta_fine IS NULL
    </value>
  </query>
  <query>
    <name>S_SMISTADOC_GET_LIST_DOCUMENTI_TRASMESSI_FILTERS</name>
    <value>
      SELECT
      E.SYSTEM_ID AS SYSTEM_ID,
      D.CHA_TIPO_RAGIONE AS TIPO_RAGIONE,
      A.SYSTEM_ID AS ID_TRASMISSIONE,
      B.SYSTEM_ID AS ID_TRASMISSIONE_SINGOLA,
      C.SYSTEM_ID AS ID_TRASMISSIONE_UTENTE,
      A.VAR_NOTE_GENERALI AS NOTE_GENERALI
      FROM
      DPA_TRASMISSIONE A,
      DPA_TRASM_SINGOLA B,
      DPA_TRASM_UTENTE C,
      DPA_RAGIONE_TRASM D,
      PROFILE E
      @queryFrom@
      WHERE
      A.ID_PROFILE=E.SYSTEM_ID and
      A.SYSTEM_ID=B.ID_TRASMISSIONE AND
      B.SYSTEM_ID=C.ID_TRASM_SINGOLA AND
      B.ID_RAGIONE=D.SYSTEM_ID AND
      C.CHA_VALIDA='1' AND
      A.DTA_INVIO IS NOT NULL AND
      ((B.ID_CORR_GLOBALE = @param1@ AND C.ID_PEOPLE=@param2@) OR B.ID_CORR_GLOBALE=
      (SELECT SYSTEM_ID
      FROM DPA_CORR_GLOBALI
      WHERE ID_PEOPLE=@param2@ AND CHA_TIPO_URP = 'P')) AND
      A.CHA_TIPO_OGGETTO = 'D' AND
      C.CHA_IN_TODOLIST = '1' AND
      (E.ID_REGISTRO IN (@param3@) OR E.ID_REGISTRO IS NULL)
      @filterString@
      ORDER BY
      A.DTA_INVIO DESC,B.ID_TRASMISSIONE DESC
    </value>
  </query>
  <query>
    <name>S_DPA_TRASM_SINGOLA</name>
    <value>
      SELECT @param1@
      FROM DPA_TRASM_SINGOLA
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>SCADENZE_TRASMISSIONI_DOC</name>
    <value>
      select
      dpa_trasmissione.DTA_INVIO,
      dpa_trasmissione.CHA_TIPO_OGGETTO,
      dpa_trasm_singola.CHA_TIPO_TRASM,
      dpa_trasmissione.ID_PROFILE,
      dpa_trasmissione.ID_PROJECT,
      dpa_trasmissione.ID_PEOPLE as ID_MITTENTE,
      profile.docnumber,
      dpa_trasmissione.ID_RUOLO_IN_UO
      @param1@
      from
      dpa_trasmissione,
      dpa_trasm_singola,
      dpa_trasm_utente,
      profile
      where
      dpa_trasmissione.system_id = dpa_trasm_singola.id_trasmissione and
      dpa_trasm_utente.id_trasm_singola = dpa_trasm_singola.system_id and
      dpa_trasmissione.id_Profile = profile.system_id and
      dpa_trasm_utente.cha_valida &lt;&gt; 0 and
      dpa_trasm_utente.cha_in_todolist = 0 and
      dpa_trasm_utente.cha_accettata = 0 and
      dpa_trasm_utente.cha_rifiutata = 0 and
      dpa_trasm_singola.dta_scadenza = GETDATE()
      union
      select
      dpa_trasmissione.DTA_INVIO,
      dpa_trasmissione.CHA_TIPO_OGGETTO,
      dpa_trasm_singola.CHA_TIPO_TRASM,
      dpa_trasmissione.ID_PROFILE,
      dpa_trasmissione.ID_PROJECT,
      dpa_trasmissione.ID_PEOPLE as ID_MITTENTE,
      profile.docnumber,
      dpa_trasmissione.ID_RUOLO_IN_UO
      @param1@
      from
      dpa_trasmissione,
      dpa_trasm_singola,
      dpa_trasm_utente,
      profile
      where
      dpa_trasmissione.system_id = dpa_trasm_singola.id_trasmissione and
      dpa_trasm_utente.id_trasm_singola = dpa_trasm_singola.system_id and
      dpa_trasmissione.id_Profile = profile.system_id and
      dpa_trasm_utente.cha_in_todolist = 1 and
      dpa_trasm_singola.dta_scadenza = GETDATE()
      ORDER BY ID_PROFILE
    </value>
  </query>
  <query>
    <name>U_DPA_TRASM_UTENTE_DTA_ACCETTATA_NEW</name>
    <value>
      UPDATE DPA_TRASM_UTENTE
      SET DTA_ACCETTATA = @param1@
      @param2@
      WHERE (SYSTEM_ID = @param3@
      OR
      SYSTEM_ID = (SELECT TU.SYSTEM_ID FROM
      DPA_TRASM_UTENTE TU,DPA_TRASMISSIONE TX,DPA_TRASM_SINGOLA TS WHERE TU.ID_PEOPLE=@param4@ AND
      TX.SYSTEM_ID=TS.ID_TRASMISSIONE AND TX.SYSTEM_ID=@param5@ AND TS.SYSTEM_ID=TU.ID_TRASM_SINGOLA
      AND TS.CHA_TIPO_DEST= 'U')
      )
      AND CHA_VALIDA='1'
    </value>
  </query>
  <query>
    <name>U_DPA_TRASM_UTENTE_RIFIUTATA_NEW</name>
    <value>
      UPDATE DPA_TRASM_UTENTE
      SET   CHA_IN_TODOLIST = '0',  CHA_RIFIUTATA='1' @param100@
      WHERE (SYSTEM_ID = @param1@
      OR
      SYSTEM_ID = (SELECT TU.SYSTEM_ID FROM
      DPA_TRASM_UTENTE TU,DPA_TRASMISSIONE TX,DPA_TRASM_SINGOLA TS WHERE TU.ID_PEOPLE=@param2@ AND
      TX.SYSTEM_ID=TS.ID_TRASMISSIONE AND TX.SYSTEM_ID=@param3@ AND TS.SYSTEM_ID=TU.ID_TRASM_SINGOLA
      AND TS.CHA_TIPO_DEST= 'U')
      )
      AND CHA_VALIDA='1'
    </value>
  </query>
  <query>
    <name>SCADENZE_TRASMISSIONI_FASC</name>
    <value>
      select
      dpa_trasmissione.DTA_INVIO,
      dpa_trasmissione.CHA_TIPO_OGGETTO,
      dpa_trasmissione.ID_PROFILE,
      dpa_trasmissione.ID_PROJECT,
      dpa_trasmissione.ID_PEOPLE as ID_MITTENTE,
      dpa_trasmissione.ID_RUOLO_IN_UO
      @param1@
      from
      dpa_trasmissione,
      dpa_trasm_singola,
      dpa_trasm_utente,
      project
      where
      dpa_trasmissione.system_id = dpa_trasm_singola.id_trasmissione and
      dpa_trasm_utente.id_trasm_singola = dpa_trasm_singola.system_id and
      dpa_trasmissione.id_Project = project.system_id and
      dpa_trasm_utente.cha_valida &lt;&gt; 0 and
      dpa_trasm_utente.cha_in_todolist = 0 and
      dpa_trasm_utente.cha_accettata = 0 and
      dpa_trasm_utente.cha_rifiutata = 0 and
      dpa_trasm_singola.dta_scadenza = GETDATE()
      union
      select
      dpa_trasmissione.DTA_INVIO,
      dpa_trasmissione.CHA_TIPO_OGGETTO,
      dpa_trasmissione.ID_PROFILE,
      dpa_trasmissione.ID_PROJECT,
      dpa_trasmissione.ID_PEOPLE as ID_MITTENTE,
      dpa_trasmissione.ID_RUOLO_IN_UO
      @param1@
      from
      dpa_trasmissione,
      dpa_trasm_singola,
      dpa_trasm_utente,
      project
      where
      dpa_trasmissione.system_id = dpa_trasm_singola.id_trasmissione and
      dpa_trasm_utente.id_trasm_singola = dpa_trasm_singola.system_id and
      dpa_trasmissione.id_Project = project.system_id and
      dpa_trasm_utente.cha_in_todolist = 1 and
      dpa_trasm_singola.dta_scadenza = GETDATE()
      ORDER BY ID_PROJECT
    </value>
  </query>
  <query>
    <name>S_FASC_CARTACEA_GET_DOCUMENTI_DA_FASCICOLARE</name>
    <value>
      select 	p.system_id as ID_PROFILE,
      p.docnumber as DOCNUMBER,
      p.creation_date as DATA_CREAZIONE,
      p.num_proto as NUMERO_PROTOCOLLO,
      p.dta_proto as DATA_PROTOCOLLO,
      p.cha_tipo_proto as TIPO_DOCUMENTO,
      p.id_registro as ID_REGISTRO,
      r.var_codice as CODICE_REGISTRO,
      v.version_id as VERSION_ID,
      v.version_label as VERSION_LABEL,
      v.comments as VERSION_NOTE,
      pj2.system_id as ID_FASCICOLO,
      pj2.var_codice as CODICE_FASCICOLO,
      pj2.description as DESCRIZIONE_FASCICOLO,
      pj2.cha_tipo_proj AS TIPO_FASCICOLO,
      pj2.cartaceo as FASCICOLO_CARTACEO,
      v.cartaceo as DOCUMENTO_CARTACEO
      from 	profile p left outer join dpa_el_registri r
      on p.id_registro = r.system_id,
      versions v,
      project_components pjc,
      project pj1,
      project pj2
      where 	p.docnumber = v.docnumber and
      p.system_id = pjc.link and
      pjc.project_id = pj1.system_id and
      pj1.id_fascicolo = pj2.system_id and
      v.version_id =
      (
      select 	max(v1.version_id)
      from 	versions v1,
      components c
      where 	v1.docnumber=p.docnumber and
      v1.version_id = c.version_id and
      not c.var_impronta is null
      ) and
      v.version_id not in
      (
      select fc.version_id
      from dpa_fascicolazione_cartacea fc
      where fc.project_id = pj2.system_id
      ) and
      v.scarta_fasc_cartacea is null
      @filters@
      order by  v.version_id desc,
      p.num_proto desc,
      p.dta_proto desc
    </value>
  </query>
  <query>
    <name>S_FASC_CARTACEA_GET_DOCUMENTI_FASCICOLATI</name>
    <value>
      select 	p.system_id as ID_PROFILE,
      p.docnumber as DOCNUMBER,
      p.creation_date as DATA_CREAZIONE,
      p.num_proto as NUMERO_PROTOCOLLO,
      p.dta_proto as DATA_PROTOCOLLO,
      p.cha_tipo_proto as TIPO_DOCUMENTO,
      p.id_registro as ID_REGISTRO,
      r.var_codice as CODICE_REGISTRO,
      v.version_id as VERSION_ID,
      v.version_label as VERSION_LABEL,
      v.comments as VERSION_NOTE,
      pj.system_id as ID_FASCICOLO,
      pj.var_codice as CODICE_FASCICOLO,
      pj.description as DESCRIZIONE_FASCICOLO,
      pj.cha_tipo_proj AS TIPO_FASCICOLO,
      fc.system_id as ID_FASCICOLAZIONE,
      fc.data_archiviazione as DATA_ARCHIVIAZIONE,
      pj.cartaceo as FASCICOLO_CARTACEO,
      v.cartaceo as DOCUMENTO_CARTACEO
      from  dpa_fascicolazione_cartacea fc,
      profile p,
      versions v,
      dpa_el_registri r,
      project pj
      where 	fc.id_document = p.system_id and
      p.docnumber = v.docnumber and
      p.id_registro = r.system_id and
      pj.system_id = fc.project_id
      @filters@
      order by fc.data_archiviazione desc,
      v.version_id desc,
      p.num_proto desc,
      p.dta_proto desc
    </value>
  </query>
  <query>
    <name>S_FASC_CARTACEA_GET_FILE_REQUEST_DATA</name>
    <value>
      SELECT 	C.PATH,
      C.FILE_SIZE,
      C.VAR_IMPRONTA,
      C.VERSION_ID,
      C.DOCNUMBER,
      V.VERSION,
      V.SUBVERSION,
      V.VERSION_LABEL
      FROM 	COMPONENTS C,
      VERSIONS V
      WHERE 	C.VERSION_ID=V.VERSION_ID AND
      C.VERSION_ID = @versionId@
    </value>
  </query>
  <query>
    <name>I_FASC_CARTACEA_INSERT_DOCUMENTO</name>
    <value>
      insert into dpa_fascicolazione_cartacea
      (
      @colSystemId@
      project_id,
      id_document,
      version_id,
      data_archiviazione
      )
      values
      (
      @systemId@
      @projectId@,
      @idDocument@,
      @versionId@,
      @dataArchiviazione@
      )
    </value>
  </query>
  <query>
    <name>D_FASC_CARTACEA_DELETE_DOCUMENTO_DA_FASCICOLO</name>
    <value>
      delete
      from dpa_fascicolazione_cartacea
      where project_id = @idFascicolo@ and id_document = @idDocumento@
    </value>
  </query>
  <query>
    <name>S_FASC_CARTACEA_GET_FASCICOLI_DOCUMENTO</name>
    <value>
      select 	pj.system_id as ID_FASCICOLO,
      pj.var_codice as CODICE_FASCICOLO,
      pj.description as DESCRIZIONE_FASCICOLO,
      pj.cha_tipo_proj AS TIPO_FASCICOLO,
      pj.cartaceo as FASCICOLO_CARTACEO
      from 	dpa_fascicolazione_cartacea fc,
      project pj
      where   	pj.system_id = fc.project_id and
      fc.version_id = @versionId@
      order by fc.system_id desc
    </value>
  </query>
  <query>
    <name>U_SET_FASCICOLO_CARTACEO</name>
    <value>
      UPDATE PROJECT
      SET CARTACEO = 1
      WHERE SYSTEM_ID = @idFascicolo@ AND
      (CARTACEO IS NULL OR CARTACEO = 0)
    </value>
  </query>
  <query>
    <name>U_SET_VERSIONE_CARTACEA</name>
    <value>
      UPDATE VERSIONS
      SET CARTACEO = 1
      WHERE VERSION_ID = @idVersione@ AND
      (CARTACEO IS NULL OR CARTACEO = 0)
    </value>
  </query>
  <query>
    <name>S_IS_DOCUMENTO_CARTACEO</name>
    <value>
      SELECT CARTACEO
      FROM VERSIONS
      WHERE VERSION_ID = @idVersione@
    </value>
  </query>
  <query>
    <name>S_FASC_CARTACEA_GET_COUNT_DOCUMENTI_DA_FASCICOLARE_PAGING</name>
    <value>
      select count(p.system_id)
      from 	profile p,
      versions v,
      project_components pjc,
      project pj1,
      project pj2
      where 	p.docnumber = v.docnumber and
      p.system_id = pjc.link and
      pjc.project_id = pj1.system_id and
      pj1.id_fascicolo = pj2.system_id and
      v.version_id =
      (
      select 	max(v1.version_id)
      from 	versions v1,
      components c
      where 	v1.docnumber=p.docnumber and
      v1.version_id = c.version_id and
      not c.var_impronta is null
      ) and
      v.version_id not in
      (
      select fc.version_id
      from dpa_fascicolazione_cartacea fc
      where fc.project_id = pj2.system_id
      )
      and v.scarta_fasc_cartacea is null
      AND ISNULL(p.CHA_IN_CESTINO, '0') = '0'
      and p.cha_in_archivio &lt;&gt; '1'
      @filters@
    </value>
  </query>
  <query>
    <name>S_FASC_CARTACEA_GET_DOCUMENTI_DA_FASCICOLARE_PAGING</name>
    <value>
      SELECT TOP @pageSize@ *
      FROM
      (
      SELECT TOP @pageSize@ *
      FROM
      (
      select top @rowsToExtract@
      p.system_id as ID_PROFILE,
      p.docnumber as DOCNUMBER,
      p.creation_date as DATA_CREAZIONE,
      p.num_proto as NUMERO_PROTOCOLLO,
      p.dta_proto as DATA_PROTOCOLLO,
      p.cha_tipo_proto as TIPO_DOCUMENTO,
      p.id_registro as ID_REGISTRO,
      r.var_codice as CODICE_REGISTRO,
      v.version_id as VERSION_ID,
      v.version_label as VERSION_LABEL,
      v.comments as VERSION_NOTE,
      pj2.system_id as ID_FASCICOLO,
      pj2.var_codice as CODICE_FASCICOLO,
      pj2.description as DESCRIZIONE_FASCICOLO,
      pj2.cha_tipo_proj AS TIPO_FASCICOLO,
      pj2.cartaceo as FASCICOLO_CARTACEO,
      v.cartaceo as DOCUMENTO_CARTACEO
      from 	profile p left outer join dpa_el_registri r
      on p.id_registro = r.system_id,
      versions v,
      project_components pjc,
      project pj1,
      project pj2
      where 	p.docnumber = v.docnumber and
      p.system_id = pjc.link and
      pjc.project_id = pj1.system_id and
      pj1.id_fascicolo = pj2.system_id and
      v.version_id =
      (
      select 	max(v1.version_id)
      from 	versions v1,
      components c
      where 	v1.docnumber=p.docnumber and
      v1.version_id = c.version_id and
      not c.var_impronta is null
      ) and
      v.version_id not in
      (
      select fc.version_id
      from dpa_fascicolazione_cartacea fc
      where fc.project_id = pj2.system_id
      )
      and v.scarta_fasc_cartacea is null
      AND ISNULL(p.CHA_IN_CESTINO, '0') = '0'
      and p.cha_in_archivio &lt;&gt; '1'
      @filters@
      order by  v.VERSION_ID desc,
      p.NUMERO_PROTOCOLLO desc,
      p.DATA_PROTOCOLLO desc
      )
      AS t1
      order by t1.VERSION_ID asc, t1.NUMERO_PROTOCOLLO asc, t1.DATA_PROTOCOLLO asc
      ) as t2
      order by t2.VERSION_ID desc, t2.NUMERO_PROTOCOLLO desc, t2.DATA_PROTOCOLLO desc
    </value>
  </query>
  <query>
    <name>S_FASC_CARTACEA_IS_DOCUMENTO_FASCICOLATO</name>
    <value>
      select count(fc.system_id)
      from dpa_fascicolazione_cartacea fc
      where fc.project_id = @projectId@ and fc.version_id = @versionId@
    </value>
  </query>
  <query>
    <name>S_GET_DATI_FASCICOLAZIONE_CARTACEA</name>
    <value>
      select fc.system_id as ID_FASCICOLAZIONE,
      fc.data_archiviazione as DATA_ARCHIVIAZIONE
      from dpa_fascicolazione_cartacea fc
      where fc.project_id = @projectId@ and
      fc.version_id = @versionId@
    </value>
  </query>
  <query>
    <name>S_CATENE_DOC_GET_DOCUMENTO_MITTENTE</name>
    <value>
      SELECT 	  A.SYSTEM_ID,
      A.DOCNUMBER,
      A.DTA_ANNULLA,
      A.VAR_PROF_OGGETTO AS VAR_DESC_OGGETTO,
      A.ID_REGISTRO,
      A.CHA_TIPO_PROTO,
      A.CHA_EVIDENZA,
      A.NUM_ANNO_PROTO,
      convert(nvarchar(10), A.CREATION_TIME, 103) AS CREATION_DATE,
      A.NUM_PROTO,
      A.VAR_SEGNATURA,
      convert(nvarchar(10), A.DTA_PROTO, 103) AS DTA_PROTO,
      docsadm.getchaimg(A.DOCNUMBER) AS CHA_IMG ,
      ID_DOCUMENTO_PRINCIPALE
      FROM    PROFILE A
      WHERE
      EXISTS (
      SELECT
      'x'
      FROM security as c  WITH (nolock)
      WHERE c.thing = a.system_id
      AND (    c.personorgroup IN (@idGruppo@, @idPeople@)
      AND c.accessrights > 0
      )
      ) AND
      A.DOCNUMBER = @docNumber@ AND
      A.CHA_TIPO_PROTO = '@tipoDocumento@'
    </value>
  </query>

  <!-- GEST VOCI MENU  sabrina -->
  <query>
    <name>S_AMM_GET_LIST_MENU_ASS_UTENTE</name>
    <value>
      SELECT
      SYSTEM_ID AS IDMENU,
      VAR_CODICE AS CODICE,
      VAR_DESCRIZIONE AS DESCRIZIONE,
      VAR_VISIBILITA_MENU AS VISIBILITA,
      (SELECT
      ID_CORR_GLOBALE
      FROM
      DPA_USERADMIN_VOCI_MENU
      WHERE
      DPA_VOCI_MENU_ADMIN.SYSTEM_ID = DPA_USERADMIN_VOCI_MENU.ID_VOCE_MENU
      AND
      DPA_USERADMIN_VOCI_MENU.ID_CORR_GLOBALE = @idCorrGlob@ AND ID_AMM = @idAmm@
      )
      AS ASSOCIATO
      FROM
      DPA_VOCI_MENU_ADMIN
      --WHERE
      --ID_AMM = @idAmm@
    </value>
  </query>
  <query>
    <name>S_MENU_ASS_UTENTE</name>
    <value>
      select id_voce_menu from dpa_useradmin_voci_menu where id_corr_globale = @idCorrGlob@
    </value>
  </query>
  <query>
    <name>D_MENU_ASS_UTENTE</name>
    <value>
      delete from dpa_useradmin_voci_menu where id_corr_globale = @idCorrGlob@
    </value>
  </query>
  <query>
    <name>I_MENU_ASS_UTENTE</name>
    <value>
      insert into dpa_useradmin_voci_menu (id_corr_globale, id_voce_menu, id_amm) values (@idCorrGlob@,@idVoceMenu@,@idAmm@)
    </value>
  </query>
  <query>
    <name>S_AMM_LOGIN3</name>
    <value>
      SELECT system_id AS ID, cha_amministratore AS TIPO, var_nome AS NOME, var_cognome AS COGNOME, id_amm AS IDAMM
      FROM PEOPLE
      WHERE user_id = '@param1@'
      AND disabled = 'N'
      AND cha_amministratore in ('1','2','3')
    </value>
  </query>
  <query>
    <name>S_AMM_LOGIN4</name>
    <value>
      SELECT  PEOPLE.system_id AS ID,
      PEOPLE.cha_amministratore AS TIPO,
      PEOPLE.var_nome AS NOME,
      PEOPLE.var_cognome AS COGNOME,
      PEOPLE.id_amm AS IDAMM,
      DPA_CORR_GLOBALI.system_id AS ID_CORR_GLOBALI
      FROM    PEOPLE LEFT OUTER JOIN DPA_CORR_GLOBALI
      ON PEOPLE.system_id = DPA_CORR_GLOBALI.id_people
      WHERE   user_id = '@param1@' and PEOPLE.ID_AMM = @param2@
      AND disabled = 'N'
    </value>
  </query>
  <query>
    <name>I_TIPO_FUNZ_NEW_AMM</name>
    <value>
      INSERT INTO DPA_TIPO_FUNZIONE
      ( @param1@
      VAR_COD_TIPO,
      VAR_DESC_TIPO_FUN,
      CHA_VIS,
      ID_AMM
      )
      SELECT    @param2@
      VAR_COD_TIPO,
      VAR_DESC_TIPO_FUN,
      CHA_VIS,
      @param3@
      FROM DPA_TIPO_FUNZIONE
      WHERE @param4@
    </value>
  </query>
  <query>
    <name>I_ASS_TIPO_FUNZ_FUNZ_NEW_AMM</name>
    <value>
      insert into dpa_funzioni
      (@param1@
      ID_AMM,
      COD_FUNZIONE,
      VAR_DESC_FUNZIONE,
      ID_TIPO_FUNZIONE
      )
      select  @param2@ b1.id_amm, a1.COD_FUNZIONE,
      a1.VAR_DESC_FUNZIONE, b1.system_id
      from 	dpa_funzioni a1,
      dpa_tipo_funzione b1,
      dpa_tipo_funzione c1
      where 	@param5@
      and a1.ID_TIPO_FUNZIONE = c1.system_id
      and b1.var_cod_tipo=c1.var_cod_tipo
      and b1.id_amm=@param3@ and @param4@
    </value>
  </query>
  <query>
    <name>S_GET_SUPPORTED_FILE_TYPES</name>
    <value>
      SELECT 	SF.SYSTEM_ID,
      SF.ID_AMMINISTRAZIONE,
      SF.FILE_TYPE_USED,
      A.VAR_CODICE_AMM AS CODICE_AMMINISTRAZIONE,
      SF.DESCRIPTION,
      SF.FILE_EXTENSION,
      SF.MAX_FILE_SIZE,
      SF.MAX_FILE_SIZE_ALERT_MODE,
      SF.CONTAINS_FILE_MODEL,
      SF.DOCUMENT_TYPE,
      SF.FILE_TYPE_SIGNATURE,
      SF.FILE_TYPE_PRESERVATION,
      SF.FILE_TYPE_VALIDATION
      FROM	DPA_FORMATI_DOCUMENTO SF,
      DPA_AMMINISTRA A
      WHERE 	SF.ID_AMMINISTRAZIONE = A.SYSTEM_ID AND
      SF.ID_AMMINISTRAZIONE = @idAmministrazione@
      ORDER BY SF.DESCRIPTION
    </value>
  </query>
  <query>
    <name>S_GET_DEFAULT_SUPPORTED_FILE_TYPES</name>
    <value>
      SELECT 	SF.SYSTEM_ID,
      SF.ID_AMMINISTRAZIONE,
      SF.FILE_TYPE_USED,
      '' AS CODICE_AMMINISTRAZIONE,
      SF.DESCRIPTION,
      SF.FILE_EXTENSION,
      SF.MAX_FILE_SIZE,
      SF.MAX_FILE_SIZE_ALERT_MODE,
      SF.CONTAINS_FILE_MODEL,
      SF.DOCUMENT_TYPE,
      SF.FILE_TYPE_SIGNATURE,
      SF.FILE_TYPE_PRESERVATION,
      SF.FILE_TYPE_VALIDATION
      FROM	DPA_FORMATI_DOCUMENTO SF
      WHERE 	@param1@
      ORDER BY SF.DESCRIPTION
    </value>
  </query>
  <query>
    <name>S_GET_SUPPORTED_FILE_TYPE</name>
    <value>
      SELECT 	SF.SYSTEM_ID,
      SF.ID_AMMINISTRAZIONE,
      SF.FILE_TYPE_USED,
      A.VAR_CODICE_AMM AS CODICE_AMMINISTRAZIONE,
      SF.DESCRIPTION,
      SF.FILE_EXTENSION,
      SF.MAX_FILE_SIZE,
      SF.MAX_FILE_SIZE_ALERT_MODE,
      SF.CONTAINS_FILE_MODEL,
      SF.DOCUMENT_TYPE,
      SF.FILE_TYPE_SIGNATURE,
      SF.FILE_TYPE_PRESERVATION,
      SF.FILE_TYPE_VALIDATION
      FROM	DPA_FORMATI_DOCUMENTO SF,
      DPA_AMMINISTRA A
      WHERE 	SF.ID_AMMINISTRAZIONE = A.SYSTEM_ID AND
      A.SYSTEM_ID = @idAmministrazione@ AND
      SF.FILE_EXTENSION = '@fileExtension@'
      ORDER BY SF.DESCRIPTION
    </value>
  </query>
  <query>
    <name>S_GET_SUPPORTED_FILE_ADMIN</name>
    <value>
      SELECT VAR_CODICE_AMM
      FROM DPA_AMMINISTRA
      WHERE SYSTEM_ID = @idAmministrazione@
    </value>
  </query>
  <query>
    <name>S_GET_EMAIL_ADDRESS_AMMINISTRA</name>
    <value>
      SELECT FROM_EMAIL_ADDRESS
      FROM DPA_AMMINISTRA
      WHERE SYSTEM_ID = @idAmministrazione@
    </value>
  </query>
  <query>
    <name>S_GET_ADMIN_SUPPORTED_FILE_MODELS</name>
    <value>
      SELECT 	SF.FILE_EXTENSION,
      SF.CONTAINS_FILE_MODEL,
      SF.DOCUMENT_TYPE
      FROM 	DPA_FORMATI_DOCUMENTO SF
      WHERE     SF.ID_AMMINISTRAZIONE = @idAmministrazione@ AND
      SF.FILE_TYPE_USED = 1
    </value>
  </query>
  <query>
    <name>S_GET_ADMIN_BY_CODE_SUPPORTED_FILE_MODELS</name>
    <value>
      SELECT 	SF.FILE_EXTENSION,
      SF.CONTAINS_FILE_MODEL
      FROM 	DPA_FORMATI_DOCUMENTO SF,
      DPA_AMMINISTRA A
      WHERE 	A.SYSTEM_ID = SF.ID_AMMINISTRAZIONE AND
      A.VAR_CODICE_AMM = '@codiceAmministrazione@'
    </value>
  </query>
  <query>
    <name>U_SET_CONTAINS_FILE_MODEL_2</name>
    <value>
      UPDATE 	DPA_FORMATI_DOCUMENTO
      SET 	CONTAINS_FILE_MODEL = @containsFileModel@
      WHERE	ID_AMMINISTRAZIONE = (SELECT SYSTEM_ID FROM DPA_AMMINISTRA WHERE VAR_CODICE_AMM = '@codiceAmministrazione@') AND
      SYSTEM_ID = (SELECT SYSTEM_ID FROM DPA_FORMATI_DOCUMENTO WHERE FILE_EXTENSION = '@fileType@' AND
      ID_AMMINISTRAZIONE = (SELECT SYSTEM_ID FROM DPA_AMMINISTRA WHERE VAR_CODICE_AMM = '@codiceAmministrazione@'))
    </value>
  </query>
  <query>
    <name>I_INSERT_SUPPORTED_FILE_TYPES</name>
    <value>
      INSERT INTO DPA_FORMATI_DOCUMENTO
      (
      @colSystemId@
      ID_AMMINISTRAZIONE,
      FILE_TYPE_USED,
      DESCRIPTION,
      FILE_EXTENSION,
      MAX_FILE_SIZE,
      MAX_FILE_SIZE_ALERT_MODE,
      CONTAINS_FILE_MODEL,
      DOCUMENT_TYPE,
      FILE_TYPE_SIGNATURE,
      FILE_TYPE_PRESERVATION,
      FILE_TYPE_VALIDATION
      )
      VALUES
      (
      @systemId@
      @idAmministrazione@,
      @fileTypeUsed@,
      '@description@',
      '@fileExtensione@',
      @maxFileSize@,
      @maxFileSizeAlertMode@,
      @containsFileModel@,
      @documentType@,
      @fileTypeSignature@,
      @fileTypePreservation@,
      @fileTypeValidation@
      )
    </value>
  </query>
  <query>
    <name>U_UPDATE_SUPPORTED_FILE_TYPES</name>
    <value>
      UPDATE 	DPA_FORMATI_DOCUMENTO
      SET 	DESCRIPTION = '@description@',
      FILE_TYPE_USED = @fileTypeUsed@,
      FILE_EXTENSION = '@fileExtensione@',
      MAX_FILE_SIZE = @maxFileSize@,
      MAX_FILE_SIZE_ALERT_MODE = @maxFileSizeAlertMode@,
      CONTAINS_FILE_MODEL = @containsFileModel@,
      DOCUMENT_TYPE = @documentType@,
      FILE_TYPE_SIGNATURE = @fileTypeSignature@,
      FILE_TYPE_PRESERVATION = @fileTypePreservation@,
      FILE_TYPE_VALIDATION = @fileTypeValidation@
      WHERE 	SYSTEM_ID = @systemId@
    </value>
  </query>
  <query>
    <name>D_REMOVE_SUPPORTED_FILE_TYPES</name>
    <value>
      DELETE
      FROM DPA_FORMATI_DOCUMENTO
      WHERE SYSTEM_ID = @systemId@
    </value>
  </query>
  <query>
    <name>S_CONTAINS_FILE_TYPE</name>
    <value>
      SELECT COUNT(SYSTEM_ID)
      FROM DPA_FORMATI_DOCUMENTO
      WHERE FILE_EXTENSION = '@fileExtension@' AND
      ID_AMMINISTRAZIONE = @idAmministrazione@
    </value>
  </query>
  <query>
    <name>S_GET_TIPO_DOCUMENTO_FROM_DOCNUMBER</name>
    <value>
      SELECT P.CHA_TIPO_PROTO
      FROM PROFILE P WITH(NOLOCK)
      WHERE	P.DOCNUMBER = @docNumber@
    </value>
  </query>
  <query>
    <name>U_FASC_CARTACEA_SCARTA_DOCUMENTO_NON_CARTACEO</name>
    <value>
      UPDATE VERSIONS
      SET SCARTA_FASC_CARTACEA = 1
      WHERE VERSION_ID = @versionId@
    </value>
  </query>
  <query>
    <name>S_FASC_CARTACEA_GET_COUNT_FASCICOLI_DOCUMENTO</name>
    <value>
      select count(*)
      from project_components
      where link = @docNumber@
    </value>
  </query>
  <query>
    <name>S_GET_MY_DOC_TODOLIST</name>
    <value>
      SELECT
      ID_TRASMISSIONE,
      ID_TRASM_SINGOLA,
      ID_TRASM_UTENTE,
      DTA_INVIO AS DTAINVIO,
      CONVERT(VARCHAR,DTA_INVIO,103)AS DTA_INVIO,
      ISNULL(DTA_SCADENZA,'25000101') AS DTA_SCAD_ASC,
      ISNULL(DTA_SCADENZA,'17530101') AS DTA_SCAD_DESC,
      @dbuser@.Vardescribe(ID_PEOPLE_MITT, 'PEOPLENAME') AS UT_MITT,
      @dbuser@.Vardescribe(ID_RUOLO_MITT, 'GROUPNAME') AS RUOLO_MITT,
      @dbuser@.Vardescribe(ID_PEOPLE_DEST, 'PEOPLENAME') AS UT_DEST,
      @dbuser@.Vardescribe(ID_RAGIONE_TRASM, 'RAGIONETRASM') AS RAG_TRASM,
      VAR_NOTE_GEN,
      VAR_NOTE_SING,
      DTA_SCADENZA,
      CONVERT(VARCHAR,DTA_SCADENZA,103) AS DTA_SCAD_CHAR,
      ID_PROFILE,
      @dbuser@.Vardescribe(ID_PROFILE, 'SEGNATURA_DOCNUMBER')AS SEGNA_DOCNUMBER,
      @dbuser@.Vardescribe(ID_PROFILE, 'OGGETTO_MITTENTE')AS OGGETTO_MITTENTE,
      @dbuser@.Vardescribe(ID_PROFILE, 'CHA_TIPO_PROTO')AS TIPO_PROTO,
      @dbuser@.Vardescribe(ID_PROFILE, 'DATADOC') AS DTA_DOC,
      @dbuser@.vardescribe(ID_PROFILE, 'NUMPROTO') AS NUM_PROTO,
      ID_PEOPLE_MITT AS ID_PEOPLE_MITT,
      ID_RUOLO_MITT AS ID_RUOLO_MITT,
      ID_RAGIONE_TRASM AS ID_RAGIONE_TRASM,
      ID_RUOLO_DEST AS ID_RUOLO_DEST,
      ID_PEOPLE_DEST AS ID_PEOPLE_DEST,
      CHA_TIPO_TRASM AS CHA_TIPO_TRASM,
      @dbuser@.Vardescribe(ID_PROFILE,'PROFILE_CHA_IMG') AS CHA_IMG
      FROM DPA_TODOLIST
      WHERE ID_PROFILE &gt; 0
      AND ((ID_PEOPLE_DEST = @idPeople@ and ID_RUOLO_DEST = @idGruppo@) OR (ID_PEOPLE_DEST = @idPeople@ AND ID_RUOLO_DEST = 0))
      AND ID_REGISTRO IN (@registri@)
      ORDER BY DTAINVIO DESC,ID_PROFILE DESC
    </value>
  </query>
  <query>
    <query>
      <name>S_GET_MY_DOC_TODOLIST_FILTERED_old</name>
      <value>
        SELECT
        ID_TRASMISSIONE,
        ID_TRASM_SINGOLA,
        ID_TRASM_UTENTE,
        DTA_INVIO AS DTAINVIO,
        CONVERT(VARCHAR,DTA_INVIO,103)AS DTA_INVIO,
        ISNULL(DTA_SCADENZA,'25000101') AS DTA_SCAD_ASC,
        ISNULL(DTA_SCADENZA,'17530101') AS DTA_SCAD_DESC,
        @dbuser@.Vardescribe(ID_PEOPLE_MITT, 'PEOPLENAME') AS UT_MITT,
        @dbuser@.Vardescribe(ID_RUOLO_MITT, 'GROUPNAME') AS RUOLO_MITT,
        @dbuser@.Vardescribe(ID_PEOPLE_DEST, 'PEOPLENAME') AS UT_DEST,
        @dbuser@.Vardescribe(ID_RAGIONE_TRASM, 'RAGIONETRASM') AS RAG_TRASM,
        VAR_NOTE_GEN,
        VAR_NOTE_SING,
        DTA_SCADENZA,
        CONVERT(VARCHAR,DTA_SCADENZA,103) AS DTA_SCAD_CHAR,
        ID_PROFILE,
        @dbuser@.Vardescribe(ID_PROFILE, 'SEGNATURA_DOCNUMBER')AS SEGNA_DOCNUMBER,
        @dbuser@.Vardescribe(ID_PROFILE, 'OGGETTO_MITTENTE')AS OGGETTO_MITTENTE,
        @dbuser@.Vardescribe(ID_PROFILE, 'CHA_TIPO_PROTO')AS TIPO_PROTO,
        @dbuser@.Vardescribe(ID_PROFILE, 'DATADOC') AS DTA_DOC,
        @dbuser@.vardescribe(ID_PROFILE, 'NUMPROTO') AS NUM_PROTO,
        ID_PEOPLE_MITT AS ID_PEOPLE_MITT,
        ID_RUOLO_MITT AS ID_RUOLO_MITT,
        ID_RAGIONE_TRASM AS ID_RAGIONE_TRASM,
        ID_RUOLO_DEST AS ID_RUOLO_DEST,
        ID_PEOPLE_DEST AS ID_PEOPLE_DEST,
        CHA_TIPO_TRASM AS CHA_TIPO_TRASM,
        @dbuser@.Vardescribe(ID_PROFILE,'PROFILE_CHA_IMG') AS CHA_IMG
        FROM DPA_TODOLIST
        WHERE ID_PROFILE &gt; 0
        AND ((ID_PEOPLE_DEST = @idPeople@ and ID_RUOLO_DEST = @idGruppo@) OR (ID_PEOPLE_DEST = @idPeople@ AND ID_RUOLO_DEST = 0))
        AND ID_REGISTRO IN (@registri@) @filtri@
        ORDER BY @order@
      </value>
    </query>
    <query>
      <name>S_GET_MY_FASC_TODOLIST_old</name>
      <value>
        SELECT
        ID_TRASMISSIONE,
        ID_TRASM_SINGOLA,
        ID_TRASM_UTENTE,
        DTA_INVIO AS DTAINVIO,
        CONVERT(VARCHAR,DTA_INVIO,103)AS DTA_INVIO,
        ISNULL(DTA_SCADENZA,'25000101') AS DTA_SCAD_ASC,
        ISNULL(DTA_SCADENZA,'17530101') AS DTA_SCAD_DESC,
        @dbuser@.Vardescribe(ID_PEOPLE_MITT, 'PEOPLENAME') AS UT_MITT,
        @dbuser@.Vardescribe(ID_RUOLO_MITT, 'GROUPNAME') AS RUOLO_MITT,
        @dbuser@.Vardescribe(ID_PEOPLE_DEST, 'PEOPLENAME') AS UT_DEST,
        @dbuser@.Vardescribe(ID_RAGIONE_TRASM, 'RAGIONETRASM') AS RAG_TRASM,
        VAR_NOTE_GEN,
        VAR_NOTE_SING,
        DTA_SCADENZA,
        CONVERT(VARCHAR,DTA_SCADENZA,103) AS DTA_SCAD_CHAR,
        ID_PROJECT,
        @dbuser@.Vardescribe(ID_PROJECT, 'DESC_FASC')AS DESC_FASC,
        @dbuser@.Vardescribe(ID_PROJECT, 'CODFASC') AS COD_FASC,
        ID_PEOPLE_MITT AS ID_PEOPLE_MITT,
        ID_RUOLO_MITT AS ID_RUOLO_MITT,
        ID_RAGIONE_TRASM AS ID_RAGIONE_TRASM,
        ID_RUOLO_DEST AS ID_RUOLO_DEST,
        ID_PEOPLE_DEST AS ID_PEOPLE_DEST,
        CHA_TIPO_TRASM AS CHA_TIPO_TRASM
        FROM DPA_TODOLIST
        WHERE ID_PROJECT &gt; 0 AND
        ((ID_PEOPLE_DEST = @idPeople@ AND ID_RUOLO_DEST = @idGruppo@) OR (ID_PEOPLE_DEST = @idPeople@ AND ID_RUOLO_DEST = 0))
        ORDER BY @order@
      </value>
    </query>
    <query>
      <name>S_GET_MY_FASC_TODOLIST_FILTERED_old</name>
      <value>
        SELECT
        ID_TRASMISSIONE,
        ID_TRASM_SINGOLA,
        ID_TRASM_UTENTE,
        DTA_INVIO AS DTAINVIO,
        CONVERT(VARCHAR,DTA_INVIO,103)AS DTA_INVIO,
        ISNULL(DTA_SCADENZA,'25000101') AS DTA_SCAD_ASC,
        ISNULL(DTA_SCADENZA,'17530101') AS DTA_SCAD_DESC,
        @dbuser@.Vardescribe(ID_PEOPLE_MITT, 'PEOPLENAME') AS UT_MITT,
        @dbuser@.Vardescribe(ID_RUOLO_MITT, 'GROUPNAME') AS RUOLO_MITT,
        @dbuser@.Vardescribe(ID_PEOPLE_DEST, 'PEOPLENAME') AS UT_DEST,
        @dbuser@.Vardescribe(ID_RAGIONE_TRASM, 'RAGIONETRASM') AS RAG_TRASM,
        VAR_NOTE_GEN,
        VAR_NOTE_SING,
        DTA_SCADENZA,
        CONVERT(VARCHAR,DTA_SCADENZA,103) AS DTA_SCAD_CHAR,
        ID_PROJECT,
        @dbuser@.Vardescribe(ID_PROJECT, 'DESC_FASC')AS DESC_FASC,
        @dbuser@.Vardescribe(ID_PROJECT, 'CODFASC') AS COD_FASC,
        ID_PEOPLE_MITT AS ID_PEOPLE_MITT,
        ID_RUOLO_MITT AS ID_RUOLO_MITT,
        ID_RAGIONE_TRASM AS ID_RAGIONE_TRASM,
        ID_RUOLO_DEST AS ID_RUOLO_DEST,
        ID_PEOPLE_DEST AS ID_PEOPLE_DEST,
        CHA_TIPO_TRASM AS CHA_TIPO_TRASM
        FROM DPA_TODOLIST
        WHERE ID_PROJECT &gt; 0 AND
        ((ID_PEOPLE_DEST = @idPeople@ AND ID_RUOLO_DEST = @idGruppo@) OR (ID_PEOPLE_DEST = @idPeople@ AND ID_RUOLO_DEST = 0)) @filtri@
        ORDER BY @order@
      </value>
    </query>
    <query>
      <name>S_SMISTADOC_GET_LIST_DOCUMENTI_IN_TODO_old</name>
      <value>
        SELECT
        ID_PROFILE AS SYSTEM_ID,
        @dbuser@.Vardescribe(ID_RAGIONE_TRASM, 'TIPO_RAGIONE') AS TIPO_RAGIONE,
        @dbuser@.Vardescribe(ID_RAGIONE_TRASM, 'RAGIONETRASM') AS RAGIONE_TRASM,
        ID_TRASMISSIONE AS ID_TRASMISSIONE,
        ID_TRASM_SINGOLA AS ID_TRASMISSIONE_SINGOLA,
        ID_TRASM_UTENTE AS ID_TRASMISSIONE_UTENTE,
        VAR_NOTE_GEN AS NOTE_GENERALI,
        VAR_NOTE_SING AS NOTE_INDIVIDUALI,
        DTA_INVIO AS DTAINVIO,
        ISNULL(A.DTA_SCADENZA,'25000101') AS DTA_SCAD_ASC,
        ISNULL(A.DTA_SCADENZA,'17530101') AS DTA_SCAD_DESC,
        @dbuser@.Vardescribe(ID_PEOPLE_MITT, 'PEOPLENAME') AS MITT_TRASM,
        @dbuser@.Vardescribe(ID_RUOLO_MITT, 'GROUPNAME') AS RUOLO_MITT
        FROM DPA_TODOLIST A, PROFILE B, DPA_RAGIONE_TRASM C
        WHERE ID_PROFILE &gt; 0
        AND ((ID_PEOPLE_DEST = @param1@ and ID_RUOLO_DEST = @param2@) OR (ID_PEOPLE_DEST = @param1@ AND ID_RUOLO_DEST = 0))
        AND A.ID_REGISTRO IN (@param3@) AND ID_PROFILE = B.SYSTEM_ID AND B.DTA_ANNULLA IS NULL AND C.SYSTEM_ID = A.ID_RAGIONE_TRASM AND C.CHA_CEDE_DIRITTI='N'
        ORDER BY @order@
      </value>
    </query>
    <query>
      <name>S_SMISTADOC_GET_LIST_DOCUMENTI_IN_TODO_FILTERED_old</name>
      <value>
        SELECT
        ID_PROFILE AS SYSTEM_ID,
        @dbuser@.Vardescribe(ID_RAGIONE_TRASM, 'TIPO_RAGIONE') AS TIPO_RAGIONE,
        @dbuser@.Vardescribe(ID_RAGIONE_TRASM, 'RAGIONETRASM') AS RAGIONE_TRASM,
        ID_TRASMISSIONE AS ID_TRASMISSIONE,
        ID_TRASM_SINGOLA AS ID_TRASMISSIONE_SINGOLA,
        ID_TRASM_UTENTE AS ID_TRASMISSIONE_UTENTE,
        VAR_NOTE_GEN AS NOTE_GENERALI,
        VAR_NOTE_SING AS NOTE_INDIVIDUALI,
        DTA_INVIO AS DTAINVIO,
        ISNULL(DTA_SCADENZA,'25000101') AS DTA_SCAD_ASC,
        ISNULL(DTA_SCADENZA,'17530101') AS DTA_SCAD_DESC,
        @dbuser@.Vardescribe(ID_PEOPLE_MITT, 'PEOPLENAME') AS MITT_TRASM,
        @dbuser@.Vardescribe(ID_RUOLO_MITT, 'GROUPNAME') AS RUOLO_MITT
        FROM DPA_TODOLIST
        WHERE ID_PROFILE &gt; 0
        AND ((ID_PEOPLE_DEST = @param1@ and ID_RUOLO_DEST = @param2@) OR (ID_PEOPLE_DEST = @param1@ AND ID_RUOLO_DEST = 0))
        AND ID_REGISTRO IN (@param3@) @filtri@
        ORDER BY @order@
      </value>
    </query>
    <name>U_DPA_TRASM_UTENTE_DTA_VISTA</name>
    <value>
      UPDATE DPA_TRASM_UTENTE
      SET DTA_VISTA = @param1@, CHA_VISTA='1'
      WHERE (SYSTEM_ID = @param3@
      OR
      SYSTEM_ID = (SELECT TU.SYSTEM_ID FROM
      DPA_TRASM_UTENTE TU,DPA_TRASMISSIONE TX,DPA_TRASM_SINGOLA TS WHERE TU.ID_PEOPLE=@param4@ AND
      TX.SYSTEM_ID=TS.ID_TRASMISSIONE AND TX.SYSTEM_ID=@param5@ AND TS.SYSTEM_ID=TU.ID_TRASM_SINGOLA
      AND TS.CHA_TIPO_DEST= 'U')
      )
      AND CHA_VALIDA='1' AND DTA_VISTA IS NULL
    </value>
  </query>
  <query>
    <name>PD_INSERT_ASS_FASC_RUOLI</name>
    <value>
      INSERT INTO DPA_VIS_TIPO_FASC
      (
      @colID@
      ID_TIPO_FASC,
      ID_RUOLO,
      DIRITTI
      )
      VALUES
      (
      @id@
      @idTipoFasc@,
      @idRuolo@,
      @diritti@
      )
    </value>
  </query>
  <query>
    <name>PD_DELETE_ASS_FASC_RUOLI</name>
    <value>
      DELETE FROM DPA_VIS_TIPO_FASC
      WHERE
      ID_TIPO_FASC = @idTipoFasc@
    </value>
  </query>
  <query>
    <name>S_DPA_TIPO_FASC_FROM_RUOLO</name>
    <value>
      SELECT
      DISTINCT DPA_TIPO_FASC.SYSTEM_ID,
      DPA_TIPO_FASC.VAR_DESC_FASC,
      DPA_TIPO_FASC.Abilitato_SI_NO,
      DPA_TIPO_FASC.In_Esercizio,
      DPA_TIPO_FASC.Path_Mod_1,
      DPA_TIPO_FASC.Path_Mod_2,
      DPA_TIPO_FASC.GG_SCADENZA,
      DPA_TIPO_FASC.GG_PRE_SCADENZA,
      DPA_TIPO_FASC.IPERFASCICOLO,
      REL_PROJECT_STRUCTURE.ID_TEMPLATE AS ID_TEMPLATE_STRUTTURA
      FROM DPA_TIPO_FASC LEFT JOIN DPA_VIS_TIPO_FASC ON
      DPA_TIPO_FASC.SYSTEM_ID = DPA_VIS_TIPO_FASC.ID_TIPO_FASC
      LEFT JOIN REL_PROJECT_STRUCTURE ON DPA_TIPO_FASC.SYSTEM_ID = REL_PROJECT_STRUCTURE.ID_TIPO_FASCICOLO
      WHERE
      (
      (ID_AMM = @idAmm@ OR ID_AMM IS NULL) AND
      <!--(In_Esercizio &lt;&gt; 'NO' OR In_Esercizio IS NULL) AND--> @paramInEsercizio@
      (Abilitato_SI_NO &lt;&gt; 0 OR Abilitato_SI_NO IS NULL) AND
      DPA_VIS_TIPO_FASC.ID_RUOLO = @idRuolo@ AND
      DPA_VIS_TIPO_FASC.DIRITTI @diritti@
      )
      OR ( IPERFASCICOLO = 1 AND (ID_AMM = @idAmm@ OR ID_AMM IS NULL))
      ORDER BY DPA_TIPO_FASC.VAR_DESC_FASC
    </value>
  </query>
  <query>
    <name>S_DPA_TIPO_FASC_FROM_RUOLO_OLD</name>
    <value>
      SELECT
      DISTINCT DPA_TIPO_FASC.SYSTEM_ID,
      DPA_TIPO_FASC.VAR_DESC_FASC,
      DPA_TIPO_FASC.Abilitato_SI_NO,
      DPA_TIPO_FASC.In_Esercizio,
      DPA_TIPO_FASC.Path_Mod_1,
      DPA_TIPO_FASC.Path_Mod_2,
      DPA_TIPO_FASC.GG_SCADENZA,
      DPA_TIPO_FASC.GG_PRE_SCADENZA,
      DPA_TIPO_FASC.IPERFASCICOLO
      FROM DPA_TIPO_FASC, DPA_VIS_TIPO_FASC
      WHERE
      (
      (ID_AMM = @idAmm@ OR ID_AMM IS NULL) AND
      <!--(In_Esercizio &lt;&gt; 'NO' OR In_Esercizio IS NULL) AND--> @paramInEsercizio@
      (Abilitato_SI_NO &lt;&gt; 0 OR Abilitato_SI_NO IS NULL) AND
      DPA_TIPO_FASC.SYSTEM_ID = DPA_VIS_TIPO_FASC.ID_TIPO_FASC AND
      DPA_VIS_TIPO_FASC.ID_RUOLO = @idRuolo@ AND
      DPA_VIS_TIPO_FASC.DIRITTI @diritti@
      )
      OR ( IPERFASCICOLO = 1 AND (ID_AMM = @idAmm@ OR ID_AMM IS NULL))
      ORDER BY DPA_TIPO_FASC.VAR_DESC_FASC
    </value>
  </query>
  <query>
    <name>PD_GET_TIPO_OGGETTO_FASC</name>
    <value>
      SELECT SYSTEM_ID FROM DPA_TIPO_OGGETTO_FASC
      WHERE Descrizione = '@Descrizione@'
    </value>
  </query>
  <query>
    <name>PD_GET_DPA_TEMPLATE_FASC</name>
    <value>
      SELECT *
      FROM DPA_TIPO_FASC
      WHERE
      ID_AMM = @idAmministrazione@ AND
      Abilitato_SI_NO = 1 ORDER BY DPA_TIPO_FASC.VAR_DESC_FASC
    </value>
  </query>
  <query>
    <name>PD_DELETE_OGGETTI_CUSTOM_DA_DB_FASC</name>
    <value>
      DELETE FROM DPA_ASS_TEMPLATES_FASC
      WHERE ID_OGGETTO = @idOggettoCustom@ AND Id_Project = ''
    </value>
  </query>
  <query>
    <name>PD_AGGIORNA_POSIZIONE_FASC</name>
    <value>
      UPDATE DPA_OGG_CUSTOM_COMP_FASC
      SET POSIZIONE = @posizione@
      WHERE
      ID_TEMPLATE = @idTemplate@
      AND
      ID_OGG_CUSTOM = @idOggettoCustom@
    </value>
  </query>
  <query>
    <name>PD_SALVA_TEMPLATES_FASC</name>
    <value>
      INSERT INTO DPA_TIPO_FASC
      (
      @colID@
      VAR_DESC_FASC,
      ID_AMM,
      Abilitato_SI_NO,
      In_Esercizio,
      CHA_PRIVATO,
      NUM_MESI_CONSERVAZIONE,
      CHA_PROCEDIMENTALE
      )
      VALUES
      (
      @id@
      '@Descrizione@',
      @id_amm@,
      @Abilitato_SI_NO@,
      '@In_Esercizio@',
      '@Privato@',
      '@NUM_MESI_CONSERVAZIONE@',
      '@CHA_PROCEDIMENTALE@'
      )
    </value>
  </query>
  <query>
    <name>PD_SALVA_OGGETTO_CUSTOM_FASC</name>
    <value>
      INSERT INTO DPA_OGGETTI_CUSTOM_FASC
      (
      @colID@
      Descrizione,
      Orizzontale_Verticale,
      Campo_Obbligatorio,
      Multilinea,
      Numero_Di_Linee,
      Numero_Di_Caratteri,
      Campo_Di_Ricerca,
      ID_TIPO_OGGETTO,
      Reset_Anno,
      Formato_Contatore,
      ID_R_DEFAULT,
      RICERCA_CORR,
      CAMPO_COMUNE,
      CHA_TIPO_TAR,
      CONTA_DOPO,
      REPERTORIO,
      DA_VISUALIZZARE_RICERCA,
      FORMATO_ORA,
      TIPO_LINK,
      TIPO_OBJ_LINK,
      CONFIG_OBJ_EST
      )
      VALUES
      (
      @id@
      '@Descrizione@',
      '@Orizzontale_Verticale@',
      '@Campo_Obbligatorio@',
      '@Multilinea@',
      '@Numero_Di_Linee@',
      '@Numero_Di_Caratteri@',
      '@Campo_Di_Ricerca@',
      @ID_TIPO_OGGETTO@,
      '@Reset_Anno@',
      '@Formato_Contatore@',
      @ID_R_DEFAULT@,
      '@RICERCA_CORR@',
      @CAMPO_COMUNE@,
      '@tipoContatore@',
      @contaDopo@,
      @repertorio@,
      @da_visualizzare_ricerca@,
      '@formatoOra@',
      '@TIPO_LINK@',
      '@TIPO_OBJ_LINK@',
      NULL
      )
    </value>
  </query>
  <query>
    <name>PD_SALVA_ASS_TEMPLATES_FASC</name>
    <value>
      INSERT INTO DPA_ASS_TEMPLATES_FASC
      (
      @colID@
      ID_OGGETTO,
      ID_TEMPLATE,
      Id_Project,
      Valore_Oggetto_Db,
      Anno,
      ID_AOO_RF,
      CODICE_DB,
      MANUAL_INSERT,
      DTA_INS,
      ANNO_ACC
      )
      VALUES
      (
      @id@
      @ID_OGGETTO@,
      @ID_TEMPLATE@,
      '@Id_Project@',
      '@Valore_Oggetto_Db@',
      @Anno@,
      @idAooRf@,
      '@CODICE_DB@',
      @MANUAL_INSERT@,
      @dtaIns@,
      '@anno_acc@'
      )
    </value>
  </query>
  <query>
    <name>PD_SALVA_ASS_VALORI_FASC</name>
    <value>
      INSERT INTO DPA_ASS_VALORI_FASC
      (
      @colID@
      Descrizione_Valore,
      Valore,
      Valore_Di_Default,
      ID_OGGETTO_CUSTOM,
      ABILITATO
      )
      VALUES
      (
      @id@
      '@Descrizione_Valore@',
      '@Valore@',
      '@Valore_Di_Default@',
      @ID_OGGETTO_CUSTOM@,
      @abilitato@
      )
    </value>
  </query>
  <query>
    <name>PD_AGGIORNA_DPA_OGGETTI_CUSTOM_FASC</name>
    <value>
      UPDATE DPA_OGGETTI_CUSTOM_FASC
      SET Descrizione = '@descrizioneOggettoCustom@',
      Orizzontale_Verticale = '@orizzontaleVerticaleOggettoCustom@',
      Campo_Obbligatorio = '@campoObbligatorioOggettoCustom@',
      Multilinea = '@multilineaOggettoCustom@',
      Numero_Di_Linee ='@numeroLineeOggettoCustom@',
      Numero_Di_Caratteri ='@numeroCaratteriOggettoCustom@',
      Campo_Di_Ricerca ='@campoRicercaOggettoCustom@',
      Reset_Anno = '@Reset_Anno@',
      Formato_Contatore = '@Formato_Contatore@',
      ID_R_DEFAULT = @ID_R_DEFAULT@,
      RICERCA_CORR = '@RICERCA_CORR@',
      CAMPO_COMUNE = @CAMPO_COMUNE@,
      CHA_TIPO_TAR = '@tipoContatore@',
      CONTA_DOPO = @contaDopo@,
      REPERTORIO = @repertorio@,
      DA_VISUALIZZARE_RICERCA = @da_visualizzare_ricerca@,
      FORMATO_ORA = '@formatoOra@',
      TIPO_LINK = '@TIPO_LINK@',
      TIPO_OBJ_LINK = '@TIPO_OBJ_LINK@'
      WHERE SYSTEM_ID = @idOggettoCustom@
    </value>
  </query>
  <query>
    <name>PD_GET_DPA_ASSOCIAZIONE_VALORI_1_FASC</name>
    <value>
      SELECT * FROM DPA_ASS_VALORI_FASC
      WHERE
      ID_OGGETTO_CUSTOM = @idOggettoCustom@
      AND
      VALORE = '@valore@'
    </value>
  </query>
  <query>
    <name>PD_GET_DPA_ASSOCIAZIONE_VALORI_FASC</name>
    <value>
      SELECT * FROM DPA_ASS_VALORI_FASC
      WHERE ID_OGGETTO_CUSTOM = @idOggettoCustom@ order by system_id
    </value>
  </query>
  <query>
    <name>PD_DELETE_DPA_ASSOCIAZIONE_VALORI_1_FASC</name>
    <value>
      DELETE FROM DPA_ASS_VALORI_FASC
      WHERE
      ID_OGGETTO_CUSTOM = @idOggettoCustom@
      AND
      VALORE = '@valore@'
    </value>
  </query>
  <query>
    <name>PD_UPDATE_DPA_ASSOCIAZIONE_VALORI_FASC</name>
    <value>
      UPDATE DPA_ASS_VALORI_FASC
      SET Descrizione_Valore = '@descrizione@', VALORE_DI_DEFAULT = '@valoreDiDefault@', ABILITATO = @abilitato@
      WHERE
      ID_OGGETTO_CUSTOM = @idOggettoCustom@
      AND
      VALORE = '@valore@'
    </value>
  </query>
  <query>
    <name>PD_IS_VALUE_IN_USE_FASC</name>
    <value>
      SELECT Valore_Oggetto_db FROM DPA_ASS_TEMPLATES_FASC
      WHERE ID_OGGETTO = @idOggetto@
      AND ID_TEMPLATE = @idTemplate@
    </value>
  </query>
  <query>
    <name>PD_DELETE_DPA_ASS_TEMPLATES_FASC</name>
    <value>
      DELETE FROM DPA_ASS_TEMPLATES_FASC
      WHERE ID_TEMPLATE = @idTemplate@
    </value>
  </query>
  <query>
    <name>PD_DELETE_DPA_ASS_VALORI_FASC</name>
    <value>
      DELETE FROM DPA_ASS_VALORI_FASC
      WHERE ID_OGGETTO_CUSTOM = @idOggettoCustom@
    </value>
  </query>
  <query>
    <name>PD_DELETE_DPA_OGGETTI_CUSTOM_FASC</name>
    <value>
      DELETE FROM DPA_OGGETTI_CUSTOM_FASC
      WHERE SYSTEM_ID = @idOggettoCustom@
    </value>
  </query>
  <query>
    <name>PD_DELETE_DPA_TEMPLATE_FASC</name>
    <value>
      DELETE FROM DPA_TIPO_FASC
      WHERE SYSTEM_ID = @idTemplate@
    </value>
  </query>
  <query>
    <name>PD_DELETE_TIPO_FASC</name>
    <value>
      DELETE FROM DPA_TIPO_FASC
      WHERE VAR_DESC_FASC = '@descrizioneTemplate@' AND
      ID_AMM = @idAmministrazione@ AND SYSTEM_ID = '@idTipoFasc@'
    </value>
  </query>
  <query>
    <name>PD_DISABILITA_TEMPLATE_FASC</name>
    <value>
      UPDATE DPA_TIPO_FASC SET Abilitato_SI_NO = 0
      WHERE SYSTEM_ID = @idTemplate@
    </value>
  </query>
  <query>
    <name>PD_GET_DPA_TEMPLATE_2_FASC</name>
    <value>
      SELECT *
      FROM DPA_TIPO_FASC
      WHERE
      SYSTEM_ID = @idTemplate@
    </value>
  </query>
  <query>
    <name>PD_SYSTEM_ID_OGGETTI_CUSTOM_FASC</name>
    <value>
      SELECT DISTINCT(ID_OGGETTO), DPA_OGG_CUSTOM_COMP_FASC.POSIZIONE
      FROM DPA_ASS_TEMPLATES_FASC, DPA_OGGETTI_CUSTOM_FASC, DPA_OGG_CUSTOM_COMP_FASC
      WHERE
      DPA_ASS_TEMPLATES_FASC.ID_OGGETTO = DPA_OGGETTI_CUSTOM_FASC.SYSTEM_ID
      AND
      DPA_OGGETTI_CUSTOM_FASC.SYSTEM_ID = DPA_OGG_CUSTOM_COMP_FASC.ID_OGG_CUSTOM
      AND
      DPA_OGG_CUSTOM_COMP_FASC.ID_TEMPLATE = @idTemplate@
      AND
      DPA_ASS_TEMPLATES_FASC.ID_PROJECT = ''
      ORDER BY DPA_OGG_CUSTOM_COMP_FASC.POSIZIONE
    </value>
  </query>
  <query>
    <name>PD_GET_OGGETTI_CUSTOM_FASC</name>
    <value>
      SELECT * FROM DPA_OGGETTI_CUSTOM_FASC, DPA_OGG_CUSTOM_COMP_FASC
      WHERE
      DPA_OGGETTI_CUSTOM_FASC.SYSTEM_ID = DPA_OGG_CUSTOM_COMP_FASC.ID_OGG_CUSTOM
      AND
      DPA_OGG_CUSTOM_COMP_FASC.ID_TEMPLATE = @idTemplate@
      AND
      DPA_OGG_CUSTOM_COMP_FASC.ID_OGG_CUSTOM = @idOggettoCustom@
    </value>
  </query>
  <query>
    <name>PD_GET_TIPI_OGGETTO_1_FASC</name>
    <value>
      SELECT * FROM DPA_TIPO_OGGETTO_FASC
      WHERE SYSTEM_ID = @idOggettoCustom@
    </value>
  </query>
  <query>
    <name>PD_MESSA_IN_ESERCIZIO_FASC</name>
    <value>
      <!--UPDATE DPA_TIPO_FASC SET In_Esercizio = 'SI'-->UPDATE DPA_TIPO_FASC SET In_Esercizio = '@paramInEsercizio@'
      WHERE SYSTEM_ID = @idTemplate@
    </value>
  </query>
  <query>
    <name>S_DPA_TIPO_FASC</name>
    <value>
      SELECT
      *
      FROM DPA_TIPO_FASC
      WHERE
      (ID_AMM = @idAmm@ OR ID_AMM IS NULL) AND
      (In_Esercizio &lt;&gt; 'NO' OR In_Esercizio IS NULL) AND
      (Abilitato_SI_NO &lt;&gt; 0 OR Abilitato_SI_NO IS NULL)
    </value>
  </query>
  <query>
    <name>PD_GET_IDPROJECT</name>
    <value>
      SELECT  DPA_ASS_TEMPLATES_FASC.ID_PROJECT,
      DPA_ASS_TEMPLATES_FASC.SYSTEM_ID,
      DPA_ASS_TEMPLATES_FASC.ID_OGGETTO
      FROM
      DPA_ASS_TEMPLATES_FASC, DPA_OGG_CUSTOM_COMP_FASC
      WHERE
      DPA_ASS_TEMPLATES_FASC.ID_OGGETTO = DPA_OGG_CUSTOM_COMP_FASC.ID_OGG_CUSTOM
      AND Id_Project = '@idProject@'
      AND DPA_OGG_CUSTOM_COMP_FASC.ID_TEMPLATE = DPA_ASS_TEMPLATES_FASC.ID_TEMPLATE
      ORDER BY  DPA_OGG_CUSTOM_COMP_FASC.POSIZIONE
    </value>
  </query>
  <query>
    <name>PD_UPDATE_DPA_ASS_TEMPLATES_FASC</name>
    <value>
      UPDATE DPA_ASS_TEMPLATES_FASC
      SET Valore_Oggetto_Db = '@valoreDbOggettoCustom@', ID_AOO_RF = @idAooRf@, CODICE_DB = '@CODICE_DB@', MANUAL_INSERT=@MANUAL_INSERT@, DTA_INS = @dtaIns@, ANNO = @anno@
      WHERE Id_Project = '@idProject@' AND
      ID_TEMPLATE = @idTemplate@ AND
      ID_OGGETTO = @idOggettoCustom@ AND
      SYSTEM_ID = @system_id@ AND
      (Valore_Oggetto_Db != '@valoreDbOggettoCustom@' OR Valore_Oggetto_Db is null)
    </value>
  </query>
  <query>
    <name>PD_GET_MAX_ANNO_FASC</name>
    <value>
      SELECT MAX(ANNO) AS ANNO FROM DPA_ASS_TEMPLATES_FASC
    </value>
  </query>
  <query>
    <name>PD_GET_CONTATORE_1_FASC</name>
    <value>
      SELECT MAX(Valore_Oggetto_Db) as VALORE_OGGETTO_DB
      FROM DPA_ASS_TEMPLATES_FASC
      WHERE
      ID_OGGETTO = @idOggetto@
      AND
      ID_TEMPLATE = @idTemplate@
    </value>
  </query>
  <query>
    <name>PD_GET_ID_TEMPLATE_FROM_ID_PROJECT</name>
    <value>
      SELECT ID_TEMPLATE FROM DPA_ASS_TEMPLATES_FASC
      WHERE Id_Project = '@idProject@'
    </value>
  </query>
  <query>
    <name>PD_GET_ID_TEMPLATE_FROM_PROJECT</name>
    <value>
      SELECT ID_TIPO_FASC AS ID_TEMPLATE FROM PROJECT
      WHERE SYSTEM_ID = '@idProject@' AND ID_TIPO_FASC IS NOT NULL
    </value>
  </query>
  <query>
    <name>PD_GET_DPA_TEMPLATE_1_FASC</name>
    <value>
      SELECT SYSTEM_ID, VAR_DESC_FASC, GG_SCADENZA, GG_PRE_SCADENZA, CHA_PRIVATO
      FROM DPA_TIPO_FASC
      WHERE
      VAR_DESC_FASC = '@tipoFasc@' AND
      ID_AMM = @idAmministrazione@ <!--AND
      Abilitato_SI_NO = 1 AND
      In_Esercizio = 'SI'-->
    </value>
  </query>
  <query>
    <name>PD_GET_DESCRIZIONE_TEMPLATE_FASC</name>
    <value>
      SELECT VAR_DESC_FASC, SYSTEM_ID, CHA_PRIVATO, IPERFASCICOLO FROM DPA_TIPO_FASC
      WHERE SYSTEM_ID = @idTemplate@
    </value>
  </query>
  <query>
    <name>PD_SYSTEM_ID_OGGETTI_CUSTOM_1_FASC</name>
    <value>
      SELECT DISTINCT(ID_OGGETTO), DPA_OGG_CUSTOM_COMP_FASC.POSIZIONE
      FROM DPA_ASS_TEMPLATES_FASC, DPA_OGGETTI_CUSTOM_FASC, DPA_OGG_CUSTOM_COMP_FASC
      WHERE
      DPA_ASS_TEMPLATES_FASC.ID_OGGETTO = DPA_OGGETTI_CUSTOM_FASC.SYSTEM_ID
      AND
      DPA_OGGETTI_CUSTOM_FASC.SYSTEM_ID = DPA_OGG_CUSTOM_COMP_FASC.ID_OGG_CUSTOM
      AND
      DPA_OGG_CUSTOM_COMP_FASC.ID_TEMPLATE = @idTemplate@
      AND
      DPA_ASS_TEMPLATES_FASC.ID_PROJECT = '@idProject@'
      ORDER BY DPA_OGG_CUSTOM_COMP_FASC.POSIZIONE
    </value>
  </query>
  <query>
    <name>PD_GET_VALORE_DB_OGGETTO_CUSTOM_1_FASC</name>
    <value>
      SELECT Valore_Oggetto_Db, Anno, ID_AOO_RF, CODICE_DB, MANUAL_INSERT FROM DPA_ASS_TEMPLATES_FASC
      WHERE ID_OGGETTO = @idOggettoCustom@
      AND Id_Project = '@idProject@'
    </value>
  </query>
  <query>
    <name>PD_GET_RUOLI_TIPO_FASC</name>
    <value>
      SELECT * FROM DPA_VIS_TIPO_FASC
      WHERE
      ID_TIPO_FASC = @idTipoFasc@
    </value>
  </query>
  <query>
    <name>S_PROFILE_ANNULLAMENTO</name>
    <value>SELECT system_id FROM PROFILE WITH(NOLOCK) WHERE DOCNUMBER=@param1@ AND DTA_ANNULLA IS NOT NULL</value>
  </query>
  <query>
    <name>DELETE_SECURITY_VISIBILITA</name>
    <value>
      DELETE
      FROM SECURITY
      WHERE THING=@param1@ AND PERSONORGROUP = @param2@
    </value>
  </query>
  <query>
    <name>SELECT_ID_PROTOCOLLO_USCITA_ORIGINARIO</name>
    <value>
      SELECT DISTINCT A.DOCNUMBER
      FROM PROFILE A WITH(NOLOCK), DPA_EL_REGISTRI B, DPA_DOC_ARRIVO_PAR C
      WHERE A.ID_REGISTRO = B.SYSTEM_ID AND C.ID_PROFILE =  A.SYSTEM_ID
      AND A.NUM_PROTO = @param1@ and num_anno_proto = @param3@ ANd B.VAR_CODICE = '@param2@' AND
      C.CHA_TIPO_MITT_DEST IN ('C', 'D')
    </value>
  </query>
  <query>
    <name>GET_NODO_TITOLARIO_BY_CODICE</name>
    <value>
      SELECT * FROM PROJECT, DPA_AMMINISTRA
      WHERE
      PROJECT.ID_AMM = DPA_AMMINISTRA.SYSTEM_ID
      AND
      VAR_CODICE = '@codice@' AND CHA_TIPO_PROJ = 'T'
      AND
      PROJECT.ID_AMM = @idAmm@
      @registro@
      @idTitolario@
    </value>
  </query>
  <query>
    <name>GET_NODO_TITOLARIO</name>
    <value>
      SELECT * FROM PROJECT P, DPA_AMMINISTRA A
      WHERE A.SYSTEM_ID = P.ID_AMM AND P.SYSTEM_ID = @idTitolario@
    </value>
  </query>
  <query>
    <name>S_J_PROJECT__SECURITY_BIS</name>
    <value>
      SELECT DISTINCT
      A.SYSTEM_ID, A.VAR_COD_LIV1, A.DESCRIPTION, A.NUM_LIVELLO, A.VAR_CODICE
      FROM PROJECT A, SECURITY as B  WITH (nolock)
      WHERE A.SYSTEM_ID=B.THING AND A.CHA_TIPO_PROJ='T' AND
      (B.PERSONORGROUP= @param1@ OR B.PERSONORGROUP= @param2@ )
      AND B.ACCESSRIGHTS > 0
      AND (A.ID_REGISTRO IS NULL OR A.ID_REGISTRO='@param3@')
      @param4@
      @param5@
      ORDER BY A.NUM_LIVELLO, A.VAR_COD_LIV1
    </value>
  </query>
  <query>
    <name>S_Project1_BIS</name>
    <value>
      SELECT
      A.DESCRIPTION, A.ID_PARENT, A.NUM_LIVELLO,
      A.VAR_CODICE,A.SYSTEM_ID,A.CHA_RW,A.ID_TITOLARIO, A.CHA_BLOCCA_FIGLI, A.CHA_CONTA_PROT_TIT, A.NUM_PROT_TIT
      FROM PROJECT A
      WHERE A.CHA_TIPO_PROJ='T' AND
      @param1@
      @param2@
      @param3@
    </value>
  </query>
  <query>
    <name>S_Project3_BIS</name>
    <value>
      SELECT DISTINCT
      A.SYSTEM_ID, A.DESCRIPTION, A.ID_PARENT,A.VAR_CODICE,A.NUM_LIVELLO, A.VAR_COD_ULTIMO,
      A.ID_REGISTRO,VAR_COD_LIV1,ID_TIPO_FASC, CHA_BLOCCA_FASC, ID_TITOLARIO, CHA_STATO, DTA_ATTIVAZIONE, DTA_CESSAZIONE, VAR_NOTE
      FROM PROJECT A
      @param1@
      A.ID_AMM='@param2@' AND CHA_TIPO_PROJ='T' @param3@
      @param4@
      @param5@
      ORDER BY NUM_LIVELLO, VAR_COD_LIV1
    </value>
  </query>
  <query>
    <name>S_VAR_COD_LIV1_BIS</name>
    <value>
      SELECT VAR_COD_LIV1
      FROM PROJECT WHERE
      ID_AMM='@param1@' AND CHA_TIPO_PROJ='T' AND @param2@
      @param3@
      @param4@
    </value>
  </query>
  <query>
    <name>TITOLARIO_DELETE</name>
    <value>
      DELETE FROM PROJECT
      WHERE
      (ID_TITOLARIO = @idTitolario@ OR SYSTEM_ID = @idTitolario@)
      AND
      ID_AMM = @idAmm@
    </value>
  </query>
  <query>
    <name>TITOLARIO_INSERT</name>
    <value>
      INSERT INTO project (
      @colID@
      DESCRIPTION,
      ICONIZED,
      CHA_TIPO_PROJ,
      VAR_CODICE,
      ID_AMM,
      NUM_LIVELLO,
      ID_PARENT,
      VAR_NOTE,
      DTA_APERTURA,
      CHA_STATO,
      VAR_COD_LIV1,
      CHA_RW,
      NUM_MESI_CONSERVAZIONE,
      ID_TITOLARIO,
      DTA_ATTIVAZIONE,
      MAX_LIV_TIT
      )
      VALUES(
      @id@
      '@description@',
      'Y',
      'T',
      '@varCodice@',
      @idAmm@,
      0,
      0,
      '@varNote@',
      GETDATE(),
      'D',
      '0000',
      'W',
      0,
      0,
      GETDATE(),
      @maxLivTit@)
    </value>
  </query>
  <query>
    <name>TITOLARIO_EXIST_IN_DEF</name>
    <value>
      SELECT SYSTEM_ID FROM PROJECT
      WHERE
      ID_AMM = @idAmm@
      AND
      ID_PARENT = 0
      AND
      CHA_STATO = 'D'
    </value>
  </query>
  <query>
    <name>TITOLARIO_UPDATE</name>
    <value>
      UPDATE PROJECT SET
      VAR_NOTE = '@varNote@',
      DESCRIPTION = '@description@',
      MAX_LIV_TIT = @maxLivTit@
      WHERE
      SYSTEM_ID = @systemId@
    </value>
  </query>
  <query>
    <name>TITOLARIO_UPDATE_VAR_CHIAVE_FASC</name>
    <value>
      UPDATE PROJECT SET VAR_CHIAVE_FASC = '@varChiaveFasc@'
      WHERE
      SYSTEM_ID = @systemId@
    </value>
  </query>
  <query>
    <name>TITOLARIO_SET_ATTIVO</name>
    <value>
      UPDATE PROJECT
      SET CHA_STATO = 'A'
      WHERE
      SYSTEM_ID = @systemId@
    </value>
  </query>
  <query>
    <name>TITOLARIO_SET_CESSATO</name>
    <value>
      UPDATE PROJECT
      SET DTA_CESSAZIONE = GETDATE(), CHA_STATO = 'C'
      WHERE
      ID_AMM = @idAmm@
      AND CHA_STATO = 'A'
      AND ID_PARENT = 0
      AND CHA_TIPO_PROJ = 'T'
      AND ID_TITOLARIO = 0
      AND VAR_CODICE = 'T'
    </value>
  </query>
  <query>
    <name>TITOLARIO_GET_TITOLARI</name>
    <value>
      SELECT P.*, A.VAR_CODICE_AMM FROM PROJECT P, DPA_AMMINISTRA A
      WHERE
      P.ID_AMM = @idAmm@
      AND
      P.ID_TITOLARIO = 0
      AND
      P.ID_PARENT = 0
      AND
      P.ID_AMM = A.SYSTEM_ID
      ORDER BY P.CHA_STATO, P.DTA_CESSAZIONE DESC
    </value>
  </query>
  <query>
    <name>S_NODO_TITOLARIO_SECURITY_2</name>
    <value>
      SELECT DISTINCT
      a.system_id as IDRECORD,
      a.var_codice as CODICE,
      a.description as DESCRIZIONE,
      a.num_livello as LIVELLO,
      a.id_registro as REGISTRO,
      a.id_parent as IDPARENT,
      a.var_cod_liv1 as CODLIV,
      a.cha_stato as STATO,
      a.dta_attivazione as DATA_ATTIVAZIONE,
      a.dta_cessazione as DATA_CESSAZIONE,
      a.num_mesi_conservazione as NUMMESICONSERVAZIONE,
      (SELECT count(b.system_id)
      FROM PROJECT b
      WHERE b.cha_tipo_proj = 'T'
      AND b.id_amm = @idAmm@
      AND b.id_parent = a.system_id
      ) as FIGLIO
      FROM PROJECT a
      WHERE a.cha_tipo_proj = 'T'
      AND a.system_id = @systemIdTit@
      ORDER BY a.var_cod_liv1
    </value>
  </query>
  <query>
    <name>TITOLARIO_BY_SYSTEM_ID</name>
    <value>
      SELECT P.*, A.VAR_CODICE_AMM FROM PROJECT P, DPA_AMMINISTRA A
      WHERE P.SYSTEM_ID = @systemId@ AND P.ID_AMM = A.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>EXIST_TEMPLATES_FASC</name>
    <value>
      SELECT COUNT(*) AS NUMBER_TEMPLATES FROM DPA_ASS_TEMPLATES_FASC
    </value>
  </query>
  <query>
    <name>GET_TITOLARIO_ATTIVO</name>
    <value>
      SELECT P.*, A.VAR_CODICE_AMM FROM PROJECT P, DPA_AMMINISTRA A
      WHERE
      P.CHA_STATO = 'A'
      AND
      P.ID_AMM = @idAmm@
      AND
      P.ID_TITOLARIO = 0
      AND
      P.VAR_CODICE = 'T'
      AND
      P.ID_PARENT = 0
      AND
      P.ID_AMM = A.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>PASSWORD_CONFIG_GET_DATA</name>
    <value>
      SELECT	SYSTEM_ID,
      ENABLE_PASSWORD_EXPIRATION,
      PASSWORD_EXPIRATION_DAYS,
      PASSWORD_MIN_LENGTH,
      PASSWORD_SPECIAL_CHAR_LIST
      FROM	  DPA_AMMINISTRA
      WHERE 	SYSTEM_ID @idAmministrazione@
    </value>
  </query>
  <query>
    <name>PASSWORD_CONFIG_GET_DATA_FROM_USER_ID</name>
    <value>
      SELECT	A.SYSTEM_ID,
      A.ENABLE_PASSWORD_EXPIRATION,
      A.PASSWORD_EXPIRATION_DAYS,
      A.PASSWORD_MIN_LENGTH,
      A.PASSWORD_SPECIAL_CHAR_LIST
      FROM	  DPA_AMMINISTRA A, PEOPLE P
      WHERE 	P.USER_ID = '@userId@' AND
      A.SYSTEM_ID = P.ID_AMM
    </value>
  </query>

  <query>
    <name>PASSWORD_CONFIG_GET_DATA_FROM_USER_ID_BY_AMM</name>
    <value>
      SELECT	A.SYSTEM_ID,
      A.ENABLE_PASSWORD_EXPIRATION,
      A.PASSWORD_EXPIRATION_DAYS,
      A.PASSWORD_MIN_LENGTH,
      A.PASSWORD_SPECIAL_CHAR_LIST
      FROM	  DPA_AMMINISTRA A, PEOPLE P
      WHERE 	P.USER_ID = '@userId@' AND
      A.SYSTEM_ID = P.ID_AMM
      AND  P.ID_AMM = @codAmm@
    </value>
  </query>



  <query>
    <name>PASSWORD_CONFIG_SET_DATA</name>
    <value>
      UPDATE 	DPA_AMMINISTRA
      SET	    ENABLE_PASSWORD_EXPIRATION = @enablePasswordExpiration@,
      PASSWORD_EXPIRATION_DAYS = @passwordExpirationDays@,
      PASSWORD_MIN_LENGTH = @passwordMinLength@,
      PASSWORD_SPECIAL_CHAR_LIST = @passwordSpecialChars@
      WHERE 	SYSTEM_ID @idAmministrazione@
    </value>
  </query>
  <query>
    <name>PASSWORD_DOMAIN_AUTH_ENABLED</name>
    <value>
      SELECT VAR_DOMINIO
      FROM DPA_AMMINISTRA
      WHERE SYSTEM_ID @idAmministrazione@
    </value>
  </query>
  <query>
    <name>PASSWORD_EXPIRATION_SET_CREATION_DATE_ALL_USER</name>
    <value>
      UPDATE 	  PEOPLE
      SET 	    PASSWORD_CREATION_DATE = @passwordCreationDate@
      WHERE	    ID_AMM @idAmministrazione@
    </value>
  </query>
  <query>
    <name>PASSWORD_EXPIRATION_EXPIRE_ALL</name>
    <value>
      UPDATE 	  PEOPLE
      SET 	    PASSWORD_CREATION_DATE = NULL
      WHERE	    ID_AMM @idAmministrazione@ AND
      (CHA_AMMINISTRATORE IS NULL OR CHA_AMMINISTRATORE = '0')
    </value>
  </query>
  <query>
    <name>USER_PASSWORD_GET_PASSWORD</name>
    <value>
      SELECT 	P.ENCRYPTED_PASSWORD
      FROM	  PEOPLE P
      WHERE   P.USER_ID = '@userId@'
    </value>
  </query>

  <query>
    <name>USER_PASSWORD_GET_PASSWORD_WITHCODAMM</name>
    <value>
      SELECT 	P.ENCRYPTED_PASSWORD
      FROM	  PEOPLE P
      WHERE   P.USER_ID = '@userId@'
      AND     P.ID_AMM = @codAmm@
    </value>
  </query>


  <query>
    <name>USER_PASSWORD_SET_PASSWORD</name>
    <value>
      UPDATE 	PEOPLE
      SET 	  USER_PASSWORD = NULL,
      ENCRYPTED_PASSWORD = '@encryptedPassword@',
      PASSWORD_CREATION_DATE = @passwordCreationDate@
      WHERE	  USER_ID = '@userId@'
    </value>
  </query>

  <query>
    <name>USER_PASSWORD_SET_PASSWORD_FOR_USER_IN_AMM</name>
    <value>
      UPDATE 	PEOPLE
      SET 	  USER_PASSWORD = NULL,
      ENCRYPTED_PASSWORD = '@encryptedPassword@',
      PASSWORD_CREATION_DATE = @passwordCreationDate@
      WHERE	  USER_ID = '@userId@'
      AND     ID_AMM = @codAmm@
    </value>
  </query>



  <query>
    <name>USER_PASSWORD_GET_DATA</name>
    <value>
      SELECT 	P.PASSWORD_CREATION_DATE,
      P.PASSWORD_NEVER_EXPIRE,
      P.CHA_AMMINISTRATORE
      FROM	  PEOPLE P
      WHERE  P.USER_ID = '@userId@'
    </value>
  </query>

  <query>
    <name>USER_IN_AMM_PASSWORD_GET_DATA</name>
    <value>
      SELECT 	P.PASSWORD_CREATION_DATE,
      P.PASSWORD_NEVER_EXPIRE,
      P.CHA_AMMINISTRATORE
      FROM	  PEOPLE P
      WHERE  P.USER_ID = '@userId@'
      AND P.ID_AMM = @codAmm@
    </value>
  </query>


  <query>
    <name>USER_PASSWORD_SET_PASSWORD_NEVER_EXPIRE_OPTION</name>
    <value>
      UPDATE 	PEOPLE
      SET 	  PASSWORD_NEVER_EXPIRE = @passwordNeverExpire@
      WHERE	  USER_ID = '@userId@' AND
      (CHA_AMMINISTRATORE IS NULL OR CHA_AMMINISTRATORE = '0')
    </value>
  </query>
  <query>
    <name>AMM_GET_DETTAGLI_UTENTE_AMMINISTRATORE</name>
    <value>
      SELECT  PEOPLE.system_id AS ID,
      PEOPLE.cha_amministratore AS TIPO,
      PEOPLE.var_nome AS NOME,
      PEOPLE.var_cognome AS COGNOME,
      PEOPLE.id_amm AS IDAMM,
      DPA_CORR_GLOBALI.system_id AS ID_CORR_GLOBALI
      FROM    PEOPLE LEFT OUTER JOIN DPA_CORR_GLOBALI
      ON PEOPLE.system_id = DPA_CORR_GLOBALI.id_people
      WHERE   user_id = '@userId@'
      AND disabled = 'N'
      AND cha_amministratore in ('1','2','3')
    </value>
  </query>
  <query>
    <name>U_PROJECT_3</name>
    <value>
      UPDATE PROJECT
      SET ID_TITOLARIO = @idTitolario@
      WHERE
      SYSTEM_ID in (@idFascicolo@,@idFolder@)
    </value>
  </query>
  <query>
    <name>S_SMISTADOC_GET_RUOLI_UO_SOTTOSTANTI_PROTO_SEMPL</name>
    <value>
      SELECT DISTINCT	CG.SYSTEM_ID AS ID,
      CG.ID_UO AS ID_UO,
      CG.ID_GRUPPO AS ID_GRUPPO,
      CG.VAR_CODICE AS CODICE_RUOLO,
      CG.VAR_DESC_CORR AS DESCRIZIONE_RUOLO,
      CG.CHA_RIFERIMENTO AS RUOLO_RIFERIMENTO,
      (case
      when TR.NUM_LIVELLO &gt; @livello@ then 0
      when TR.NUM_LIVELLO = @livello@ then 2
      when TR.NUM_LIVELLO &lt; @livello@ then 1
      end
      ) AS GERARCHIA
      FROM	DPA_CORR_GLOBALI CG,
      DPA_TIPO_RUOLO TR,
      DPA_L_RUOLO_REG RR
      WHERE	CG.ID_TIPO_RUOLO = TR.SYSTEM_ID	AND
      RR.ID_RUOLO_IN_UO = CG.SYSTEM_ID AND
      CG.ID_TIPO_RUOLO = TR.SYSTEM_ID	 AND
      RR.ID_REGISTRO IN (@param2@) AND
      RR.DTA_FINE IS NULL AND
      CG.ID_UO = @param1@ AND
      CG.CHA_TIPO_URP='R' AND
      CG.DTA_FINE IS NULL
    </value>
  </query>
  <query>
    <name>AMM_U_UPDATE_MSG_NOTIFICA_RAGIONE_TRASMISSIONE</name>
    <value>
      UPDATE 	DPA_RAGIONE_TRASM
      SET @testoMsgNotificaDoc@
      @testoMsgNotificaFasc@
      WHERE ID_AMM=@idAmministrazione@ @paramAllRag@
    </value>
  </query>
  <query>
    <name>S_NODI_TITOLARIO</name>
    <value>
      SELECT system_id FROM project WHERE
      ID_TITOLARIO = @idTitolario@
      AND
      ID_AMM = @idAmm@
    </value>
  </query>
  <query>
    <name>TITOLARIO_DELETE_2</name>
    <value>
      DELETE FROM project
      WHERE
      system_id = @idTitolario@
    </value>
  </query>
  <query>
    <name>TITOLARIO_GET_NODI</name>
    <value>
      SELECT * FROM PROJECT
      WHERE
      ID_TITOLARIO = @idTitolario@
      AND
      CHA_TIPO_PROJ = 'T'
      @condRegistro@
      ORDER BY VAR_COD_LIV1
    </value>
  </query>
  <query>
    <name>REMOVE_USER_LOGIN_LOCK</name>
    <value>
      DELETE FROM DPA_LOGIN WHERE DST='@dst@'
    </value>
  </query>
  <query>
    <name>TITOLARIO_GET_NODI_NEW</name>
    <value>
      SELECT *,b.VAR_DESC_REGISTRO FROM PROJECT a join DPA_EL_REGISTRI b on a.ID_REGISTRO = b.SYSTEM_ID
      WHERE
      ID_TITOLARIO = @idTitolario@
      AND
      CHA_TIPO_PROJ = 'T'
      @condRegistro@
      ORDER BY a.VAR_COD_LIV1
    </value>
  </query>
  <query>
    <name>HUMMY_I_MANUAL_CHECKOUT_DOCUMENT</name>
    <value>
      INSERT INTO CHECKOUT
      (
      @colId@
      DOCNUMBER,
      VERSION_LABEL,
      TYPIST,
      CHECKOUT_DATE,
      CHECKIN_DATE,
      CHECKOUT_TIME,
      LOCATION
      )
      VALUES
      (
      @systemId@
      @docNumber@,
      @versionLabel@,
      @typist@,
      @checkoutdate@,
      @checkindate@,
      @checkouttime@,
      '@location@'
      )
    </value>
  </query>

  <query>
    <name>TITOLARIO_GET_TITOLARI_UTILI_BY_IDREGISTRO</name>
    <value>
      SELECT p.*,b.VAR_CODICE_AMM  FROM PROJECT p,DPA_AMMINISTRA b WHERE p.SYSTEM_ID IN (
      SELECT DISTINCT(a.ID_TITOLARIO) FROM
      (
      SELECT * FROM PROJECT WHERE
      (ID_REGISTRO= @idReg@ or
      ID_REGISTRO IS NULL)
      AND
      CHA_STATO is null and CHA_TIPO_PROJ = 'T'
      ) as a
      )AND p.ID_AMM = @idAmm@ AND p.ID_TITOLARIO = 0 AND p.ID_PARENT = 0 AND p.ID_AMM = b.SYSTEM_ID and p.CHA_STATO != 'D'
      ORDER BY p.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>HUMMY_D_MANUAL_CHECKOUT_DOCUMENT</name>
    <value>
      DELETE FROM CHECKOUT
      WHERE DOCNUMBER = @docNumber@
    </value>
  </query>
  <query>
    <name>UPDATE_CHIUSURA_FASC_PROC</name>
    <value>
      update PROJECT set ID_TITOLARIO =(@systemId@)
      WHERE  (CHA_TIPO_FASCICOLO = 'P') AND ID_AMM = @idAmm@
      AND ID_TITOLARIO in (select SYSTEM_ID from PROJECT where CHA_STATO='A' AND ID_TITOLARIO=0) @param1@
    </value>
  </query>
  <!--fine Emilio-->
  <!--Emilio Titolario Aggiornamento 16 Luglio-->
  <query>
    <name>HUMMY_U_MANUAL_CHECKINOUT_DOCUMENT_STATE</name>
    <value>
      UPDATE PROFILE
      SET STATUS = @status@
      WHERE DOCNUMBER = @docNumber@
    </value>
  </query>
  <query>
    <name>TITOLARIO_GET_ALL_DEF</name>
    <value>
      select distinct
      b.id_registro as REGISTRO, isnull ((select DISTINCT a.var_desc_registro FROM DPA_EL_REGISTRI A WHERE A.SYSTEM_ID = B.ID_REGISTRO),'Nodi Comuni') as AOO ,
      b.id_titolario as TITOLARIO  , isnull ((select DISTINCT a.VAR_CODICE FROM DPA_EL_REGISTRI A WHERE A.SYSTEM_ID = B.ID_REGISTRO),'CODCOM') as CODICEAOO  from PROJECT b
      where b.ID_PARENT in (select DISTINCT system_id from PROJECT where CHA_STATO='D')
      @condReg@
    </value>
  </query>
  <!--fine Emilio-->
  <!--Emilio Titolario-->
  <query>
    <name>PD_GET_CAMPI_COMUNI_FASC</name>
    <value>
      SELECT DPA_OGGETTI_CUSTOM_FASC.SYSTEM_ID FROM DPA_ASS_TEMPLATES_FASC, DPA_OGGETTI_CUSTOM_FASC
      WHERE
      DPA_ASS_TEMPLATES_FASC.ID_OGGETTO = DPA_OGGETTI_CUSTOM_FASC.SYSTEM_ID
      AND
      DPA_ASS_TEMPLATES_FASC.ID_TEMPLATE = @idTemplate@
      AND
      DPA_ASS_TEMPLATES_FASC.ID_PROJECT = ''
      AND
      DPA_OGGETTI_CUSTOM_FASC.CAMPO_COMUNE = 1
    </value>
  </query>

  <query>
    <name>TITOLARIO_GET_ALL</name>
    <value>
      SELECT DISTINCT
      (select var_codice from DPA_EL_REGISTRI where SYSTEM_ID = a.ID_REGISTRO) as CODICEAOO,
      (select var_desc_registro from DPA_EL_REGISTRI where SYSTEM_ID = a.ID_REGISTRO) as AOO,
      a.system_id as IDRECORD,
      a.var_codice as CODICE,
      a.description as DESCRIZIONE,
      a.num_livello as LIVELLO,
      a.id_registro as REGISTRO,
      a.id_parent as IDPARENT,
      a.var_cod_liv1 as CODLIV,
      cha_rw as RW,(SELECT count(b.system_id)
      FROM PROJECT b
      WHERE b.cha_tipo_proj = 'T'
      AND b.id_amm = @idAmministrazione@
      AND b.id_parent = a.system_id
      ) as FIGLIO,
      a.NUM_MESI_CONSERVAZIONE as NUMMESICONSERVAZIONE,
      a.ID_TIPO_FASC,
      a.CHA_BLOCCA_FASC,
      a.ID_TITOLARIO,
      a.CHA_STATO,
      a.DTA_ATTIVAZIONE,
      a.DTA_CESSAZIONE,
      a.VAR_NOTE,
      a.CHA_BLOCCA_FIGLI,
      a.CHA_CONTA_PROT_TIT,
      a.NUM_PROT_TIT,
      a.CHA_CONSENTI_CLASS,
      a.CHA_CONSENTI_FASC
      FROM  PROJECT a
      WHERE a.cha_tipo_proj = 'T'
      AND a.id_amm = @idAmministrazione@
      AND a.id_parent = @idParentTitolario@
      ORDER BY AOO
    </value>
  </query>
  <!--fine Emilio-->
  <query>
    <name>PD_DELETE_CAMPI_COMUNI_FASC</name>
    <value>
      DELETE DPA_ASS_TEMPLATES_FASC
      WHERE
      ID_TEMPLATE = @idTemplate@
      AND
      ID_OGGETTO = @idOggettoCustom@
      AND
      ID_PROJECT = ''
    </value>
  </query>
  <!--Emilio-->
  <query>
    <name>AMM_S_NODO_TITOLARIO_PADRI</name>
    <value>
      select a.system_id as IDRECORD,
      a.var_codice as CODICE,
      a.description as DESCRIZIONE,
      a.num_livello as LIVELLO,
      a.id_registro as REGISTRO,
      a.id_parent as IDPARENT,
      a.var_cod_liv1 as CODLIV,
      a.cha_rw as RW,(SELECT count(b.system_id)
      FROM PROJECT b
      WHERE b.cha_tipo_proj = 'T'
      AND b.id_amm = @idamm@
      AND b.id_parent = a.system_id
      ) as FIGLIO,
      a.NUM_MESI_CONSERVAZIONE as NUMMESICONSERVAZIONE,
      a.ID_TIPO_FASC,
      a.CHA_BLOCCA_FASC,
      a.ID_TITOLARIO,
      a.CHA_STATO,
      a.DTA_ATTIVAZIONE,
      a.DTA_CESSAZIONE,
      a.VAR_NOTE,
      a.CHA_BLOCCA_FIGLI,
      a.CHA_CONTA_PROT_TIT,
      a.NUM_PROT_TIT,
      a.CHA_CONSENTI_CLASS, a.CHA_CONSENTI_FASC from PROJECT a where a.ID_AMM=@idamm@ and a.ID_PARENT = @idparent@ and a.SYSTEM_ID in (

      select distinct(a.ID_TITOLARIO) from
      (
      select * from PROJECT where @condreg@ CHA_STATO is null and CHA_TIPO_PROJ = 'T'
      ) as a )

      union (select a.system_id as IDRECORD,
      a.var_codice as CODICE,
      a.description as DESCRIZIONE,
      a.num_livello as LIVELLO,
      a.id_registro as REGISTRO,
      a.id_parent as IDPARENT,
      a.var_cod_liv1 as CODLIV,
      a.cha_rw as RW,(SELECT count(b.system_id)
      FROM PROJECT b
      WHERE b.cha_tipo_proj = 'T'
      AND b.id_amm = @idamm@
      AND b.id_parent = a.system_id
      ) as FIGLIO,
      a.NUM_MESI_CONSERVAZIONE as NUMMESICONSERVAZIONE,
      a.ID_TIPO_FASC,
      a.CHA_BLOCCA_FASC,
      a.ID_TITOLARIO,
      a.CHA_STATO,
      a.DTA_ATTIVAZIONE,
      a.DTA_CESSAZIONE,
      a.VAR_NOTE,
      a.CHA_BLOCCA_FIGLI,
      a.CHA_CONTA_PROT_TIT,
      a.NUM_PROT_TIT,
      a.CHA_CONSENTI_CLASS, a.CHA_CONSENTI_FASC from PROJECT a where a.CHA_STATO = 'D')
    </value>
  </query>
  <!--fine Emilio-->
  <query>
    <name>PD_INSERT_DPA_OGG_CUSTOM_COMP_FASC</name>
    <value>
      INSERT INTO DPA_OGG_CUSTOM_COMP_FASC
      (
      @colID@
      ID_TEMPLATE,
      ID_OGG_CUSTOM,
      POSIZIONE
      )
      VALUES
      (
      @id@
      @idTemplate@,
      @idOggettoCustom@,
      @posizione@
      )
    </value>
  </query>
  <query>
    <name>PD_DELETE_DPA_OGG_CUSTOM_COMP_FASC</name>
    <value>
      DELETE FROM DPA_OGG_CUSTOM_COMP_FASC
      WHERE
      ID_TEMPLATE = @idTemplate@
      AND
      ID_OGG_CUSTOM = @idOggettoCustom@
    </value>
  </query>

  <!--Emilio Titolario-->
  <query>
    <name>INSERT_STORICO_TITOLARIO_BY_REGISTRO</name>
    <value>
      insert into PROJECT (
      @colID@
      DESCRIPTION,
      ICONIZED,
      CHA_TIPO_PROJ,
      VAR_CODICE,
      ID_AMM,
      NUM_LIVELLO,
      ID_PARENT,
      VAR_NOTE,
      DTA_APERTURA,
      CHA_STATO,
      VAR_COD_LIV1,
      CHA_RW,
      NUM_MESI_CONSERVAZIONE,
      ID_TITOLARIO,
      DTA_ATTIVAZIONE,
      DTA_CESSAZIONE,
      MAX_LIV_TIT
      )
      VALUES(
      @id@
      'Titolario Storico',
      'Y',
      'T',
      (select VAR_CODICE from PROJECT where CHA_STATO='A' and ID_TITOLARIO=0),
      @idAmm@,
      0,
      0,
      (select VAR_NOTE from PROJECT where CHA_STATO='A' and ID_TITOLARIO=0),
      GETDATE(),
      'C',
      '0000',
      'W',
      0,
      0,
      GETDATE(),
      GETDATE(),
      (select MAX_LIV_TIT from PROJECT where CHA_STATO='A' and ID_TITOLARIO=0))
    </value>
  </query>
  <!--fine Emilio-->
  <!--Emilio Titolario-->
  <query>
    <name>UPDATE_CHIUSURA_NODI_BY_REGISTRO</name>
    <value>
      UPDATE PROJECT
      SET
      ID_TITOLARIO=(@systemId@),
      PROJECT.CHA_STATO = 'C',
      PROJECT.DTA_CHIUSURA = GETDATE()
      WHERE
      PROJECT.CHA_TIPO_FASCICOLO = 'G'
      AND
      (PROJECT.DTA_CHIUSURA IS NULL OR PROJECT.DTA_CHIUSURA = '')
      AND
      PROJECT.ID_TITOLARIO IN
      (
      SELECT
      SYSTEM_ID
      FROM PROJECT
      WHERE
      PROJECT.ID_AMM = @idAmm@
      AND
      PROJECT.CHA_STATO = 'A'
      AND
      PROJECT.ID_PARENT = 0
      AND
      PROJECT.CHA_TIPO_PROJ = 'T'
      AND
      PROJECT.ID_TITOLARIO = 0
      AND
      PROJECT.VAR_CODICE = 'T'
      )
      @param1@
    </value>
  </query>
  <!--fine Emilio-->
  <!--Emilio Titolario-->
  <query>
    <name>UPDATE_TITOLARIO_STORICO_BY_REGISTRO</name>
    <value>
      update PROJECT
      set ID_PARENT=(@systemId@),
      ID_TITOLARIO=(@systemId@),
      DTA_CHIUSURA=GETDATE(),DTA_CESSAZIONE=GETDATE()
      WHERE ID_PARENT in (select SYSTEM_ID from PROJECT where CHA_STATO='A' and ID_TITOLARIO=0) and
      NUM_LIVELLO=1 and CHA_STATO is null @param1@
    </value>
  </query>
  <!--fine Emilio-->
  <!--Emilio Titolario-->
  <query>
    <name>UPDATE_CHIUSURA_NODI_LIVELLI_BY_REGISTRO</name>
    <value>
      update PROJECT
      set ID_TITOLARIO=(@systemId@),
      DTA_CHIUSURA=GETDATE(),DTA_CESSAZIONE=GETDATE()
      WHERE ID_TITOLARIO in (select SYSTEM_ID from PROJECT where CHA_STATO='A' and ID_TITOLARIO=0) and
      CHA_STATO is null and NUM_LIVELLO > 1 @param1@
    </value>
  </query>
  <!--fine Emilio-->
  <!--Emilio Titolario-->
  <query>
    <name>UPDATE_TITOLARIO_DEFINIZIONE_BY_REGISTRO</name>
    <value>
      update PROJECT
      set ID_PARENT=(select SYSTEM_ID from PROJECT where CHA_STATO='A' and ID_TITOLARIO=0),
      ID_TITOLARIO=(select SYSTEM_ID from PROJECT where CHA_STATO='A' and ID_TITOLARIO=0),
      DTA_APERTURA=GETDATE()
      WHERE ID_PARENT in (select SYSTEM_ID from PROJECT where CHA_STATO='D' and ID_TITOLARIO=0) and
      NUM_LIVELLO=1 and CHA_STATO is null @param1@
    </value>
  </query>
  <!--Emilio Titolario Aggiornamento 17 Luglio-->
  <query>
    <name>UPDATE_TITOLARIO_DEFINIZIONE_TIPO_T</name>
    <value>
      update PROJECT
      set ID_TITOLARIO=(select SYSTEM_ID from PROJECT where CHA_STATO='A' and ID_TITOLARIO=0)
      where cha_tipo_proj = 'T' and ID_TITOLARIO in (select SYSTEM_ID from PROJECT where CHA_STATO='D' and ID_TITOLARIO=0)
      and NUM_LIVELLO > 1 @param1@
    </value>
  </query>
  <!--Emilio Titolario Aggiornamento 17 Luglio-->
  <query>
    <name>UPDATE_TITOLARIO_DEFINIZIONE_TIPO_F</name>
    <value>
      update PROJECT
      set ID_TITOLARIO=(select SYSTEM_ID from PROJECT where CHA_STATO='A' and ID_TITOLARIO=0)
      where cha_tipo_proj = 'F' and ID_TITOLARIO in (select SYSTEM_ID from PROJECT where CHA_STATO='D' and ID_TITOLARIO=0)
      and CHA_TIPO_FASCICOLO = 'G' @param1@
    </value>
  </query>
  <!--Emilio Titolario Aggiornamento 17 Luglio-->
  <query>
    <name>UPDATE_TITOLARIO_DEFINIZIONE_TIPO_C</name>
    <value>
      update PROJECT
      set ID_TITOLARIO=(select SYSTEM_ID from PROJECT where CHA_STATO='A' and ID_TITOLARIO=0)
      where CHA_TIPO_PROJ = 'C' and ID_PARENT in (select SYSTEM_ID from PROJECT where CHA_TIPO_FASCICOLO = 'G' @param1@)
      and ID_TITOLARIO in (select SYSTEM_ID from PROJECT where CHA_STATO='D' and ID_TITOLARIO=0)
    </value>
  </query>
  <!--Emilio Titolario-->
  <query>
    <name>UPDATE_TITOLARIO_ATTIVO</name>
    <value>
      update PROJECT set VAR_NOTE = (select VAR_NOTE from PROJECT where CHA_STATO = 'd' and ID_TITOLARIO = 0),
      MAX_LIV_TIT = (select MAX_LIV_TIT from PROJECT where CHA_STATO = 'd' and ID_TITOLARIO = 0)
      where SYSTEM_ID = (select SYSTEM_ID from PROJECT where CHA_STATO = 'a' and ID_TITOLARIO = 0)
    </value>
  </query>
  <!--fine Emilio-->
  <query>
    <name>REMOVE_USER_LOGIN_LOCK</name>
    <value>
      DELETE FROM DPA_LOGIN WHERE DST='@dst@'
    </value>
  </query>
  <query>
    <name>HUMMY_I_MANUAL_CHECKOUT_DOCUMENT</name>
    <value>
      INSERT INTO CHECKOUT
      (
      @colId@
      DOCNUMBER,
      VERSION_LABEL,
      TYPIST,
      CHECKOUT_DATE,
      CHECKIN_DATE,
      CHECKOUT_TIME,
      LOCATION
      )
      VALUES
      (
      @systemId@
      @docNumber@,
      @versionLabel@,
      @typist@,
      @checkoutdate@,
      @checkindate@,
      @checkouttime@,
      '@location@'
      )
    </value>
  </query>
  <query>
    <name>HUMMY_D_MANUAL_CHECKOUT_DOCUMENT</name>
    <value>
      DELETE FROM CHECKOUT
      WHERE DOCNUMBER = @docNumber@
    </value>
  </query>
  <query>
    <name>HUMMY_U_MANUAL_CHECKINOUT_DOCUMENT_STATE</name>
    <value>
      UPDATE PROFILE
      SET STATUS = @status@
      WHERE DOCNUMBER = @docNumber@
    </value>
  </query>
  <query>
    <name>PD_GET_CAMPI_COMUNI_FASC</name>
    <value>
      SELECT DPA_OGGETTI_CUSTOM_FASC.SYSTEM_ID FROM DPA_ASS_TEMPLATES_FASC, DPA_OGGETTI_CUSTOM_FASC
      WHERE
      DPA_ASS_TEMPLATES_FASC.ID_OGGETTO = DPA_OGGETTI_CUSTOM_FASC.SYSTEM_ID
      AND
      DPA_ASS_TEMPLATES_FASC.ID_TEMPLATE = @idTemplate@
      AND
      DPA_ASS_TEMPLATES_FASC.ID_PROJECT = ''
      AND
      DPA_OGGETTI_CUSTOM_FASC.CAMPO_COMUNE = 1
    </value>
  </query>
  <query>
    <name>PD_DELETE_CAMPI_COMUNI_FASC</name>
    <value>
      DELETE DPA_ASS_TEMPLATES_FASC
      WHERE
      ID_TEMPLATE = @idTemplate@
      AND
      ID_OGGETTO = @idOggettoCustom@
      AND
      ID_PROJECT = ''
    </value>
  </query>
  <query>
    <name>PD_INSERT_DPA_OGG_CUSTOM_COMP_FASC</name>
    <value>
      INSERT INTO DPA_OGG_CUSTOM_COMP_FASC
      (
      @colID@
      ID_TEMPLATE,
      ID_OGG_CUSTOM,
      POSIZIONE
      )
      VALUES
      (
      @id@
      @idTemplate@,
      @idOggettoCustom@,
      @posizione@
      )
    </value>
  </query>
  <query>
    <name>PD_DELETE_DPA_OGG_CUSTOM_COMP_FASC</name>
    <value>
      DELETE FROM DPA_OGG_CUSTOM_COMP_FASC
      WHERE
      ID_TEMPLATE = @idTemplate@
      AND
      ID_OGG_CUSTOM = @idOggettoCustom@
    </value>
  </query>
  <query>
    <name>PD_UPDATE_DPA_OGG_CUSTOM_COMP_FASC</name>
    <value>
      UPDATE  DPA_OGG_CUSTOM_COMP_FASC
      SET POSIZIONE = @posizione@
      WHERE
      ID_TEMPLATE = @idTemplate@
      AND
      ID_OGG_CUSTOM = @idOggettoCustom@
    </value>
  </query>
  <query>
    <name>PD_IS_IN_USE_CAMPO_COMUNE_FASC</name>
    <value>
      SELECT * FROM DPA_ASS_TEMPLATES_FASC
      WHERE
      ID_TEMPLATE &lt; &gt; @idTemplate@
      AND
      ID_OGGETTO = @idOggetto@
      AND
      ID_PROJECT = ''
    </value>
  </query>
  <query>
    <name>PD_INSERT_DPA_OGG_CUSTOM_COMP</name>
    <value>
      INSERT INTO DPA_OGG_CUSTOM_COMP
      (
      @colID@
      ID_TEMPLATE,
      ID_OGG_CUSTOM,
      POSIZIONE
      )
      VALUES
      (
      @id@
      @idTemplate@,
      @idOggettoCustom@,
      @posizione@
      )
    </value>
  </query>
  <query>
    <name>PD_DELETE_DPA_OGG_CUSTOM_COMP</name>
    <value>
      DELETE FROM DPA_OGG_CUSTOM_COMP
      WHERE
      ID_TEMPLATE = @idTemplate@
      AND
      ID_OGG_CUSTOM = @idOggettoCustom@
    </value>
  </query>
  <query>
    <name>PD_GET_CONT_DOC</name>
    <value>
      SELECT * FROM DPA_CONTATORI_DOC
      WITH(UPDLOCK)
      WHERE
      ID_OGG = @idOggetto@
      AND
      ID_TIPOLOGIA = @idTipologia@
    </value>
  </query>
  <query>
    <name>PD_UPDATE_CONT_DOC</name>
    <value>
      UPDATE DPA_CONTATORI_DOC
      SET VALORE = @valoreContatore@, ANNO = @anno@, VALORE_SC = @valoreSottocontatore@
      WHERE
      SYSTEM_ID = @idContatore@
    </value>
  </query>
  <query>
    <name>PD_GET_CONT_FASC</name>
    <value>
      SELECT * FROM DPA_CONTATORI_FASC
      WITH(UPDLOCK)
      WHERE
      ID_OGG = @idOggetto@
      AND
      ID_TIPOLOGIA = @idTipologia@
    </value>
  </query>
  <query>
    <name>PD_UPDATE_CONT_FASC</name>
    <value>
      UPDATE DPA_CONTATORI_FASC
      SET VALORE = @valoreContatore@, ANNO = @anno@
      WHERE
      SYSTEM_ID = @idContatore@
    </value>
  </query>

  <query>
    <name>S_GET_COUNT_ROWS_TODO_LIST_DOCUMENTI</name>
    <value>
      SELECT COUNT(*)
      FROM
      (
      SELECT DISTINCT ID_TRASMISSIONE
      FROM 	 DPA_TODOLIST
      WHERE 	  ID_PROFILE &gt; 0
      AND ((ID_PEOPLE_DEST = @idPeople@ and ID_RUOLO_DEST = @idGruppo@) OR
      (ID_PEOPLE_DEST = @idPeople@ AND ID_RUOLO_DEST = 0))
      AND ID_REGISTRO IN (@registri@)
      @filters@
      ) AS A
    </value>
  </query>
  <query>
    <name>S_TODO_LIST_DOCUMENTI</name>
    <value>
      SELECT TOP @pageSize@ *
      FROM
      (
      SELECT TOP @pageSize@ *
      FROM
      (
      SELECT TOP @totalRows@
      ID_TRASMISSIONE,
      ID_TRASM_SINGOLA,
      ID_TRASM_UTENTE,
      DTA_INVIO,
      CONVERT(VARCHAR,DTA_INVIO,103)AS DTAINVIO,
      ISNULL(DTA_SCADENZA,'25000101') AS DTA_SCAD_ASC,
      ISNULL(DTA_SCADENZA,'17530101') AS DTA_SCAD_DESC,
      @dbuser@.Vardescribe(ID_PEOPLE_MITT, 'PEOPLENAME') AS UT_MITT,
      @dbuser@.Vardescribe(ID_RUOLO_MITT, 'GROUPNAME') AS RUOLO_MITT,
      @dbuser@.Vardescribe(ID_PEOPLE_DEST, 'PEOPLENAME') AS UT_DEST,
      @dbuser@.Vardescribe(ID_RAGIONE_TRASM, 'RAGIONETRASM') AS RAG_TRASM,
      VAR_NOTE_GEN,
      VAR_NOTE_SING,
      DTA_SCADENZA,
      CONVERT(VARCHAR,DTA_SCADENZA,103) AS DTA_SCAD_CHAR,
      ID_PROFILE,
      @dbuser@.Vardescribe(ID_PROFILE, 'SEGNATURA_DOCNUMBER')AS SEGNA_DOCNUMBER,
      @dbuser@.Vardescribe(ID_PROFILE, 'OGGETTO_MITTENTE')AS OGGETTO_MITTENTE,
      @dbuser@.Vardescribe(ID_PROFILE, 'CHA_TIPO_PROTO')AS TIPO_PROTO,
      @dbuser@.Vardescribe(ID_PROFILE, 'DATADOC') AS DTA_DOC,
      @dbuser@.vardescribe(ID_PROFILE, 'NUMPROTO') AS NUM_PROTO,
      ID_PEOPLE_MITT AS ID_PEOPLE_MITT,
      ID_RUOLO_MITT AS ID_RUOLO_MITT,
      ID_RAGIONE_TRASM AS ID_RAGIONE_TRASM,
      ID_RUOLO_DEST AS ID_RUOLO_DEST,
      ID_PEOPLE_DEST AS ID_PEOPLE_DEST,
      CHA_TIPO_TRASM AS CHA_TIPO_TRASM,
      @dbuser@.Vardescribe(ID_PROFILE,'PROFILE_CHA_IMG') AS CHA_IMG
      FROM DPA_TODOLIST
      WHERE ID_PROFILE &gt; 0
      AND ((ID_PEOPLE_DEST = @idPeople@ and ID_RUOLO_DEST = @idGruppo@) OR (ID_PEOPLE_DEST = @idPeople@ AND ID_RUOLO_DEST = 0))
      AND ID_REGISTRO IN (@registri@)
      @filters@
      ORDER BY @order@
      ) AS A
      ORDER BY  @reverseOrder@
      ) AS A
      ORDER BY  @order@
    </value>
  </query>
  <query>
    <name>S_GET_COUNT_ROWS_TODO_LIST_FASCICOLI</name>
    <value>
      SELECT COUNT(*)
      FROM
      (
      SELECT DISTINCT ID_TRASMISSIONE
      FROM 	 DPA_TODOLIST
      WHERE 	  ID_PROJECT &gt; 0
      AND ((ID_PEOPLE_DEST = @idPeople@ and ID_RUOLO_DEST = @idGruppo@) OR
      (ID_PEOPLE_DEST = @idPeople@ AND ID_RUOLO_DEST = 0))
      AND ID_REGISTRO IN (@registri@)
      @filters@
      ) AS A
    </value>
  </query>
  <query>
    <name>S_GET_COUNT_INFO_TRASMISSIONI_EFFETTUATE</name>
    <value>
      SELECT COUNT(system_id)
      FROM dpa_trasmissione
      WHERE @filters@
    </value>
  </query>
  <query>
    <name>S_GET_INFO_TRASMISSIONI_EFFETTUATE</name>
    <value>
      SELECT TOP @pageSize@ *
      FROM
      (
      SELECT TOP @pageSize@ *
      FROM
      (
      SELECT TOP @totalRows@
      a.system_id,
      a.id_ruolo_in_uo as ruolo_system_id,
      g.var_cod_rubrica as ruolo_mittente,
      a.id_people as user_system_id,
      p.full_name as user_id,
      a.cha_tipo_oggetto,
      a.id_profile,
      a.id_project,
      isnull(a.dta_invio, '99991231') as data_invio,
      @dtaInvio@ AS dta_invio,
      a.var_note_generali,
      a.cha_salvata_con_cessione,
      g.VAR_DESC_CORR as ruolo,
      p.user_id as us_id,
      a.id_people_delegato
      FROM      dpa_trasmissione a
      INNER JOIN people p ON a.id_people = p.system_id
      INNER JOIN dpa_corr_globali g ON a.id_ruolo_in_uo = g.system_id
      WHERE     @filters@
      ORDER BY data_invio DESC
      ) AS A
      ORDER BY  a.data_invio ASC
      ) AS A
      ORDER BY  a.data_invio DESC
    </value>
  </query>
  <query>
    <name>S_GET_COUNT_INFO_TRASMISSIONI_RICEVUTE</name>
    <value>
      SELECT COUNT(*)
      FROM
      (
      SELECT    t.system_id
      FROM      dpa_trasmissione t
      INNER JOIN dpa_trasm_singola ts ON t.system_id = ts.id_trasmissione
      INNER JOIN dpa_trasm_utente tu ON ts.system_id = tu.id_trasm_singola
      WHERE		  @filters@ AND t.dta_invio IS NOT NULL AND
      ((ts.id_corr_globale = @idCorrGlobale@ AND tu.id_people = @idPeople@) OR
      ts.id_corr_globale = @idPeopleCorrGlobale@)
      ) AS A
    </value>
  </query>
  <query>
    <name>S_GET_INFO_TRASMISSIONI_RICEVUTE</name>
    <value>
      SELECT TOP @pageSize@ *
      FROM
      (
      SELECT TOP @pageSize@ *
      FROM
      (
      SELECT TOP @totalRows@
      t.system_id,
      ts.cha_tipo_dest,
      ts.id_corr_globale as ruolo_system_id,
      @dbUser@.getDescCorr(t.id_ruolo_in_uo) as ruolo,
      t.id_people as user_system_id,
      @dbUser@.getPeopleName(t.id_people) as user_id,
      t.cha_tipo_oggetto,
      t.id_profile,
      t.id_project,
      isnull(t.dta_invio, '99991231') as data_invio,
      @dtaInvio@  AS dta_invio,
      t.var_note_generali,
      ts.id_ragione,
      rt.var_desc_ragione AS ragione,
      @dtaScadenza@  AS dta_scadenza,
      t.cha_salvata_con_cessione,
      @dbUser@.GETCODRUBRICACORR(t.ID_RUOLO_IN_UO) as ruolo_mittente,
      @dbUser@.GETPEOPLEUSERID(t.id_people) as us_id,
      t.id_people_delegato
      FROM        dpa_trasmissione t
      INNER JOIN  dpa_trasm_singola ts ON t.system_id = ts.id_trasmissione
      INNER JOIN  dpa_trasm_utente tu ON ts.system_id = tu.id_trasm_singola
      INNER JOIN  dpa_ragione_trasm rt ON ts.id_ragione = rt.system_id
      WHERE		  @filters@ AND t.dta_invio IS NOT NULL AND
      ((ts.id_corr_globale = @idCorrGlobale@ AND tu.id_people = @idPeople@) OR
      ts.id_corr_globale = @idPeopleCorrGlobale@)
      ORDER BY data_invio DESC
      ) AS A
      ORDER BY a.data_invio ASC
      ) AS A
      ORDER BY a.data_invio DESC
    </value>
  </query>
  <query>
    <name>S_GET_COUNT_INFO_TRASMISSIONI_FILTERED</name>
    <value>
      SELECT    COUNT(DISTINCT a.system_id)
      FROM      dpa_trasmissione a
      @from@
      INNER JOIN people p ON a.id_people = p.system_id
      INNER JOIN dpa_corr_globali g ON a.id_ruolo_in_uo = g.system_id
      WHERE     @filters@
    </value>
  </query>
  <query>
    <name>S_GET_COUNT_INFO_TRASMISSIONI_FILTERED_orig</name>
    <value>
      SELECT    COUNT(DISTINCT a.system_id)
      FROM      dpa_trasmissione a
      @from@
      INNER JOIN people p ON a.id_people = p.system_id
      INNER JOIN dpa_corr_globali g ON a.id_ruolo_in_uo = g.system_id
      WHERE     @filters@
    </value>
  </query>
  <query>
    <name>S_GET_INFO_TRASMISSIONI_FILTERED</name>
    <value>
      <!-- //ADP Task  167-->
      <!-- //ADP Task  167-->
      select distinct

      B.system_id,
      B.ruolo_system_id,
      B.ruolo_mittente,
      B.user_system_id,
      B.user_id,
      B.cha_tipo_oggetto,
      B.id_profile,
      B.id_project,
      B.dta_invio,
      B.var_note_generali,
      B.cha_salvata_con_cessione,
      B.ruolo,
      B.us_id,
      B.id_people_delegato

      from ( select /*+ FIRST_ROWS(n) */
      a.*, a.RN rnum
      from
      (
      SELECT /*+ index (A INDX_TRASM3) */
      ROW_NUMBER() OVER(ORDER BY a.dta_invio DESC) AS RN,
      a.system_id,
      a.id_ruolo_in_uo as ruolo_system_id,
      g.var_cod_rubrica as ruolo_mittente,
      a.id_people as user_system_id,
      p.full_name as user_id,
      a.cha_tipo_oggetto,
      a.id_profile,
      a.id_project,
      @dtaInvio@ AS dta_invio,
      a.var_note_generali,
      a.cha_salvata_con_cessione,
      g.VAR_DESC_CORR as ruolo,
      p.user_id as us_id,
      a.id_people_delegato
      FROM      dpa_trasmissione a
      @from@
      INNER JOIN people p ON a.id_people = p.system_id
      INNER JOIN dpa_corr_globali g ON a.id_ruolo_in_uo = g.system_id
      WHERE     @filters@
      ) a
      where RN &lt;= @endRow@ ) B
      where rnum  &gt;= @startRow@

      order by dta_invio desc, system_id desc
    </value>
  </query>

  <query>
    <name>S_GET_INFO_TRASMISSIONI_FILTERED_orig</name>
    <value>
      <!-- //ADP Task  167-->
      select distinct

      B.system_id,
      B.ruolo_system_id,
      B.ruolo_mittente,
      B.user_system_id,
      B.user_id,
      B.cha_tipo_oggetto,
      B.id_profile,
      B.id_project,
      B.dta_invio,
      B.var_note_generali,
      B.cha_salvata_con_cessione,
      B.ruolo,
      B.us_id,
      B.id_people_delegato

      from ( select /*+ FIRST_ROWS(n) */
      a.*, @@ROWCOUNT rnum
      from
      (
      SELECT /*+ index (A INDX_TRASM3) */
      ROW_NUMBER() OVER(ORDER BY a.dta_invio DESC) AS RN,
      a.system_id,
      a.id_ruolo_in_uo as ruolo_system_id,
      g.var_cod_rubrica as ruolo_mittente,
      a.id_people as user_system_id,
      p.full_name as user_id,
      a.cha_tipo_oggetto,
      a.id_profile,
      a.id_project,
      @dtaInvio@ AS dta_invio,
      a.var_note_generali,
      a.cha_salvata_con_cessione,
      g.VAR_DESC_CORR as ruolo,
      p.user_id as us_id,
      a.id_people_delegato
      FROM      dpa_trasmissione a
      @from@
      INNER JOIN people p ON a.id_people = p.system_id
      INNER JOIN dpa_corr_globali g ON a.id_ruolo_in_uo = g.system_id
      WHERE     @filters@
      ) a
      where @@ROWCOUNT &lt;= @endRow@ ) B
      where rnum  &gt;= @startRow@
      order by dta_invio desc, system_id desc
    </value>
  </query>

  <query>
    <name>AMM_D_DELETE_RF_RUOLO_REG</name>
    <value>
      DELETE FROM dpa_l_ruolo_reg
      WHERE id_ruolo_in_uo NOT IN (
      SELECT DISTINCT id_ruolo_in_uo
      FROM dpa_l_ruolo_reg
      WHERE id_registro IN (@idAooColl@))
      AND id_registro = @idRF@
    </value>
  </query>
  <query>
    <name>AMM_S_GET_COUNT_RF_REGISTRO</name>
    <value>
      SELECT COUNT(*)
      FROM DPA_EL_REGISTRI
      WHERE CHA_RF = 1
      AND ID_AOO_COLLEGATA = @idRegistro@
    </value>
  </query>
  <query>
    <name>S_J_DPA_L_RUOLO_REG_REGISTRI_E_RF</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      A.VAR_CODICE,
      A.NUM_RIF,
      A.VAR_DESC_REGISTRO,
      A.VAR_EMAIL_REGISTRO,
      A.CHA_STATO,
      A.ID_AMM,
      @param1@
      FROM DPA_L_RUOLO_REG B, DPA_EL_REGISTRI A
      WHERE A.SYSTEM_ID = B.ID_REGISTRO
      AND @param2@ @param4@
      ORDER BY @param3@
    </value>
  </query>
  <query>
    <name>AMM_S_GET_COUNT_OGGETTI_ASSOCIATI</name>
    <value>
      SELECT	COUNT(SYSTEM_ID)
      FROM	DPA_OGGETTARIO
      WHERE	ID_REGISTRO=@idElemento@
    </value>
  </query>
  <query>
    <name>AMM_S_GET_COUNT_CORRISPONDENTI_ASSOCIATI</name>
    <value>
      SELECT	COUNT(SYSTEM_ID)
      FROM	DPA_CORR_GLOBALI
      WHERE	CHA_TIPO_IE = 'E' AND ID_REGISTRO = @idElemento@
    </value>
  </query>
  <query>
    <name>S_TODO_LIST_FASCICOLI</name>
    <value>
      SELECT TOP @pageSize@ *
      FROM
      (
      SELECT TOP @pageSize@ *
      FROM
      (
      SELECT TOP @totalRows@
      ID_TRASMISSIONE,
      ID_TRASM_SINGOLA,
      ID_TRASM_UTENTE,
      DTA_INVIO AS DTAINVIO,
      CONVERT(VARCHAR,DTA_INVIO,103)AS DTA_INVIO,
      ISNULL(DTA_SCADENZA,'25000101') AS DTA_SCAD_ASC,
      ISNULL(DTA_SCADENZA,'17530101') AS DTA_SCAD_DESC,
      @dbuser@.Vardescribe(ID_PEOPLE_MITT, 'PEOPLENAME') AS UT_MITT,
      @dbuser@.Vardescribe(ID_RUOLO_MITT, 'GROUPNAME') AS RUOLO_MITT,
      @dbuser@.Vardescribe(ID_PEOPLE_DEST, 'PEOPLENAME') AS UT_DEST,
      @dbuser@.Vardescribe(ID_RAGIONE_TRASM, 'RAGIONETRASM') AS RAG_TRASM,
      VAR_NOTE_GEN,
      VAR_NOTE_SING,
      DTA_SCADENZA,
      CONVERT(VARCHAR,DTA_SCADENZA,103) AS DTA_SCAD_CHAR,
      ID_PROJECT,
      @dbuser@.Vardescribe(ID_PROJECT, 'DESC_FASC')AS DESC_FASC,
      @dbuser@.Vardescribe(ID_PROJECT, 'CODFASC') AS COD_FASC,
      ID_PEOPLE_MITT AS ID_PEOPLE_MITT,
      ID_RUOLO_MITT AS ID_RUOLO_MITT,
      ID_RAGIONE_TRASM AS ID_RAGIONE_TRASM,
      ID_RUOLO_DEST AS ID_RUOLO_DEST,
      ID_PEOPLE_DEST AS ID_PEOPLE_DEST,
      CHA_TIPO_TRASM AS CHA_TIPO_TRASM
      FROM DPA_TODOLIST
      WHERE ID_PROJECT &gt; 0
      AND ((ID_PEOPLE_DEST = @idPeople@ and ID_RUOLO_DEST = @idGruppo@) OR (ID_PEOPLE_DEST = @idPeople@ AND ID_RUOLO_DEST = 0))
      @filters@
      ORDER BY @order@
      ) AS A
      ORDER BY  @reverseOrder@
      ) AS A
      ORDER BY  @order@
    </value>
  </query>
  <query>
    <name>GET_RUOLI_ASSOCIATI_REGISTRO_RF</name>
    <value>
      SELECT
      A.SYSTEM_ID AS IDRUOLO,
      A.VAR_COD_RUBRICA AS CODICE,
      A.VAR_DESC_CORR AS DESCRIZIONE,
      A.ID_GRUPPO AS GRUPPO,
      A.ID_AMM AS IDAMMINISTRAZIONE
      FROM DPA_CORR_GLOBALI A, DPA_L_RUOLO_REG B
      WHERE B.ID_RUOLO_IN_UO = A.SYSTEM_ID
      AND B.ID_REGISTRO = @idRegistro@
    </value>
  </query>
  <query>
    <name>S_AMM_GET_LIST_RUOLI_RICERCA</name>
    <value>
      SELECT A.SYSTEM_ID AS IDCORRGLOBALE,
      A.ID_GRUPPO AS IDGRUPPO,
      A.VAR_CODICE AS CODICE,
      A.VAR_COD_RUBRICA AS CODICERUBRICA,
      A.VAR_DESC_CORR AS DESCRIZIONE,
      A.ID_AMM AS IDAMMINISTRAZIONE
      FROM DPA_CORR_GLOBALI A
      WHERE exists (select 'x' from DPA_L_RUOLO_REG B where A.SYSTEM_ID = B.ID_RUOLO_IN_UO
      AND B.DTA_FINE IS NULL)
      @param4@
      @param1@
      AND A.DTA_FINE IS NULL
      AND A.ID_AMM = @param2@
      @param3@
    </value>
  </query>
  <query>
    <name>S_DPAOggettario</name>
    <value>
      SELECT @param1@
      FROM DPA_OGGETTARIO
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__TIPO_F_RUOLO__TIPO_FUNZIONE__TIPO_RUOLO__CORR_GLOBALI__L_RUOLO_REG_2</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      A.VAR_CODICE,
      A.VAR_COD_RUBRICA,
      D.VAR_DESC_RUOLO,
      A.ID_GRUPPO,
      A.ID_UO,
      D.NUM_LIVELLO,
      E.VAR_DESC_CORR
      FROM DPA_CORR_GLOBALI A,
      DPA_TIPO_F_RUOLO B,
      DPA_TIPO_FUNZIONE C,
      DPA_TIPO_RUOLO D,
      DPA_CORR_GLOBALI E,
      DPA_L_RUOLO_REG F
      WHERE A.CHA_TIPO_URP = 'R'
      AND F.ID_REGISTRO = @param1@
      AND B.ID_RUOLO_IN_UO = A.SYSTEM_ID
      AND B.ID_TIPO_FUNZ = C.SYSTEM_ID
      AND C.VAR_COD_TIPO = '@prau@'
      AND D.SYSTEM_ID = A.ID_TIPO_RUOLO
      AND E.SYSTEM_ID = A.ID_UO
      AND F.ID_RUOLO_IN_UO = A.SYSTEM_ID
      AND C.ID_AMM = @param2@
      AND (A.CHA_DISABLED_TRASM &lt;&gt; '1' OR A.CHA_DISABLED_TRASM IS NULL)
    </value>
  </query>
  <query>
    <name>PD_DISABLE_CONT_DOC</name>
    <value>
      UPDATE DPA_CONTATORI_DOC
      SET ABILITATO = 0
      WHERE
      ID_OGG = @idOgg@
    </value>
  </query>
  <query>
    <name>PD_DISABLE_CONT_FASC</name>
    <value>
      UPDATE DPA_CONTATORI_FASC
      SET ABILITATO = 0
      WHERE
      ID_OGG = @idOgg@
    </value>
  </query>
  <query>
    <name>PD_INSERT_CONT_DOC</name>
    <value>
      INSERT INTO DPA_CONTATORI_DOC
      (
      @colID@
      ID_OGG,
      ID_TIPOLOGIA,
      ID_AOO,
      ID_RF,
      VALORE,
      VALORE_SC,
      ABILITATO,
      ANNO
      )
      VALUES
      (
      @id@
      @idOgg@,
      @idTipologia@,
      @idAoo@,
      @idRf@,
      @valore@,
      @valoreSottocontatore@,
      @abilitato@,
      @anno@
      )
    </value>
  </query>
  <query>
    <name>PD_INSERT_CONT_FASC</name>
    <value>
      INSERT INTO DPA_CONTATORI_FASC
      (
      @colID@
      ID_OGG,
      ID_TIPOLOGIA,
      ID_AOO,
      ID_RF,
      VALORE,
      ABILITATO,
      ANNO
      )
      VALUES
      (
      @id@
      @idOgg@,
      @idTipologia@,
      @idAoo@,
      @idRf@,
      @valore@,
      @abilitato@,
      @anno@
      )
    </value>
  </query>
  <query>
    <name>PD_EXIST_CONT_DOC</name>
    <value>
      SELECT * FROM DPA_CONTATORI_DOC
      WHERE
      ID_OGG = @idOggetto@
      AND
      ID_TIPOLOGIA = @idTipologia@
      @param1@
    </value>
  </query>
  <query>
    <name>PD_EXIST_CONT_FASC</name>
    <value>
      SELECT * FROM DPA_CONTATORI_FASC
      WHERE
      ID_TIPOLOGIA = @idTipologia@
      @param1@
    </value>
  </query>
  <query>
    <name>PD_GET_CONT_DOC_BY_ID</name>
    <value>
      SELECT * FROM DPA_CONTATORI_DOC
      WHERE
      SYSTEM_ID = @systemId@
    </value>
  </query>
  <query>
    <name>PD_GET_CONT_FASC_BY_ID</name>
    <value>
      SELECT * FROM DPA_CONTATORI_FASC
      WHERE
      SYSTEM_ID = @systemId@
    </value>
  </query>
  <query>
    <name>PD_GET_CONT_CUSTOM_DOC_BY_ID</name>
    <value>
      SELECT * FROM DPA_CONT_CUSTOM_DOC
      WHERE
      SYSTEM_ID = @systemId@
    </value>
  </query>
  <query>
    <name>PD_GET_CONT_CUSTOM_DOC_BY_IDOGG</name>
    <value>
      SELECT * FROM DPA_CONT_CUSTOM_DOC WITH(NOLOCK)
      WHERE
      ID_OGG = @idOgg@
    </value>
  </query>
  <query>
    <name>PD_GET_CONT_CUSTOM_FASC_BY_IDOGG</name>
    <value>
      SELECT * FROM DPA_CONT_CUSTOM_FASC
      WHERE
      ID_OGG_FASC = @idOgg@
    </value>
  </query>
  <query>
    <name>PD_UPDATE_CONT_CUSTOM_DOC</name>
    <value>
      UPDATE DPA_CONT_CUSTOM_DOC
      SET DATA_FINE = @dataFine@,
      DATA_INIZIO = @dataInizio@
      WHERE ID_OGG = @idOgg@
    </value>
  </query>

  <query>
    <name>PD_UPDATE_CONT_CUSTOM_FASC</name>
    <value>
      UPDATE DPA_CONT_CUSTOM_FASC
      SET DATA_FINE = @dataFine@,
      DATA_INIZIO = @dataInizio@
      WHERE ID_OGG_FASC = @idOgg@
    </value>
  </query>

  <query>
    <name>PD_INSERT_CONT_CUSTOM_DOC</name>
    <value>
      INSERT INTO DPA_CONT_CUSTOM_DOC
      (
      @colID@
      DATA_FINE,
      ID_OGG,
      DATA_INIZIO
      )
      VALUES
      (
      @id@
      @dataFine@
      @idOgg@,
      @dataInizio@
      )
    </value>
  </query>

  <query>
    <name>PD_SALVA_DATE_CONT_CUSTOM_DOC</name>
    <value>
      INSERT INTO DPA_CONT_CUSTOM_DOC
      (
      @colID@
      DATA_FINE,
      ID_OGG,
      DATA_INIZIO
      )
      VALUES
      (
      @id@
      @dataFine@,
      @idOgg@,
      @dataInizio@
      )
    </value>
  </query>

  <query>
    <name>PD_SALVA_DATE_CONT_CUSTOM_FASC</name>
    <value>
      INSERT INTO DPA_CONT_CUSTOM_FASC
      (
      @colID@
      DATA_FINE,
      ID_OGG_FASC,
      DATA_INIZIO
      )
      VALUES
      (
      @id@
      @dataFine@,
      @idOgg@,
      @dataInizio@
      )
    </value>
  </query>
  <query>
    <name>PD_DELETE_DPA_CONT_CUSTOM_DOC</name>
    <value>
      DELETE FROM DPA_CONT_CUSTOM_DOC
      WHERE ID_OGG = @idOgg@
    </value>
  </query>
  <query>
    <name>PD_GESTIONE_SOSPENSIONE</name>
    <value>
      UPDATE DPA_CONT_CUSTOM_DOC SET SOSPESO = '@sospensione@'
      WHERE ID_OGG= @id_ogg@
    </value>
  </query>
  <query>
    <name>PD_DELETE_DPA_CONT_CUSTOM_FASC</name>
    <value>
      DELETE FROM DPA_CONT_CUSTOM_FASC
      WHERE ID_OGG_FASC = @idOgg@
    </value>
  </query>
  <query>
    <name>PD_GESTIONE_SOSPENSIONE_FASC</name>
    <value>
      UPDATE DPA_CONT_CUSTOM_FASC SET SOSPESO = '@sospensione@'
      WHERE ID_OGG_FASC= @id_ogg_fasc@
    </value>
  </query>
  <query>
    <name>DO_GET_IDPROFILE_BY_DATA_DOC_GRIGIO</name>
    <value>
      SELECT SYSTEM_ID FROM PROFILE P WITH(NOLOCK) WHERE P.DOCNUMBER = @ID_DOC@
      AND ISNULL(P.CHA_IN_CESTINO, '0') = '0'
      --and (@dbuser@.checkSecurityDocumento(P.SYSTEM_ID, @idPeople@, @idGruppo@,'D') > 0)
    </value>
  </query>
  <query>
    <name>PD_IS_DOC_REPERTORIATO</name>
    <value>
      select DISTINCT(profile.docnumber)
      from profile WITH(NOLOCK), dpa_associazione_templates, dpa_oggetti_custom
      where
      profile.docnumber = dpa_associazione_templates.doc_number
      and
      dpa_associazione_templates.id_oggetto = dpa_oggetti_custom.system_id
      and
      profile.docnumber = @docNumber@
      and
      dpa_associazione_templates.id_template = @idTipoAtto@
      and
      dpa_oggetti_custom.repertorio = 1
      and
      dpa_associazione_templates.valore_oggetto_db is not null
    </value>
  </query>
  <query>
    <name>U_DPA_TRASM_UTENTE_RIFIUTATA_NEW2</name>
    <value>
      UPDATE DPA_TRASM_UTENTE
      SET DTA_RIFIUTATA = @param1@,
      DTA_VISTA = (CASE WHEN DTA_VISTA IS NULL THEN GETDATE() ELSE DTA_VISTA END),
      CHA_VISTA  = (CASE WHEN DTA_VISTA IS NULL THEN 1 ELSE 0 END)
      @param2@
      WHERE (SYSTEM_ID = @param3@
      OR
      SYSTEM_ID = (SELECT TU.SYSTEM_ID FROM
      DPA_TRASM_UTENTE TU,DPA_TRASMISSIONE TX,DPA_TRASM_SINGOLA TS WHERE TU.ID_PEOPLE=@param4@ AND
      TX.SYSTEM_ID=TS.ID_TRASMISSIONE AND TX.SYSTEM_ID=@param5@ AND TS.SYSTEM_ID=TU.ID_TRASM_SINGOLA
      AND TS.CHA_TIPO_DEST= 'U')
      )
      AND CHA_VALIDA='1'
    </value>
  </query>
  <query>
    <name>S_COUNT_FASCICOLI_PAGING</name>
    <value>
      SELECT count (*) FROM
      (
      select a.system_id
      from project a @tblCL1@
      WHERE @security@
      AND (a.id_amm IS NULL OR a.id_amm = @idAmm@ )
      AND a.cha_tipo_proj = 'F'
      @idReg@
      @whereTlbCL1@
      @guiFilters@
      ) AS A
    </value>
  </query>
  <query>
    <name>S_FASCICOLI_PAGING</name>
    <value>
      SELECT TOP @pageSize@ *
      FROM
      (
      SELECT TOP @pageSize@ *
      FROM
      (
      SELECT TOP @totalRows@
      a.system_id, a.description, a.cha_tipo_proj, a.var_codice,
      a.id_amm, a.num_livello,a.cha_tipo_fascicolo, a.id_fascicolo,
      a.id_parent,a.var_cod_ultimo,a.var_note,@dtaAp@ AS dta_apertura,
      @dtaCh@ AS dta_chiusura,a.cha_stato, a.id_tipo_proc, a.id_registro ,
      @dbuser@.getcodreg(a.id_registro) as codReg,a.id_uo_lf,A.DTA_UO_LF,
      a.dta_creazione, a.cartaceo,a.cha_privato,a.ID_UO_REF,
      @dbuser@.getAccessRightsProject(@idPeo@,@idGrp@, @idRuoloPubblico@,a.system_id) as accessrights,
      @dbuser@.getCodtit(a.id_parent) as codTit, convert(nvarchar (10), a.dta_scadenza, 103) AS DTA_SCADENZA,
      @dbuser@.getInConservazione(null, a.system_id,'F', @idPeo@, @idGrp@) AS IN_CONSERVAZIONE, a.CHA_IN_ARCHIVIO,
      a.AUTHOR, a.ID_RUOLO_CREATORE, a.ID_UO_CREATORE,
      @dbuser@.GetContatoreFasc(a.system_id, @tipoContatore@) as CONTATORE,
      @dbuser@.getContatoreFascContatore(a.system_id, @tipoContatore@) as contatore_ordinamento,
      a.NUM_FASCICOLO, a.cha_controllato, a.cha_consenti_class, a.CHA_CONSENTI_FASC, a.ID_RUOLO_CHIUSURA, a.ID_UO_CHIUSURA, a.ID_AUTHOR_CHIUSURA,
      a.DTA_APERTURA AS DTA_APERTURA_ORDER,
      a.DTA_CHIUSURA AS DTA_CHIUSURA_ORDER, a.id_titolario, @adl@
      @customFieldForOrder@
      FROM project a @tblCL1@
      WHERE @security@
      AND (a.id_amm IS NULL OR a.id_amm = @idAmm@ )
      AND a.cha_tipo_proj = 'F'
      @idReg@
      @whereTlbCL1@
      @guiFilters@
      order by @customOrder@
      ) AS A
      ORDER BY  @customOrder1@
      ) AS A
      ORDER BY @customOrder@
    </value>
  </query>
  <query>
    <name>RF_EXIST</name>
    <value>
      select count(*)
      from dpa_el_registri
      where id_amm = @idAmm@
      and cha_rf = '1'
    </value>
  </query>
  <query>
    <name>I_INSERT_NOTA</name>
    <value>
      INSERT INTO DPA_NOTE
      (
      @colId@
      Testo,
      DataCreazione,
      IdUtenteCreatore,
      IdRuoloCreatore,
      TipoVisibilita,
      TipoOggettoAssociato,
      IdOggettoAssociato,
      IdPeopleDelegato,
      IdRfAssociato
      )
      VALUES
      (
      @id@
      '@testo@',
      @dataCreazione@,
      @idUtenteCreatore@,
      @idRuoloCreatore@,
      '@tipoVisibilita@',
      '@tipoOggetto@',
      @idOggetto@,
      @idPeopleDelegato@,
      @idRfAssociato@
      )
    </value>
  </query>
  <query>
    <name>U_UPDATE_NOTA</name>
    <value>
      UPDATE DPA_NOTE
      SET Testo = '@testo@',
      TipoVisibilita = '@tipoVisibilita@'
      WHERE SYSTEM_ID = @id@
    </value>
  </query>
  <query>
    <name>D_DELETE_NOTA</name>
    <value>
      DELETE
      FROM DPA_NOTE
      WHERE SYSTEM_ID = @id@
    </value>
  </query>
  <query>
    <name>S_GET_NOTA</name>
    <value>
      SELECT  N.SYSTEM_ID,
      N.TESTO,
      N.DATACREAZIONE,
      N.IDUTENTECREATORE,
      N.IDRUOLOCREATORE,
      N.TIPOVISIBILITA,
      N.TIPOOGGETTOASSOCIATO,
      N.IDOGGETTOASSOCIATO,
      P.USER_ID,
      P.FULL_NAME,
      G.GROUP_ID,
      G.GROUP_NAME,
      N.IDPEOPLEDELEGATO,
      <!-- Laura 5 Marzo 2013 Aggiunto campo IDRFASSOCIATO-->
      N.IDRFASSOCIATO
      FROM DPA_NOTE N
      LEFT JOIN People P ON N.IDUTENTECREATORE = P.SYSTEM_ID
      LEFT JOIN Groups G ON N.IDRUOLOCREATORE = G.SYSTEM_ID
      WHERE   N.SYSTEM_ID = @id@ AND
      (N.TIPOVISIBILITA = 'T' OR
      (N.TIPOVISIBILITA = 'F' and N.IDRFASSOCIATO in (select id_registro from dpa_l_ruolo_reg rr where  rr.ID_RUOLO_IN_UO = @idRuoloCorrGlobali@)) OR
      (N.TIPOVISIBILITA = 'P' AND N.IDUTENTECREATORE = @idUtenteCreatore@) OR
      (N.TIPOVISIBILITA = 'R' AND N.IDRUOLOCREATORE = @idRuoloCreatore@))
    </value>
  </query>
  <query>
    <name>S_GET_NOTE</name>
    <value>
      SELECT  N.SYSTEM_ID,
      N.TESTO,
      N.DATACREAZIONE,
      N.IDUTENTECREATORE,
      N.IDRUOLOCREATORE,
      N.TIPOVISIBILITA,
      N.TIPOOGGETTOASSOCIATO,
      N.IDOGGETTOASSOCIATO,
      P.USER_ID,
      P.FULL_NAME,
      G.GROUP_ID,
      G.GROUP_NAME,
      N.IDPEOPLEDELEGATO,
      <!--Laura 25 Marzo-->
      N.IDRFASSOCIATO
      FROM    DPA_NOTE N
      LEFT JOIN People P ON N.IDUTENTECREATORE = P.SYSTEM_ID
      LEFT JOIN Groups G ON N.IDRUOLOCREATORE = G.SYSTEM_ID
      WHERE   N.TIPOOGGETTOASSOCIATO = '@tipoOggetto@' AND
      N.IDOGGETTOASSOCIATO = @idOggetto@ AND
      (N.TIPOVISIBILITA = 'T' OR
      (N.TIPOVISIBILITA = 'F' and N.IDRFASSOCIATO in (select id_registro from dpa_l_ruolo_reg rr where  rr.ID_RUOLO_IN_UO = @idRuoloCorrGlobali@)) OR
      (N.TIPOVISIBILITA = 'P' AND N.IDUTENTECREATORE = @idUtenteCreatore@) OR
      (N.TIPOVISIBILITA = 'R' AND N.IDRUOLOCREATORE = @idRuoloCreatore@))
      @filtro@
      ORDER BY N.DATACREAZIONE DESC
    </value>
  </query>
  <query>
    <name>S_GET_ULTIMA_NOTA_INSERITA</name>
    <value>
      SELECT TOP 1  N.SYSTEM_ID,
      N.TESTO,
      N.DATACREAZIONE,
      N.IDUTENTECREATORE,
      N.IDRUOLOCREATORE,
      N.TIPOVISIBILITA,
      N.TIPOOGGETTOASSOCIATO,
      N.IDOGGETTOASSOCIATO,
      P.USER_ID,
      P.FULL_NAME,
      G.GROUP_ID,
      G.GROUP_NAME,
      N.IDPEOPLEDELEGATO,
      <!--Laura 25 Marzo-->
      N.IDRFASSOCIATO
      FROM DPA_NOTE N
      LEFT JOIN People P ON N.IDUTENTECREATORE = P.SYSTEM_ID
      LEFT JOIN Groups G ON N.IDRUOLOCREATORE = G.SYSTEM_ID
      WHERE   N.TIPOOGGETTOASSOCIATO = '@tipoOggetto@' AND
      N.IDOGGETTOASSOCIATO = @idOggetto@ AND
      (N.TIPOVISIBILITA = 'T' OR
      (N.TIPOVISIBILITA = 'F' and N.IDRFASSOCIATO in (select id_registro from dpa_l_ruolo_reg rr where  rr.ID_RUOLO_IN_UO = @idRuoloCorrGlobali@)) OR
      (N.TIPOVISIBILITA = 'P' AND N.IDUTENTECREATORE = @idUtenteCreatore@) OR
      (N.TIPOVISIBILITA = 'R' AND N.IDRUOLOCREATORE = @idRuoloCreatore@))
      ORDER BY N.DATACREAZIONE DESC
    </value>
  </query>
  <query>
    <name>S_GET_VISIBILITA_NOTA</name>
    <value>
      SELECT TIPOVISIBILITA FROM DPA_NOTE WHERE SYSTEM_ID = @id@
    </value>
  </query>
  <query>
    <name>S_IS_CREATORE_NOTA</name>
    <value>
      SELECT COUNT(N.SYSTEM_ID)
      FROM DPA_NOTE N
      WHERE N.SYSTEM_ID = @id@ AND N.IDUTENTECREATORE = @idUtenteCreatore@
    </value>
  </query>
  <query>


    <name>S_LOG_DOC</name>
    <value>
      SELECT *
      FROM
      (
      SELECT distinct(A.SYSTEM_ID), A.USERID_OPERATORE, A.ID_PEOPLE_OPERATORE,@docsadm@.getpeoplename(id_people_operatore) people_Desc,
      A.DTA_AZIONE AS DTA_AZIONE, @docsadm@.getdescruolo(A.ID_GRUPPO_OPERATORE) RUOLO_DESC,A.ID_AMM,
      A.VAR_DESC_OGGETTO, A.VAR_COD_AZIONE,A.CHA_ESITO, A.VAR_DESC_AZIONE,a.desc_producer
      FROM DPA_LOG A, DPA_ANAGRAFICA_LOG B, DPA_LOG_ATTIVATI C
      WHERE A.ID_OGGETTO = '@param1@'
      AND (A.VAR_OGGETTO = '@param2@' @param4@)
      AND A.VAR_COD_AZIONE &lt;&gt; 'OPEN_DET_DOC'
      AND A.VAR_COD_AZIONE = B.VAR_CODICE
      AND B.SYSTEM_ID = C.SYSTEM_ID_ANAGRAFICA
      UNION ALL
      SELECT distinct(A.SYSTEM_ID), A.USERID_OPERATORE, A.ID_PEOPLE_OPERATORE,@docsadm@.getpeoplename(id_people_operatore) people_Desc,
      A.DTA_AZIONE AS DTA_AZIONE, @docsadm@.getdescruolo(A.ID_GRUPPO_OPERATORE) RUOLO_DESC, A.ID_AMM,
      A.VAR_DESC_OGGETTO, A.VAR_COD_AZIONE,A.CHA_ESITO, A.VAR_DESC_AZIONE,a.desc_producer
      FROM DPA_LOG_STORICO A, DPA_ANAGRAFICA_LOG B, DPA_LOG_ATTIVATI C
      WHERE A.ID_OGGETTO = '@param1@'
      AND (A.VAR_OGGETTO = '@param2@' @param4@)
      AND A.VAR_COD_AZIONE &lt;&gt; 'OPEN_DET_DOC'
      AND A.VAR_COD_AZIONE = B.VAR_CODICE
      AND B.SYSTEM_ID = C.SYSTEM_ID_ANAGRAFICA
      ) A
      ORDER BY A.SYSTEM_ID DESC
    </value>
    <!--
    <value>
      SELECT *
      FROM
      (
      SELECT distinct(A.SYSTEM_ID), A.USERID_OPERATORE, A.ID_PEOPLE_OPERATORE,
      A.DTA_AZIONE AS DTA_AZIONE, A.ID_GRUPPO_OPERATORE,A.ID_AMM,
      A.VAR_DESC_AZIONE, A.VAR_COD_AZIONE,A.CHA_ESITO
      FROM DPA_LOG A, DPA_ANAGRAFICA_LOG B, DPA_LOG_ATTIVATI C
      WHERE A.ID_OGGETTO = '@param1@'
      AND A.VAR_OGGETTO = '@param2@'
      AND A.VAR_COD_AZIONE &lt;&gt; 'OPEN_DET_DOC'
      AND A.VAR_COD_AZIONE = B.VAR_CODICE
      AND B.SYSTEM_ID = C.SYSTEM_ID_ANAGRAFICA
      UNION ALL
      SELECT distinct(A.SYSTEM_ID), A.USERID_OPERATORE, A.ID_PEOPLE_OPERATORE,
      A.DTA_AZIONE AS DTA_AZIONE, A.ID_GRUPPO_OPERATORE,A.ID_AMM,
      A.VAR_DESC_AZIONE, A.VAR_COD_AZIONE,A.CHA_ESITO
      FROM DPA_LOG_STORICO A, DPA_ANAGRAFICA_LOG B, DPA_LOG_ATTIVATI C
      WHERE A.ID_OGGETTO = '@param1@'
      AND A.VAR_OGGETTO = '@param2@'
      AND A.VAR_COD_AZIONE &lt;&gt; 'OPEN_DET_DOC'
      AND A.VAR_COD_AZIONE = B.VAR_CODICE
      AND B.SYSTEM_ID = C.SYSTEM_ID_ANAGRAFICA
      ) A
      ORDER BY A.SYSTEM_ID
    </value>
    -->
  </query>
  <query>
    <name>S_LOG_FASC</name>
    <value>
      SELECT *
      FROM
      (
      SELECT distinct(A.SYSTEM_ID), A.USERID_OPERATORE, A.ID_PEOPLE_OPERATORE,@dbuser@.getpeoplename(id_people_operatore) AS people_Desc,
      A.DTA_AZIONE AS DTA_AZIONE, A.ID_GRUPPO_OPERATORE, @dbuser@.getdescruolo(A.ID_GRUPPO_OPERATORE) AS RUOLO_DESC,A.ID_AMM,
      A.VAR_DESC_OGGETTO, A.VAR_COD_AZIONE,A.VAR_DESC_AZIONE,A.CHA_ESITO,a.desc_producer
      FROM DPA_LOG A, DPA_ANAGRAFICA_LOG B, DPA_LOG_ATTIVATI C
      WHERE A.ID_OGGETTO = '@param1@'
      AND A.VAR_OGGETTO IN ('FOLDER', 'FASCICOLO')
      AND A.VAR_COD_AZIONE = B.VAR_CODICE
      AND B.SYSTEM_ID = C.SYSTEM_ID_ANAGRAFICA
      UNION ALL
      SELECT distinct(A.SYSTEM_ID), A.USERID_OPERATORE, A.ID_PEOPLE_OPERATORE,@dbuser@.getpeoplename(id_people_operatore) AS people_Desc,
      A.DTA_AZIONE AS DTA_AZIONE, A.ID_GRUPPO_OPERATORE,@dbuser@.getdescruolo(A.ID_GRUPPO_OPERATORE) AS RUOLO_DESC,A.ID_AMM,
      A.VAR_DESC_OGGETTO, A.VAR_COD_AZIONE,A.VAR_DESC_AZIONE,A.CHA_ESITO,a.desc_producer
      FROM DPA_LOG_STORICO A, DPA_ANAGRAFICA_LOG B, DPA_LOG_ATTIVATI C
      WHERE A.ID_OGGETTO = '@param1@'
      AND A.VAR_OGGETTO IN ('FOLDER', 'FASCICOLO')
      AND A.VAR_COD_AZIONE = B.VAR_CODICE
      AND B.SYSTEM_ID = C.SYSTEM_ID_ANAGRAFICA
      ) A
      ORDER BY A.SYSTEM_ID DESC
    </value>
  </query>
  <query>
    <name>S_LOG_ATTIVI_AMM</name>
    <value>
      SELECT a.VAR_CODICE as CODICE, a.VAR_DESCRIZIONE as DESCRIZIONE, a.VAR_OGGETTO as OGGETTO, VAR_METODO as METODO, 1 as ATTIVO
      FROM DPA_ANAGRAFICA_LOG a , DPA_LOG_ATTIVATI b
      WHERE a.system_id = b.system_id_anagrafica
      AND b.id_amm = @param1@
      AND a.VAR_CODICE like 'AMM_%'
      ORDER BY a.VAR_OGGETTO
    </value>
  </query>
  <query>
    <name>J_LOG_ATTIVI_DISATTIVI_AMM</name>
    <value>
      SELECT DISTINCT a.VAR_CODICE AS CODICE, a.VAR_DESCRIZIONE AS DESCRIZIONE, a.VAR_OGGETTO AS OGGETTO, VAR_METODO AS METODO, 0 AS ATTIVO
      FROM DPA_ANAGRAFICA_LOG a , DPA_LOG_ATTIVATI b
      WHERE a.system_id NOT IN
      (SELECT system_id_anagrafica FROM DPA_LOG_ATTIVATI WHERE id_amm = @param1@)
      AND b.ID_AMM = @param1@
      AND a.VAR_CODICE like 'AMM_%'
      ORDER BY a.VAR_OGGETTO
    </value>
  </query>

  <query>
    <name>S_LOG_DISATTIVI_AMM</name>
    <value>
      SELECT VAR_CODICE as CODICE, VAR_DESCRIZIONE as DESCRIZIONE, VAR_OGGETTO as OGGETTO, VAR_METODO as METODO, 0 as ATTIVO
      FROM DPA_ANAGRAFICA_LOG
      WHERE VAR_CODICE like 'AMM_%'
      ORDER BY VAR_OGGETTO
    </value>
  </query>
  <query>
    <name>D_LOG_ATTIVATI_AMM</name>
    <value>
      DELETE FROM DPA_LOG_ATTIVATI
      WHERE ID_AMM = @param1@
      AND SYSTEM_ID_ANAGRAFICA IN
      (SELECT SYSTEM_ID FROM DPA_ANAGRAFICA_LOG WHERE VAR_CODICE LIKE 'AMM_%')
    </value>
  </query>
  <query>
    <name>S_FONT_COLOR</name>
    <value>
      SELECT FONTCOLOR
      FROM DPA_AMMINISTRA
      WHERE SYSTEM_ID = @param1@
    </value>
  </query>
  <query>
    <name>U_FONT_COLOR</name>
    <value>
      UPDATE DPA_AMMINISTRA
      SET FONTCOLOR = '@param2@'
      WHERE SYSTEM_ID = @param1@
    </value>
  </query>
  <query>
    <name>I_DPALOG_STORICO</name>
    <value>
      INSERT INTO DPA_LOG_STORICO
      (
      @param1@
      )
      VALUES
      (
      @param2@
      )
    </value>
  </query>
  <query>
    <name>S_NUM_RECORD</name>
    <value>
      SELECT NUM_RECORD, CHA_ARCHIVIAZIONE_LOG
      FROM DPA_AMMINISTRA
      WHERE SYSTEM_ID = @param1@
    </value>
  </query>
  <query>
    <name>U_NUM_RECORD</name>
    <value>
      UPDATE DPA_AMMINISTRA SET CHA_ARCHIVIAZIONE_LOG = '@param2@',
      NUM_RECORD = @param3@
      WHERE SYSTEM_ID = @param1@
    </value>
  </query>
  <query>
    <name>S_RIC_DOC</name>
    <value>
      SELECT TOP @pageSize@ * FROM (
      SELECT TOP @pageSize@ * FROM (
      (
      SELECT DISTINCT TOP @totalRows@
      A.SYSTEM_ID, A.DOCNUMBER, A.DTA_ANNULLA, A.VAR_PROF_OGGETTO AS VAR_DESC_OGGETTO,
      A.ID_REGISTRO, A.CHA_TIPO_PROTO, A.CHA_EVIDENZA, A.NUM_ANNO_PROTO,
      ISNULL(A.DTA_PROTO,A.CREATION_TIME) AS DATA,
      convert(nvarchar (10), A.CREATION_TIME, 103) AS CREATION_DATE,
      A.NUM_PROTO, A.VAR_SEGNATURA, convert(nvarchar (10), A.DTA_PROTO, 103) AS DTA_PROTO,
      @dbuser@.getchaimg(A.DOCNUMBER) AS CHA_IMG , A.CHA_PRIVATO, A.CHA_PERSONALE, @dbuser@.getInADL(A.SYSTEM_ID,'D',@idGruppo@,@idPeople@) AS IN_ADL,
      A.ID_DOCUMENTO_PRINCIPALE, @dbuser@.getInConservazione(A.SYSTEM_ID, null,'D', @idPeople@, @idGruppo@) AS IN_CONSERVAZIONE, A.CHA_IN_ARCHIVIO,
      a.id_tipo_atto as ID_TIPO_ATTO, ta.var_desc_atto as DESC_TIPO_ATTO, @dbuser@.getPeopleUserId (a.AUTHOR) as AUTHOR, a.prot_tit as PROT_TIT,
      @dbuser@.getchafirmato(A.DOCNUMBER) as CHA_FIRMATO, @dbuser@.getchatipofirma(A.DOCNUMBER) as CHA_TIPO_FIRMA, @dbuser@.GetContatoreDoc(a.system_id, @tipo_doc@) as CONTATORE,
      @dbuser@.getContatoreDocOrdinamento(a.system_id, @tipo_doc@) as contatore_ordinamento
      @customFieldFilter@
      FROM PROFILE a WITH(NOLOCK)
      LEFT JOIN dpa_tipo_atto ta on a.id_tipo_atto = ta.system_id
      @from@
      WHERE @security@
      @filters@
      @unionStampe@
      ORDER BY  @order@
      )
      ) AS A ORDER BY  @reverseOrder@
      ) AS A ORDER BY  @order@
    </value>
  </query>
  <query>
    <name>S_RIC_DOC_VELOCE</name>
    <value>
      SELECT TOP @pageSize@ * FROM (
      SELECT TOP @pageSize@ * FROM (
      SELECT DISTINCT TOP @totalRows@
      A.SYSTEM_ID, A.DOCNUMBER, A.DTA_ANNULLA, A.VAR_PROF_OGGETTO AS VAR_DESC_OGGETTO, A.ID_REGISTRO,
      A.CHA_TIPO_PROTO, A.CHA_EVIDENZA, A.NUM_ANNO_PROTO, ISNULL(A.DTA_PROTO,A.CREATION_TIME) AS DATA,
      convert(nvarchar (10), A.CREATION_TIME, 103) AS CREATION_DATE,
      A.NUM_PROTO, A.VAR_SEGNATURA, convert(nvarchar (10), A.DTA_PROTO, 103) AS DTA_PROTO,
      @dbuser@.getchaimg(A.DOCNUMBER) AS CHA_IMG , A.CHA_PRIVATO, A.CHA_PERSONALE, @dbuser@.getInADL(A.SYSTEM_ID,'D',@idGruppo@,@idPeople@) AS IN_ADL,
      A.ID_DOCUMENTO_PRINCIPALE,
      @dbuser@.getInConservazione(A.SYSTEM_ID, null,'D', @idPeople@, @idGruppo@) AS IN_CONSERVAZIONE,
      a.id_tipo_atto as ID_TIPO_ATTO, ta.var_desc_atto as DESC_TIPO_ATTO, @dbuser@.getPeopleUserId (a.AUTHOR) as AUTHOR,
      @dbuser@.getchafirmato(A.DOCNUMBER) as CHA_FIRMATO,
      @dbuser@.getchatipofirma(A.DOCNUMBER) as CHA_TIPO_FIRMA
      FROM PROFILE a WITH(NOLOCK)
      LEFT JOIN dpa_tipo_atto ta on a.id_tipo_atto = ta.system_id
      WHERE @security@
      @filters@
      and isnull(dta_proto,creation_date) between convert(datetime,'@dataInizioAnno@',103) and getdate()
      @unionStampe@
      ORDER BY @order@
      ) AS A ORDER BY @reverseOrder@
      ) AS A ORDER BY @order@
    </value>
  </query>
  <query>
    <name>MODELLI_TRASM_UTENTI_CON_NOTIFICA</name>
    <value>
      select
      p.system_id as ID,
      p.user_id as CODICE,
      p.FULL_NAME as UTENTE,
      cg.VAR_DESC_CORR as RUOLO,
      @dbuser@.getflagnotifica(@id_mod_mitt_dest@,p.system_id) as FLAG_NOTIFICA,
      p.var_cognome
      from
      people p,
      peoplegroups pg,
      dpa_corr_globali cg
      where
      cg.system_id = @id_corr_glob_ruolo@
      and cg.id_gruppo = pg.groups_system_id
      and pg.PEOPLE_SYSTEM_ID = p.system_id
      and pg.DTA_FINE is null
      order by p.var_cognome asc
    </value>
  </query>
  <query>
    <name>MODELLI_TRASM_UTENTI_CON_NOTIFICA_P</name>
    <value>
      select
      p.system_id as ID,
      p.user_id as CODICE,
      p.FULL_NAME as UTENTE,
      '' as RUOLO,
      @dbuser@.getflagnotifica(@id_mod_mitt_dest@,p.system_id) as FLAG_NOTIFICA
      from
      people p
      where
      p.system_id = (select id_people from dpa_corr_globali where system_id = @id_corr_glob@)
      and p.disabled = 'N'
    </value>
  </query>
  <query>
    <name>MODELLI_TRASM_DEL_UT_CON_NOTIFICA</name>
    <value>
      DELETE FROM DPA_MODELLI_DEST_CON_NOTIFICA WHERE @id@
    </value>
  </query>
  <query>
    <name>MODELLI_TRASM_INS_UT_CON_NOTIFICA</name>
    <value>
      INSERT INTO DPA_MODELLI_DEST_CON_NOTIFICA
      (@colID@ ID_MODELLO_MITT_DEST,ID_PEOPLE,ID_MODELLO)
      VALUES
      (@system_id@ @id_mod_mitt_dest@, @id_people@, @id_modello@)
    </value>
  </query>
  <query>
    <name>MODELLI_TRASM_CESSIONE_DIRITTI</name>
    <value>
      UPDATE DPA_MODELLI_TRASM
      SET CHA_CEDE_DIRITTI = '@flag_cessione@', ID_PEOPLE_NEW_OWNER = @id_people_new_owner@, ID_GROUP_NEW_OWNER = @id_group_new_owner@
      WHERE @queryWhere@
    </value>
  </query>
  <query>
    <name>S_GET_INFO_DOCUMENTO</name>
    <value>
      SELECT 	A.SYSTEM_ID,
      A.DOCNUMBER,
      A.VAR_PROF_OGGETTO AS VAR_DESC_OGGETTO,
      @dtaAnnulla@ AS DTA_ANNULLA,
      A.ID_REGISTRO,
      A.CHA_TIPO_PROTO,
      A.CHA_EVIDENZA,
      @creationDate@ AS CREATION_DATE,
      A.NUM_PROTO,
      A.VAR_SEGNATURA,
      A.ID_TIPO_ATTO,
      @dtaProto@ AS DTA_PROTO,
      docsadm.getchaimg(A.DOCNUMBER) AS CHA_IMG ,
      A.CHA_PRIVATO,
      A.CHA_PERSONALE,
      A.ID_DOCUMENTO_PRINCIPALE,
      ta.var_desc_atto as DESC_TIPO_ATTO, @dbUser@.getPeopleUserId (a.AUTHOR) as AUTHOR
      FROM 	  PROFILE A
      LEFT JOIN dpa_tipo_atto ta on a.id_tipo_atto = ta.system_id
      WHERE 	A.SYSTEM_ID = (SELECT SYSTEM_ID FROM PROFILE WITH(NOLOCK) WHERE DOCNUMBER = @idProfile@) AND
      (@dbUser@.checkSecurityDocumento(A.SYSTEM_ID, @idPeople@, @idGroup@, @idRuoloPubblico@,'D') > 0)
    </value>
  </query>
  <query>
    <name>S_GET_INFO_DOCUMENTO_NO_SECURITY</name>
    <value>
      SELECT 	A.SYSTEM_ID,
      A.DOCNUMBER,
      A.VAR_PROF_OGGETTO AS VAR_DESC_OGGETTO,
      @dtaAnnulla@ AS DTA_ANNULLA,
      A.ID_REGISTRO,
      A.CHA_TIPO_PROTO,
      A.CHA_EVIDENZA,
      @creationDate@ AS CREATION_DATE,
      A.NUM_PROTO,
      A.VAR_SEGNATURA,
      A.ID_TIPO_ATTO,
      @dtaProto@ AS DTA_PROTO,
      docsadm.getchaimg(A.DOCNUMBER) AS CHA_IMG ,
      A.CHA_PRIVATO,
      A.CHA_PERSONALE,
      A.ID_DOCUMENTO_PRINCIPALE,
      ta.var_desc_atto as DESC_TIPO_ATTO, @dbUser@.getPeopleUserId (a.AUTHOR) as AUTHOR,
      A.IN_LIBROFIRMA
      FROM 	  PROFILE A
      LEFT JOIN dpa_tipo_atto ta on a.id_tipo_atto = ta.system_id
      WHERE 	A.SYSTEM_ID = (SELECT SYSTEM_ID FROM PROFILE WITH(NOLOCK) WHERE DOCNUMBER = @idProfile@)
    </value>
  </query>
  <query>
    <name>S_GET_SCHEDA_DOCUMENTO</name>
    <value>
      SELECT 	A.SYSTEM_ID,
      A.DOCNUMBER,
      A.DOCNAME,
      A.STATUS,
      A.DOCSERVER_LOC,
      A.PATH,
      @creationDate@ AS CREATION_DATE,
      @creationTime@ AS CREATION_TIME,
      A.ID_REGISTRO,
      A.CHA_TIPO_PROTO,
      A.ID_OGGETTO,
      A.NUM_PROTO,
      A.NUM_ANNO_PROTO,
      A.VAR_PROTO_EME,
      @dtaProtoEme@ AS DTA_PROTO_EME,
      A.CHA_ASSEGNATO,
      A.VAR_COGNOME_EME,
      A.VAR_NOME_EME,
      A.ID_PARENT,
      @dtaProto@ AS DTA_PROTO,
      A.CHA_MOD_OGGETTO,
      A.CHA_MOD_MITT_DEST,
      A.CHA_MOD_MITT_INT,
      A.VAR_PROTO_IN,
      A.ID_ANNULLATORE,
      A.VAR_AUT_ANNULLA,
      A.CHA_INVIO_CONFERMA,
      @dtaProtoIn@ AS DTA_PROTO_IN,
      @dtaAnnulla@ AS DTA_ANNULLA,
      A.VAR_SEGNATURA,
      A.CHA_DA_PROTO,
      A.CHA_FASCICOLATO,
      A.ID_TIPO_ATTO,
      A.CHA_PRIVATO,
      A.CHA_PERSONALE,
      A.CHA_EVIDENZA,
      A.VAR_PROF_OGGETTO AS VAR_DESC_OGGETTO,
      D.TYPE_ID,
      D.DESCRIPTION,
      A.ID_PEOPLE_PROT,
      A.ID_RUOLO_PROT,
      A.ID_UO_PROT,
      A.ID_RUOLO_CREATORE,
      A.ID_UO_CREATORE,
      A.AUTHOR,
      A.CHA_INTEROP,
      A.DTA_SCADENZA,
      A.CHA_IN_CESTINO,
      @dbUser@.getAccessRights(@idGroup@, @idPeople@, @idRuoloPubblico@, A.SYSTEM_ID) AS ACCESSRIGHTS,
      @documentoPubblico@
      A.ID_DOCUMENTO_PRINCIPALE,
      A.PROT_TIT,
      A.NUM_IN_FASC,
      A.ID_FASC_PROT_TIT,
      A.NUM_PROT_TIT,
      A.ID_TITOLARIO,
      A.CHA_RIFF_MITT,
      A.ID_PEOPLE_DELEGATO,
      A.CHA_DOCUMENTO_DA_PEC,
      A.FORWARDING_SOURCE,
      A.LAST_FORWARD,
      A.PRINTS_NUM,
      A.CHA_COD_T_A,
      A.COD_EXT_APP,
      A.MIS_OBIETTIVO,
      A.ID_OBIETTIVO,
      A.FASE,
      A.ID_TIPO_COMUNICAZIONE,
      A.ID_CENTRO_DI_COSTO,
      <!--GIORDANO IACOZZILLI Gestione dell'icona della copia del docuemnto/fascicolo in deposito.-->
      A.CHA_IN_ARCHIVIO,
      <!--**************************************  FINE  ******************************************-->
      @dbUser@.getInConservazione(A.DOCNUMBER,'','D', @idPeople@,@idGroup@) as inConservazione,
      A.IN_LIBROFIRMA
      FROM 	  PROFILE A,
      DOCUMENTTYPES D
      WHERE 	A.DOCUMENTTYPE=D.SYSTEM_ID AND
      (@dbUser@.checkSecurityDocumento(A.SYSTEM_ID, @idPeople@, @idGroup@, @idRuoloPubblico@,'D') > 0) AND
      @pk@
    </value>
  </query>
  <query>
    <name>S_UTENTI_BY_GROUPS_SYSTEM_ID</name>
    <value>
      SELECT DISTINCT p.system_id, p.user_id, p.full_name,p.matricola
      FROM people p, peoplegroups pg
      WHERE p.system_id = pg.people_system_id
      AND p.disabled = 'N'
      AND pg.dta_fine IS NULL
      AND pg.GROUPS_SYSTEM_ID in( select id_gruppo from dpa_corr_globali where system_id = @param1@ )
    </value>
  </query>
  <query>
    <name>GET_NUM_UTENTI_ATTIVI</name>
    <value>
      select count(*) from people where id_amm = @param1@ and disabled = 'N'
    </value>
  </query>
  <query>
    <name>GET_NUM_UTENTI_CONNESSI</name>
    <value>
      select count(*) from DPA_LOGIN where id_amm = @param1@
    </value>
  </query>
  <query>
    <name>S_AMM_GET_LIST_MEZZO_SPEDIZIONE</name>
    <value>
      SELECT distinct
      a.system_id AS IDSYSTEM_MS,
      a.description AS DESCRIPTION,
      a.CHA_TIPO_CANALE AS CHA_TIPO_CANALE,
      a.DISABLED as DISABLED
      FROM DOCUMENTTYPES A
      WHERE CHA_TIPO_CANALE IS NOT NULL
    </value>
  </query>
  <query>
    <name>AMM_S_CHECK_UNIQUE_MEZZO_SPEDIZIONE</name>
    <value>
      SELECT COUNT(SYSTEM_ID)
      FROM DOCUMENTTYPES
      WHERE	DESCRIPTION='@descrizione@'
      AND DISABLED IS NULL
    </value>
  </query>
  <query>
    <name>AMM_I_INSERT_MEZZO_SPEDIZIONE</name>
    <value>
      INSERT INTO DOCUMENTTYPES
      (
      TYPE_ID,
      DESCRIPTION,
      CHA_TIPO_CANALE
      )
      VALUES
      (
      '@typeId@',
      '@description@',
      '@chaTipoCanale@'
      )
    </value>
  </query>
  <query>
    <name>AMM_S_GET_DESC_MEZZO_SPEDIZIONE</name>
    <value>
      SELECT TR.DESCRIPTION
      FROM	DOCUMENTTYPES TR
      WHERE	TR.SYSTEM_ID=@idMezzoSpedizione@
      AND DISABLED IS NULL
    </value>
  </query>
  <query>
    <name>AMM_U_UPDATE_MEZZO_SPEDIZIONE</name>
    <value>
      UPDATE DOCUMENTTYPES
      SET	DESCRIPTION='@descrizione@',
      CHA_TIPO_CANALE='@cha_tipo_canale@'
      WHERE	SYSTEM_ID=@systemID@
      AND DISABLED IS NULL
    </value>
  </query>
  <query>
    <name>AMM_S_GET_MEZZO_SPEDIZIONE</name>
    <value>
      SELECT TR.SYSTEM_ID AS ID_MEZZO_SPEDIZIONE,
      TR.CHA_TIPO_CANALE AS CHA_TIPO_CANALE,
      TR.DESCRIPTION AS DESCRIZIONE,
      TR.TYPE_ID AS TYPE_ID,
      TR.DISABLED AS DISABLED
      FROM	DOCUMENTTYPES TR
      WHERE	TR.SYSTEM_ID=@systemID@
      AND DISABLED IS NULL
    </value>
  </query>
  <query>
    <name>AMM_D_DELETE_MEZZO_SPEDIZIONE</name>
    <value>
      UPDATE DOCUMENTTYPES
      SET DISABLED = 'Y'
      WHERE  SYSTEM_ID=@systemID@
    </value>
  </query>
  <query>
    <name>I_COLL_MSPEDIZ_DOCUMENTO</name>
    <value>
      INSERT INTO DPA_COLL_MSPEDIZ_DOCUMENTO
      (
      IDAMM,
      ID_RUOLO,
      ID_UTENTE,
      ID_DOCUMENTTYPES,
      ID_PROFILE
      )
      VALUES
      (
      @idAmm@,
      null,
      null,
      @idDocumenttypes@,
      @idProfile@
      )
    </value>
  </query>
  <query>
    <name>U_COLL_MSPEDIZ_DOCUMENTO</name>
    <value>
      UPDATE DPA_COLL_MSPEDIZ_DOCUMENTO
      SET ID_DOCUMENTTYPES = @idDocumenttypes@
      WHERE ID_PROFILE = @idProfile@
      AND IDAMM = @idAmm@
    </value>
  </query>
  <query>
    <name>U_MSPEDIZ_DOC_ARRIVO_PAR</name>
    <value>
      UPDATE DPA_DOC_ARRIVO_PAR
      SET ID_DOCUMENTTYPES = @idDocumenttypes@
      WHERE ID_PROFILE = @idProfile@
      @param1@
    </value>
  </query>
  <query>
    <name>D_COLL_MSPEDIZ_DOCUMENTO</name>
    <value>
      DELETE FROM DPA_COLL_MSPEDIZ_DOCUMENTO
      WHERE ID_PROFILE = @idProfile@
      AND IDAMM = @idAmm@
    </value>
  </query>
  <query>
    <name>S_DPAELRegistri_AMMINISTRA</name>
    <value>
      SELECT
      (coalesce(A.VAR_CODICE,'') + ' ' + coalesce(A.VAR_DESC_REGISTRO,'')) as VAR_DESC_REGISTRO,
      B.VAR_CODICE_AMM,
      B.VAR_DESC_AMM
      FROM DPA_EL_REGISTRI A, DPA_AMMINISTRA B
      WHERE A.SYSTEM_ID = @param1@
      AND B.SYSTEM_ID=A.ID_AMM
    </value>
  </query>
  <query>
    <name>S_DPA_AMMINISTRA3_TIMBRO</name>
    <value>
      SELECT
      @param1@
      @param2@
      @param3@
    </value>
  </query>
  <query>
    <name>S_TRASM_UNO_TUTTI_ACC_RIF</name>
    <value>
      SELECT count(DPA_TRASM_UTENTE.SYSTEM_ID) as CONTA
      FROM
      DPA_TRASM_SINGOLA,
      DPA_TRASM_UTENTE
      WHERE
      DPA_TRASM_SINGOLA.system_id = DPA_TRASM_UTENTE.ID_TRASM_SINGOLA
      AND DPA_TRASM_SINGOLA.SYSTEM_ID = @idTrasmSingola@
      @queryWhere@
    </value>
  </query>
  <query>
    <name>GET_LAST_VERSION_ALLEGATO_ESTESO</name>
    <value>
      SELECT COUNT(VERSION_LABEL)
      FROM VERSIONS
      WHERE DOCNUMBER IN
      (SELECT SYSTEM_ID FROM PROFILE WITH(NOLOCK) WHERE ID_DOCUMENTO_PRINCIPALE = @docNumber@)
    </value>
  </query>
  <query>
    <name>S_DPA_COLL_MSPEDIZ_DOC</name>
    <value>
      SELECT B.SYSTEM_ID AS MEZZOSPEDIZIONE, B.DESCRIPTION AS DESCMEZZOSPEDIZIONE
      FROM DPA_COLL_MSPEDIZ_DOCUMENTO A, DOCUMENTTYPES B
      WHERE A.ID_DOCUMENTTYPES = B.SYSTEM_ID
      AND A.ID_PROFILE = @param1@
    </value>
  </query>
  <query>
    <name>S_UTENTE_RESP_AOO</name>
    <value>
      SELECT SYSTEM_ID, VAR_CODICE  FROM DPA_EL_REGISTRI WHERE ID_PEOPLE_AOO = @idPeople@
    </value>
  </query>
  <query>
    <name>S_GET_RUOLO_RESP_UO</name>
    <value>
      SELECT SYSTEM_ID, ID_GRUPPO, ID_TIPO_RUOLO, VAR_CODICE, VAR_COD_RUBRICA,
      VAR_DESC_CORR, CHA_RIFERIMENTO, ID_AMM, CHA_RESPONSABILE
      FROM DPA_CORR_GLOBALI
      WHERE ID_UO = @idUo@ AND CHA_RESPONSABILE ='1' AND DTA_FINE IS NULL
    </value>
  </query>
  <query>
    <name>U_DPAOggettario</name>
    <value>
      UPDATE DPA_OGGETTARIO
      SET ID_REGISTRO = @idRegistro@,
      CHA_OCCASIONALE = '0',
      VAR_DESC_OGGETTO = '@param1@'
      WHERE VAR_COD_OGGETTO = '@varCodOggetto@'
      AND ID_AMM = @param2@
    </value>
  </query>
  <query>
    <name>S_DPA_EL_REG</name>
    <value>
      SELECT SYSTEM_ID
      FROM DPA_EL_REGISTRI
      WHERE
      @param1@
    </value>
  </query>
  <query>
    <name>U_PULS_COLOR</name>
    <value>
      UPDATE DPA_AMMINISTRA
      SET PULS_COLOR = '@param2@'
      WHERE SYSTEM_ID = @param1@
    </value>
  </query>
  <query>
    <name>S_PULS_COLOR</name>
    <value>
      SELECT PULS_COLOR
      FROM DPA_AMMINISTRA
      WHERE SYSTEM_ID = @param1@
    </value>
  </query>
  <query>
    <name>S_IS_RUOLO_PRAU</name>
    <value>
      SELECT SYSTEM_ID FROM DPA_TIPO_F_RUOLO WHERE id_Ruolo_in_uo= @id_ruolo_creatore@
      AND ID_TIPO_FUNZ IN
      (SELECT SYSTEM_ID FROM DPA_TIPO_FUNZIONE WHERE VAR_COD_TIPO ='PRAU')
    </value>
  </query>
  <query>
    <name>S_IS_PROTOCOLLATO</name>
    <value>
      SELECT COUNT(NUM_PROTO) FROM PROFILE WHERE DOCNUMBER = @idprofile@
    </value>
  </query>
  <query>
    <name>UPDATE_TRASM_UTENTE_TOGLIE_TODOLIST</name>
    <value>
      update dpa_trasm_utente
      set cha_in_todolist = '0',
      dta_rimozione_todolist = @data_rimozione@
      where cha_in_todolist = '1'
      and id_trasm_singola in
      (select ts.system_id
      from dpa_trasm_singola ts, dpa_trasmissione t
      where ts.cha_tipo_dest = 'R'
      and ts.id_corr_globale = (select system_id from dpa_corr_globali where id_gruppo = @idgruppo@)
      and id_trasmissione = t.system_id
      and (t.id_profile = @idoggetto@ or id_project = @idoggetto@))
    </value>
  </query>
  <query>
    <name>U_DPAOggettario2</name>
    <value>
      UPDATE DPA_OGGETTARIO
      SET CHA_OCCASIONALE = '1'
      WHERE VAR_DESC_OGGETTO = '@param1@'
      AND ID_AMM = @param2@
      @param3@
    </value>
  </query>
  <query>
    <name>S_FOLDER_BY_DESCR</name>
    <value>
      SELECT DISTINCT(P.SYSTEM_ID) AS ID_FOLDER,
      P.ID_PARENT AS ID_PARENT_FOLDER,
      P.ID_FASCICOLO ID_FASCICOLO,
      P.DESCRIPTION FOLDER_DESCRIPTION,
      P.cha_tipo_fascicolo,
      P.dta_apertura APERTURA,
      P.NUM_LIVELLO,
      P.VAR_COD_LIV1
      FROM PROJECT P, SECURITY as B  WITH (nolock)
      WHERE P.SYSTEM_ID=B.THING
      AND P.ID_FASCICOLO=@param1@
      @param5@
      AND ( B.PERSONORGROUP=@param2@
      OR B.PERSONORGROUP=@param3@ OR B.PERSONORGROUP=@idRuoloPubblico@)
      @param4@
      AND B.ACCESSRIGHTS >= 0
      ORDER BY DESCRIPTION ASC
    </value>
  </query>
  <query>
    <name>S_FOLDER_BY_IDFASC</name>
    <value>
      SELECT DISTINCT(P.SYSTEM_ID) AS ID_FOLDER,
      P.ID_PARENT AS ID_PARENT_FOLDER,
      P.ID_FASCICOLO ID_FASCICOLO,
      P.DESCRIPTION FOLDER_DESCRIPTION,
      P.cha_tipo_fascicolo,
      P.DTA_APERTURA APERTURA
      FROM PROJECT P, SECURITY as B  WITH (nolock)
      WHERE P.SYSTEM_ID=B.THING
      AND P.ID_FASCICOLO=@param1@
      AND ( B.PERSONORGROUP=@param2@
      OR B.PERSONORGROUP=@param3@ )
      AND B.ACCESSRIGHTS >= 0
      ORDER BY DESCRIPTION ASC
    </value>
  </query>
  <query>
    <name>S_CONTA_TRASM_DA_ACC</name>
    <value>
      select count(tot_trasm) as tot_trasm
      from (
      select tr.system_id as tot_trasm
      from dpa_trasmissione tr, dpa_trasm_singola ts, dpa_trasm_utente tu, dpa_ragione_trasm rt
      where tr.system_id = ts.id_trasmissione
      and ts.system_id = tu.id_trasm_singola
      and ts.ID_RAGIONE = rt.SYSTEM_ID
      and rt.CHA_TIPO_RAGIONE = 'W'
      and tu.DTA_ACCETTATA is not null
      and tr.@campoOggetto@ = @IDOggetto@
      and (tu.ID_PEOPLE = @IDPeople@ or ts.ID_CORR_GLOBALE = (select system_id from dpa_corr_globali where id_gruppo = @IDGroup@))
      union
      select tr.system_id as tot_trasm
      from dpa_trasmissione tr, dpa_trasm_singola ts, dpa_trasm_utente tu, dpa_ragione_trasm rt
      where tr.system_id = ts.id_trasmissione
      and ts.system_id = tu.id_trasm_singola
      and ts.ID_RAGIONE = rt.SYSTEM_ID
      and rt.CHA_TIPO_RAGIONE &lt;&gt; 'W'
      and tu.DTA_VISTA is not null
      and tr.@campoOggetto@ = @IDOggetto@
      and (tu.ID_PEOPLE = @IDPeople@ or ts.ID_CORR_GLOBALE = (select system_id from dpa_corr_globali where id_gruppo = @IDGroup@))
      ) a
    </value>
  </query>
  <query>
    <name>S_EXPORT_TODO_LIST_DOCUMENTI</name>
    <value>
      SELECT
      ID_TRASMISSIONE,
      ID_TRASM_SINGOLA,
      ID_TRASM_UTENTE,
      DTA_INVIO,
      ID_PEOPLE_DELEGATO,
      CONVERT(VARCHAR,DTA_INVIO,103)AS DTAINVIO,
      ISNULL(DTA_SCADENZA,'25000101') AS DTA_SCAD_ASC,
      ISNULL(DTA_SCADENZA,'17530101') AS DTA_SCAD_DESC,
      @dbuser@.Vardescribe(ID_PEOPLE_MITT, 'PEOPLENAME') AS UT_MITT,
      @dbuser@.Vardescribe(ID_RUOLO_MITT, 'GROUPNAME') AS RUOLO_MITT,
      @dbuser@.Vardescribe(ID_PEOPLE_DEST, 'PEOPLENAME') AS UT_DEST,
      @dbuser@.Vardescribe(ID_RAGIONE_TRASM, 'RAGIONETRASM') AS RAG_TRASM,
      VAR_NOTE_GEN,
      VAR_NOTE_SING,
      DTA_SCADENZA,
      CONVERT(VARCHAR,DTA_SCADENZA,103) AS DTA_SCAD_CHAR,
      ID_PROFILE,
      @dbuser@.Vardescribe(ID_PROFILE, 'SEGNATURA_DOCNUMBER')AS SEGNA_DOCNUMBER,
      @dbuser@.Vardescribe(ID_PROFILE, 'OGGETTO_MITTENTE')AS OGGETTO_MITTENTE,
      @dbuser@.Vardescribe(ID_PROFILE, 'CHA_TIPO_PROTO')AS TIPO_PROTO,
      @dbuser@.Vardescribe(ID_PROFILE, 'DATADOC') AS DTA_DOC,
      @dbuser@.vardescribe(ID_PROFILE, 'NUMPROTO') AS NUM_PROTO,
      ID_PEOPLE_MITT AS ID_PEOPLE_MITT,
      ID_RUOLO_MITT AS ID_RUOLO_MITT,
      ID_RAGIONE_TRASM AS ID_RAGIONE_TRASM,
      ID_RUOLO_DEST AS ID_RUOLO_DEST,
      ID_PEOPLE_DEST AS ID_PEOPLE_DEST,
      CHA_TIPO_TRASM AS CHA_TIPO_TRASM
      FROM DPA_TODOLIST
      WHERE ID_PROFILE &gt; 0
      AND ((ID_PEOPLE_DEST = @idPeople@ and ID_RUOLO_DEST = @idGruppo@) OR (ID_PEOPLE_DEST = @idPeople@ AND ID_RUOLO_DEST = 0))
      AND ID_REGISTRO IN (@registri@)
      @filters@
      ORDER BY @order@
    </value>
  </query>
  <query>
    <name>S_EXPORT_TODO_LIST_FASCICOLI</name>
    <value>
      SELECT
      ID_TRASMISSIONE,
      ID_TRASM_SINGOLA,
      ID_TRASM_UTENTE,
      ID_PEOPLE_DELEGATO,
      DTA_INVIO AS DTA_INVIO,
      CONVERT(VARCHAR,DTA_INVIO,103)AS DTA_INVIO,
      ISNULL(DTA_SCADENZA,'25000101') AS DTA_SCAD_ASC,
      ISNULL(DTA_SCADENZA,'17530101') AS DTA_SCAD_DESC,
      @dbuser@.Vardescribe(ID_PEOPLE_MITT, 'PEOPLENAME') AS UT_MITT,
      @dbuser@.Vardescribe(ID_RUOLO_MITT, 'GROUPNAME') AS RUOLO_MITT,
      @dbuser@.Vardescribe(ID_PEOPLE_DEST, 'PEOPLENAME') AS UT_DEST,
      @dbuser@.Vardescribe(ID_RAGIONE_TRASM, 'RAGIONETRASM') AS RAG_TRASM,
      VAR_NOTE_GEN,
      VAR_NOTE_SING,
      DTA_SCADENZA,
      CONVERT(VARCHAR,DTA_SCADENZA,103) AS DTA_SCAD_CHAR,
      ID_PROJECT,
      @dbuser@.Vardescribe(ID_PROJECT, 'DESC_FASC')AS DESC_FASC,
      @dbuser@.Vardescribe(ID_PROJECT, 'CODFASC') AS COD_FASC,
      ID_PEOPLE_MITT AS ID_PEOPLE_MITT,
      ID_RUOLO_MITT AS ID_RUOLO_MITT,
      ID_RAGIONE_TRASM AS ID_RAGIONE_TRASM,
      ID_RUOLO_DEST AS ID_RUOLO_DEST,
      ID_PEOPLE_DEST AS ID_PEOPLE_DEST,
      CHA_TIPO_TRASM AS CHA_TIPO_TRASM
      FROM DPA_TODOLIST
      WHERE ID_PROJECT &gt; 0
      AND ((ID_PEOPLE_DEST = @idPeople@ and ID_RUOLO_DEST = @idGruppo@) OR (ID_PEOPLE_DEST = @idPeople@ AND ID_RUOLO_DEST = 0))
      @filters@
      ORDER BY @order@
    </value>
  </query>
  <query>
    <name>U_PROFILE_ANNULLA_PRED</name>
    <value>
      UPDATE PROFILE
      SET CHA_TIPO_PROTO = 'G',
      LAST_EDIT_DATE = GETDATE(),
      CHA_DA_PROTO = 0,
      ID_PARENT = NULL,
      ID_REGISTRO = NULL
      WHERE SYSTEM_ID = @param1@
    </value>
  </query>
  <query>
    <name>D_DPA_DOC_ARRIVO_PAR</name>
    <value>
      DELETE FROM DPA_DOC_ARRIVO_PAR
      WHERE ID_PROFILE IN ( @param1@ )
    </value>
  </query>
  <query>
    <name>INDS_INSERT_INDX_SIS</name>
    <value>
      INSERT INTO DPA_INDX_SIS
      (
      @colID@
      ID_AMM,
      VOCE_INDICE
      )
      VALUES
      (
      @id@
      @idAmm@,
      '@voceIndice@'
      )
    </value>
  </query>
  <query>
    <name>INDS_DELETE_INDX_SIS</name>
    <value>
      DELETE DPA_INDX_SIS
      WHERE SYSTEM_ID = @systemId@
    </value>
  </query>
  <query>
    <name>INDS_GET_BY_IDAMM</name>
    <value>
      SELECT * FROM DPA_INDX_SIS
      WHERE ID_AMM = @idAmm@
      ORDER BY VOCE_INDICE
    </value>
  </query>
  <query>
    <name>INDS_INSERT_ASS_INDX_SIS</name>
    <value>
      INSERT INTO DPA_ASS_INDX_SIS
      (
      @colID@
      ID_PROJECT,
      ID_INDICE_SIS
      )
      VALUES
      (
      @id@
      @idProject@,
      @idIndiceSis@
      )
    </value>
  </query>
  <query>
    <name>INDS_DELETE_ASS_INDX_SIS</name>
    <value>
      DELETE DPA_ASS_INDX_SIS
      WHERE
      ID_INDICE_SIS = @idIndiceSis@
      AND
      ID_PROJECT = @idProject@
    </value>
  </query>
  <query>
    <name>INDS_GET_BY_IDPROJECT</name>
    <value>
      SELECT DPA_INDX_SIS.SYSTEM_ID, DPA_INDX_SIS.ID_AMM, DPA_INDX_SIS.VOCE_INDICE, DPA_ASS_INDX_SIS.ID_PROJECT
      FROM DPA_INDX_SIS, DPA_ASS_INDX_SIS
      WHERE
      DPA_INDX_SIS.SYSTEM_ID = DPA_ASS_INDX_SIS.ID_INDICE_SIS
      AND
      DPA_ASS_INDX_SIS.ID_PROJECT = @idProject@
      ORDER BY DPA_INDX_SIS.VOCE_INDICE
    </value>
  </query>
  <query>
    <name>INDS_GET_NODI_BY_INDICE</name>
    <value>
      SELECT * FROM PROJECT, DPA_ASS_INDX_SIS, DPA_INDX_SIS
      where
      PROJECT.SYSTEM_ID = DPA_ASS_INDX_SIS.ID_PROJECT
      AND
      DPA_ASS_INDX_SIS.ID_INDICE_SIS = DPA_INDX_SIS.SYSTEM_ID
      @titolario@
      AND
      DPA_INDX_SIS.VOCE_INDICE = '@indice@'
    </value>
  </query>
  <query>
    <name>TITOLARIO_GET_TITOLARI_UTILI</name>
    <value>
      SELECT P.*, A.VAR_CODICE_AMM FROM PROJECT P, DPA_AMMINISTRA A
      WHERE
      P.ID_AMM = @idAmm@
      AND
      P.ID_TITOLARIO = 0
      AND
      P.ID_PARENT = 0
      AND
      P.ID_AMM = A.SYSTEM_ID
      AND
      P.CHA_STATO &lt; &gt; 'D'
      ORDER BY P.CHA_STATO, P.DTA_CESSAZIONE DESC
    </value>
  </query>
  <query>
    <name>S_SELECT_DATA_SCAMBIA_ALLEGATO</name>
    <value>
      SELECT
      V.SUBVERSION,
      V.CARTACEO,
      V.SCARTA_FASC_CARTACEA,
      C.PATH,
      C.FILE_SIZE,
      C.VAR_IMPRONTA,
      C.EXT,
      C.CHA_FIRMATO,
      C.VAR_NOMEORIGINALE,
      C.FILE_INFO,
      C.ID_PEOPLE_PUTFILE,
      C.ID_PEOPLE_DELEGATO_PUTFILE,
      C.DTA_FILE_ACQUIRED
      FROM VERSIONS V
      INNER JOIN COMPONENTS C ON V.VERSION_ID = C.VERSION_ID
      WHERE V.VERSION_ID = @versionId@
    </value>
  </query>
  <query>
    <name>U_UPDATE_VERSION_SCAMBIA_ALLEGATO</name>
    <value>
      UPDATE VERSIONS
      SET SUBVERSION = @subVersion@,
      CARTACEO = @cartaceo@,
      SCARTA_FASC_CARTACEA = @scartaFascCartacea@
      WHERE VERSION_ID = @versionId@
    </value>
  </query>
  <query>
    <name>U_UPDATE_COMPONENTS_SCAMBIA_ALLEGATO</name>
    <value>
      UPDATE COMPONENTS
      SET PATH = @path@,
      FILE_SIZE = @fileSize@,
      VAR_IMPRONTA = @impronta@,
      CHA_FIRMATO = '@firmato@',
      EXT = '@estensione@',
      VAR_NOMEORIGINALE = '@nomeOriginale@',
      FILE_INFO = '@fileInfo@',
      ID_PEOPLE_PUTFILE = @idPeoplePutfile@,
      ID_PEOPLE_DELEGATO_PUTFILE = @idPeopleDelegatoPutfile@,
      DTA_FILE_ACQUIRED = @dtaFileAcquired@
      WHERE VERSION_ID = @versionId@
    </value>
  </query>
  <query>
    <name>U_UPDATE_TIMESTAMP_SCAMBIA_ALLEGATO</name>
    <value>
      UPDATE DPA_TIMESTAMP_DOC
      SET DOC_NUMBER = @docnumber@,
      VERSION_ID = @versionId@
      WHERE SYSTEM_ID = @systemId@
    </value>
  </query>
  <query>
    <name>S_IS_ALLEGATO_PROFILATO</name>
    <value>
      SELECT ID_DOCUMENTO_PRINCIPALE
      FROM PROFILE WITH(NOLOCK)
      WHERE DOCNUMBER = @docnumber@
    </value>
  </query>
  <query>
    <name>S_GET_INDICE_SISTEMATICO</name>
    <value>
      SELECT PROJECT.VAR_CODICE, PROJECT.DESCRIPTION, PROJECT.ID_REGISTRO, DPA_INDX_SIS.VOCE_INDICE
      FROM
      PROJECT LEFT OUTER JOIN DPA_ASS_INDX_SIS
      ON PROJECT.SYSTEM_ID = DPA_ASS_INDX_SIS.ID_PROJECT
      LEFT OUTER JOIN DPA_INDX_SIS
      ON DPA_INDX_SIS.SYSTEM_ID = DPA_ASS_INDX_SIS.ID_INDICE_SIS
      WHERE
      ID_TITOLARIO = @idTitolario@
      AND CHA_TIPO_PROJ = 'T'
      @orderBy@
    </value>
  </query>
  <query>
    <name>INDS_EXSIST_VOCE_INDICE</name>
    <value>
      SELECT *
      FROM DPA_INDX_SIS
      WHERE
      VOCE_INDICE = '@voceIndice@'
    </value>
  </query>
  <query>
    <name>INDS_IS_ASSOCIATA_VOCE</name>
    <value>
      SELECT *
      FROM DPA_ASS_INDX_SIS
      WHERE
      @idProject@
      @idIndice@
    </value>
  </query>
  <query>
    <name>S_Project14</name>
    <value>
      SELECT
      SYSTEM_ID, DESCRIPTION, ID_PARENT
      FROM PROJECT
      WHERE CHA_TIPO_PROJ='C'
      AND ID_FASCICOLO=@param1@
    </value>
  </query>
  <query>
    <name>S_SYSTEM_ID_DPA_CORR_GLOBALI</name>
    <value>
      SELECT SYSTEM_ID
      FROM DPA_CORR_GLOBALI
      WHERE
      VAR_COD_RUBRICA = '@param1@'
      and id_amm=@param2@
    </value>
  </query>
  <query>
    <name>S_SYSTEM_ID_DPA_CORR_GLOBALI_PARAM</name>
    <value>
      SELECT SYSTEM_ID
      FROM DPA_CORR_GLOBALI
      WHERE
      VAR_COD_RUBRICA = '@param1@'
      and id_amm=@param2@ @params@
    </value>
  </query>
  <query>
    <name>S_System_id__DocumentTypes</name>
    <value>
      SELECT
      SYSTEM_ID
      FROM DOCUMENTTYPES
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>S_PREDISPOSTI_IN_REGISTRO</name>
    <value>
      select * from profile WITH(NOLOCK)
      where cha_da_proto = '1'
      and ID_REGISTRO = @idReg@
      and cha_in_cestino = '0'
    </value>
  </query>
  <query>
    <name>AMM_SELECT_DISABLED_DPA_EL_REGISTRI</name>
    <value>
      select CHA_DISABILITATO
      from DPA_EL_REGISTRI
      where SYSTEM_ID = @param1@
    </value>
  </query>
  <query>
    <name>S_CSS_AMMINISTRA</name>
    <value>
      select b.THEME + '^' + cast(b.system_id as varchar) + '^' + b.color
      from DPA_AMMINISTRA a,
      DPA_THEMES b
      where a.SYSTEM_ID = @idAmm@
      and a.css = b.system_id
    </value>
  </query>
  <query>
    <name>U_THEME_DPA_AMMINISTRA</name>
    <value>
      update DPA_AMMINISTRA
      set CSS = @param1@
      where system_id = @idAmm@
    </value>
  </query>
  <query>
    <name>S_CONTA_TRASM_CON_WF_IN_TDL_PER_UT</name>
    <value>
      select count(*) as tot_trasm
      from dpa_todolist tdl, dpa_ragione_trasm rt, dpa_trasm_singola ts
      where tdl.@campoOggetto@ = @IDOggetto@
      and tdl.id_people_dest = @IDPeople@
      and rt.CHA_TIPO_RAGIONE = 'W'
      and ts.ID_RAGIONE = rt.SYSTEM_ID
      and tdl.ID_TRASM_SINGOLA = ts.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>DS_GET_DIAGRAMMA_ASSOCIATO_FASC</name>
    <value>
      SELECT ID_DIAGRAMMA FROM DPA_ASS_DIAGRAMMI
      WHERE ID_TIPO_FASC = @idTipoFasc@ AND ID_DIAGRAMMA IS NOT NULL
    </value>
  </query>
  <query>
    <name>DS_GET_ID_MODELLO_TIPOFASC_DS_1</name>
    <value>
      SELECT * FROM DPA_ASS_DIAGRAMMI
      WHERE ID_TIPO_FASC = @idTipoFasc@
      AND
      (ID_DIAGRAMMA = @idDiagramma@ OR ID_DIAGRAMMA IS NULL)
      AND
      ID_STATO IS NULL
    </value>
  </query>
  <query>
    <name>DS_DISASSOCIA_TIPO_FASC_DIAGRAMMA_1</name>
    <value>
      DELETE FROM DPA_ASS_DIAGRAMMI
      WHERE
      ID_STATO IS NULL
      AND
      ID_DIAGRAMMA IS NULL
      AND
      ID_TIPO_FASC = @idTipoFasc@
    </value>
  </query>
  <query>
    <name>DS_DISASSOCIA_TIPO_FASC_DIAGRAMMA_3</name>
    <value>
      DELETE FROM DPA_ASS_DIAGRAMMI
      WHERE
      ID_DIAGRAMMA = @idDiagramma@
      AND
      ID_TIPO_FASC = @idTipoFasc@
      AND
      ID_STATO = @idStato@
    </value>
  </query>
  <query>
    <name>DS_INS_ASSOCIA_TIPO_FASC_DIAGRAMMA_3</name>
    <value>
      INSERT INTO DPA_ASS_DIAGRAMMI
      (
      @colID@
      ID_TIPO_FASC,
      ID_DIAGRAMMA,
      ID_MOD_TRASM,
      ID_STATO,
      TRASM_AUT
      )
      VALUES
      (
      @id@
      @idTipoFasc@,
      @idDiagramma@,
      @idTemplate@,
      @idStato@,
      @trasmAut@
      )
    </value>
  </query>
  <query>
    <name>DS_ASSOCIA_TIPO_FASC_DIAGRAMMA</name>
    <value>
      SELECT * FROM DPA_ASS_DIAGRAMMI
      WHERE ID_TIPO_FASC = @idTipoFasc@
      AND
      ID_DIAGRAMMA = @idDiagramma@
      AND
      ID_MOD_TRASM IS NULL AND ID_STATO IS NULL
    </value>
  </query>
  <query>
    <name>DS_GET_DPA_DIAGRAMMI_FASC</name>
    <value>
      SELECT DISTINCT(ID_STATO)
      FROM DPA_DIAGRAMMI, DPA_ASS_TEMPLATES_FASC, DPA_STATI
      WHERE
      DPA_DIAGRAMMI.ID_PROJECT = DPA_ASS_TEMPLATES_FASC.ID_PROJECT
      AND
      DPA_STATI.SYSTEM_ID = DPA_DIAGRAMMI.ID_STATO
      AND
      DPA_STATI.STATO_FINALE &lt;&gt; 1
      AND
      DPA_ASS_TEMPLATES_FASC.ID_TEMPLATE = @idTemplate@
      AND
      DPA_DIAGRAMMI.ID_DIAGRAMMA = @idDiagramma@
    </value>
  </query>
  <query>
    <name>DS_DEL_TRASM_STORICO_FASC</name>
    <value>
      DELETE FROM DPA_TRASM_DIAGR WHERE ID_STATO = @idStato@ AND ID_PROJECT = @idProject@
    </value>
  </query>
  <query>
    <name>DS_GET_STATO_FASC_1</name>
    <value>
      SELECT * FROM DPA_DIAGRAMMI
      WHERE ID_PROJECT = @idProject@
    </value>
  </query>
  <query>
    <name>DS_INS_DPA_DIAGRAMMI_STO_FASC</name>
    <value>
      INSERT INTO DPA_DIAGRAMMI_STO
      (
      @colID@
      Id_user,
      Id_Project,
      Dta_date,
      Var_desc_old_stato,
      Var_desc_new_stato,
      Id_people,
      Id_ruolo
      )
      VALUES
      (
      @id@
      '@idUtente@',
      @idProject@,
      GETDATE(),
      '@oldStato@',
      '@newStato@',
      @idPeople@,
      @idRuolo@
      )
    </value>
  </query>
  <query>
    <name>PD_GET_SCADENZE_FASC</name>
    <value>
      SELECT * FROM DPA_TIPO_FASC
      WHERE
      DPA_TIPO_FASC.SYSTEM_ID = @idTipoFasc@
    </value>
  </query>
  <query>
    <name>UPDATE_SCADENZA_PROJECT</name>
    <value>
      UPDATE PROJECT SET DTA_SCADENZA = DATEADD(DAY, +@scadenza_gg@, GETDATE()) WHERE SYSTEM_ID = @idProject@
    </value>
  </query>
  <query>
    <name>UPDATE_SCADENZA_PROJECT_1</name>
    <value>
      UPDATE PROJECT SET DTA_SCADENZA = convert(datetime,'@data@',103) WHERE SYSTEM_ID = @idProject@
    </value>
  </query>
  <query>
    <name>DS_IS_STATO_TRASM_AUTO_FASC</name>
    <value>
      SELECT ID_MOD_TRASM, TRASM_AUT
      FROM DPA_ASS_DIAGRAMMI
      WHERE ID_STATO = @idStato@
      AND
      ID_TIPO_FASC = @idTipoFasc@
    </value>
  </query>
  <query>
    <name>DS_GET_ID_TRASM_DIAGR_FASC</name>
    <value>
      SELECT ID_TRASM FROM DPA_TRASM_DIAGR WHERE ID_PROJECT = @idProject@ AND ID_STATO = @idStato@
    </value>
  </query>
  <query>
    <name>DS_GET_DIAGRAMMA_STORICO_FASC</name>
    <value>
      SELECT  ID_USER, DTA_DATE, VAR_DESC_OLD_STATO, VAR_DESC_NEW_STATO, ID_PEOPLE, ID_RUOLO
      FROM DPA_DIAGRAMMI_STO
      WHERE ID_PROJECT = @idProject@ ORDER BY SYSTEM_ID
    </value>
  </query>
  <query>
    <name>PD_GET_ID_TEMPLATE_FASC</name>
    <value>
      SELECT ID_TIPO_FASC as ID_TEMPLATE FROM PROJECT
      WHERE SYSTEM_ID = @idProject@
    </value>
  </query>
  <query>
    <name>TRASM_SCADENZE_FASC</name>
    <value>
      SELECT distinct(thing),personorgroup,project.system_id as P_SYSTEM_ID,project.system_id as idproject
      FROM
      project,
      dpa_tipo_fasc,
      security  WITH (nolock) ,
      people,
      dpa_stati,
      dpa_diagrammi
      WHERE
      project.id_tipo_fasc = dpa_tipo_fasc.system_id
      AND
      project.dta_scadenza = @param1@
      AND
      project.system_id = security.thing
      AND
      people.system_id = security.personorgroup
      AND
      security.accessrights=0
      AND
      security.cha_tipo_diritto &lt;&gt; 'A'
      AND
      project.system_id = dpa_diagrammi.id_project
      AND
      dpa_diagrammi.id_diagramma = dpa_stati.id_diagramma
      AND
      dpa_stati.stato_finale &lt;&gt; 1
    </value>
  </query>
  <query>
    <name>TRASM_SCADENZE_DEST_FASC</name>
    <value>
      select
      personorgroup,
      accessrights,
      project.system_id as idproject, thing,
      cha_tipo_diritto,
      'R' as tipo
      from
      project,
      dpa_tipo_fasc,
      security  WITH (nolock) ,
      groups
      where
      project.id_tipo_fasc = dpa_tipo_fasc.system_id
      and
      project.dta_scadenza = @param1@
      and
      project.system_id = security.thing
      and
      security.accessrights > 0
      and
      project.system_id = @idProject@
      and
      groups.system_id = security.personorgroup
      and
      security.cha_tipo_diritto &lt;&gt; 'A'
      union
      select
      personorgroup,
      accessrights,
      project.system_id as idproject, thing,
      cha_tipo_diritto,
      'P' as tipo
      from
      project,
      dpa_tipo_fasc,
      security  WITH (nolock) ,
      people
      where
      project.id_tipo_fasc = dpa_tipo_fasc.system_id
      and
      project.dta_scadenza = @param1@
      and
      project.system_id = security.thing
      and
      security.accessrights > 0
      and
      project.system_id = @idProject@
      and
      people.system_id = security.personorgroup
      and
      security.cha_tipo_diritto &lt;&gt; 'A'
    </value>
  </query>
  <query>
    <name>S_IS_NOTE_FASCICOLO_SOLA_LETTURA</name>
    <value>
      SELECT @dbUser@.getAccessRightsProject(@idRuoloCreatore@, @idUtenteCreatore@, @idRuoloPubblico@, @idOggetto@) AS ACCESS_RIGHTS
      FROM PROJECT p
      WHERE   p.system_id = @idOggetto@
    </value>
  </query>
  <query>
    <name>S_VISIB_RUOLO_NODI_TITOLARIO</name>
    <value>
      SELECT
      p.system_id as IDRECORD,
      p.var_codice as CODICE,
      p.description as DESCRIZIONE,
      p.num_livello as LIVELLO,
      p.var_cod_liv1 as CODLIV,
      p.id_parent as IDPARENT
      FROM PROJECT p, SECURITY as s  WITH (nolock)
      WHERE p.system_id = s.THING
      AND p.cha_tipo_proj = 'T'
      AND s.accessrights IN (255,47,63)
      AND s.PERSONORGROUP = @idgruppo@
      ORDER BY p.var_cod_liv1
    </value>
  </query>
  <query>
    <name>DEL_DOC_IN_CONVERSIONE_PDF</name>
    <value>
      DELETE DPA_CONV_PDF_SERVER WHERE ID_PROFILE = @idProfile@
    </value>
  </query>
  <query>
    <name>IS_DOC_IN_CONVERSIONE_PDF</name>
    <value>
      SELECT * FROM DPA_CONV_PDF_SERVER WHERE ID_PROFILE = @idProfile@
    </value>
  </query>
  <query>
    <name>S_DPA_MODELLI_TRASM_GENERIC</name>
    <value>
      SELECT @campi@
      FROM DPA_MODELLI_TRASM
      WHERE @condizioni@
    </value>
  </query>
  <query>
    <name>S_UTENTE_UNICO_IN_NOTIFICHE</name>
    <value>
      SELECT m.*
      FROM DPA_MODELLI_TRASM m, DPA_MODELLI_MITT_DEST d, DPA_MODELLI_DEST_CON_NOTIFICA n
      WHERE
      n.ID_MODELLO_MITT_DEST = d.SYSTEM_ID
      and d.ID_MODELLO = m.SYSTEM_ID
      and (select count(*) from dpa_modelli_dest_con_notifica where ID_MODELLO_MITT_DEST = n.ID_MODELLO_MITT_DEST) = 1
      and d.ID_CORR_GLOBALI = (select system_id from dpa_corr_globali where id_gruppo = @idGruppo@)
      AND n.ID_PEOPLE = @idPeople@
    </value>
  </query>
  <query>
    <name>S_GET_COUNT_ROWS_RICERCA_DOCUMENTI_UNION</name>
    <value>
      SELECT COUNT(*)
      FROM
      (
      SELECT distinct top @rowCount@
      A.SYSTEM_ID
      FROM    PROFILE a
      @from@
      WHERE @security@
      @filters@
      UNION
      SELECT distinct top @rowCount@
      A.SYSTEM_ID
      FROM    PROFILE a
      @from_cons@
      WHERE @security@
      @filters_cons@
      @unionStampe@
      ) AS A
    </value>
  </query>
  <query>
    <name>S_RIC_DOC_UNION</name>
    <value>
      SELECT TOP @pageSize@ * FROM (
      SELECT TOP @pageSize@ * FROM (
      (
      SELECT TOP @totalRows@
      A.SYSTEM_ID, A.DOCNUMBER, A.DTA_ANNULLA, A.VAR_PROF_OGGETTO AS VAR_DESC_OGGETTO,
      A.ID_REGISTRO, A.CHA_TIPO_PROTO, A.CHA_EVIDENZA, A.NUM_ANNO_PROTO,
      ISNULL(A.DTA_PROTO,A.CREATION_TIME) AS DATA,
      convert(nvarchar (10), A.CREATION_TIME, 103) AS CREATION_DATE,
      A.NUM_PROTO, A.VAR_SEGNATURA, convert(nvarchar (10), A.DTA_PROTO, 103) AS DTA_PROTO,
      docsadm.getchaimg(A.DOCNUMBER) AS CHA_IMG , A.CHA_PRIVATO, A.CHA_PERSONALE, @dbuser@.getInADL(A.SYSTEM_ID,'D',@idGruppo@,@idPeople@) AS IN_ADL,
      A.ID_DOCUMENTO_PRINCIPALE, a.id_tipo_atto as ID_TIPO_ATTO, ta.var_desc_atto as DESC_TIPO_ATTO, @dbuser@.getPeopleUserId (a.AUTHOR) as AUTHOR,
      docsadm.getchafirmato(A.DOCNUMBER) as CHA_FIRMATO,
      docsadm.getchatipofirma(A.DOCNUMBER) as CHA_TIPO_FIRMA
      FROM PROFILE a WITH(NOLOCK)
      LEFT JOIN dpa_tipo_atto ta on a.id_tipo_atto = ta.system_id
      @from@
      WHERE
      @security@
      @filters@
      ORDER BY  @order@
      UNION
      SELECT TOP @totalRows@
      A.SYSTEM_ID, A.DOCNUMBER, A.DTA_ANNULLA, A.VAR_PROF_OGGETTO AS VAR_DESC_OGGETTO,
      A.ID_REGISTRO, A.CHA_TIPO_PROTO, A.CHA_EVIDENZA, A.NUM_ANNO_PROTO,
      ISNULL(A.DTA_PROTO,A.CREATION_TIME) AS DATA,
      convert(nvarchar (10), A.CREATION_TIME, 103) AS CREATION_DATE,
      A.NUM_PROTO, A.VAR_SEGNATURA, convert(nvarchar (10), A.DTA_PROTO, 103) AS DTA_PROTO,
      docsadm.getchaimg(A.DOCNUMBER) AS CHA_IMG , A.CHA_PRIVATO, A.CHA_PERSONALE, @dbuser@.getInADL(A.SYSTEM_ID,'D',@idGruppo@,@idPeople@) AS IN_ADL,
      A.ID_DOCUMENTO_PRINCIPALE, a.id_tipo_atto as ID_TIPO_ATTO, ta.var_desc_atto as DESC_TIPO_ATTO, @dbuser@.getPeopleUserId (a.AUTHOR) as AUTHOR,
      docsadm.getchafirmato(A.DOCNUMBER) as CHA_FIRMATO,
      docsadm.getchatipofirma(A.DOCNUMBER) as CHA_TIPO_FIRMA
      FROM PROFILE a WITH(NOLOCK)
      LEFT JOIN dpa_tipo_atto ta on a.id_tipo_atto = ta.system_id
      @from_cons@
      WHERE
      @security@
      @filters_cons@
      ORDER BY  @order@
      @unionStampe@
      )
      ) AS A ORDER BY  @reverseOrder@
      ) AS A ORDER BY  @order@
    </value>
  </query>
  <query>
    <name>S_RIC_DOC_VELOCE_UNION</name>
    <value>
      SELECT TOP @pageSize@ * FROM (
      SELECT TOP @pageSize@ * FROM (
      SELECT TOP @totalRows@
      A.SYSTEM_ID, A.DOCNUMBER, A.DTA_ANNULLA, A.VAR_PROF_OGGETTO AS VAR_DESC_OGGETTO, A.ID_REGISTRO,
      A.CHA_TIPO_PROTO, A.CHA_EVIDENZA, A.NUM_ANNO_PROTO, ISNULL(A.DTA_PROTO,A.CREATION_TIME) AS DATA,
      convert(nvarchar (10), A.CREATION_TIME, 103) AS CREATION_DATE,
      A.NUM_PROTO, A.VAR_SEGNATURA, convert(nvarchar (10), A.DTA_PROTO, 103) AS DTA_PROTO,
      docsadm.getchaimg(A.DOCNUMBER) AS CHA_IMG , A.CHA_PRIVATO, A.CHA_PERSONALE, @dbuser@.getInADL(A.SYSTEM_ID,'D',@idGruppo@,@idPeople@) AS IN_ADL,
      A.ID_DOCUMENTO_PRINCIPALE, a.id_tipo_atto as ID_TIPO_ATTO, ta.var_desc_atto as DESC_TIPO_ATTO, @dbuser@.getPeopleUserId (a.AUTHOR) as AUTHOR,
      docsadm.getchafirmato(A.DOCNUMBER) as CHA_FIRMATO,
      docsadm.getchatipofirma(A.DOCNUMBER) as CHA_TIPO_FIRMA
      FROM PROFILE a WITH(NOLOCK)
      LEFT JOIN dpa_tipo_atto ta on a.id_tipo_atto = ta.system_id
      WHERE @security@
      @filters@
      isnull(dta_proto,creation_date) between    convert(datetime,'@dataInizioAnno@',103) and getdate()
      ORDER BY @order@
      UNION
      SELECT TOP @totalRows@
      A.SYSTEM_ID, A.DOCNUMBER, A.DTA_ANNULLA, A.VAR_PROF_OGGETTO AS VAR_DESC_OGGETTO, A.ID_REGISTRO,
      A.CHA_TIPO_PROTO, A.CHA_EVIDENZA, A.NUM_ANNO_PROTO, ISNULL(A.DTA_PROTO,A.CREATION_TIME) AS DATA,
      convert(nvarchar (10), A.CREATION_TIME, 103) AS CREATION_DATE,
      A.NUM_PROTO, A.VAR_SEGNATURA, convert(nvarchar (10), A.DTA_PROTO, 103) AS DTA_PROTO,
      docsadm.getchaimg(A.DOCNUMBER) AS CHA_IMG , A.CHA_PRIVATO, A.CHA_PERSONALE, @dbuser@.getInADL(A.SYSTEM_ID,'D',@idGruppo@,@idPeople@) AS IN_ADL,
      A.ID_DOCUMENTO_PRINCIPALE, a.id_tipo_atto as ID_TIPO_ATTO, ta.var_desc_atto as DESC_TIPO_ATTO, @dbuser@.getPeopleUserId (a.AUTHOR) as AUTHOR,
      docsadm.getchafirmato(A.DOCNUMBER) as CHA_FIRMATO,
      docsadm.getchatipofirma(A.DOCNUMBER) as CHA_TIPO_FIRMA
      FROM PROFILE a WITH(NOLOCK)
      LEFT JOIN dpa_tipo_atto ta on a.id_tipo_atto = ta.system_id
      @from_cons@
      WHERE @security@
      @filters_cons@
      isnull(dta_proto,creation_date) between    convert(datetime,'@dataInizioAnno@',103) and getdate()
      ORDER BY @order@
      @unionStampe@
      ) AS A ORDER BY @reverseOrder@
      ) AS A ORDER BY @order@
    </value>
  </query>
  <query>
    <name>S_MAX_PESO_UO_ORG</name>
    <value>
      select max(id_peso_org) as maggiore
      from dpa_corr_globali
      where id_parent = @idParent@ and
      cha_tipo_urp = 'U' and
      cha_tipo_ie = 'I' and
      dta_fine is null
    </value>
  </query>
  <query>
    <name>S_MAX_PESO_RUOLO_ORG</name>
    <value>
      select max(id_peso_org) as maggiore
      from dpa_corr_globali
      where id_uo = @idUO@ and
      cha_tipo_urp = 'R' and
      cha_tipo_ie = 'I' and
      dta_fine is null
    </value>
  </query>
  <query>
    <name>TIPO_PROTO_RISPOSTA</name>
    <value>
      SELECT CHA_TIPO_PROTO FROM PROFILE WITH(NOLOCK) WHERE CHA_TIPO_PROTO &lt;&gt; 'G'
      AND (ID_PARENT IS NOT NULL OR ID_PARENT &lt;&gt; 0 )
      AND ID_PARENT = @param1@
      GROUP BY ID_PARENT,CHA_TIPO_PROTO
    </value>
  </query>
  <query>
    <name>S_RICERCA_ALL_CORRISPONDENTI1</name>
    <value>
      SELECT
      a.system_id, a.id_amm, r.var_codice, a.var_cod_rubrica,
      a.var_codice_amm, a.var_codice_aoo, a.cha_tipo_urp, a.var_desc_corr, a.var_cognome, a.var_nome,
      b.var_indirizzo, b.var_cap, b.var_citta, b.var_provincia,b.var_localita,
      b.var_nazione, b.var_telefono, b.var_telefono2,
      b.var_fax, id_old, a.var_email,b.VAR_NOTE, b.var_cod_fisc, b.var_cod_pi
      FROM dpa_corr_globali a
      left OUTER JOIN dpa_dett_globali b ON a.system_id = b.id_corr_globali
      LEFT OUTER JOIN	dpa_el_registri r on a.id_registro = r.system_id
      WHERE
      a.cha_tipo_corr not in ('O','C')
      AND a.cha_tipo_ie = 'E'
      AND a.id_old = 0
      AND a.dta_fine is null
      AND a.id_amm = @idamm@
      AND a.var_cod_rubrica not like 'INTEROP_%'
      @registri@
      ORDER BY a.var_desc_corr
    </value>
  </query>
  <query>
    <name>S_RICERCA_ALL_CORRISPONDENTI</name>
    <value>
      SELECT
      a.system_id, a.id_amm, r.var_codice, a.var_cod_rubrica,
      a.var_codice_amm, a.var_codice_aoo, a.cha_tipo_urp, a.var_desc_corr, a.var_cognome, a.var_nome,
      b.var_indirizzo, b.var_cap, b.var_citta, b.var_provincia,b.var_localita,
      b.var_nazione, b.var_cod_fisc, b.var_telefono, b.var_telefono2,
      b.var_fax, id_old, a.var_email, b.VAR_NOTE, b.var_cod_pi, Dt.description
      FROM dpa_corr_globali a
      left OUTER JOIN dpa_dett_globali b ON a.system_id = b.id_corr_globali
      LEFT OUTER JOIN	dpa_el_registri r on a.id_registro = r.system_id
      , Documenttypes Dt, dpa_T_Canale_Corr Tcc
      WHERE
      a.cha_tipo_corr not in ('O','C')
      AND Tcc.id_corr_globale = a.system_id and Dt.system_id = Tcc.id_documenttype
      AND a.cha_tipo_ie = 'E'
      AND a.id_old = 0
      AND a.dta_fine is null
      AND a.id_amm = @idamm@
      AND a.var_cod_rubrica not like 'INTEROP_%'
      @registri@
      ORDER BY a.var_desc_corr
    </value>
  </query>
  <query>
    <name>S_CONTA_MOD_RAG_CESSIONE</name>
    <value>
      select count(*) as tot
      from dpa_modelli_trasm m, dpa_modelli_mitt_dest md
      where
      md.ID_RAGIONE = @idRagione@
      and
      m.cha_cede_diritti = '1'
      and
      m.system_id = md.id_modello
    </value>
  </query>
  <query>
    <name>AMM_U_UPDATE_RF</name>
    <value>
      update DPA_EL_REGISTRI
      set CHA_DISABILITATO = '1'
      where ID_AOO_COLLEGATA = @param1@
      and CHA_RF = '1'
    </value>
  </query>
  <query>
    <name>S_DPA_THEMES</name>
    <value>
      select SYSTEM_ID, THEME
      from DPA_THEMES
    </value>
  </query>
  <query>
    <name>D_CLEAR_NOTE</name>
    <value>
      DELETE
      FROM DPA_NOTE N
      WHERE N.IDOGGETTOASSOCIATO = @idOggetto@ AND
      N.TIPOOGGETTOASSOCIATO = '@tipoOggetto@'
    </value>
  </query>
  <query>
    <name>S_CONTA_TRASM_CON_WF_IN_TDL_PER_RUOLO</name>
    <value>
      select count(*) as tot_trasm
      from dpa_todolist tdl, dpa_ragione_trasm rt, dpa_trasm_singola ts
      where tdl.@campoOggetto@ = @IDOggetto@
      and tdl.id_ruolo_dest = @IDGruppo@
      and rt.CHA_TIPO_RAGIONE = 'W'
      and ts.ID_RAGIONE = rt.SYSTEM_ID
      and tdl.ID_TRASM_SINGOLA = ts.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>DS_GET_ID_MODELLO_TIPOFASC_DS</name>
    <value>
      SELECT * FROM DPA_ASS_DIAGRAMMI
      WHERE ID_TIPO_FASC = @idTipoFasc@
      AND
      ID_DIAGRAMMA = @idDiagramma@
      AND
      ID_STATO = @idStato@
    </value>
  </query>
  <query>
    <name>DS_DISASSOCIA_TIPO_FASC_DIAGRAMMA_2</name>
    <value>
      DELETE FROM DPA_ASS_DIAGRAMMI
      WHERE
      ID_STATO IS NULL
      AND
      ID_MOD_TRASM IS NOT NULL
      AND
      ID_DIAGRAMMA = @idDiagramma@
      AND
      ID_TIPO_FASC = @idTipoFasc@
    </value>
  </query>
  <query>
    <name>DS_INS_ASSOCIA_TIPO_FASC_DIAGRAMMA_1</name>
    <value>
      INSERT INTO DPA_ASS_DIAGRAMMI
      (
      @colID@
      ID_TIPO_FASC,
      ID_MOD_TRASM
      )
      VALUES
      (
      @id@
      @idTipoFasc@,
      @idTemplate@
      )
    </value>
  </query>
  <query>
    <name>DS_INS_ASSOCIA_TIPO_FASC_DIAGRAMMA_2</name>
    <value>
      INSERT INTO DPA_ASS_DIAGRAMMI
      (
      @colID@
      ID_TIPO_FASC,
      ID_DIAGRAMMA,
      ID_MOD_TRASM
      )
      VALUES
      (
      @id@
      @idTipoFasc@,
      @idDiagramma@,
      @idTemplate@
      )
    </value>
  </query>
  <query>
    <name>PD_UPDATE_SCADENZE_FASC</name>
    <value>
      UPDATE DPA_TIPO_FASC
      SET GG_SCADENZA = @scadenza@,
      GG_PRE_SCADENZA = @preScadenza@
      WHERE
      SYSTEM_ID = @idTemplate@
    </value>
  </query>
  <query>
    <name>DS_ASSOCIA_TIPO_FASC_DIAGRAMMA</name>
    <value>
      SELECT * FROM DPA_ASS_DIAGRAMMI
      WHERE ID_TIPO_FASC = @idTipoFasc@
      AND
      ID_DIAGRAMMA = @idDiagramma@
      AND
      ID_MOD_TRASM IS NULL AND ID_STATO IS NULL
    </value>
  </query>
  <query>
    <name>DS_INS_ASSOCIA_TIPO_FASC_DIAGRAMMA</name>
    <value>
      INSERT INTO DPA_ASS_DIAGRAMMI
      (
      @colID@
      ID_TIPO_FASC,
      ID_DIAGRAMMA
      )
      VALUES
      (
      @id@
      @idTipoFasc@,
      @idDiagramma@
      )
    </value>
  </query>
  <query>
    <name>DS_DISASSOCIA_TIPO_FASC_DIAGRAMMA</name>
    <value>
      DELETE FROM DPA_ASS_DIAGRAMMI
      WHERE ID_TIPO_FASC = @idTipoFasc@
    </value>
  </query>
  <query>
    <name>DS_GET_BY_ID_TIPO_FASC</name>
    <value>
      SELECT DPA_ASS_DIAGRAMMI.ID_DIAGRAMMA
      FROM DPA_TIPO_FASC, DPA_ASS_DIAGRAMMI
      WHERE
      DPA_TIPO_FASC.SYSTEM_ID = @id_tipo_fasc@
      AND
      DPA_TIPO_FASC.SYSTEM_ID = DPA_ASS_DIAGRAMMI.ID_TIPO_FASC
      AND
      DPA_TIPO_FASC.ID_AMM = @id_amm@ AND ID_DIAGRAMMA IS NOT NULL
    </value>
  </query>
  <query>
    <name>DS_UPDATE_DPA_DIAGRAMMI_FASC</name>
    <value>
      UPDATE DPA_DIAGRAMMI
      SET ID_STATO = @idStato@
      WHERE
      ID_PROJECT = @idProject@
    </value>
  </query>
  <query>
    <name>DS_INS_DPA_DIAGRAMMI_FASC</name>
    <value>
      INSERT INTO DPA_DIAGRAMMI
      (
      @colID@
      Id_Project,
      Id_stato,
      Id_diagramma
      )
      VALUES
      (
      @id@
      @idProject@,
      @idStato@,
      @idDiagramma@
      )
    </value>
  </query>
  <query>
    <name>DS_GET_ID_TRASM_DIAGR_FASC</name>
    <value>
      SELECT ID_TRASM FROM DPA_TRASM_DIAGR WHERE ID_PROJECT = @idProject@ AND ID_STATO = @idStato@
    </value>
  </query>
  <query>
    <name>DS_INS_TRASM_STORICO_FASC</name>
    <value>
      INSERT INTO DPA_TRASM_DIAGR
      (
      @colID@
      ID_TRASM,
      ID_PROJECT,
      ID_STATO
      )
      VALUES
      (
      @id@
      @idTrasm@,
      @idProject@,
      @idStato@
      )
    </value>
  </query>
  <query>
    <name>TRASM_SCADENZE_MITT_FASC</name>
    <value>
      SELECT distinct(personorgroup),thing,project.system_id as P_SYSTEM_ID,project.system_id as idproject
      FROM
      project,
      dpa_tipo_fasc,
      security  WITH (nolock) ,
      people
      WHERE
      project.id_tipo_fasc = dpa_tipo_fasc.system_id
      AND
      project.dta_scadenza = @param1@
      AND
      project.system_id = security.thing
      AND
      security.accessrights=255
      AND
      project.system_id = @idProject@
      AND
      security.cha_tipo_diritto &lt;&gt; 'A'
    </value>
  </query>

  <query>
    <name>S_IS_NOTE_DOCUMENTO_SOLA_LETTURA</name>
    <value>
      SELECT @dbUser@.getAccessRightsProject(@idRuoloCreatore@, @idUtenteCreatore@, @idRuoloPubblico@, @idOggetto@) AS ACCESS_RIGHTS,
      p.cha_in_cestino AS IN_CESTINO
      FROM PROFILE p WITH(NOLOCK)
      WHERE   p.system_id = @idOggetto@
    </value>
  </query>
  <query>
    <name>INS_DOC_IN_CONVERSIONE_PDF</name>
    <value>
      INSERT INTO DPA_CONV_PDF_SERVER
      (
      @colID@
      ID_PROFILE,
      DTA_CONVERSIONE
      )
      VALUES
      (
      @id@
      @idProfile@,
      @dtaConversione@
      )
    </value>
  </query>
  <query>
    <name>S_GET_COUNT_ROWS_RICERCA_DOCUMENTI_VELOCE_UNION</name>
    <value>
      SELECT COUNT(SYSTEM_ID)
      FROM
      (
      SELECT distinct TOP @rowCount@
      A.SYSTEM_ID
      FROM    PROFILE a
      WHERE @security@
      @filters@
      ORDER BY A.SYSTEM_ID DESC
      UNION
      SELECT distinct TOP @rowCount@
      A.SYSTEM_ID
      FROM    PROFILE a @from_cons@
      WHERE @security@
      @filters_cons@
      and isnull(dta_proto,creation_date) between    convert(datetime,'@dataInizioAnno@',103) and getdate()
      ORDER BY A.SYSTEM_ID DESC
      ) AS A
    </value>
  </query>
  <query>
    <name>PROFILE_RIMUOVI_CATENA</name>
    <value>
      UPDATE PROFILE
      SET ID_PARENT = NULL WHERE ID_PARENT = @param1@
    </value>
  </query>
  <query>
    <name>S_MittDestIndirizzo</name>
    <value>
      SELECT corrcat_address(@systemID@,'@tipo@') as MITT_DEST
      from profile WITH(NOLOCK) where system_id = @systemID@
    </value>
  </query>
  <!--Laura modificata la query seguente. Proobabilmente non ha mai funzionato, aveva errori di sintassi-->
  <query>
    <name>S_COUNT_FASCICOLI_PAGING_UNION</name>
    <value>
      SELECT count(*) from (
      Select a.system_id as c
      FROM project a
      @tblCL1@
      WHERE @security@
      AND (a.id_amm IS NULL OR a.id_amm = @idAmm@ )
      AND a.cha_tipo_proj = 'F'
      @idReg@
      @whereTlbCL1@
      @guiFilters@
      UNION
      Select a.system_id as c
      FROM project a
      @tblCL1@
      WHERE @security@
      AND (a.id_amm IS NULL OR a.id_amm = @idAmm@ )
      AND a.cha_tipo_proj = 'F'
      @idReg@
      @whereTlbCL1@
      @guiFilters1@
      ) as a
    </value>
  </query>
  <!--Laura modificata la query seguente. Proobabilmente non ha mai funzionato, aveva errori di sintassi, campi diversi estratti dalle due query in union-->
  <query>
    <name>S_FASCICOLI_PAGING_UNION</name>
    <value>
      SELECT Row,
      system_id, description, cha_tipo_proj, var_codice,
      id_amm, num_livello,cha_tipo_fascicolo, id_fascicolo,
      id_parent,var_cod_ultimo,var_note, dta_apertura,
      dta_chiusura,cha_stato, id_tipo_proc, id_registro,
      id_uo_lf,DTA_UO_LF,
      dta_creazione, cartaceo,cha_privato,ID_UO_REF,
      DTA_SCADENZA,
      CHA_IN_ARCHIVIO,AUTHOR,
      ID_RUOLO_CREATORE, ID_UO_CREATORE, cha_controllato, cha_consenti_class, a.CHA_CONSENTI_FASC,
      ID_RUOLO_CHIUSURA, ID_UO_CHIUSURA, ID_AUTHOR_CHIUSURA,
      DTA_APERTURA_ORDER,DTA_CHIUSURA_ORDER, id_titolario,
      num_fasc, NUM_MESI_CONSERVAZIONE,
      desc_tipo_atto,
      ID_TIPO_FASC, COD_EXT_APP,
      @dbuser@.getinadl (system_id, 'F', @idGruppo@, @idPeople@) AS in_adl,
      @dbuser@.getinadl (system_id, 'F', @idGruppo@, '0') AS in_adlrole,
      @dbuser@.getaccessrightsProject (@idGruppo@, @idPeople@, @idRuoloPubblico@, system_id) AS accessrights,
      @dbuser@.getcodtit (id_parent) AS codtit,
      @dbuser@.getinconservazione (NULL,system_id, 'F', @idPeople@, @idGruppo@) AS in_conservazione,
      @dbuser@.getcodreg(id_registro) as AOO,
      @dbuser@.gettestoultimanota ('F',system_id, @idGruppo@,@idPeople@,@idGruppo@) as ultima_nota,
      @dbuser@.getdiagrammistato (system_id, 'F') AS stato,
      @dbuser@.getDescTitolario(id_titolario) as cod_titolario,
      @dbuser@.getpeoplename (author) as desc_autore,
      @dbuser@.getdesccorr(id_ruolo_creatore) as desc_ruolo,
      @dbuser@.getdesccorr(id_uo_creatore) as desc_uo,
      @dbuser@.getdesccorr(id_uo_lf) as desc_coll,
      @dbuser@.esisteNotaVisibile('F',system_id,@idGruppo@,@idPeople@,@idGruppo@) AS esiste_nota,
      cha_cod_t_a
      @contatore@
      @valoriCustom@
      FROM
      (SELECT * from (SELECT  ROW_NUMBER() OVER (ORDER BY @order@)
      AS Row,
      a.system_id, a.description, a.cha_tipo_proj, a.var_codice,
      a.id_amm, a.num_livello,a.cha_tipo_fascicolo, a.id_fascicolo,
      a.id_parent,a.var_cod_ultimo,a.var_note, @dtaAp@ AS dta_apertura,
      @dtaCh@ AS dta_chiusura,a.cha_stato, a.id_tipo_proc, a.id_registro ,
      a.id_uo_lf,A.DTA_UO_LF,
      a.dta_creazione, a.cartaceo,a.cha_privato,a.ID_UO_REF,
      convert(nvarchar (10), a.dta_scadenza, 103) AS DTA_SCADENZA,
      a.CHA_IN_ARCHIVIO,a.AUTHOR,
      a.ID_RUOLO_CREATORE, a.ID_UO_CREATORE, a.cha_controllato, a.cha_consenti_class, a.CHA_CONSENTI_FASC,
      a.ID_RUOLO_CHIUSURA, a.ID_UO_CHIUSURA, a.ID_AUTHOR_CHIUSURA,
      a.DTA_APERTURA AS DTA_APERTURA_ORDER,
      a.DTA_CHIUSURA AS DTA_CHIUSURA_ORDER, a.id_titolario,
      a.num_fascicolo as num_fasc, a.NUM_MESI_CONSERVAZIONE,
      ta.var_desc_fasc AS desc_tipo_atto,
      a.ID_TIPO_FASC, a.COD_EXT_APP,
      a.cha_cod_t_a
      FROM project a LEFT JOIN dpa_tipo_fasc ta on a.ID_TIPO_FASC = ta.system_id
      @tblCL1@
      WHERE
      @security@
      AND (a.id_amm IS NULL OR a.id_amm = @idAmm@)
      AND a.cha_tipo_proj = 'F'
      @listDocuments@
      @idReg@
      @whereTlbCL1@
      @guiFilters@
      )a
      @paging@
      UNION
      select * from
      (SELECT  ROW_NUMBER() OVER (ORDER BY @order@)
      AS Row,
      a.system_id, a.description, a.cha_tipo_proj, a.var_codice,
      a.id_amm, a.num_livello,a.cha_tipo_fascicolo, a.id_fascicolo,
      a.id_parent,a.var_cod_ultimo,a.var_note, @dtaAp@ AS dta_apertura,
      @dtaCh@ AS dta_chiusura,a.cha_stato, a.id_tipo_proc, a.id_registro ,
      a.id_uo_lf,A.DTA_UO_LF,
      a.dta_creazione, a.cartaceo,a.cha_privato,a.ID_UO_REF,
      convert(nvarchar (10), a.dta_scadenza, 103) AS DTA_SCADENZA,
      a.CHA_IN_ARCHIVIO,a.AUTHOR,
      a.ID_RUOLO_CREATORE, a.ID_UO_CREATORE, a.cha_controllato, a.cha_consenti_class, a.CHA_CONSENTI_FASC,
      a.ID_RUOLO_CHIUSURA, a.ID_UO_CHIUSURA, a.ID_AUTHOR_CHIUSURA,
      a.DTA_APERTURA AS DTA_APERTURA_ORDER,
      a.DTA_CHIUSURA AS DTA_CHIUSURA_ORDER, a.id_titolario,
      a.num_fascicolo as num_fasc, a.NUM_MESI_CONSERVAZIONE,
      ta.var_desc_fasc AS desc_tipo_atto,
      a.ID_TIPO_FASC, a.COD_EXT_APP,
      a.cha_cod_t_a
      FROM project a LEFT JOIN dpa_tipo_fasc ta on a.ID_TIPO_FASC = ta.system_id
      @tblCL1@
      WHERE
      @security@
      AND (a.id_amm IS NULL OR a.id_amm = @idAmm@)
      AND a.cha_tipo_proj = 'F'
      @listDocuments@
      @idReg@
      @whereTlbCL1@
      @guiFilters1@
      )a ) v
      @paging@
    </value>
  </query>
  <query>
    <name>DS_GET_TRASM_DIAGR_AR_2</name>
    <value>
      SELECT *
      FROM
      DPA_TRASMISSIONE,
      DPA_TRASM_SINGOLA,
      DPA_TRASM_UTENTE,
      DPA_RAGIONE_TRASM
      WHERE
      DPA_TRASM_SINGOLA.ID_RAGIONE = DPA_RAGIONE_TRASM.SYSTEM_ID
      AND
      DPA_TRASMISSIONE.system_id = DPA_TRASM_SINGOLA.ID_TRASMISSIONE
      AND
      DPA_TRASM_SINGOLA.system_id = DPA_TRASM_UTENTE.ID_TRASM_SINGOLA
      AND
      DPA_RAGIONE_TRASM.CHA_TIPO_RAGIONE = 'W'
      AND
      DPA_TRASMISSIONE.SYSTEM_ID = @idTrasmissione@
      AND CHA_RIFIUTATA = '1'
    </value>
  </query>
  <query>
    <name>S_GET_LDAP_CONFIG</name>
    <value>
      SELECT  SERVER_NAME,
      GROUP_DN,
      USER_NAME,
      USERID_ATTRIBUTE,
      EMAIL_ATTRIBUTE,
      MATRICOLA_ATTRIBUTE,
      NOME_ATTRIBUTE,
      COGNOME_ATTRIBUTE,
      SEDE_ATTRIBUTE
      FROM    DPA_LDAP_CONFIG
      WHERE   ID_AMM = @idAmm@
    </value>
  </query>
  <query>
    <name>I_INSERT_LDAP_CONFIG</name>
    <value>
      INSERT INTO DPA_LDAP_CONFIG
      (
      ID_AMM,
      SERVER_NAME,
      GROUP_DN,
      USERID_ATTRIBUTE,
      EMAIL_ATTRIBUTE,
      MATRICOLA_ATTRIBUTE,
      NOME_ATTRIBUTE,
      COGNOME_ATTRIBUTE,
      SEDE_ATTRIBUTE
      )
      VALUES
      (
      @idAmm@,
      '@serverName@',
      '@groupDN@',
      '@userId@',
      '@email@',
      '@matricola@',
      '@nome@',
      '@cognome@',
      '@sede@'
      )
    </value>
  </query>
  <query>
    <name>U_UPDATE_LDAP_CONFIG</name>
    <value>
      UPDATE  DPA_LDAP_CONFIG
      SET     SERVER_NAME = '@serverName@',
      GROUP_DN = '@groupDN@',
      USERID_ATTRIBUTE = '@userId@',
      EMAIL_ATTRIBUTE = '@email@',
      MATRICOLA_ATTRIBUTE = '@matricola@',
      NOME_ATTRIBUTE = '@nome@',
      COGNOME_ATTRIBUTE = '@cognome@',
      SEDE_ATTRIBUTE = '@sede@'
      WHERE   ID_AMM = @idAmm@
    </value>
  </query>
  <query>
    <name>S_CONTAINS_LDAP_CONFIG</name>
    <value>
      SELECT  COUNT(*)
      FROM    DPA_LDAP_CONFIG
      WHERE   ID_AMM = @idAmm@
    </value>
  </query>
  <query>
    <name>U_SET_LDAP_CONFIG_DOMAIN_CREDENTIALS</name>
    <value>
      UPDATE DPA_LDAP_CONFIG
      SET USER_NAME = '@userName@',
      PASSWORD = '@encryptedPassword@'
      WHERE   ID_AMM = @idAmm@
    </value>
  </query>
  <query>
    <name>S_GET_LDAP_CONFIG_DOMAIN_USER_PASSWORD</name>
    <value>
      SELECT PASSWORD
      FROM DPA_LDAP_CONFIG
      WHERE ID_AMM = @idAmm@
    </value>
  </query>
  <query>
    <name>S_GET_LDAP_SYNC_HISTORY</name>
    <value>
      SELECT SYSTEM_ID,
      USER_ID,
      SYNC_DATE,
      ITEMS_SYNCRONIZED,
      ERROR_DETAILS
      FROM   DPA_LDAP_SYNC_HISTORY
      WHERE  ID_AMM = @idAmm@
      ORDER BY SYNC_DATE DESC
    </value>
  </query>
  <query>
    <name>D_DELETE_LDAP_SYNC_HISTORY_ITEM</name>
    <value>
      DELETE FROM DPA_LDAP_SYNC_HISTORY WHERE SYSTEM_ID = @id@
    </value>
  </query>
  <query>
    <name>I_INSERT_LDAP_SYNC_HISTORY_ITEM</name>
    <value>
      INSERT INTO DPA_LDAP_SYNC_HISTORY
      (
      @colId@
      ID_AMM,
      USER_ID,
      SYNC_DATE,
      ITEMS_SYNCRONIZED,
      ERROR_DETAILS
      )
      VALUES
      (
      @idValue@
      @idAmm@,
      '@userId@',
      @syncDate@,
      @itemsSync@,
      '@errorDetails@'
      )
    </value>
  </query>
  <query>
    <name>U_DPA_TRASM_UTENTE_SOSTIT2</name>
    <value>
      UPDATE DPA_TODOLIST
      SET ID_PEOPLE_DEST = @param1@
      WHERE ID_TRASM_UTENTE IN
      (
      SELECT C.SYSTEM_ID
      FROM DPA_TRASMISSIONE A, DPA_TRASM_SINGOLA B, DPA_TRASM_UTENTE C, DPA_RAGIONE_TRASM D
      WHERE A.SYSTEM_ID = B.ID_TRASMISSIONE
      AND B.SYSTEM_ID = C.ID_TRASM_SINGOLA
      AND C.CHA_VALIDA = '1'
      AND A.DTA_INVIO IS NOT NULL
      AND B.ID_CORR_GLOBALE = @param2@
      AND (A.CHA_TIPO_OGGETTO = 'D' OR A.CHA_TIPO_OGGETTO = 'F')
      AND B.ID_RAGIONE = D.SYSTEM_ID
      AND ((D.CHA_TIPO_RAGIONE = 'W' AND C.CHA_ACCETTATA='0' AND C.CHA_RIFIUTATA = '0' AND C.CHA_VALIDA = '1') OR ((D.CHA_TIPO_RAGIONE = 'N' OR D.CHA_TIPO_RAGIONE = 'I') AND C.CHA_VISTA = '0'))
      )
    </value>
  </query>
  <query>
    <name>PD_GET_TEMPLATES_ARCHIVIO_DEPOSITO</name>
    <value>
      select
      distinct(dpa_tipo_atto.system_id),
      dpa_tipo_atto.VAR_DESC_ATTO,
      dpa_tipo_atto.Abilitato_SI_NO,
      dpa_tipo_atto.In_Esercizio,
      dpa_tipo_atto.Path_Mod_1,
      dpa_tipo_atto.Path_Mod_2,
      dpa_tipo_atto.Path_Mod_SU,
      dpa_tipo_atto.Path_All_1,
      dpa_tipo_atto.GG_SCADENZA,
      dpa_tipo_atto.GG_PRE_SCADENZA,
      dpa_tipo_atto.CHA_PRIVATO
      from
      dpa_tipo_atto, dpa_associazione_templates, dpa_oggetti_custom, dpa_tipo_oggetto
      where
      dpa_tipo_atto.system_id = dpa_associazione_templates.id_template
      and
      dpa_associazione_templates.id_oggetto = dpa_oggetti_custom.system_id
      and
      dpa_oggetti_custom.id_tipo_oggetto = dpa_tipo_oggetto.system_id
      and
      dpa_tipo_oggetto.DESCRIZIONE like '%CONTATORE%'
      and
      --    dpa_oggetti_custom.FORMATO_CONTATORE like '%ANNO%'
      --   and
      dpa_tipo_atto.id_amm = @idAmm@
      @seRepertorio@
    </value>
  </query>
  <query>
    <name>S_PROJECT_TRASFERIMENTO_DEPOSITO</name>
    <value>
      SELECT /*+ index (B INDX_SEC5) NO_INDEX (A INDX_PROJ18)*/
      DISTINCT
      SYSTEM_ID, DESCRIPTION, CHA_TIPO_PROJ,
      VAR_CODICE, ID_AMM, NUM_LIVELLO, CHA_TIPO_FASCICOLO,
      ID_FASCICOLO, ID_PARENT, VAR_COD_ULTIMO,
      VAR_NOTE,@param1@ AS DTA_APERTURA,
      @param2@ AS DTA_CHIUSURA,CHA_STATO, ID_TIPO_PROC, ID_REGISTRO, @dbuser@.getcodreg(ID_REGISTRO) as CODREG,
      ID_UO_LF, DTA_UO_LF,
      DTA_CREAZIONE,
      CARTACEO, CHA_PRIVATO, ID_TITOLARIO, convert(nvarchar (10),dta_scadenza, 103) AS DTA_SCADENZA
      FROM PROJECT
      WHERE (ID_AMM IS NULL OR ID_AMM = @param3@ )
      AND CHA_TIPO_PROJ = 'F'
      and cha_stato='@stato@' and CHA_TIPO_FASCICOLO='@tipofasc@'
      and (CHA_IN_ARCHIVIO &lt;&gt; '1')
    </value>
  </query>
  <query>
    <name>S_COUNT_FASCICOLI__TRASFERIMENTO_DEPOSITO</name>
    <value>
      SELECT count (*)
      FROM project a @tblCL1@
      WHERE (a.id_amm IS NULL OR a.id_amm = @idAmm@ )
      AND a.cha_tipo_proj = 'F'
      and a.cha_in_archivio &lt;&gt; '1'
      and a.cha_tipo_fascicolo = 'G'
      @idReg@
      @whereTlbCL1@
      @guiFilters@
    </value>
  </query>
  <query>
    <name>S_FASCICOLI_TRASFERIMENTO_DEPOSITO</name>
    <value>
      SELECT TOP @pageSize@ *
      FROM
      (
      SELECT TOP @pageSize@ *
      FROM
      (
      SELECT TOP @totalRows@
      a.system_id, a.description, a.cha_tipo_proj, a.var_codice,
      a.id_amm, a.num_livello,a.cha_tipo_fascicolo, a.id_fascicolo,
      a.id_parent,a.var_cod_ultimo,a.var_note, convert(nvarchar (10), a.dta_apertura, 103) AS dta_apertura,
      convert(nvarchar (10), a.dta_chiusura, 103) AS dta_chiusura, a.cha_stato, a.id_tipo_proc, a.id_registro ,
      @dbuser@.getcodreg(a.id_registro) as codReg,a.id_uo_lf,A.DTA_UO_LF,
      a.dta_creazione, a.cartaceo,a.cha_privato,a.ID_UO_REF,
      @dbuser@.getCodtit(a.id_parent) as codTit, convert(nvarchar (10), a.dta_scadenza, 103) AS DTA_SCADENZA,
      @dbuser@.getInConservazione(null, a.system_id,'F', 218, 240) AS IN_CONSERVAZIONE, a.CHA_IN_ARCHIVIO,
      a.AUTHOR, a.ID_RUOLO_CREATORE, a.ID_UO_CREATORE
      FROM project a @tblCL1@
      WHERE
      (a.id_amm IS NULL OR a.id_amm = @idAmm@)
      AND a.cha_tipo_proj = 'F'
      and a.cha_tipo_fascicolo = 'G'
      and a.cha_in_archivio &lt;&gt; '1'
      @idReg@
      @whereTlbCL1@
      @guiFilters@
      order by a.dta_creazione DESC
      ) AS A
      ORDER BY  a.dta_creazione ASC
      ) AS A
      ORDER BY a.dta_creazione DESC
    </value>
  </query>
  <query>
    <name>S_DOC_IN_SERIE_TRASFERIMENTO_DEPOSITO</name>
    <value>
      SELECT
      (SELECT CAST(Valore_Oggetto_Db AS INT) FROM DPA_ASSOCIAZIONE_TEMPLATES
      WHERE ID_OGGETTO = @paramOggetto@
      AND Doc_Number = A.DOCNUMBER) as numSerie,
      A.SYSTEM_ID, A.DOCNUMBER, A.DTA_ANNULLA, A.VAR_PROF_OGGETTO AS VAR_DESC_OGGETTO,
      A.ID_REGISTRO, A.CHA_TIPO_PROTO, A.CHA_EVIDENZA, A.NUM_ANNO_PROTO,
      isnull(A.DTA_PROTO,A.CREATION_TIME) AS DATA,
      convert(nvarchar (10), a.CREATION_DATE, 103) AS CREATION_DATE,
      A.NUM_PROTO, A.VAR_SEGNATURA, convert(nvarchar (10), a.DTA_PROTO, 103) AS DTA_PROTO,
      docsadm.getchaimg(A.DOCNUMBER) AS CHA_IMG , A.CHA_PRIVATO, A.CHA_PERSONALE, --getInADL(A.SYSTEM_ID,'D',@idGruppo@,@idPeople@) AS IN_ADL,
      A.ID_DOCUMENTO_PRINCIPALE,
      (select 	MAX(FC.DATA_ARCHIVIAZIONE)
      from 	DPA_FASCICOLAZIONE_CARTACEA FC
      where 	FC.ID_DOCUMENT = A.SYSTEM_ID) AS DATA_ARCHIVIAZIONE
      FROM PROFILE a WITH(NOLOCK)
      WHERE
      @filters@
      order by numSerie desc
    </value>
  </query>
  <query>
    <name>S_DOCUMENTI_INFASCICOLO_TRASFERIMENTO_DEPOSITO</name>
    <value>
      SELECT  /*+ index (d) index (b) index (a) NO_INDEX(A INDX_PROFILE41) index (e)  */ DISTINCT A.SYSTEM_ID,
      A.DOCNUMBER, A.DOCNAME, A.STATUS, A.DOCSERVER_LOC, A.PATH,
      @param1@ AS CREATION_DATE,
      A.ID_REGISTRO, A.CHA_TIPO_PROTO, A.ID_OGGETTO, A.NUM_PROTO,
      A.NUM_ANNO_PROTO, A.VAR_PROTO_EME, A.DTA_PROTO_EME,
      A.VAR_COGNOME_EME, A.VAR_NOME_EME, A.ID_PARENT, A.DTA_PROTO,
      A.CHA_MOD_OGGETTO, A.CHA_MOD_MITT_DEST, A.CHA_MOD_MITT_INT,
      A.CHA_MOD_DEST_OCC, A.DTA_PROTO_IN, A.VAR_PROTO_IN,
      A.ID_ANNULLATORE, A.DTA_ANNULLA, A.VAR_AUT_ANNULLA,
      A.VAR_SEGNATURA,
      A.CHA_INVIO_CONFERMA,
      A.ID_TIPO_ATTO, A.CHA_PRIVATO, A.CHA_PERSONALE, A.CHA_EVIDENZA, A.VAR_PROF_OGGETTO AS VAR_DESC_OGGETTO, B.PROJECT_ID, B.LINK, B.TYPE,
      D.TYPE_ID, D.DESCRIPTION, docsadm.getchaimg(A.DOCNUMBER) AS CHA_IMG , @dbuser@.getInADL(A.SYSTEM_ID,'D',@param3@,@param4@) AS IN_ADL,
      (CASE
      WHEN a.num_proto IS NULL
      THEN creation_date
      ELSE dta_proto
      END
      ) AS dta_protocollo_new,
      (select 	MAX(FC.DATA_ARCHIVIAZIONE)
      from 	DPA_FASCICOLAZIONE_CARTACEA FC
      where 	FC.ID_DOCUMENT = A.SYSTEM_ID) AS DATA_ARCHIVIAZIONE,
      ID_DOCUMENTO_PRINCIPALE
      FROM PROFILE A WITH(NOLOCK), PROJECT_COMPONENTS B, DOCUMENTTYPES D @param6@
      WHERE B.TYPE = 'D' AND A.DOCUMENTTYPE=D.SYSTEM_ID
      AND A.SYSTEM_ID=B.LINK AND B.PROJECT_ID= @param2@ and
      isnull(CHA_IN_CESTINO,'0')='0'
      and (@dbuser@.checkVisibilitaArchivio('D', A.SYSTEM_ID, @param3@) > 0)
      @anno@
      ORDER BY A.NUM_ANNO_PROTO DESC, A.NUM_PROTO DESC, A.DOCNUMBER DESC
    </value>
  </query>
  <query>
    <name>S_J_PROJECT__FOLDERB_AND_CHILD_DEPOSITO</name>
    <value>
      SELECT DISTINCT A.*
      FROM PROJECT A
      WHERE
      A.ID_FASCICOLO=@param1@ OR A.SYSTEM_ID=@param2@
      ORDER BY ID_PARENT ASC
    </value>
  </query>
  <query>
    <name>S_J_PROJECT_FOLDERByID_DEPOSITO</name>
    <value>
      SELECT DISTINCT A.*
      FROM PROJECT A
      WHERE A.SYSTEM_ID=@param1@
    </value>
  </query>
  <query>
    <name>GET_ALL_FASC_NO_PAGING</name>
    <value>
      SELECT  *
      FROM (SELECT
      a.system_id, a.description, a.cha_tipo_proj, a.var_codice,
      a.id_amm, a.num_livello,a.cha_tipo_fascicolo, a.id_fascicolo,
      a.id_parent,a.var_cod_ultimo,a.var_note,@dtaAp@ AS dta_apertura,
      @dtaCh@ AS dta_chiusura,a.cha_stato, a.id_tipo_proc, a.id_registro ,
      @dbuser@.getcodreg(a.id_registro) as codReg,a.id_uo_lf,A.DTA_UO_LF,
      a.dta_creazione, a.cartaceo,a.cha_privato,a.ID_UO_REF,
      @dbuser@.getAccessRightsProject(@idGrp@,@idPeo@, @idRuoloPubblico@,a.system_id) as accessrights,
      @dbuser@.getCodtit(a.id_parent) as codTit, convert(nvarchar (10), a.dta_scadenza, 103) AS DTA_SCADENZA,
      @dbuser@.getInConservazione(null, a.system_id,'F', @idPeo@, @idGrp@) AS IN_CONSERVAZIONE
      FROM project a @tblCL1@
      WHERE exists
      (select 'x' from security as b  WITH (nolock)  where a.system_id = b.thing
      AND (b.personorgroup = @idPeo@ OR b.personorgroup = @idGrp@)
      AND b.accessrights &gt; 0)
      AND (a.id_amm IS NULL OR a.id_amm = @idAmm@ )
      AND a.cha_tipo_proj = 'F'
      and (@dbuser@.checkVisibilitaArchivio('F', A.SYSTEM_ID, @idGrp@) > 0)
      @idReg@
      @whereTlbCL1@
      @guiFilters@
      order by a.dta_creazione desc )
    </value>
  </query>
  <query>
    <name>TRASF_DEP_FASC_PROC</name>
    <value>
      update project set cha_in_archivio=@valore@
      where system_id = @system_id@
    </value>
  </query>
  <query>
    <name>U_DPA_ITEMS_CONS</name>
    <value>
      UPDATE DPA_ITEMS_CONSERVAZIONE
      SET
      @param1@
      WHERE
      @param2@
    </value>
  </query>
  <query>
    <name>S_DETT_CONS</name>
    <value>
      SELECT DISTINCT
      @param1@
      @param2@
      @param3@
    </value>
  </query>

  <query>
    <name>S_TIPO_SUPPORTO</name>
    <value>
      SELECT @param@ FROM DPA_TIPO_SUPPORTO
    </value>
  </query>

  <query>
    <name>D_DPAItemsConservazione</name>
    <value>
      DELETE FROM DPA_ITEMS_CONSERVAZIONE WHERE
      @param@
    </value>
  </query>
  <query>
    <name>S_DPAItemsConservazione</name>
    <value>
      SELECT DISTINCT DPA_ITEMS_CONSERVAZIONE.SYSTEM_ID FROM DPA_AREA_CONSERVAZIONE, DPA_ITEMS_CONSERVAZIONE WHERE
      DPA_ITEMS_CONSERVAZIONE.ID_CONSERVAZIONE=DPA_AREA_CONSERVAZIONE.SYSTEM_ID AND
      @param@
    </value>
  </query>
  <query>
    <name>U_AREA_CONS</name>
    <value>
      UPDATE DPA_AREA_CONSERVAZIONE
      SET CHA_STATO='I', VAR_TIPO_SUPPORTO=@idTipoSupp@, VAR_TIPO_CONS=@tipoCons@, VAR_NOTE=@note@, VAR_DESCRIZIONE=@descrizione@, DATA_INVIO=@data@, CONSOLIDA=@consolida@
      WHERE SYSTEM_ID=@sysId@
    </value>
  </query>
  <query>
    <name>S_DPAAreaConservazione</name>
    <value>
      SELECT DISTINCT DPA_AREA_CONSERVAZIONE.SYSTEM_ID FROM DPA_AREA_CONSERVAZIONE WHERE
      DPA_AREA_CONSERVAZIONE.ID_PEOPLE=@idPeople@ AND
      DPA_AREA_CONSERVAZIONE.ID_RUOLO_IN_UO = (SELECT DPA_CORR_GLOBALI.SYSTEM_ID FROM DPA_CORR_GLOBALI WHERE DPA_CORR_GLOBALI.ID_GRUPPO = @idGruppo@)
      AND DPA_AREA_CONSERVAZIONE.CHA_STATO='N'
    </value>
  </query>
  <query>
    <name>S_RIC_AREA_CONS</name>
    <value>
      SELECT SYSTEM_ID, CHA_STATO, VAR_TIPO_SUPPORTO, VAR_NOTE, VAR_DESCRIZIONE, DATA_APERTURA, DATA_INVIO, DATA_CONSERVAZIONE FROM DPA_AREA_CONSERVAZIONE
      WHERE ID_PEOPLE=@idPeople@ AND ID_RUOLO_IN_UO=@idRuoloInUo@
    </value>
  </query>
  <query>
    <name>D_DPAAreaConservazione</name>
    <value>
      DELETE FROM DPA_AREA_CONSERVAZIONE WHERE
      SYSTEM_ID=@idIstanza@
    </value>
  </query>
  <query>
    <name>U_ItemsConservazione</name>
    <value>
      UPDATE DPA_ITEMS_CONSERVAZIONE
      SET CHA_STATO='I'
      WHERE ID_CONSERVAZIONE=@idCons@
    </value>
  </query>
  <query>
    <name>U_SizeItemCons</name>
    <value>
      UPDATE DPA_ITEMS_CONSERVAZIONE
      SET SIZE_ITEM=@size@
      WHERE SYSTEM_ID=@sysId@
    </value>
  </query>
  <query>
    <name>S_CONSERVAZIONE</name>
    <value>
      SELECT
      @param1@
      @param2@
      @param3@
    </value>
  </query>
  <query>
    <name>I_CONSERVAZIONE</name>
    <value>
      INSERT INTO
      @param1@
      @param2@
      @param3@
    </value>
  </query>

  <!--Lnr 16/01/2013 Aggiunta query per l'update del supporto-->
  <query>
    <name>U_REGISTRA_SUPPORTO_RIMOVIBILE</name>
    <value>
      UPDATE DPA_SUPPORTO
      SET CHA_STATO = '@stato@',
      VAR_COLLOCAZIONE_FISICA = '@collocazione@',
      VAR_NOTE = '@note@'
      WHERE SYSTEM_ID = @systemId@
    </value>
  </query>
  <query>
    <name>U_CONSERVAZIONE</name>
    <value>
      UPDATE
      @param1@
      @param2@
      @param3@
    </value>
  </query>
  <query>
    <name>S_GROUPNAME_FROM_GROUPS</name>
    <value>
      SELECT GROUP_NAME
      FROM GROUPS
      WHERE SYSTEM_ID = @idGruppo@
    </value>
  </query>
  <query>
    <name>S_CONSERVAZIONE1</name>
    <value>
      SELECT
      @param1@
      DOCSADM.Vardescribe(DPA_ITEMS_CONSERVAZIONE.ID_PROFILE, 'SEGNATURA_DOCNUMBER') AS SEGNATURA,
      DOCSADM.Vardescribe(DPA_ITEMS_CONSERVAZIONE.ID_PROFILE, 'DATADOC') AS DATA_PROT_OR_CREA,
      DOCSADM.Vardescribe(DPA_ITEMS_CONSERVAZIONE.ID_PROFILE, 'NUMPROTO') AS NUM_PROT,
      docsadm.getchaimg(DPA_ITEMS_CONSERVAZIONE.DOCNUMBER) AS IMG_ACQUISITA
      @param2@
      @param3@
    </value>
  </query>
  <query>
    <name>U_CONSERVAZIONE_DATI_TIMESTAMP</name>
    <value>
      UPDATE
      DPA_SUPPORTO
      SET
      DATA_APPO_MARCA=convert(datetime,'@dataAppoMarca@', 101),
      DATA_SCADENZA_MARCA=convert(datetime,'@dataScadMarca@', 101),
      VAR_MARCA_TEMPORALE=@marca@,
      NUM_MARCA=@numeroMarca@
      WHERE
      ID_CONSERVAZIONE=@idCons@
    </value>
  </query>
  <query>
    <name>S_GET_CLIENT_MODEL_PROCESSORS</name>
    <value>
      SELECT *
      FROM DPA_CLIENT_MODEL_PROCESSORS P
      ORDER BY P.NAME ASC
    </value>
  </query>
  <query>
    <name>S_GET_CLIENT_MODEL_PROCESSOR_FOR_ADMIN</name>
    <value>
      SELECT P.*
      FROM DPA_CLIENT_MODEL_PROCESSORS P
      INNER JOIN DPA_AMMINISTRA A ON P.SYSTEM_ID = A.ID_CLIENT_MODEL_PROCESSOR
      WHERE A.SYSTEM_ID = @idAdmin@
    </value>
  </query>
  <query>
    <name>S_GET_CLIENT_MODEL_PROCESSOR_FOR_USER</name>
    <value>
      SELECT P.*
      FROM DPA_CLIENT_MODEL_PROCESSORS P
      INNER JOIN PEOPLE PL ON P.SYSTEM_ID = PL.ID_CLIENT_MODEL_PROCESSOR
      WHERE PL.SYSTEM_ID = @idUser@
    </value>
  </query>
  <query>
    <name>S_CONSERVAZIONE2</name>
    <value>
      SELECT
      @param1@
      @dbuser@.Vardescribe(DPA_ITEMS_CONSERVAZIONE.ID_PROFILE, 'SEGNATURA_DOCNUMBER') AS SEGNATURA,
      docsadm.getchaimg(DPA_ITEMS_CONSERVAZIONE.DOCNUMBER) AS IMG_ACQUISITA
      @param2@
      @param3@
    </value>
  </query>
  <query>
    <name>DELETE_DPA_ITEMS_CONS</name>
    <value>
      DELETE FROM DPA_ITEMS_CONSERVAZIONE
      WHERE
      @param@
    </value>
  </query>
  <query>
    <name>GET_NODI_TITOLARIO</name>
    <value>
      SELECT * FROM PROJECT P, DPA_AMMINISTRA A
      WHERE A.SYSTEM_ID = P.ID_AMM AND P.ID_TITOLARIO = @idTitolario@
      AND P.CHA_TIPO_PROJ = 'T'
    </value>
  </query>
  <query>
    <name>AMM_S_VISIBILITA_NODO_RUOLI</name>
    <value>
      SELECT * FROM SECURITY  WITH (nolock)
      WHERE THING = @thing@
      AND PERSONORGROUP = @personorgroup@
      AND ACCESSRIGHTS = 255
      AND CHA_TIPO_DIRITTO = 'P'
    </value>
  </query>
  <query>
    <name>S_FULLTEXT_GET_DOCUMENTI</name>
    <value>
      SELECT DISTINCT P.SYSTEM_ID,
      P.DOCNUMBER, P.NUM_PROTO,
      P.VAR_SEGNATURA, @creationDate@ AS DATA, P.CHA_TIPO_PROTO As A_P,
      P.VAR_PROF_OGGETTO AS OGGETTO, P.ID_REGISTRO AS ID_REGISTRO,
      @dbuser@.getchaimg(P.DOCNUMBER) AS CHA_IMG, P.ID_DOCUMENTO_PRINCIPALE
      FROM	PROFILE P
      WHERE	P.SYSTEM_ID IN (@param@)
      ORDER BY P.DOCNUMBER DESC
    </value>
  </query>
  <query>
    <name>AMM_S_GET_CHIAVI_CONFIGURAZIONE</name>
    <value>
      SELECT		CC.SYSTEM_ID AS ID,
      CC.ID_AMM AS ID_AMMINISTRAZIONE,
      CC.VAR_CODICE AS CODICE,
      CC.VAR_DESCRIZIONE AS DESCRIZIONE,
      CC.VAR_VALORE AS VALORE,
      CC.CHA_TIPO_CHIAVE AS TIPO,
      CC.CHA_VISIBILE AS CHA_VIS,
      CC.CHA_MODIFICABILE AS CHA_MOD,
      CC.CHA_GLOBALE AS CHA_GLOBALE,
      CC.CHA_CONSERVAZIONE AS CHA_CONSERVAZIONE
      FROM		DPA_CHIAVI_CONFIGURAZIONE CC WITH(NOLOCK)
      WHERE CC.ID_AMM = @idAmm@
      ORDER BY	CC.VAR_CODICE
    </value>
  </query>
  <query>
    <name>AMM_S_GET_CHIAVE_CONFIGURAZIONE</name>
    <value>
      SELECT		CC.SYSTEM_ID AS ID,
      CC.VAR_CODICE AS CODICE,
      CC.VAR_DESCRIZIONE AS DESCRIZIONE,
      CC.VALORE AS VALORE,
      CC.TIPO_CHIAVE AS TIPO,
      CC.CHA_VISIBILE AS CHA_VIS,
      CC.CHA_MODIFICABILE AS CHA_MOD,
      CC.CHA_GLOBALE AS CHA_GLOBALE
      FROM		DPA_CHIAVI_CONFIGURAZIONE CC
      WHERE	CC.SYSTEM_ID=@idChiave@
    </value>
  </query>
  <query>
    <name>AMM_U_UPDATE_CHIAVE_CONFIGURAZIONE</name>
    <value>
      UPDATE 	DPA_CHIAVI_CONFIGURAZIONE
      SET 	VAR_DESCRIZIONE='@descrizione@',
      VAR_VALORE='@valore@'
      WHERE 	SYSTEM_ID=@systemID@
    </value>
  </query>
  <query>
    <name>I_CHIAVI_CONFIG_NEW_AMM</name>
    <value>
      INSERT INTO DPA_CHIAVI_CONFIGURAZIONE
      ( @param1@
      VAR_CODICE,
      VAR_DESCRIZIONE,
      VAR_VALORE,
      CHA_VISIBILE,
      CHA_MODIFICABILE,
      CHA_TIPO_CHIAVE,
      CHA_GLOBALE,
      ID_AMM
      )
      SELECT   @param2@
      VAR_CODICE,
      VAR_DESCRIZIONE,
      VAR_VALORE,
      CHA_VISIBILE,
      CHA_MODIFICABILE,
      CHA_TIPO_CHIAVE,
      '0',
      @param3@
      FROM DPA_CHIAVI_CONFIG_TEMPLATE
    </value>
  </query>
  <query>
    <name>S_GET_COUNT_ROWS_TODOLIST_GFD</name>
    <value>
      SELECT      COUNT(DISTINCT(ID_TRASMISSIONE))
      FROM   DPA_TODOLIST as TDL
      LEFT OUTER JOIN PROFILE as P ON TDL.ID_PROFILE = P.SYSTEM_ID
      LEFT OUTER JOIN DPA_TIPO_ATTO as TA ON P.ID_TIPO_ATTO = TA.SYSTEM_ID
      WHERE      @docORfasc@
      (
      TA.SISTEMA_PROPRIETARIO = (
      SELECT DPA_EXT_APPS.SYSTEM_ID as SISTEMA_ID
      FROM DPA_EXT_APPS
      WHERE DPA_EXT_APPS.VAR_CODE= '@SISTEMA_PROPRIETARIO@')
      or TA.SISTEMA_PROPRIETARIO is null
      )
      AND
      ((ID_PEOPLE_DEST = @idPeople@ and ID_RUOLO_DEST = @idGruppo@) OR
      (ID_PEOPLE_DEST = @idPeople@ AND ID_RUOLO_DEST = 0))
      @filters@
    </value>
  </query>

  <query>
    <name>S_GET_COUNT_ROWS_TODOLIST</name>
    <value>
      SELECT      COUNT(DISTINCT(ID_TRASMISSIONE))
      FROM   DPA_TODOLIST as TDL
      LEFT OUTER JOIN PROFILE as P ON TDL.ID_PROFILE = P.SYSTEM_ID
      LEFT OUTER JOIN DPA_TIPO_ATTO as TA ON P.ID_TIPO_ATTO = TA.SYSTEM_ID
      WHERE      @docORfasc@

      ((ID_PEOPLE_DEST = @idPeople@ and ID_RUOLO_DEST = @idGruppo@) OR
      (ID_PEOPLE_DEST = @idPeople@ AND ID_RUOLO_DEST = 0))
      @filters@
    </value>
  </query>
  <query>
    <name>S_GET_COUNT_ROWSNONVISTE_TODOLIST</name>
    <value>
      SELECT	  COUNT(DISTINCT(ID_TRASMISSIONE))
      FROM  	  DPA_TODOLIST
      WHERE 	  (ID_PROFILE > 0 or ID_PROJECT > 0) and
      ((ID_PEOPLE_DEST = @idPeople@ and ID_RUOLO_DEST = @idGruppo@) OR
      (ID_PEOPLE_DEST = @idPeople@ AND ID_RUOLO_DEST = 0))
      @filters@
    </value>
  </query>
  <query>
    <name>S_TODOLIST</name>
    <value>
      SELECT TOP @pageSize@ * FROM (
      SELECT TOP @pageSize@ * FROM (
      SELECT TOP @totalRows@
      ID_TRASMISSIONE,
      ID_TRASM_SINGOLA,
      ID_TRASM_UTENTE,
      DTA_INVIO,
      CONVERT(VARCHAR,DTA_INVIO,103)AS DTAINVIO,
      ISNULL(DTA_SCADENZA,'25000101') AS DTA_SCAD_ASC,
      ISNULL(DTA_SCADENZA,'17530101') AS DTA_SCAD_DESC,
      ISNULL(DTA_VISTA,'17530101') AS DTA_VISTA,
      @dbuser@.Vardescribe(ID_PEOPLE_MITT, 'PEOPLENAME') AS UT_MITT,
      @dbuser@.Vardescribe(ID_RUOLO_MITT, 'GROUPNAME') AS RUOLO_MITT,
      @dbuser@.Vardescribe(ID_PEOPLE_DEST, 'PEOPLENAME') AS UT_DEST,
      @dbuser@.Vardescribe(ID_RAGIONE_TRASM, 'RAGIONETRASM') AS RAG_TRASM,
      VAR_NOTE_GEN,
      VAR_NOTE_SING,
      DTA_SCADENZA,
      convert(nvarchar (10), dta_scadenza, 103) AS DTA_SCAD_CHAR,
      ID_PROFILE,
      @dbuser@.Vardescribe(ID_PROFILE, 'SEGNATURA_DOCNUMBER')AS SEGNA_DOCNUMBER,
      @dbuser@.Vardescribe(ID_PROFILE, 'OGGETTO_MITTENTE')AS OGGETTO_MITTENTE,
      @dbuser@.Vardescribe(ID_PROFILE, 'CHA_TIPO_PROTO')AS TIPO_PROTO,
      @dbuser@.Vardescribe(ID_PROFILE, 'DATADOC') AS DTA_DOC,
      @dbuser@.vardescribe(ID_PROFILE, 'NUMPROTO') AS NUM_PROTO,
      ID_PEOPLE_MITT AS ID_PEOPLE_MITT,
      ID_RUOLO_MITT AS ID_RUOLO_MITT,
      ID_RAGIONE_TRASM AS ID_RAGIONE_TRASM,
      ID_RUOLO_DEST AS ID_RUOLO_DEST,
      ID_PEOPLE_DEST AS ID_PEOPLE_DEST,
      CHA_TIPO_TRASM AS CHA_TIPO_TRASM,
      @dbuser@.Vardescribe(ID_PROFILE,'PROFILE_CHA_IMG') AS CHA_IMG,
      @dbuser@.Vardescribe(ID_PROFILE,'COMPONENTS_CHA_FIRMATO') AS CHA_FIRMATO,
      ID_PROJECT,
      @dbuser@.Vardescribe(ID_PROJECT, 'DESC_FASC')AS DESC_FASC,
      @dbuser@.Vardescribe(ID_PROJECT, 'CODFASC') AS COD_FASC,
      @dbuser@.Vardescribe(ID_PROJECT, 'DTA_CREAZ') AS DTA_CREAZ,
      @dbuser@.Vardescribe(ID_PROJECT, 'NUM_FASC') AS NUM_FASC,
      ID_PEOPLE_DELEGATO
      FROM        DPA_TODOLIST
      WHERE      @docORFasc@
      ((ID_PEOPLE_DEST = @idPeople@ and ID_RUOLO_DEST = @idGruppo@) OR
      (ID_PEOPLE_DEST = @idPeople@ AND ID_RUOLO_DEST = 0))
      @filters@
      ORDER BY @order@
      ) AS A
      ORDER BY @reverseOrder@
      ) AS A
      ORDER BY @order@
    </value>
  </query>
  <!--ADP Aggiunta per la gestione export con campo sistema proprietario valorizzato-->
  <query>
    <name>S_TODOLIST_SISTEMAP</name>
    <value>
      SELECT TOP @pageSize@ * FROM (
      SELECT TOP @pageSize@ * FROM (
      SELECT TOP @totalRows@
      ID_TRASMISSIONE,
      ID_TRASM_SINGOLA,
      ID_TRASM_UTENTE,
      DTA_INVIO,
      CONVERT(VARCHAR,DTA_INVIO,103)AS DTAINVIO,
      ISNULL(TDL.DTA_SCADENZA,'25000101') AS DTA_SCAD_ASC,
      ISNULL(TDL.DTA_SCADENZA,'17530101') AS DTA_SCAD_DESC,
      ISNULL(DTA_VISTA,'17530101') AS DTA_VISTA,
      @dbuser@.Vardescribe(ID_PEOPLE_MITT, 'PEOPLENAME') AS UT_MITT,
      @dbuser@.Vardescribe(ID_RUOLO_MITT, 'GROUPNAME') AS RUOLO_MITT,
      @dbuser@.Vardescribe(ID_PEOPLE_DEST, 'PEOPLENAME') AS UT_DEST,
      @dbuser@.Vardescribe(ID_RAGIONE_TRASM, 'RAGIONETRASM') AS RAG_TRASM,
      VAR_NOTE_GEN,
      VAR_NOTE_SING,
      TDL.DTA_SCADENZA,
      convert(nvarchar (10), TDL.dta_scadenza, 103) AS DTA_SCAD_CHAR,
      ID_PROFILE,
      @dbuser@.Vardescribe(ID_PROFILE, 'SEGNATURA_DOCNUMBER')AS SEGNA_DOCNUMBER,
      @dbuser@.Vardescribe(ID_PROFILE, 'OGGETTO_MITTENTE')AS OGGETTO_MITTENTE,
      @dbuser@.Vardescribe(ID_PROFILE, 'CHA_TIPO_PROTO')AS TIPO_PROTO,
      @dbuser@.Vardescribe(ID_PROFILE, 'DATADOC') AS DTA_DOC,
      @dbuser@.vardescribe(ID_PROFILE, 'NUMPROTO') AS NUM_PROTO,
      ID_PEOPLE_MITT AS ID_PEOPLE_MITT,
      ID_RUOLO_MITT AS ID_RUOLO_MITT,
      ID_RAGIONE_TRASM AS ID_RAGIONE_TRASM,
      ID_RUOLO_DEST AS ID_RUOLO_DEST,
      ID_PEOPLE_DEST AS ID_PEOPLE_DEST,
      TDL.CHA_TIPO_TRASM AS CHA_TIPO_TRASM,
      @dbuser@.Vardescribe(ID_PROFILE,'PROFILE_CHA_IMG') AS CHA_IMG,
      @dbuser@.Vardescribe(ID_PROFILE,'COMPONENTS_CHA_FIRMATO') AS CHA_FIRMATO,
      ID_PROJECT,
      @dbuser@.Vardescribe(ID_PROJECT, 'DESC_FASC')AS DESC_FASC,
      @dbuser@.Vardescribe(ID_PROJECT, 'CODFASC') AS COD_FASC,
      @dbuser@.Vardescribe(ID_PROJECT, 'DTA_CREAZ') AS DTA_CREAZ,
      @dbuser@.Vardescribe(ID_PROJECT, 'NUM_FASC') AS NUM_FASC,
      TDL.ID_PEOPLE_DELEGATO
      FROM   DPA_TODOLIST as TDL
      LEFT OUTER JOIN PROFILE as P ON TDL.ID_PROFILE = P.SYSTEM_ID
      LEFT OUTER JOIN DPA_TIPO_ATTO as TA ON P.ID_TIPO_ATTO = TA.SYSTEM_ID
      WHERE      @docORFasc@
      (
      TA.SISTEMA_PROPRIETARIO = (
      SELECT DPA_EXT_APPS.SYSTEM_ID as SISTEMA_ID
      FROM DPA_EXT_APPS
      WHERE DPA_EXT_APPS.VAR_CODE= '@SISTEMA_PROPRIETARIO@')
      or TA.SISTEMA_PROPRIETARIO is null
      )AND
      ((ID_PEOPLE_DEST = @idPeople@ and ID_RUOLO_DEST = @idGruppo@) OR
      (ID_PEOPLE_DEST = @idPeople@ AND ID_RUOLO_DEST = 0))
      @filters@
      ORDER BY @order@
      ) AS A
      ORDER BY @reverseOrder@
      ) AS A
      ORDER BY @order@
    </value>
  </query>
  <query>
    <name>S_EXPORT_TODO_LIST</name>
    <value>
      SELECT      ID_TRASMISSIONE,
      ID_TRASM_SINGOLA,
      ID_TRASM_UTENTE,
      DTA_INVIO,
      ID_PEOPLE_DELEGATO,
      CONVERT(VARCHAR,DTA_INVIO,103)AS DTAINVIO,
      ISNULL(DTA_SCADENZA,'25000101') AS DTA_SCAD_ASC,
      ISNULL(DTA_SCADENZA,'17530101') AS DTA_SCAD_DESC,
      ISNULL(DTA_VISTA,'17530101') AS DTA_VISTA,
      @dbuser@.Vardescribe(ID_PEOPLE_MITT, 'PEOPLENAME') AS UT_MITT,
      @dbuser@.Vardescribe(ID_RUOLO_MITT, 'GROUPNAME') AS RUOLO_MITT,
      @dbuser@.Vardescribe(ID_PEOPLE_DEST, 'PEOPLENAME') AS UT_DEST,
      @dbuser@.Vardescribe(ID_RAGIONE_TRASM, 'RAGIONETRASM') AS RAG_TRASM,
      VAR_NOTE_GEN,
      VAR_NOTE_SING,
      DTA_SCADENZA,
      convert(nvarchar (10), dta_scadenza, 103) AS DTA_SCAD_CHAR,
      ID_PROJECT,
      @dbuser@.Vardescribe(ID_PROJECT, 'DESC_FASC')AS DESC_FASC,
      @dbuser@.Vardescribe(ID_PROJECT, 'CODFASC') AS COD_FASC,
      @dbuser@.Vardescribe(ID_PROJECT, 'DTA_CREAZ') AS DTA_CREAZ,
      @dbuser@.Vardescribe(ID_PROJECT, 'NUM_FASC') AS NUM_FASC,
      ID_PROFILE,
      @dbuser@.Vardescribe(ID_PROFILE, 'SEGNATURA_DOCNUMBER')AS SEGNA_DOCNUMBER,
      @dbuser@.Vardescribe(ID_PROFILE, 'OGGETTO_MITTENTE')AS OGGETTO_MITTENTE,
      @dbuser@.Vardescribe(ID_PROFILE, 'CHA_TIPO_PROTO')AS TIPO_PROTO,
      @dbuser@.Vardescribe(ID_PROFILE, 'DATADOC') AS DTA_DOC,
      @dbuser@.vardescribe(ID_PROFILE, 'NUMPROTO') AS NUM_PROTO,
      ID_PEOPLE_MITT AS ID_PEOPLE_MITT,
      ID_RUOLO_MITT AS ID_RUOLO_MITT,
      ID_RAGIONE_TRASM AS ID_RAGIONE_TRASM,
      ID_RUOLO_DEST AS ID_RUOLO_DEST,
      ID_PEOPLE_DEST AS ID_PEOPLE_DEST,
      CHA_TIPO_TRASM AS CHA_TIPO_TRASM,
      @dbuser@.Vardescribe(ID_PROFILE,'PROFILE_CHA_IMG') AS CHA_IMG,
      @dbuser@.Vardescribe(ID_PROFILE,'COMPONENTS_CHA_FIRMATO') AS CHA_FIRMATO
      FROM  	  DPA_TODOLIST
      WHERE 	   @docORFasc@
      ((ID_PEOPLE_DEST = @idPeople@ and ID_RUOLO_DEST = @idGruppo@) OR
      (ID_PEOPLE_DEST = @idPeople@ AND ID_RUOLO_DEST = 0))
      AND ID_REGISTRO IN (@registri@)
      @filters@
      ORDER BY @order@
    </value>
  </query>
  <!--ADP Aggiunta per la gestione export con campo sistema proprietario valorizzato-->
  <query>
    <name>S_EXPORT_TODO_LIST_SISTEMAP</name>
    <value>
      SELECT      ID_TRASMISSIONE,
      ID_TRASM_SINGOLA,
      ID_TRASM_UTENTE,
      DTA_INVIO,
      TDL.ID_PEOPLE_DELEGATO,
      CONVERT(VARCHAR,DTA_INVIO,103)AS DTAINVIO,
      ISNULL(TDL.DTA_SCADENZA,'25000101') AS DTA_SCAD_ASC,
      ISNULL(TDL.DTA_SCADENZA,'17530101') AS DTA_SCAD_DESC,
      ISNULL(DTA_VISTA,'17530101') AS DTA_VISTA,
      @dbuser@.Vardescribe(ID_PEOPLE_MITT, 'PEOPLENAME') AS UT_MITT,
      @dbuser@.Vardescribe(ID_RUOLO_MITT, 'GROUPNAME') AS RUOLO_MITT,
      @dbuser@.Vardescribe(ID_PEOPLE_DEST, 'PEOPLENAME') AS UT_DEST,
      @dbuser@.Vardescribe(ID_RAGIONE_TRASM, 'RAGIONETRASM') AS RAG_TRASM,
      VAR_NOTE_GEN,
      VAR_NOTE_SING,
      TDL.DTA_SCADENZA,
      convert(nvarchar (10), TDL.dta_scadenza, 103) AS DTA_SCAD_CHAR,
      ID_PROJECT,
      @dbuser@.Vardescribe(ID_PROJECT, 'DESC_FASC')AS DESC_FASC,
      @dbuser@.Vardescribe(ID_PROJECT, 'CODFASC') AS COD_FASC,
      @dbuser@.Vardescribe(ID_PROJECT, 'DTA_CREAZ') AS DTA_CREAZ,
      @dbuser@.Vardescribe(ID_PROJECT, 'NUM_FASC') AS NUM_FASC,
      ID_PROFILE,
      @dbuser@.Vardescribe(ID_PROFILE, 'SEGNATURA_DOCNUMBER')AS SEGNA_DOCNUMBER,
      @dbuser@.Vardescribe(ID_PROFILE, 'OGGETTO_MITTENTE')AS OGGETTO_MITTENTE,
      @dbuser@.Vardescribe(ID_PROFILE, 'CHA_TIPO_PROTO')AS TIPO_PROTO,
      @dbuser@.Vardescribe(ID_PROFILE, 'DATADOC') AS DTA_DOC,
      @dbuser@.vardescribe(ID_PROFILE, 'NUMPROTO') AS NUM_PROTO,
      ID_PEOPLE_MITT AS ID_PEOPLE_MITT,
      ID_RUOLO_MITT AS ID_RUOLO_MITT,
      ID_RAGIONE_TRASM AS ID_RAGIONE_TRASM,
      ID_RUOLO_DEST AS ID_RUOLO_DEST,
      ID_PEOPLE_DEST AS ID_PEOPLE_DEST,
      TDL.CHA_TIPO_TRASM AS CHA_TIPO_TRASM,
      @dbuser@.Vardescribe(ID_PROFILE,'PROFILE_CHA_IMG') AS CHA_IMG,
      @dbuser@.Vardescribe(ID_PROFILE,'COMPONENTS_CHA_FIRMATO') AS CHA_FIRMATO
      FROM  	  DPA_TODOLIST as TDL
      LEFT OUTER JOIN PROFILE as P ON TDL.ID_PROFILE = P.SYSTEM_ID
      LEFT OUTER JOIN DPA_TIPO_ATTO as TA ON P.ID_TIPO_ATTO = TA.SYSTEM_ID
      WHERE 	   @docORFasc@
      (
      TA.SISTEMA_PROPRIETARIO = (
      SELECT DPA_EXT_APPS.SYSTEM_ID as SISTEMA_ID
      FROM DPA_EXT_APPS
      WHERE DPA_EXT_APPS.VAR_CODE= '@SISTEMA_PROPRIETARIO@')
      or TA.SISTEMA_PROPRIETARIO is null
      )AND
      ((ID_PEOPLE_DEST = @idPeople@ and ID_RUOLO_DEST = @idGruppo@) OR
      (ID_PEOPLE_DEST = @idPeople@ AND ID_RUOLO_DEST = 0))
      AND TDL.ID_REGISTRO IN (@registri@)
      @filters@
      ORDER BY @order@
    </value>
  </query>
  <query>
    <name>S_GET_CURRENT_VERSION_FILE_PATH</name>
    <value>
      SELECT c.path
      FROM components c
      WHERE c.version_id = (SELECT MAX(v.version_id)
      FROM versions v
      WHERE v.docnumber = @docNumber@)
    </value>
  </query>
  <query>
    <name>D_VIS_TITOLARIO_PER_RUOLO</name>
    <value>
      delete from security as s  where s.THING in
      (select system_id from project where id_titolario = @idTitolario@)
      and s.PERSONORGROUP = @systemId@
    </value>
  </query>
  <query>
    <name>S_MODELLI_ASS_DIAGRAMMI</name>
    <value>
      select distinct m.SYSTEM_ID, m.NOME, m.CHA_TIPO_OGGETTO, m.ID_REGISTRO, m.VAR_NOTE_GENERALI, m.ID_PEOPLE, m.SINGLE,
      m.ID_AMM, m.CHA_CEDE_DIRITTI, m.ID_PEOPLE_NEW_OWNER, m.ID_GROUP_NEW_OWNER
      from DPA_MODELLI_TRASM m, dpa_ass_diagrammi d
      where m.ID_AMM = @idAmm@ and
      @filters@
      order by m.id_registro,m.single,m.nome
    </value>
  </query>
  <query>
    <name>S_APPS_EXTENSION</name>
    <value>
      select upper(default_extension) from apps group by default_extension order by default_extension asc
    </value>
  </query>
  <query>
    <name>S_APPS_EXTENSION_FORMATI</name>
    <value>
      select  upper(file_extension) from dpa_formati_documento d where id_amministrazione=@idAmm@ and file_extension not  like '%.%' order by file_extension asc
    </value>
  </query>
  <query>
    <name>U_ET_TITOLARIO</name>
    <value>
      UPDATE PROJECT SET
      ET_TITOLARIO = '@etTitolario@',
      ET_LIVELLO1 = '@etLivello1@',
      ET_LIVELLO2 = '@etLivello2@',
      ET_LIVELLO3 = '@etLivello3@',
      ET_LIVELLO4 = '@etLivello4@',
      ET_LIVELLO5 = '@etLivello5@',
      ET_LIVELLO6 = '@etLivello6@'
      WHERE
      ID_AMM = @idAmm@
      AND
      ID_PARENT = 0
      AND
      CHA_TIPO_PROJ = 'T'
    </value>
  </query>
  <query>
    <name>I_DPA_PROTO_TIT</name>
    <value>
      INSERT INTO DPA_PROTO_TIT
      (
      @colID@
      ID_AMM,
      ID_NODO_TIT,
      ID_REGISTRO,
      NUM_RIF
      )
      VALUES
      (
      @id@
      @idAmm@,
      @idNodoTit@,
      @idRegistro@,
      @numRif@
      )
    </value>
  </query>
  <query>
    <name>D_DPA_PROTO_TIT</name>
    <value>
      DELETE DPA_PROTO_TIT
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>S_DPA_PROTO_TIT</name>
    <value>
      SELECT NUM_RIF FROM DPA_PROTO_TIT
      WITH(UPDLOCK)
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>S_PROJECT_PROTO_TIT</name>
    <value>
      SELECT * FROM PROJECT
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>U_DPA_PROTO_TIT</name>
    <value>
      UPDATE DPA_PROTO_TIT
      SET NUM_RIF = @numProtoTit@
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>S_PROFILE_PROTO_TIT</name>
    <value>
      SELECT * FROM PROFILE WITH(NOLOCK)
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>U_PROFILE_PROTO_TIT</name>
    <value>
      UPDATE PROFILE
      SET PROT_TIT = '@protoTitolario@', LAST_EDIT_DATE = GETDATE(), NUM_IN_FASC = @numInFasc@, ID_FASC_PROT_TIT = @idFascProtTit@, NUM_PROT_TIT = @numProtTit@, ID_TITOLARIO = @idTitolario@, DTA_PROTO_TIT = @dataProtoTit@
      WHERE
      @param1@
    </value>
  </query>
  <query>
    <name>U_PROJC_PROTO_TIT</name>
    <value>
      UPDATE PROJECT_COMPONENTS SET PROT_TIT = '@protoTit@'
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>S_PROJC_PROTO_TIT</name>
    <value>
      SELECT PROT_TIT FROM PROJECT_COMPONENTS
      WITH(UPDLOCK) WHERE PROJECT_ID = @projectId@ AND PROT_TIT IS NOT NULL
    </value>
  </query>
  <query>
    <name>S_MAX_NUM_DOC_IN_FASC</name>
    <value>
      SELECT MAX(NUM_IN_FASC) AS MAX_NUM_IN_FASC FROM PROFILE
      WHERE ID_FASC_PROT_TIT = @idFascicolo@
    </value>
  </query>
  <query>
    <name>S_NODI_FROM_NUM_PROT_TIT</name>
    <value>
      SELECT * FROM PROJECT WHERE
      @paramRegistro@
      ID_AMM = @idAmm@
      AND
      ID_TITOLARIO IN (@idTitolario@)
      AND
      NUM_PROT_TIT = @numProtTit@
      AND
      CHA_TIPO_PROJ = 'T'
    </value>
  </query>
  <query>
    <name>S_GET_DATA_ULTIMA_TRASMISSIONE_EFFETTUATA</name>
    <value>
      SELECT TOP 1 t.dta_invio
      FROM  dpa_trasmissione t
      INNER JOIN dpa_trasm_singola ts ON t.system_id = ts.id_trasmissione
      WHERE cha_tipo_oggetto = '@tipoOggetto@' AND
      @filtroIdOggetto@ AND
      ts.id_corr_globale = @idDestinatario@
      ORDER BY t.system_id DESC
    </value>
  </query>
  <query>
    <name>S_GET_DATA_ULTIMA_SPEDIZIONE_DOCUMENTO_EFFETTUATA</name>
    <value>
      SELECT TOP 1 I.DTA_SPEDIZIONE
      FROM DPA_STATO_INVIO I
      INNER JOIN DPA_CORR_GLOBALI C ON I.ID_CORR_GLOBALE = C.SYSTEM_ID
      WHERE I.ID_PROFILE = @idProfile@
      AND ID_CORR_GLOBALE = @destinatario@
      ORDER BY I.SYSTEM_ID DESC
    </value>
  </query>
  <query>
    <name>U_UPDATE_DATA_SPEDIZIONE_DOCUMENTO</name>
    <value>
      UPDATE DPA_STATO_INVIO
      SET DTA_SPEDIZIONE = @dtaSpedizione@,
      VAR_INDIRIZZO = @mail@
      STATUS_C_MASK = (select @dbUser@.getstatoinviomaskbytypeid(id_documenttype) from dpa_stato_invio where id_corr_globale= @idDestinatario@ and id_profile= @idProfile@)
      WHERE ID_PROFILE = @idProfile@ AND
      ID_CORR_GLOBALE = @idDestinatario@
    </value>
  </query>
  <query>
    <name>GET_CORRISPONDENTE_RF</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      A.ID_PEOPLE,
      A.ID_REGISTRO,
      A.ID_AMM,
      A.VAR_DESC_CORR,
      A.VAR_CODICE,
      A.VAR_COD_RUBRICA,
      A.VAR_NOME,
      A.VAR_COGNOME,
      A.CHA_DETTAGLI,
      A.CHA_PA,
      A.CHA_TIPO_URP,
      A.ID_TIPO_RUOLO,
      A.VAR_EMAIL,
      A.VAR_SMTP,
      A.NUM_PORTA_SMTP,
      A.NUM_LIVELLO,
      A.VAR_CODICE_AMM,
      A.VAR_CODICE_AOO,
      A.VAR_CODICE_ISTAT,
      A.ID_PARENT,
      A.ID_UO,
      A.DTA_FINE,
      A.ID_GRUPPO,
      A.CHA_TIPO_CORR,
      A.CHA_TIPO_IE,
      A.ID_RF
      FROM
      DPA_CORR_GLOBALI A
      WHERE
      A.SYSTEM_ID=@param1@
      AND ((A.ID_AMM IS NULL) OR (A.ID_AMM='@param2@'))
    </value>
  </query>
  <query>
    <name>S_COD_RF_BY_SYSTEM_ID</name>
    <value>
      select a.system_id from dpa_el_registri a, dpa_corr_globali b
      where b.var_cod_rubrica = '@param1@'
      and b.ID_RF = a.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>GET_CORRISPONDENTE_BY_RF</name>
    <value>
      select c.id_ruolo_in_uo, d.id_amm from dpa_l_ruolo_reg c, dpa_el_registri d
      where c.id_registro in (
      select a.system_id from dpa_el_registri a, dpa_corr_globali b
      where b.id_rf = a.SYSTEM_ID and a.VAR_CODICE = '@param1@'@idAmm@)
      and c.id_registro = d.system_id
    </value>
  </query>
  <query>
    <name>GET_CORRISPONDENTE_BY_DESC_RF</name>
    <value>
      select c.id_ruolo_in_uo, d.id_amm from dpa_l_ruolo_reg c, dpa_el_registri d
      where c.id_registro in (
      select a.system_id from dpa_el_registri a, dpa_corr_globali b
      where b.id_rf = a.SYSTEM_ID and a.VAR_DESC_REGISTRO = '@param1@')
      and c.id_registro = d.system_id
    </value>
  </query>
  <query>
    <name>LS_GET_CORRISPONDENTI_BY_DESC_LISTA</name>
    <value>
      SELECT ID_DPA_CORR, L.ID_AMM
      FROM DPA_LISTE_DISTR, DPA_CORR_GLOBALI L,DPA_CORR_GLOBALI C
      WHERE
      L.VAR_DESC_CORR = '@param1@' AND
      L.SYSTEM_ID = DPA_LISTE_DISTR.ID_LISTA_DPA_CORR
      AND C.SYSTEM_ID=DPA_LISTE_DISTR.ID_DPA_CORR
      AND C.DTA_FINE IS NULL
    </value>
  </query>
  <query>
    <name>LS_GET_SYSTEM_ID_LISTA</name>
    <value>
      SELECT SYSTEM_ID
      FROM DPA_CORR_GLOBALI
      WHERE
      VAR_COD_RUBRICA = '@param1@'
    </value>
  </query>
  <query>
    <name>S_IDAMM_DPA_CORR_GLOBALI</name>
    <value>
      SELECT SYSTEM_ID FROM DPA_CORR_GLOBALI
      WHERE
      (ID_PARENT = 0 OR ID_PARENT = NULL)
      AND
      ID_AMM = @idAmm@
      AND
      CHA_TIPO_URP = 'U'
      AND
      CHA_TIPO_IE = 'I'
      ORDER BY SYSTEM_ID ASC
    </value>
  </query>
  <query>
    <name>S_AMM_GET_UTENTI</name>
    <value>
      SELECT
      a.system_id AS IDCORRGLOBALE,
      c.system_id AS IDPEOPLE,
      c.user_id AS USERID,
      a.var_nome AS NOME,
      a.var_cognome AS COGNOME,
      a.var_codice AS CODICE,
      a.var_cod_rubrica AS CODICERUBRICA,
      c.cha_amministratore AS AMMINISTRATORE,
      a.var_email AS EMAIL,
      c.from_email_address AS FROM_EMAIL,
      c.disabled AS ABILITATO,
      (SELECT b.network_id FROM NETWORK_ALIASES b WHERE b.personorgroup = c.system_id) AS DOMINIO,
      c.var_sede AS SEDE,
      c.cha_notifica AS NOTIFICA,
      c.cha_notifica_con_allegato AS ALLEGATO_NOTIFICA,
      a.id_amm AS IDAMMINISTRAZIONE,
      c.password_never_expire as NESSUNA_SCADENZA_PASSWORD,
      c.ldap_never_sync,
      c.ldap_id_sync,
      c.ldap_authenticated,
      c.ID_CLIENT_MODEL_PROCESSOR,
      c.CHA_TIPO_COMPONENTI,
      c.is_enabled_smart_client,
      c.smart_client_pdf_conv_on_scan,
      C.ABILITATO_CENTRO_SERVIZI,
      c.id_dispositivo_stampa,
      c.matricola,
      c.abilitato_chiavi_config
      FROM
      DPA_CORR_GLOBALI a, PEOPLE c
      WHERE
      a.cha_tipo_urp = 'P'
      AND a.cha_tipo_ie = 'I'
      AND a.id_people = c.system_id
    </value>
  </query>
  <query>
    <name>S_RICERCA_TIPO_URP</name>
    <value>
      select
      cha_tipo_urp from dpa_corr_globali
      where
      var_cod_rubrica = '@param1@' and cha_tipo_ie = '@param2@' and
      id_amm = @param3@ and dta_fine is null
    </value>
  </query>
  <query>
    <name>S_RICERCA_RUOLI_UTENTE</name>
    <value>
      SELECT
      c.GROUPS_SYSTEM_ID FROM DPA_CORR_GLOBALI a, PEOPLE b, PEOPLEGROUPS c, GROUPS d
      WHERE
      a.id_people = b.system_id
      AND b.system_id = c.PEOPLE_SYSTEM_ID
      AND c.GROUPS_SYSTEM_ID = d.system_id
      AND a.cha_tipo_urp='P'
      AND a.cha_tipo_ie = 'I'
      AND a.id_amm = @param1@
      AND a.dta_fine IS NULL
      AND c.dta_fine IS NULL
      AND b.user_id = '@param2@'
    </value>
  </query>
  <query>
    <name>I_DPA_DELEGHE</name>
    <value>
      INSERT INTO DPA_DELEGHE
      (
      @colID@
      ID_PEOPLE_DELEGANTE,
      ID_RUOLO_DELEGANTE,
      ID_PEOPLE_DELEGATO,
      ID_RUOLO_DELEGATO,
      ID_UO_DELEGATO,
      COD_PEOPLE_DELEGANTE,
      COD_RUOLO_DELEGANTE,
      COD_PEOPLE_DELEGATO,
      COD_RUOLO_DELEGATO,
      DATA_DECORRENZA,
      DATA_SCADENZA,
      CHA_IN_ESERCIZIO
      ) VALUES (
      @id@
      @param1@
      )
    </value>
  </query>
  <query>
    <name>S_DELEGHE_ASSEGNATE</name>
    <value>
      SELECT *
      FROM DPA_DELEGHE
      @param1@ @order@
    </value>
  </query>
  <query>
    <name>S_COUNT_DELEGHE</name>
    <value>SELECT COUNT(*) FROM DPA_DELEGHE @param1@</value>
  </query>
  <query>
    <name>S_DELEGHE_PAGING</name>
    <value>
      SELECT * FROM (
      SELECT TOP @pageSize@ * FROM
      (
      SELECT TOP @rowNum@ * FROM DPA_DELEGHE @param1@ ORDER BY @order@
      ) AS T1 ORDER BY @order_desc@
      ) AS T2 ORDER BY @order@
    </value>
  </query>
  <query>
    <name>U_REVOCA_DELEGA</name>
    <value>
      UPDATE DPA_DELEGHE SET DATA_SCADENZA = GETDATE()
      WHERE SYSTEM_ID = @id_delega@
    </value>
  </query>
  <query>
    <name>U_MODIFICA_DELEGA</name>
    <value>
      UPDATE DPA_DELEGHE SET @param1@
      WHERE SYSTEM_ID = @id_delega@
    </value>
  </query>
  <query>
    <name>U_DISMETTI_DELEGA</name>
    <value>
      UPDATE DPA_DELEGHE SET cha_in_esercizio='0'
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>DELETE_DELEGA</name>
    <value>DELETE FROM DPA_DELEGHE WHERE SYSTEM_ID = @id_delega@</value>
  </query>
  <query>
    <name>CONTA_DELEGHE_ATTIVE</name>
    <value>
      SELECT COUNT(*)
      FROM DPA_DELEGHE
      WHERE
      @param1@
    </value>
  </query>
  <query>
    <name>DELEGHE_IN_ESERCIZIO</name>
    <value>
      SELECT cha_in_esercizio
      FROM DPA_DELEGHE
      WHERE
      @param1@
    </value>
  </query>
  <query>
    <name>LOCK_USER_LOGIN_DELEGATO</name>
    <value>
      INSERT INTO DPA_LOGIN (USER_ID,ID_AMM,IP_ADDRESS,DTA_CONNESSIONE, SESSION_ID,DST, CHA_DELEGA, USER_ID_DELEGATO) VALUES
      (UPPER('@param1@'),@param2@,'@param3@',@param4@, '@param5@','@param6@', '1', UPPER('@param7@'))
    </value>
  </query>
  <query>
    <name>S_REPORT_CONTATORI_DOCUMENTO</name>
    <value>
      select
      dpa_oggetti_custom.DESCRIZIONE,
      dpa_tipo_atto.VAR_DESC_ATTO,
      dpa_oggetti_custom.REPERTORIO,
      case dpa_oggetti_custom.CHA_TIPO_TAR
      when 'T' then 'Tipologia'
      when 'A' then 'AOO'
      when 'R' then 'RF'
      end as CHA_TIPO_TAR,
      dpa_contatori_doc.ANNO,
      dpa_contatori_doc.VALORE,
      docsadm.getCodReg(dpa_contatori_doc.ID_AOO) as COD_AOO,
      docsadm.getCodReg(dpa_contatori_doc.ID_RF) as COD_RF
      from
      dpa_tipo_atto,
      dpa_contatori_doc,
      dpa_oggetti_custom
      where
      dpa_tipo_atto.ID_AMM = @idAmm@
      and
      dpa_tipo_atto.IN_ESERCIZIO = 'SI'
      and
      dpa_tipo_atto.ABILITATO_SI_NO = 1
      and
      dpa_tipo_atto.SYSTEM_ID = dpa_contatori_doc.ID_TIPOLOGIA
      and
      dpa_contatori_doc.ID_OGG = dpa_oggetti_custom.SYSTEM_ID
      and
      dpa_contatori_doc.ANNO=@anno@
    </value>
  </query>
  <query>
    <name>S_REPORT_CONTATORI_FASCICOLO</name>
    <value>
      select
      dpa_oggetti_custom_fasc.descrizione,
      dpa_tipo_fasc.VAR_DESC_FASC,
      dpa_oggetti_custom_fasc.REPERTORIO,
      case dpa_oggetti_custom_fasc.CHA_TIPO_TAR
      when 'T' then 'Tipologia'
      when 'A' then 'AOO'
      when 'R' then 'RF'
      end as CHA_TIPO_TAR,
      dpa_contatori_fasc.ANNO,
      dpa_contatori_fasc.VALORE,
      docsadm.getCodReg(dpa_contatori_fasc.ID_AOO) as COD_AOO,
      docsadm.getCodReg(dpa_contatori_fasc.ID_RF) as COD_RF
      from
      dpa_tipo_fasc,
      dpa_contatori_fasc,
      dpa_oggetti_custom_fasc
      where
      dpa_tipo_fasc.ID_AMM = @idAmm@
      and
      dpa_tipo_fasc.IN_ESERCIZIO = 'SI'
      and
      dpa_tipo_fasc.ABILITATO_SI_NO = 1
      and
      dpa_tipo_fasc.SYSTEM_ID = dpa_contatori_fasc.ID_TIPOLOGIA
      and
      dpa_contatori_fasc.ID_OGG = dpa_oggetti_custom_fasc.SYSTEM_ID
      and
      dpa_contatori_fasc.ANNO=@anno@
    </value>
  </query>
  <query>
    <name>PD_SYSTEM_ID_OGGETTI_CUSTOM_FASC_CAMPI_COMUNI</name>
    <value>
      SELECT DISTINCT(ID_OGGETTO), DPA_OGG_CUSTOM_COMP_FASC.POSIZIONE
      FROM DPA_ASS_TEMPLATES_FASC, DPA_OGGETTI_CUSTOM_FASC, DPA_OGG_CUSTOM_COMP_FASC
      WHERE
      DPA_ASS_TEMPLATES_FASC.ID_OGGETTO = DPA_OGGETTI_CUSTOM_FASC.SYSTEM_ID
      AND
      DPA_OGGETTI_CUSTOM_FASC.SYSTEM_ID = DPA_OGG_CUSTOM_COMP_FASC.ID_OGG_CUSTOM
      AND
      DPA_OGG_CUSTOM_COMP_FASC.ID_TEMPLATE = @idTemplate@
      AND
      DPA_ASS_TEMPLATES_FASC.ID_PROJECT = ''
      and id_oggetto in
      (
      SELECT
      DPA_OGGETTI_CUSTOM_FASC.SYSTEM_ID
      FROM DPA_TIPO_FASC, DPA_VIS_TIPO_FASC, DPA_OGGETTI_CUSTOM_FASC, DPA_ASS_TEMPLATES_FASC
      WHERE
      (
      (ID_AMM = @idAmm@ OR ID_AMM IS NULL)
      AND
      (In_Esercizio &lt;&gt; 'NO' OR In_Esercizio IS NULL)
      AND
      (Abilitato_SI_NO &lt;&gt; 0 OR Abilitato_SI_NO IS NULL)
      AND
      DPA_TIPO_FASC.SYSTEM_ID = DPA_VIS_TIPO_FASC.ID_TIPO_FASC
      AND
      DPA_VIS_TIPO_FASC.ID_RUOLO = @idRuolo@
      AND
      DPA_VIS_TIPO_FASC.DIRITTI  IN (1,2)
      )
      AND DPA_TIPO_FASC.SYSTEM_ID = DPA_ASS_TEMPLATES_FASC.ID_TEMPLATE
      AND DPA_ASS_TEMPLATES_FASC.ID_PROJECT = ''
      AND DPA_ASS_TEMPLATES_FASC.ID_OGGETTO = DPA_OGGETTI_CUSTOM_FASC.SYSTEM_ID
      )
      ORDER BY DPA_OGG_CUSTOM_COMP_FASC.POSIZIONE
    </value>
  </query>
  <query>
    <name>U_AMM_NEWS</name>
    <value>
      UPDATE DPA_AMMINISTRA
      SET NEWS = '@news@',
      ENABLE_NEWS = '@enable_news@'
      WHERE SYSTEM_ID = @idAmm@
    </value>
  </query>
  <query>
    <name>S_AMM_NEWS</name>
    <value>
      SELECT ENABLE_NEWS + '^' + NEWS
      FROM DPA_AMMINISTRA
      WHERE SYSTEM_ID = @idAmm@
    </value>
  </query>
  <query>
    <name>U_AMM_BANNER</name>
    <value>
      UPDATE DPA_AMMINISTRA
      SET VAR_MSG_BANNER = '@banner@'
      WHERE SYSTEM_ID = @idAmm@
    </value>
  </query>
  <query>
    <name>S_AMM_BANNER</name>
    <value>
      SELECT VAR_MSG_BANNER
      FROM DPA_AMMINISTRA
      WHERE SYSTEM_ID = @idAmm@
    </value>
  </query>
  <query>
    <name>UPDATE_ESITO_DPA_ITEMS_CONS</name>
    <value>
      UPDATE DPA_ITEMS_CONSERVAZIONE
      SET CHA_ESITO=@param1@
      WHERE
      SYSTEM_ID=@param2@
    </value>
  </query>
  <query>
    <name>S_CONSERVAZIONE_DOC_NUMBER_TRASM</name>
    <value>
      select docNumber
      from profile p WITH(NOLOCK), dpa_area_conservazione c
      where
      c.ID_PROFILE_TRASMISSIONE=p.SYSTEM_ID and c.SYSTEM_ID=@idIstanza@
    </value>
  </query>
  <!--Lnr 16/01/2013 tolta colonna chiave primaria "SYSTEM_ID" nella insert-->
  <query>
    <name>I_dpa_cons_verifica</name>
    <value>
      insert into dpa_cons_verifica
      (
      ID_SUPPORTO,
      ID_ISTANZA,
      DATA_VER,
      NUM_VER,
      VAR_NOTE,
      PERCENTUALE,
      ESITO
      )
      values
      (
      @id@
      @idSupporto@,
      @idIstanza@,
      GETDATE(),
      @numVer@,
      @note@,
      @perc@,
      @esito@
      )
    </value>
  </query>
  <!--Lnr 16/01/2013 aggiunta query per l'update del supporto remoto che serve per la verifica-->
  <query>
    <name>U_UPDATE_STATO_SUPPORTO_REMOTO</name>
    <value>
      UPDATE DPA_SUPPORTO
      SET CHA_STATO = '@stato@', PERC_VERIFICA = @percentuale@
      WHERE ID_CONSERVAZIONE = @idConservazione@
      AND ID_TIPO_SUPPORTO = (SELECT SYSTEM_ID FROM DPA_TIPO_SUPPORTO WHERE VAR_TIPO = 'REMOTO')
    </value>
  </query>
  <query>
    <name>S_REPORT_CONS_VERIFICHE</name>
    <value>
      SELECT
      NUM_VER,
      ID_SUPPORTO,
      ID_ISTANZA,
      DATA_VER,
      ESITO,
      PERCENTUALE,
      VAR_NOTE AS NOTE
      FROM DPA_CONS_VERIFICA
      WHERE ID_SUPPORTO=@idSupporto@ AND ID_ISTANZA = @idIstanza@
      order by data_ver desc
    </value>
  </query>
  <query>
    <name>S_FIRST_DAY_WEEK</name>
    <value>
      select convert(VARCHAR(25),DATEADD(DAY,-DATEPART(WEEKDAY,(DATEADD(DAY,7-DATEPART(WEEKDAY,GETDATE()),GETDATE())))
      +(7-DATEPART(WEEKDAY,GETDATE()))+2 ,GETDATE()),103) as DAY
    </value>
  </query>
  <query>
    <name>S_FIRST_DAY_MONTH</name>
    <value>
      SELECT CONVERT(VARCHAR(25),DATEADD(dd,-(DAY(getdate())-1),getdate()),103) AS DAY
    </value>
  </query>
  <query>
    <name>S_LAST_DAY_WEEK</name>
    <value>
      select convert(varchar(25),DATEADD(DAY , 8-DATEPART(WEEKDAY,GETDATE()),GETDATE()),103) AS DAY
    </value>
  </query>
  <query>
    <name>S_LAST_DAY_MONTH</name>
    <value>
      SELECT CONVERT(VARCHAR(25),DATEADD(dd,-(DAY(DATEADD(mm,1,getdate()))),DATEADD(mm,1,getdate())),103) AS DAY
    </value>
  </query>
  <query>
    <name>S_TODAY</name>
    <value>
      select CONVERT(VARCHAR(25),GETDATE(),103) as DAY
    </value>
  </query>
  <query>
    <name>S_YESTERDAY</name>
    <value>
      SELECT CONVERT(VARCHAR,(DATEADD(day, -1, GETDATE())),103) AS DAY
    </value>
  </query>
  <query>
    <name>S_LAST_THIRTY_ONE_DAY</name>
    <value>
      SELECT CONVERT(VARCHAR,(DATEADD(day, -31, GETDATE())),103) AS DAY
    </value>
  </query>
  <query>
    <name>S_LAST_SEVEN_DAY</name>
    <value>
      SELECT CONVERT(VARCHAR,(DATEADD(day, -7, GETDATE())),103) AS DAY
    </value>
  </query>
  <query>
    <name>S_PROFILE_TRASMISSIONE</name>
    <value>
      select ID_PROFILE_TRASMISSIONE
      from DPA_AREA_CONSERVAZIONE
      WHERE SYSTEM_ID=@IdCons@
    </value>
  </query>
  <query>
    <name>PR_DO_GET_TITOLARI</name>
    <value>
      SELECT SYSTEM_ID,
      DESCRIPTION,
      ET_TITOLARIO
      FROM PROJECT
      WHERE ID_TITOLARIO=0
      AND ID_AMM=@idAmm@
    </value>
  </query>
  <query>
    <name>S_REPORT_PROTOCOLLO_ARMA</name>
    <value>
      select
      project.NUM_PROT_TIT,
      @paramDate@ as DTA_APERTURA,
      project.DESCRIPTION as OGGETTO,
      project.VAR_CODICE AS CODICE
      from project
      where
      num_prot_tit is not null
      and
      cha_tipo_proj = 'T'
      and
      id_titolario = @idTitolario@
      and
      project.id_amm = @idAmm@
      and
      @idReg@
      order by num_prot_tit asc
    </value>
  </query>
  <query>
    <name>S_REPORT_DETTAGLIO_PRATICA</name>
    <value>
      SELECT p.NUM_FASCICOLO, p.DESCRIPTION as DESCRIZIONE, @paramDate@ as DTA_CREAZIONE
      FROM PROJECT p
      WHERE id_parent in (SELECT system_id FROM PROJECT WHERE
      (@idReg@)
      AND
      ID_TITOLARIO =@idTitolario@
      AND
      NUM_PROT_TIT = @numPratica@
      AND
      ID_AMM = @idAmm@ and
      CHA_TIPO_PROJ = 'T') and p.CHA_TIPO_FASCICOLO ='P' order by num_fascicolo
    </value>
  </query>
  <query>
    <name>S_REPORT_GIORNALE_RISCONTRI</name>
    <value>
      select
      dpa_riscontri_classifica.RIFF_MITT as CLASSIFICA_MITTENTE,
      dpa_corr_globali.VAR_DESC_CORR as DESCRIZIONE_MITTENTE,
      (select project.DESCRIPTION from project where system_id = dpa_riscontri_classifica.ID_TITOLARIO_DEST and project.cha_tipo_proj = 'T' and project.id_titolario = 0) as TITOLARIO_INTERNO,
      dpa_riscontri_classifica.PROT_TIT_DEST as PRATICA_INTERNA,
      dpa_riscontri_classifica.CLASS_DEST as CLASSIFICA_INTERNA,
      (select project.DESCRIPTION from project where num_prot_tit = dpa_riscontri_classifica.prot_tit_dest and project.cha_tipo_proj = 'T' and project.id_titolario = dpa_riscontri_classifica.ID_TITOLARIO_DEST and PROJECT.DTA_APERTURA is not null) as DESC_PRATICA_INTERNA
      from dpa_riscontri_classifica, dpa_corr_globali
      where dpa_corr_globali.SYSTEM_ID= dpa_riscontri_classifica.ID_CORR_GLOB
      and dpa_corr_globali.ID_AMM=@idAmm@
      and @idReg@
    </value>
  </query>
  <query>
    <name>PR_DO_GET_DOC_SPEDITI</name>
    <value>
      select
      count(profile.system_id) as tot_documenti
      from dpa_stato_invio, profile, dpa_corr_globali c
      where
      dpa_stato_invio.ID_PROFILE=profile.SYSTEM_ID
      and dpa_stato_invio.ID_CORR_GLOBALE=c.SYSTEM_ID
      and DOCSADM.GETIDAMM(profile.AUTHOR)=@idAmm@
      @filters@
    </value>
  </query>
  <query>
    <name>S_REPORT_DOC_SPEDITI_INTEROP</name>
    <value>
      select
      profile.VAR_SEGNATURA,
      profile.VAR_PROF_OGGETTO as OGGETTO,
      dpa_stato_invio.DTA_SPEDIZIONE,
      c.VAR_DESC_CORR AS DESTINATARIO,
      dpa_stato_invio.VAR_PROTO_DEST AS PROTO_DEST
      from dpa_stato_invio, profile, dpa_corr_globali c
      where
      dpa_stato_invio.ID_PROFILE=profile.SYSTEM_ID
      and dpa_stato_invio.ID_CORR_GLOBALE=c.SYSTEM_ID
      and DOCSADM.GETIDAMM(profile.AUTHOR)=@idAmm@
      @filters@
    </value>
  </query>
  <query>
    <name>S_COUNT_DOC_FASCICOLATO</name>
    <value>
      SELECT COUNT(*) FROM PROJECT_COMPONENTS
      WHERE LINK = @param1@
    </value>
  </query>
  <query>
    <name>INSERT_DPA_RISCONTRI_CLASSIFICA</name>
    <value>
      INSERT INTO DPA_RISCONTRI_CLASSIFICA
      (
      @colID@
      RIFF_MITT,
      ID_CORR_GLOB,
      ID_TITOLARIO_DEST,
      ID_REG_DEST,
      CLASS_DEST,
      COD_FASC_DEST,
      PROT_TIT_DEST,
      DTA_RISCONTRO
      )
      VALUES
      (
      @id@
      '@riffMitt@',
      @idCorrGlob@,
      @idTitolarioDest@,
      @idRegDest@,
      '@classDest@',
      '@codFascDest@',
      '@protTitDest@',
      @dtaRiscontro@
      )
    </value>
  </query>
  <query>
    <name>SELECT_DPA_RISCONTRI_CLASSIFICA</name>
    <value>
      SELECT
      *
      FROM DPA_RISCONTRI_CLASSIFICA
      WHERE
      ID_CORR_GLOB = @idCorrGlob@
    </value>
  </query>
  <query>
    <name>DELETE_DPA_RISCONTRI_CLASSIFICA</name>
    <value>
      DELETE DPA_RISCONTRI_CLASSIFICA
      WHERE
      SYSTEM_ID = @systemId@
    </value>
  </query>
  <query>
    <name>U_PROFILE_RIF_MIT</name>
    <value>
      UPDATE PROFILE
      SET CHA_RIFF_MITT = '@riffMitt@',
      LAST_EDIT_DATE = GETDATE()
      WHERE
      @param1@
    </value>
  </query>
  <query>
    <name>S_ID_TRASM_UTENTE_TODOLIST</name>
    <value>
      SELECT
      ID_TRASM_UTENTE
      FROM DPA_TODOLIST
      WHERE @docORFasc@
      ((ID_PEOPLE_DEST = @idPeople@ and ID_RUOLO_DEST = @idGruppo@) OR
      (ID_PEOPLE_DEST = @idPeople@ AND ID_RUOLO_DEST = 0))
      @filters@
    </value>
  </query>
  <query>
    <name>S_GET_COUNT_ROWSNONVISTE_PRED_TODOLIST</name>
    <value>
      select count(a.id_trasmissione) from (
      SELECT DISTINCT id_trasmissione
      FROM dpa_todolist a, PROFILE b
      WHERE (a.id_profile > 0 OR a.id_project > 0)
      AND (   (a.id_people_dest = @idPeople@ AND a.id_ruolo_dest = @idGruppo@)
      OR (a.id_people_dest = @idPeople@ AND a.id_ruolo_dest = 0)
      )
      AND a.id_profile = b.system_id
      AND b.cha_da_proto = 1
      @filters@
      UNION
      SELECT DISTINCT id_trasmissione
      FROM dpa_todolist a, PROFILE b
      WHERE (a.id_profile > 0 OR a.id_project > 0)
      AND (   (a.id_people_dest = @idPeople@ AND a.id_ruolo_dest = @idGruppo@)
      OR (a.id_people_dest = @idPeople@ AND a.id_ruolo_dest = 0)
      )
      AND a.id_profile = b.system_id
      AND b.cha_da_proto = 1
      AND (   a.id_trasm_utente IN (SELECT system_id
      FROM dpa_trasm_utente
      WHERE cha_accettata = '0')
      )
      ) a
    </value>
  </query>
  <query>
    <name>S_DOCTYPES_DOC_ARRIVO_PAR</name>
    <value>
      SELECT B.SYSTEM_ID, B.DESCRIPTION, B.TYPE_ID, B.CHA_TIPO_CANALE
      FROM DPA_DOC_ARRIVO_PAR A, DOCUMENTTYPES B
      WHERE A.ID_PROFILE = @idProfile@
      AND A.ID_MITT_DEST = @idDestinatario@
      AND A.ID_DOCUMENTTYPES = B.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>S_SEGN_AMMINISTRA</name>
    <value>
      select COL_SEGN
      from DPA_AMMINISTRA a
      where a.SYSTEM_ID = @idAmm@
    </value>
  </query>
  <query>
    <name>U_COL_SEGN_DPA_AMMINISTRA</name>
    <value>
      update DPA_AMMINISTRA
      set COL_SEGN = @param1@
      where system_id = @idAmm@
    </value>
  </query>
  <query>
    <name>S_NUM_FOLDER_DOC</name>
    <value>
      select count(*) from project_components where link=@idProfile@
    </value>
  </query>
  <query>
    <name>S_PROTO_DEST</name>
    <value>
      select VAR_PROTO_DEST  from DPA_STATO_INVIO b where
      b.ID_CORR_GLOBALE=@idCorrDest@ and
      b.ID_PROFILE=@idProfile@
    </value>
  </query>
  <query>
    <name>I_PROTO_TIT_NUM_DOC_IN_FASC</name>
    <value>
      INSERT INTO DPA_PROTO_TIT
      (
      @colID@
      ID_AMM,
      ID_FASC,
      NUM_DOC_IN_FASC
      )
      VALUES
      (
      @id@
      @idAmm@,
      @idFasc@,
      @numDocInFasc@
      )
    </value>
  </query>
  <query>
    <name>U_PROTO_TIT_NUM_DOC_IN_FASC</name>
    <value>
      UPDATE DPA_PROTO_TIT SET NUM_DOC_IN_FASC = @numDocInFasc@
      WHERE ID_FASC = @idFasc@
    </value>
  </query>
  <query>
    <name>S_PROTO_TIT_NUM_DOC_IN_FASC</name>
    <value>
      SELECT NUM_DOC_IN_FASC FROM DPA_PROTO_TIT
      WITH(UPDLOCK) WHERE ID_FASC = @idFasc@
    </value>
  </query>
  <query>
    <name>SELECT_CORR_GLOBALI</name>
    <value>
      SELECT
      *
      FROM DPA_CORR_GLOBALI A
      WHERE
      A.VAR_COD_RUBRICA = @codRubrica@
      and  ((A.ID_AMM IS NULL) OR (A.ID_AMM=@idAmm@))
    </value>
  </query>
  <query>
    <name>S_SMISTADOC_GET_DATI_UTENTI</name>
    <value>
      SELECT
      CG.SYSTEM_ID AS ID_CORR_GLOBALI,
      P.EMAIL_ADDRESS AS EMAIL_UTENTE,
      P.CHA_NOTIFICA,
      P.CHA_NOTIFICA_CON_ALLEGATO,
      P.SYSTEM_ID AS ID_PEOPLE
      from people P,
      DPA_CORR_GLOBALI CG
      where CG.ID_PEOPLE = @idPeople@
      and P.SYSTEM_ID=CG.ID_PEOPLE
    </value>
  </query>
  <query>
    <name>S_SMISTADOC_GET_UTENTI_RUOLO</name>
    <value>
      SELECT DISTINCT
      c.SYSTEM_ID AS ID,
      a.SYSTEM_ID AS ID_CORR_GLOBALI,
      c.USER_ID AS CODICE_UTENTE,
      c.FULL_NAME AS DESCRIZIONE_UTENTE,
      c.EMAIL_ADDRESS AS EMAIL_UTENTE,
      c.CHA_NOTIFICA,
      c.CHA_NOTIFICA_CON_ALLEGATO,
      a.VAR_COGNOME
      FROM
      DPA_CORR_GLOBALI a, PEOPLEGROUPS b, PEOPLE c
      WHERE
      a.id_people = b.people_system_id
      AND b.people_system_id = c.system_id
      AND c.disabled = 'N'
      AND a.dta_fine is NULL
      AND b.dta_fine is NULL
      AND a.cha_tipo_urp = 'P'
      AND a.cha_tipo_ie = 'I'
      AND @param1@
      ORDER BY a.var_cognome
    </value>
  </query>
  <query>
    <name>S_SMISTADOC_GET_RUOLI_UO</name>
    <value>
      SELECT
      a.system_id AS ID,
      a.var_desc_corr AS DESCRIZIONE,
      a.var_codice AS CODICE,
      a.CHA_RIFERIMENTO
      FROM
      DPA_CORR_GLOBALI a
      WHERE
      a.cha_tipo_urp = 'R'
      AND a.cha_tipo_ie = 'I'
      AND a.dta_fine is null
      AND a.id_uo=@param1@
      ORDER BY DESCRIZIONE ASC
    </value>
  </query>
  <query>
    <name>S_SMISTADOC_GET_ALL_RAGIONI_TRASM</name>
    <value>
      SELECT
      SYSTEM_ID,
      VAR_DESC_RAGIONE,
      CHA_TIPO_RAGIONE,
      CHA_TIPO_DIRITTI,
      CHA_TIPO_DEST,
      CHA_RISPOSTA,
      VAR_NOTE,
      CHA_EREDITA,
      CHA_TIPO_RISPOSTA,
      CHA_CEDE_DIRITTI,
      VAR_NOTIFICA_TRASM,
      VAR_TESTO_MSG_NOTIFICA_DOC,
      VAR_TESTO_MSG_NOTIFICA_FASC
      FROM DPA_RAGIONE_TRASM
      WHERE  DPA_RAGIONE_TRASM.CHA_VIS = '1'
      AND ID_AMM = @param1@ ORDER BY VAR_NOTE ASC
    </value>
  </query>
  <query>
    <name>CHECK_ADMIN_USER_LOGIN_ON_SESSION_ID</name>
    <value>
      SELECT COUNT(*) AS TOT
      FROM DPA_LOGIN
      WHERE SESSION_ID = '@param1@'
    </value>
  </query>
  <query>
    <name>GET_FRIEND_APPLICATION</name>
    <value>
      SELECT
      DPA_FRIEND_APPLICATION.COD_APPLICAZIONE,
      DPA_FRIEND_APPLICATION.COD_REGISTRO,
      DPA_EL_REGISTRI.ID_PEOPLE_FACTORY,
      DPA_EL_REGISTRI.ID_GRUPPO_FACTORY,
      DPA_EL_REGISTRI.SYSTEM_ID AS ID_REGISTRO
      FROM DPA_FRIEND_APPLICATION, DPA_EL_REGISTRI, PEOPLE
      WHERE
      DPA_FRIEND_APPLICATION.COD_APPLICAZIONE = '@friendApplication@'
      AND
      DPA_FRIEND_APPLICATION.COD_REGISTRO = '@codRegistro@'
      AND
      DPA_FRIEND_APPLICATION.ID_REGISTRO = DPA_EL_REGISTRI.SYSTEM_ID
      AND
      DPA_EL_REGISTRI.ID_PEOPLE_FACTORY = PEOPLE.SYSTEM_ID
      AND
      PEOPLE.FACTORY_USER = 'Y'
    </value>
  </query>
  <query>
    <name>GET_NOMECOGNOMEUTENTE</name>
    <value>
      SELECT VAR_NOME, VAR_COGNOME FROM PEOPLE
      WHERE user_id = '@userId@' AND ID_AMM = @idAmm@
    </value>
  </query>
  <query>
    <name>GET_FUNZIONE</name>
    <value>
      SELECT COUNT(*)
      FROM DPA_ANAGRAFICA_FUNZIONI
      WHERE COD_FUNZIONE = '@codFunzione@' AND DISABLED = 'N'
    </value>
  </query>
  <query>
    <name>S_GET_STATO_TRASMISSIONE_UTENTE</name>
    <value>
      SELECT  TU.CHA_VISTA AS VISTA,
      TU.CHA_ACCETTATA AS ACCETTATA,
      TU.CHA_RIFIUTATA AS RIFIUTATA,
      TU.CHA_IN_TODOLIST AS IN_TODOLIST
      FROM    DPA_TRASM_UTENTE TU
      WHERE   TU.SYSTEM_ID = @idTrasmissioneSingola@
    </value>
  </query>
  <query>
    <name>S_J_DPA_T_CANALE_CORR__DOCUMENTTYPES2</name>
    <value>
      SELECT
      A.SYSTEM_ID
      FROM DPA_T_CANALE_CORR A, DOCUMENTTYPES B
      WHERE A.ID_DOCUMENTTYPE = B.SYSTEM_ID
      AND B.CHA_TIPO_CANALE in ('M','I')
      AND A.ID_CORR_GLOBALE = @param1@
      AND A.CHA_PREFERITO = '1'
    </value>
  </query>
  <query>
    <name>PD_DELETE_ASS_RUOLO_OGGETTO_CUSTOM_DOC</name>
    <value>
      DELETE FROM DPA_A_R_OGG_CUSTOM_DOC
      WHERE
      ID_OGGETTO_CUSTOM = @idOggettoCustom@
    </value>
  </query>
  <query>
    <name>PD_INSERT_ASS_RUOLO_OGG_CUSTOM_DOC</name>
    <value>
      INSERT INTO DPA_A_R_OGG_CUSTOM_DOC
      (
      @colID@
      ID_OGGETTO_CUSTOM,
      ID_RUOLO,
      INS_MOD
      )
      VALUES
      (
      @id@
      @idOggettoCustom@,
      @idRuolo@,
      @inserimento@
      )
    </value>
  </query>
  <query>
    <name>PD_UPDATE_RUOLI_TIPO_DOC</name>
    <value>
      UPDATE DPA_VIS_TIPO_DOC
      SET DIRITTI = @diritti@
      WHERE
      ID_TIPO_DOC = @idTipoDoc@
      AND ID_RUOLO = @idRuolo@
    </value>
  </query>
  <query>
    <name>PD_UPDATE_RUOLI_TIPO_FASC</name>
    <value>
      UPDATE DPA_VIS_TIPO_FASC
      SET DIRITTI = @diritti@
      WHERE
      ID_TIPO_FASC = @idTipoFasc@
      AND ID_RUOLO = @idRuolo@
    </value>
  </query>
  <query>
    <name>PD_GET_RUOLI_OGG_CUSTOM_DOC</name>
    <value>
      SELECT ID_RUOLO
      FROM DPA_A_R_OGG_CUSTOM_DOC A, DPA_CORR_GLOBALI B
      WHERE A.ID_OGGETTO_CUSTOM = @idOggCustom@
      AND A.INS_MOD = 1
      AND A.ID_RUOLO = B.ID_GRUPPO
    </value>
  </query>
  <query>
    <name>PD_GET_RUOLI_TIPO_ATTO</name>
    <value>
      SELECT B.SYSTEM_ID FROM DPA_VIS_TIPO_DOC A, DPA_CORR_GLOBALI B
      WHERE
      ID_TIPO_DOC = @idTipoDoc@
      AND A.ID_RUOLO = B.ID_GRUPPO
    </value>
  </query>
  <query>
    <name>PD_SELECT_ASS_RUOLO_OGGETTO_CUSTOM_DOC</name>
    <value>
      SELECT * FROM DPA_A_R_OGG_CUSTOM_DOC
      WHERE
      ID_OGGETTO_CUSTOM = @idOggettoCustom@
      AND @funzione@
    </value>
  </query>
  <query>
    <name>S_ATTRIBUTI_TIPOFASC</name>
    <value>
      select system_id, descrizione from dpa_oggetti_custom_fasc
      where system_id in (select id_ogg_custom from dpa_ogg_custom_comp_fasc where id_template=@id_template@)
    </value>
  </query>
  <query>
    <name>S_TIPOOGGETTO_TIPOFASC</name>
    <value>
      select tipo from dpa_tipo_oggetto_fasc where system_id in
      (select id_tipo_oggetto from dpa_oggetti_custom_fasc where system_id = @id_oggetto@)
    </value>
  </query>
  <query>
    <name>S_GET_UO_IN_AOO_NO_REG</name>
    <value>
      select dpa_corr_globali.var_cod_rubrica as CODICE,
      dpa_corr_globali.system_id as IDCORRGLOBALE,
      dpa_corr_globali.var_desc_corr as DESCRIZIONE
      from dpa_corr_globali, dpa_uo_reg
      where
      dpa_uo_reg.id_uo = dpa_corr_globali.system_id
      order by var_cod_rubrica, var_desc_corr asc
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__DOC_ARRIVO_PAR_NEW</name>
    <value>
      select cg.*, ap.cha_tipo_mitt_dest, dt.system_id AS id_documenttypes,
      dt.description, dt.type_id, dt.cha_tipo_canale,
      @dbuser@.VardescribeInvio(ap.id_profile,cg.SYSTEM_ID,'VAR_CODICE_AOO') as VAR_CODICE_AOO_INVIO,
      @dbuser@.VardescribeInvio(ap.id_profile,cg.SYSTEM_ID,'VAR_CODICE_AMM')as VAR_CODICE_AMM_INVIO,
      @dbuser@.VardescribeInvio(ap.id_profile,cg.SYSTEM_ID,'DTA_SPEDIZIONE') as DTA_SPEDIZIONE,
      @dbuser@.VardescribeInvio(ap.id_profile,cg.SYSTEM_ID,'VAR_PROTO_DEST') as VAR_PROTO_DEST,
      @dbuser@.VardescribeInvio(ap.id_profile,cg.SYSTEM_ID,'DTA_PROTO_DEST') as DTA_PROTO_DEST,
      @dbuser@.VardescribeInvio(ap.id_profile,cg.SYSTEM_ID,'ID_CORR_GLOBALE') as  ID_CORR_GLOBALE,
      @dbuser@.VardescribeInvio(ap.id_profile,cg.SYSTEM_ID,'ID_DOCUMENTTYPE') as ID_DOCUMENTTYPE,
      @dbuser@.VardescribeInvio(ap.id_profile,cg.SYSTEM_ID,'CHA_ANNULLATO') as CHA_ANNULLATO,
      @dbuser@.VardescribeInvio(ap.id_profile,cg.SYSTEM_ID,'VAR_MOTIVO_ANNULLA') as  VAR_MOTIVO_ANNULLA,
      @dbuser@.VardescribeInvio(ap.id_profile,cg.SYSTEM_ID,'VAR_PROVVEDIMENTO') as  VAR_PROVVEDIMENTO,
      @dbuser@.VardescribeInvio(ap.id_profile,cg.SYSTEM_ID,'SYSTEM_ID') as  SYSTEM_ID_INVIO,
      C.CHA_NOTIFICA, C.CHA_NOTIFICA_CON_ALLEGATO
      from dpa_doc_arrivo_par ap
      left join dpa_corr_globali cg on ap.id_mitt_dest = cg.system_id
      left join documenttypes dt on ap.id_documenttypes = dt.system_id
      left join people c on cg.id_people = c.system_id
      where ap.id_profile = @system_id@
      order by ap.system_id asc
    </value>
  </query>
  <query>
    <name>S_DOC_INARCHIVIO</name>
    <value>SELECT CHA_IN_ARCHIVIO FROM PROFILE WITH(NOLOCK) WHERE DOCNUMBER = @ID_DOC@</value>
  </query>
  <query>
    <name>S_DPACorrGlobali_byMail_Descrizone</name>
    <value>
      SELECT
      A.SYSTEM_ID,
      CHA_TIPO_URP,
      ID_GRUPPO,
      ID_PEOPLE,
      CHA_TIPO_IE,
      A.CHA_TIPO_CORR
      FROM DPA_CORR_GLOBALI A, DPA_MAIL_CORR_ESTERNI M
      WHERE A.SYSTEM_ID = M.ID_CORR AND
      M.VAR_EMAIL= @mail@
      AND (VAR_DESC_CORR_OLD = '@descrizione@' @descrizioneRC@)
      AND (ID_AMM= @idamm@
      OR id_amm is null)
      AND (
      ((id_registro is null
      or id_registro = @id_reg@) and CHA_TIPO_IE='E')
      OR
      ((id_registro is null
      or id_registro != @id_reg@) and CHA_TIPO_IE='I')
      )
      AND DTA_FINE IS NULL
    </value>
  </query>
  <query>
    <name>S_GET_CORRISPONDENTI_BY_EMAIL</name>
    <value>
      SELECT  a.system_id,
      a.var_cod_rubrica,
      a.cha_tipo_urp,
      a.id_gruppo,
      a.id_people,
      a.cha_tipo_ie,
      a.cha_tipo_corr,
      a.var_codice_amm,
      a.var_codice_aoo
      FROM    dpa_corr_globali a
      WHERE
      (a.var_email = '@email@' AND
      a.CHA_TIPO_IE = 'I')
      AND (id_amm = @idAmministrazione@ OR id_amm IS NULL)
      AND (id_registro IS NULL OR id_registro =  @idRegistro@)
      AND dta_fine IS NULL
      union
      SELECT  a.system_id,
      a.var_cod_rubrica,
      a.cha_tipo_urp,
      a.id_gruppo,
      a.id_people,
      a.cha_tipo_ie,
      a.cha_tipo_corr,
      a.var_codice_amm,
      a.var_codice_aoo
      FROM    dpa_corr_globali a, dpa_mail_corr_esterni m where
      a.system_id = m.id_corr AND
      m.var_email = '@email@'
      AND (id_amm = @idAmministrazione@ OR id_amm IS NULL)
      AND (id_registro IS NULL OR id_registro =  @idRegistro@)
      AND dta_fine IS NULL
    </value>
  </query>
  <query>
    <name>S_ISCORRISPONDENTEINTERNO</name>
    <value>
      SELECT @dbuser@.iscorrispondenteinterno(@idcorrglobali@,@idregistro@) as risultato
    </value>
  </query>
  <query>
    <name>GET_BASE_INFO_DOC</name>
    <value>
      SELECT  p.ID_DOCUMENTO_PRINCIPALE,
      p.DOCNAME,
      p.VAR_PROF_OGGETTO,
      p.CHA_TIPO_PROTO,
      c.FILE_SIZE,
      c.PATH,
      c.VAR_NOMEORIGINALE,
      v.VERSION_LABEL,
      v.VERSION,
      v.VERSION_ID,
      p.DOCNUMBER,
      p.SYSTEM_ID
      FROM profile p WITH(NOLOCK), components c, versions v
      WHERE
      p.DOCNUMBER = c.DOCNUMBER
      AND
      c.DOCNUMBER
      IN
      (
      SELECT doc.DOCNUMBER
      FROM profile doc WITH(NOLOCK)
      WHERE doc.ID_DOCUMENTO_PRINCIPALE = @idProfile@
      OR doc.DOCNUMBER = @docNumber@
      )
      AND c.VERSION_ID = v.VERSION_ID
      ORDER BY c.VERSION_ID ASC
    </value>
  </query>
  <query>
    <name>PD_GET_RUOLI_OGG_CUSTOM_FASC</name>
    <value>
      SELECT ID_RUOLO
      FROM DPA_A_R_OGG_CUSTOM_FASC A, DPA_CORR_GLOBALI B
      WHERE A.ID_OGGETTO_CUSTOM = @idOggCustom@
      AND A.INS_MOD = 1
      AND A.ID_RUOLO = B.ID_GRUPPO
    </value>
  </query>
  <query>
    <name>PD_DELETE_ASS_RUOLO_OGGETTO_CUSTOM_FASC</name>
    <value>
      DELETE FROM DPA_A_R_OGG_CUSTOM_FASC
      WHERE
      ID_OGGETTO_CUSTOM = @idOggettoCustom@
    </value>
  </query>
  <query>
    <name>PD_INSERT_ASS_RUOLO_OGG_CUSTOM_FASC</name>
    <value>
      INSERT INTO DPA_A_R_OGG_CUSTOM_FASC
      (
      @colID@
      ID_OGGETTO_CUSTOM,
      ID_RUOLO,
      INS_MOD
      )
      VALUES
      (
      @id@
      @idOggettoCustom@,
      @idRuolo@,
      @inserimento@
      )
    </value>
  </query>
  <query>
    <name>PD_GET_A_R_CAMPI_DOC</name>
    <value>
      SELECT * FROM DPA_A_R_OGG_CUSTOM_DOC WHERE ID_RUOLO = @idRuolo@ and ID_TEMPLATE = @idTemplate@
    </value>
  </query>
  <query>
    <name>PD_DEL_A_R_CAMPI_DOC</name>
    <value>
      DELETE DPA_A_R_OGG_CUSTOM_DOC WHERE ID_TEMPLATE = @idTemplate@ and ID_OGGETTO_CUSTOM = @idOggettoCustom@
    </value>
  </query>
  <query>
    <name>PD_INS_A_R_CAMPI_DOC</name>
    <value>
      INSERT INTO DPA_A_R_OGG_CUSTOM_DOC
      (
      @colID@
      ID_TEMPLATE,
      ID_OGGETTO_CUSTOM,
      ID_RUOLO,
      INS_MOD,
      VIS,
      DEL_REP
      )
      VALUES
      (
      @id@
      @idTemplate@,
      @idOggettoCustom@,
      @idRuolo@,
      @inserimento@,
      @visibilita@,
      @delRep@
      )
    </value>
  </query>
  <query>
    <name>PD_UPDATE_A_R_CAMPI_DOC</name>
    <value>
      UPDATE DPA_A_R_OGG_CUSTOM_DOC SET INS_MOD = @insMod@, VIS = @vis@, DEL_REP = @delRep@ WHERE ID_RUOLO = @idRuolo@ and ID_TEMPLATE = @idTemplate@ and ID_OGGETTO_CUSTOM = @idOggettoCustom@
    </value>
  </query>
  <query>
    <name>PD_GET_A_R_CAMPO_DOC</name>
    <value>
      SELECT * FROM DPA_A_R_OGG_CUSTOM_DOC WHERE ID_TEMPLATE = @idTemplate@ and ID_OGGETTO_CUSTOM = @idOggettoCustom@ and ID_RUOLO = @idRuolo@
    </value>
  </query>
  <query>
    <name>PD_GET_A_R_CAMPI_FASC</name>
    <value>
      SELECT * FROM DPA_A_R_OGG_CUSTOM_FASC WHERE ID_RUOLO = @idRuolo@ and ID_TEMPLATE = @idTemplate@
    </value>
  </query>
  <query>
    <name>PD_DEL_A_R_CAMPI_FASC</name>
    <value>
      DELETE DPA_A_R_OGG_CUSTOM_FASC WHERE ID_TEMPLATE = @idTemplate@ and ID_OGGETTO_CUSTOM = @idOggettoCustom@
    </value>
  </query>
  <query>
    <name>PD_INS_A_R_CAMPI_FASC</name>
    <value>
      INSERT INTO DPA_A_R_OGG_CUSTOM_FASC
      (
      @colID@
      ID_TEMPLATE,
      ID_OGGETTO_CUSTOM,
      ID_RUOLO,
      INS_MOD,
      VIS
      )
      VALUES
      (
      @id@
      @idTemplate@,
      @idOggettoCustom@,
      @idRuolo@,
      @inserimento@,
      @visibilita@
      )
    </value>
  </query>
  <query>
    <name>PD_UPDATE_A_R_CAMPI_FASC</name>
    <value>
      UPDATE DPA_A_R_OGG_CUSTOM_FASC SET INS_MOD = @insMod@, VIS = @vis@ WHERE ID_RUOLO = @idRuolo@ and ID_TEMPLATE = @idTemplate@ and ID_OGGETTO_CUSTOM = @idOggettoCustom@
    </value>
  </query>
  <query>
    <name>PD_GET_A_R_CAMPO_FASC</name>
    <value>
      SELECT * FROM DPA_A_R_OGG_CUSTOM_FASC WHERE ID_TEMPLATE = @idTemplate@ and ID_OGGETTO_CUSTOM = @idOggettoCustom@ and ID_RUOLO = @idRuolo@
    </value>
  </query>
  <query>
    <name>PD_GET_A_R_RUOLI_FROM_OGG_CUSTOM_DOC</name>
    <value>
      SELECT * FROM DPA_A_R_OGG_CUSTOM_DOC WHERE ID_TEMPLATE = @idTemplate@ and ID_OGGETTO_CUSTOM = @idOggettoCustom@
    </value>
  </query>
  <query>
    <name>PD_GET_A_R_RUOLI_FROM_OGG_CUSTOM_FASC</name>
    <value>
      SELECT * FROM DPA_A_R_OGG_CUSTOM_FASC WHERE ID_TEMPLATE = @idTemplate@ and ID_OGGETTO_CUSTOM = @idOggettoCustom@
    </value>
  </query>
  <query>
    <name>S_DPA_SALVA_RICERCHE_COUNT_NAME</name>
    <value>
      select count(*)
      from DPA_SALVA_RICERCHE
      where VAR_DESCRIZIONE = '@param1@'
      and (id_people = @idPeople@ or id_gruppo = @idGruppo@)
      and var_pagina_ric = '@pagina@'
    </value>
  </query>
  <query>
    <name>AMM_D_DELETE_RF_CORR_GLOBALI</name>
    <value>
      DELETE DPA_CORR_GLOBALI WHERE ID_RF = @idRF@
    </value>
  </query>
  <query>
    <name>S_DOC_IN_ADL</name>
    <value>
      SELECT DISTINCT(SYSTEM_ID) FROM DPA_AREA_LAVORO
      WHERE ID_PROFILE = @idDoc@
      AND ID_PEOPLE = @idPeople@
    </value>
  </query>
  <query>
    <name>U_DPACorrGlobaliStor</name>
    <value>
      UPDATE DPA_CORR_GLOBALI
      SET dta_fine = @param1@,
      var_cod_rubrica = @param2@,
      var_codice = @param3@,
      id_parent = NULL
      WHERE SYSTEM_ID = @param4@
    </value>
  </query>
  <query>
    <name>U_DPACorrGlobaliReset</name>
    <value>
      UPDATE DPA_CORR_GLOBALI
      SET var_insert_by_interop = @param1@
      WHERE SYSTEM_ID = @param2@
    </value>
  </query>
  <query>
    <name>U_DPACorrGlobaliResetCodRubrica</name>
    <value>
      UPDATE DPA_CORR_GLOBALI
      SET var_cod_rubrica = '@param1@'
      WHERE SYSTEM_ID = @param2@
    </value>
  </query>
  <query>
    <name>ESTRAZIONE_IDPEOPLEGROUP</name>
    <value>
      SELECT CHA_TIPO_URP,
      isnull(id_gruppo,id_people)AS idPeopleGroup
      FROM DPA_CORR_GLOBALI WHERE SYSTEM_ID=@idCorr@
    </value>
  </query>
  <query>
    <name>ESTRAZIONE_IDPEOPLEGROUP</name>
    <value>
      SELECT CHA_TIPO_URP,
      isNull(id_gruppo,id_people)AS idPeopleGroup
      FROM DPA_CORR_GLOBALI WHERE SYSTEM_ID=@idCorr@
    </value>
  </query>
  <query>
    <name>MT_GET_MODELLI_PER_TRASM_AUTORIZZATI</name>
    <value>
      select *
      from dpa_modelli_trasm  mod
      where
      mod.id_amm = @idAmm@
      @paramRegistri@
      and
      mod.single = '1'
      and
      mod.cha_tipo_oggetto = '@cha_tipo_oggetto@'
      and
      not exists (select DPA_ASS_DIAGRAMMI.id_mod_trasm FROM DPA_ASS_DIAGRAMMI where mod.system_id=DPA_ASS_DIAGRAMMI.id_mod_trasm)
      @paramautorizzato@
      ORDER BY mod.NOME
    </value>
  </query>
  <query>
    <name>MT_GET_MODELLI_PER_TRASM_AUTORIZZATI_1</name>
    <value>
      select mod.*
      from dpa_modelli_trasm  mod, dpa_modelli_mitt_dest  mittDest
      where
      mod.system_id = mittDest.id_modello
      and
      (mod.id_people = @idPeople@ or mod.id_people is null)
      and
      ( mittDest.id_corr_globali =0 or mittDest.id_corr_globali = @idCorrGlobali@)
      and
      mittDest.CHA_TIPO_MITT_DEST = 'M'
      and
      mod.id_amm = @idAmm@
      @paramRegistri@
      and
      mod.single = '0'
      and
      mod.cha_tipo_oggetto = '@cha_tipo_oggetto@'
      and
      not exists (select DPA_ASS_DIAGRAMMI.id_mod_trasm FROM DPA_ASS_DIAGRAMMI where mod.system_id=DPA_ASS_DIAGRAMMI.id_mod_trasm)
      @paramautorizzato@
      ORDER BY mod.NOME
    </value>
  </query>
  <query>
    <name>MT_GET_MODELLI_PER_TRASM_AUTORIZZATI_2</name>
    <value>
      select *
      from dpa_modelli_trasm  mod
      where
      mod.id_amm = @idAmm@
      @paramRegistri@
      and
      mod.single = '1'
      and
      mod.cha_tipo_oggetto = '@cha_tipo_oggetto@'
      and
      exists (select DPA_ASS_DIAGRAMMI.id_mod_trasm FROM DPA_ASS_DIAGRAMMI where mod.system_id=DPA_ASS_DIAGRAMMI.id_mod_trasm
      and
      @tipoAssDiagramma@
      @paramautorizzato@
      @condizione@
      ORDER BY mod.NOME
    </value>
  </query>
  <query>
    <name>MT_GET_MODELLI_PER_TRASM_AUTORIZZATI_3</name>
    <value>
      select mod.*
      from dpa_modelli_trasm  mod, dpa_modelli_mitt_dest  mittDest
      where
      mod.system_id = mittDest.id_modello
      and
      (mod.id_people = @idPeople@ or mittDest.id_corr_globali = @idCorrGlobali@)
      and
      mittDest.CHA_TIPO_MITT_DEST = 'M'
      and
      mod.id_amm = @idAmm@
      @paramRegistri@
      and
      mod.single = '0'
      and
      mod.cha_tipo_oggetto = '@cha_tipo_oggetto@'
      and
      exists (select DPA_ASS_DIAGRAMMI.id_mod_trasm FROM DPA_ASS_DIAGRAMMI where mod.system_id=DPA_ASS_DIAGRAMMI.id_mod_trasm
      and
      @tipoAssDiagramma@
      @paramautorizzato@
      @condizione@
      ORDER BY mod.NOME
    </value>
  </query>
  <query>
    <name>S_J_PROFILESTAMPAREG__SECURITY__OGGETTARIO2</name>
    <value>
      SELECT /*+ NO_INDEX(A INDX_PROFILE41) */ DISTINCT @param1@
      FROM PROFILE A WITH(NOLOCK),DPA_STAMPAREGISTRI R
      @param2@
      WHERE
      (@dbUser@.checkSecurityDocumento(A.SYSTEM_ID, @idPeople@, @idGruppo@, @idRuoloPubblico@, 'D') > 0)
      @param3@
    </value>
  </query>
  <query>
    <name>S_J_PROFILESTAMPAREG__DPA_OGGETTARIO4</name>
    <value>
      SELECT /*+ NO_INDEX(A INDX_PROFILE41) */ DISTINCT @param1@
      FROM PROFILE A WITH(NOLOCK),DPA_STAMPAREGISTRI R
      @param2@
      WHERE @param3@
    </value>
  </query>
  <query>
    <name>S_DPA_ELENCO_NOTE</name>
    <value>
      SELECT *
      FROM DPA_ELENCO_NOTE
      @param1@
      order by id_reg_rf, var_desc_nota
    </value>
  </query>
  <query>
    <name>S_GET_NOTA_DA_ELENCO</name>
    <value>
      SELECT SYSTEM_ID,
      ID_REG_RF,
      COD_REG_RF,
      VAR_DESC_NOTA
      FROM DPA_ELENCO_NOTE
      WHERE SYSTEM_ID = @id@
    </value>
  </query>
  <query>
    <name>I_DPA_ELENCO_NOTE</name>
    <value>
      INSERT INTO DPA_ELENCO_NOTE
      (
      @colID@
      ID_REG_RF,
      VAR_DESC_NOTA,
      COD_REG_RF
      ) VALUES (
      @id@
      @param1@
      )
    </value>
  </query>
  <query>
    <name>U_DPA_ELENCO_NOTE</name>
    <value>
      UPDATE DPA_ELENCO_NOTE
      SET ID_REG_RF = @idRegRf@, VAR_DESC_NOTA = '@varDescNota@', COD_REG_RF = '@codRegRf@'
      WHERE SYSTEM_ID = @system_id@
    </value>
  </query>
  <query>
    <name>D_DPA_ELENCO_NOTE</name>
    <value>
      DELETE FROM DPA_ELENCO_NOTE
      WHERE SYSTEM_ID = @idNota@
    </value>
  </query>
  <query>
    <name>S_COUNT_DPA_ELENCO_NOTE</name>
    <value>
      SELECT count(*)
      FROM DPA_ELENCO_NOTE
      @param1@
    </value>
  </query>
  <query>
    <name>S_NOTA_PRESENTE_IN_ELENCO</name>
    <value>
      SELECT count(*)
      FROM DPA_ELENCO_NOTE
      where ID_REG_RF = @idRegRf@ and VAR_DESC_NOTA = '@desc@' and COD_REG_RF = '@codRegRf@'
    </value>
  </query>
  <query>
    <name>S_SYSTEM_ID_DPA_EL_REGISTRI</name>
    <value>
      select system_id from dpa_el_registri where var_codice = '@var_codice@'
    </value>
  </query>
  <query>
    <name>S_LETTERE_DOCUMENTI</name>
    <value>
      SELECT *
      FROM DPA_LETTERE_DOCUMENTI WITH(NOLOCK)
    </value>
  </query>
  <query>
    <name>S_LETTERE_DOCUMENTI_ASS</name>
    <value>
      SELECT *
      FROM DPA_ASS_LETTERE_DOCUMENTI ALD WITH(NOLOCK)
      INNER JOIN DPA_LETTERE_DOCUMENTI LD WITH(NOLOCK) ON ALD.ID_LETTERADOC = LD.SYSTEM_ID
      WHERE ID_AMM = '@idAmministrazione@' ORDER BY ID_LETTERADOC
    </value>
  </query>
  <query>
    <name>S_LETTERE_DOCUMENTI_AMMIN</name>
    <value>
      SELECT *
      FROM DPA_ASS_LETTERE_DOCUMENTI
      WHERE ID_AMM = '@idAmministrazione@' ORDER BY ID_LETTERADOC
    </value>
  </query>
  <query>
    <name>UPDATE_LETTERE_DOCUMENTI_AMMIN</name>
    <value>
      UPDATE DPA_ASS_LETTERE_DOCUMENTI SET DESCRIZIONE='@descrizione@', etichetta = '@etichetta@' WHERE ID_LETTERADOC='@letteradoc@' AND ID_AMM='@idAmministrazione@'
    </value>
  </query>
  <query>
    <name>INSERT_LETTERE_DOCUMENTI_AMMIN</name>
    <value>
      INSERT INTO DPA_ASS_LETTERE_DOCUMENTI VALUES('@idAmministrazione@','@letteradoc@','@descrizione@','@etichetta@')
    </value>
  </query>
  <query>
    <name>SET_DETTAGLI_ALL_TODOLIST</name>
    <value>BEGIN SP_DPA_COUNT_TODOLIST(@IDPEOPLE@,@IDGRUPPO@,'@TIMESTAMP@'); END;</value>
  </query>
  <query>
    <name>SET_DETTAGLI_ALL_TODOLIST_NO_REG</name>
    <value>BEGIN SP_DPA_COUNT_TODOLIST_NO_REG(@IDPEOPLE@,@IDGRUPPO@,'@TIMESTAMP@'); END;</value>
  </query>
  <query>
    <name>GET_DETTAGLI_ALL_TODOLIST</name>
    <value>
      SELECT TOT_DOC, TOT_DOC_NO_LETTI, TOT_DOC_NO_ACCETTATI, TOT_FASC, TOT_FASC_NO_LETTI, TOT_FASC_NO_ACCETTATI, TOT_DOC_PREDISPOSTI
      FROM DPA_COUNT_TODOLIST WHERE ID_PEOPLE=@IDPEOPLE@ AND TS_STAMPA=CONVERT(DATETIME, '@TIMESTAMP@', 103)
    </value>
  </query>
  <query>
    <name>S_GET_SOTTO_FASCICOLI</name>
    <value>
      select system_id from project a where id_fascicolo in
      (select system_id from project a where system_id = @system_id@ and cha_tipo_proj='F' and cha_tipo_fascicolo='P')
      and id_fascicolo &lt;&gt; id_parent
    </value>
  </query>
  <query>
    <name>S_IDRF_DPA_CORR_GLOBALI</name>
    <value>
      select a.system_id, a.dta_fine from dpa_corr_globali a, dpa_el_registri b
      where b.ID_AOO_COLLEGATA = @idRegistro@
      and b.SYSTEM_ID = a.ID_RF
      and b.CHA_RF = 1
    </value>
  </query>
  <query>
    <name>U_IDRF_DPA_CORR_GLOBALI</name>
    <value>
      Update DPA_CORR_GLOBALI set DTA_FINE = @param1@
      where system_id = @param2@
    </value>
  </query>
  <query>
    <name>S_DOCUMENTI_INFASCICOLO_Scarto</name>
    <value>
      SELECT  DISTINCT A.SYSTEM_ID,
      A.DOCNUMBER, A.DOCNAME, A.STATUS, A.DOCSERVER_LOC, A.PATH,
      @param1@ AS CREATION_DATE,
      A.ID_REGISTRO, A.CHA_TIPO_PROTO, A.ID_OGGETTO, A.NUM_PROTO,
      A.NUM_ANNO_PROTO, A.VAR_PROTO_EME, A.DTA_PROTO_EME,
      A.VAR_COGNOME_EME, A.VAR_NOME_EME, A.ID_PARENT, A.DTA_PROTO,
      A.CHA_MOD_OGGETTO, A.CHA_MOD_MITT_DEST, A.CHA_MOD_MITT_INT,
      A.CHA_MOD_DEST_OCC, A.DTA_PROTO_IN, A.VAR_PROTO_IN,
      A.ID_ANNULLATORE, A.DTA_ANNULLA, A.VAR_AUT_ANNULLA,
      A.VAR_SEGNATURA,
      A.CHA_INVIO_CONFERMA,
      A.ID_TIPO_ATTO, A.CHA_PRIVATO, A.CHA_PERSONALE, A.CHA_EVIDENZA, A.VAR_PROF_OGGETTO AS VAR_DESC_OGGETTO, B.PROJECT_ID, B.LINK, B.TYPE,
      D.TYPE_ID, D.DESCRIPTION, docsadm.getchaimg(A.DOCNUMBER) AS CHA_IMG , getInADL(A.SYSTEM_ID,'D',@param3@,@param4@) AS IN_ADL,
      (CASE
      WHEN a.num_proto IS NULL
      THEN creation_date
      ELSE dta_proto
      END
      ) AS dta_protocollo_new,
      (select 	MAX(FC.DATA_ARCHIVIAZIONE)
      from 	DPA_FASCICOLAZIONE_CARTACEA FC
      where 	FC.ID_DOCUMENT = A.SYSTEM_ID) AS DATA_ARCHIVIAZIONE,
      ID_DOCUMENTO_PRINCIPALE
      FROM PROFILE A WITH(NOLOCK), PROJECT_COMPONENTS B, DOCUMENTTYPES D @param6@
      WHERE B.TYPE = 'D' AND A.DOCUMENTTYPE=D.SYSTEM_ID
      AND A.SYSTEM_ID=B.LINK AND B.PROJECT_ID= @param2@ and
      isnull(CHA_IN_CESTINO,'0')='0'
      and a.cha_in_archivio = '1'
      ORDER BY A.NUM_ANNO_PROTO DESC, A.NUM_PROTO DESC, A.DOCNUMBER DESC
    </value>
  </query>
  <query>
    <name>S_GET_ID_DOCUMENTI_IN_FASCICOLO</name>
    <value>
      SELECT link AS ID_DOC
      FROM PROJECT_COMPONENTS
      WHERE project_id IN
      (
      SELECT system_id
      FROM project
      WHERE id_fascicolo = (SELECT system_id FROM project WHERE VAR_CODICE = '@codiceFascicolo@')
      AND cha_tipo_proj = 'C'
      )
    </value>
  </query>
  <query>
    <name>S_J_PROJECT_NO_SECURITY</name>
    <value>
      SELECT DISTINCT A.*
      FROM PROJECT A
      WHERE A.ID_FASCICOLO=@param1@
      ORDER BY DESCRIPTION ASC
    </value>
  </query>
  <query>
    <name>U_DPATrasmUtente_archivio</name>
    <value>
      update dpa_trasm_utente set cha_in_todolist = '0' where id_trasm_singola in
      (select system_id from dpa_trasm_singola where id_trasmissione in
      (select system_id from dpa_trasmissione where id_project = @id_project@))
    </value>
  </query>
  <query>
    <name>S_SECURITY__DPA_CORR_GLOBALI__CESSIONE</name>
    <value>
      SELECT S.ACCESSRIGHTS, S.CHA_TIPO_DIRITTO, C.VAR_COD_RUBRICA FROM SECURITY as S  WITH (nolock) , DPA_CORR_GLOBALI C WHERE S.THING=@param1@ AND S.PERSONORGROUP=C.ID_PEOPLE
    </value>
  </query>
  <query>
    <name>PD_GET_CONTATORE_FASC</name>
    <value>
      SELECT count(PROJECT.SYSTEM_ID) As Contatore
      FROM PROJECT
      WHERE PROJECT.ID_AMM = @idAmministrazione@ AND
      PROJECT.ID_TIPO_FASC = @idTipoFasc@
    </value>
  </query>
  <query>
    <name>S_DPARegistriAOO1</name>
    <value>
      SELECT
      ID_UTENTEAOO,
      ID_RUOLOAOO,
      FROM DPA_EL_REGISTRI
      WHERE VAR_CODICE = @param1@
    </value>
  </query>
  <query>
    <name>S_COUNT_FASCICOLI_SCARTO</name>
    <value>
      SELECT count(*)
      FROM project a
      WHERE
      @dbuser@.checkSecurity(a.system_id,@idPeo@,@idGrp@, @idRuoloPubblico@,'F') > 0
      AND (a.id_amm IS NULL OR a.id_amm = @idAmm@ )
      AND a.cha_tipo_proj = 'F'
      and id_parent = @idParent@ and cha_stato = 'C' and cha_tipo_fascicolo='P' and cha_in_archivio = '1'
    </value>
  </query>
  <query>
    <name>S_FASCICOLI_SCARTO_PAGING</name>
    <value>
      SELECT  *
      FROM (SELECT
      a.system_id, a.description, a.cha_tipo_proj, a.var_codice,
      a.NUM_MESI_CONSERVAZIONE,
      a.id_amm, a.num_livello,a.cha_tipo_fascicolo, a.id_fascicolo,
      a.id_parent,a.var_cod_ultimo,a.var_note,@dtaAp@ AS dta_apertura,
      @dtaCh@ AS dta_chiusura,a.cha_stato, a.id_tipo_proc, a.id_registro ,
      @dbuser@.getcodreg(a.id_registro) as codReg,a.id_uo_lf,A.DTA_UO_LF,
      a.dta_creazione, a.cartaceo,a.cha_privato,a.ID_UO_REF,
      @dbuser@.getAccessRightsProject(@idGrp@,@idPeo@,@idRuoloPubblico@,a.system_id) as accessrights,
      @dbuser@.getCodtit(a.id_parent) as codTit,
      convert(nvarchar (10), a.dta_scadenza, 103) AS DTA_SCAD_CHAR,
      @dbuser@.getInScarto(null, a.system_id,@idPeo@, @idGrp@) AS IN_SCARTO
      FROM project a
      WHERE
      @dbuser@.checkSecurity(a.system_id,@idPeo@,@idGrp@, @idRuoloPubblico@,'F') > 0
      AND (a.id_amm IS NULL OR a.id_amm = @idAmm@)
      AND a.cha_tipo_proj = 'F'
      and @idParent@ cha_stato = 'C' and cha_tipo_fascicolo='P' and cha_in_archivio = '1'
      and month between GETDATE() and a.dta_chiusura > a.NUM_MESI_CONSERVAZIONE
      and @dbuser@.getInScarto(null, a.system_id,@idPeo@, @idGrp@) = '0'
      order by a.dta_creazione desc )
    </value>
  </query>
  <query>
    <name>S_DPAAreaScarto</name>
    <value>
      SELECT DISTINCT DPA_AREA_SCARTO.SYSTEM_ID FROM DPA_AREA_SCARTO WHERE
      DPA_AREA_SCARTO.ID_PEOPLE=@idPeople@ AND
      DPA_AREA_SCARTO.ID_RUOLO_IN_UO = (SELECT DPA_CORR_GLOBALI.SYSTEM_ID FROM DPA_CORR_GLOBALI WHERE DPA_CORR_GLOBALI.ID_GRUPPO = @idGruppo@)
      AND DPA_AREA_SCARTO.CHA_STATO='N'
    </value>
  </query>
  <query>

    <name>D_DPAItemsScarto</name>
    <value>
      DELETE FROM DPA_ITEMS_SCARTO WHERE
      @param@
    </value>
  </query>
  <query>
    <name>U_DPAAreaScarto</name>
    <value>
      UPDATE DPA_AREA_SCARTO SET VAR_DESCRIZIONE = '@desc@', VAR_NOTE = '@note@', CHA_STATO = '@stato@'
      WHERE SYSTEM_ID = @sysId@
    </value>
  </query>
  <query>
    <name>U_CambiaStatoScarto</name>
    <value>
      UPDATE DPA_AREA_SCARTO SET CHA_STATO = @stato@
      WHERE SYSTEM_ID = @sysId@
    </value>
  </query>
  <query>
    <name>D_DPAAreaScarto</name>
    <value>
      DELETE FROM DPA_AREA_SCARTO WHERE
      SYSTEM_ID=@idIstanza@
    </value>
  </query>
  <query>
    <name>S_GET_LISTA_SCARTO</name>
    <value>
      SELECT
      SYSTEM_ID, ID_AMM, ID_PEOPLE, ID_RUOLO_IN_UO, CHA_STATO, VAR_NOTE, VAR_DESCRIZIONE, DATA_APERTURA, @dtasc@ AS DATA_SCARTO, VAR_ESTREMI_RICHIESTA, VAR_ESTREMI_AUTORIZ
      FROM DPA_AREA_SCARTO
      WHERE ID_PEOPLE = @idPeople@ AND ID_RUOLO_IN_UO = (SELECT DPA_CORR_GLOBALI.SYSTEM_ID FROM DPA_CORR_GLOBALI WHERE DPA_CORR_GLOBALI.ID_GRUPPO = @idRuoloInUO@)
    </value>
  </query>
  <query>
    <name>S_GET_FASC_IN_ISTANZA</name>
    <value>
      select a.system_id, a.description, a.cha_tipo_proj, a.var_codice,
      a.id_amm, a.num_livello,a.cha_tipo_fascicolo, a.id_fascicolo,
      a.NUM_MESI_CONSERVAZIONE,
      a.id_parent,a.var_cod_ultimo,a.var_note,@dtaAp@ AS dta_apertura,
      @dtaCh@ AS dta_chiusura,a.cha_stato, a.id_tipo_proc, a.id_registro ,
      getcodreg(a.id_registro) as codReg,a.id_uo_lf,A.DTA_UO_LF,
      a.dta_creazione, a.cartaceo,a.cha_privato,a.ID_UO_REF,
      getAccessRightsProject(@idGrp@,@idPeo@, @idRuoloPubblico@,a.system_id) as accessrights,
      getCodtit(a.id_parent) as codTit,
      convert(nvarchar (10), a.dta_scadenza, 103) AS DTA_SCADENZA
      from project a
      where system_id in (select DISTINCT id_project  from dpa_items_scarto where id_scarto=@idScarto@)
    </value>
  </query>
  <query>
    <name>PD_IS_IN_USE_CAMPO_COMUNE_DOC</name>
    <value>
      SELECT * FROM DPA_ASSOCIAZIONE_TEMPLATES
      WHERE
      ID_TEMPLATE &lt; &gt; @idTemplate@
      AND
      ID_OGGETTO = @idOggetto@
      AND
      DOC_NUMBER = ''
    </value>
  </query>
  <query>
    <name>PD_GET_CAMPI_COMUNI_DOC</name>
    <value>
      SELECT DPA_OGGETTI_CUSTOM.SYSTEM_ID FROM DPA_ASSOCIAZIONE_TEMPLATES, DPA_OGGETTI_CUSTOM
      WHERE
      DPA_ASSOCIAZIONE_TEMPLATES.ID_OGGETTO = DPA_OGGETTI_CUSTOM.SYSTEM_ID
      AND
      DPA_ASSOCIAZIONE_TEMPLATES.ID_TEMPLATE = @idTemplate@
      AND
      DPA_ASSOCIAZIONE_TEMPLATES.DOC_NUMBER = ''
      AND
      DPA_OGGETTI_CUSTOM.CAMPO_COMUNE = 1
    </value>
  </query>
  <query>
    <name>PD_DELETE_CAMPI_COMUNI_DOC</name>
    <value>
      DELETE DPA_ASSOCIAZIONE_TEMPLATES
      WHERE
      ID_TEMPLATE = @idTemplate@
      AND
      ID_OGGETTO = @idOggettoCustom@
      AND
      DOC_NUMBER = ''
    </value>
  </query>
  <query>
    <name>PD_UPDATE_DPA_OGG_CUSTOM_COMP</name>
    <value>
      UPDATE  DPA_OGG_CUSTOM_COMP
      SET POSIZIONE = @posizione@
      WHERE
      ID_TEMPLATE = @idTemplate@
      AND
      ID_OGG_CUSTOM = @idOggettoCustom@
    </value>
  </query>
  <query>
    <name>PD_SYSTEM_ID_OGGETTI_CUSTOM_CAMPI_COMUNI</name>
    <value>
      SELECT DISTINCT(ID_OGGETTO), DPA_OGG_CUSTOM_COMP.POSIZIONE
      FROM DPA_ASSOCIAZIONE_TEMPLATES, DPA_OGGETTI_CUSTOM, DPA_OGG_CUSTOM_COMP
      WHERE
      DPA_ASSOCIAZIONE_TEMPLATES.ID_OGGETTO = DPA_OGGETTI_CUSTOM.SYSTEM_ID
      AND
      DPA_OGGETTI_CUSTOM.SYSTEM_ID = DPA_OGG_CUSTOM_COMP.ID_OGG_CUSTOM
      AND
      DPA_OGG_CUSTOM_COMP.ID_TEMPLATE = @idTemplate@
      AND
      DPA_ASSOCIAZIONE_TEMPLATES.DOC_NUMBER = ''
      AND ID_OGGETTO IN
      (
      SELECT
      DPA_OGGETTI_CUSTOM.SYSTEM_ID
      FROM DPA_TIPO_ATTO, DPA_VIS_TIPO_DOC, DPA_OGGETTI_CUSTOM, DPA_ASSOCIAZIONE_TEMPLATES
      WHERE
      (
      (ID_AMM = @idAmm@ OR ID_AMM IS NULL)
      AND
      (In_Esercizio &lt;&gt; 'NO' OR In_Esercizio IS NULL)
      AND
      (Abilitato_SI_NO &lt;&gt; 0 OR Abilitato_SI_NO IS NULL)
      AND
      DPA_TIPO_ATTO.SYSTEM_ID = DPA_VIS_TIPO_DOC.ID_TIPO_DOC
      AND
      DPA_VIS_TIPO_DOC.ID_RUOLO = @idRuolo@
      AND
      DPA_VIS_TIPO_DOC.DIRITTI  IN (1,2)
      )
      AND DPA_TIPO_ATTO.SYSTEM_ID = DPA_ASSOCIAZIONE_TEMPLATES.ID_TEMPLATE
      AND DPA_ASSOCIAZIONE_TEMPLATES.DOC_NUMBER = ''
      AND DPA_ASSOCIAZIONE_TEMPLATES.ID_OGGETTO = DPA_OGGETTI_CUSTOM.SYSTEM_ID
      )
      ORDER BY DPA_OGG_CUSTOM_COMP.POSIZIONE
    </value>
  </query>
  <!--ADP modifica con aggiunta selezione per Sistema_Proprietario di competenza-->
  <query>
    <name>PD_GET_TEMPLATE_DOC</name>
    <value>
      SELECT
      DISTINCT(DPA_ASSOCIAZIONE_TEMPLATES.ID_OGGETTO) AS SYSTEM_ID_OGG_CUSTOM,
      DPA_TIPO_ATTO.SYSTEM_ID AS SYSTEM_ID_TIPO_ATTO,
      DPA_ASSOCIAZIONE_TEMPLATES.ID_TEMPLATE AS SYSTEM_ID_TEMPLATE,
      DPA_OGG_CUSTOM_COMP.SYSTEM_ID AS SYSTEM_ID_OGG_CUSTOM_COMP,
      DPA_TIPO_OGGETTO.SYSTEM_ID AS SYSTEM_ID_TIPO_OGGETTO,
      DPA_TIPO_ATTO.VAR_DESC_ATTO,
      DPA_TIPO_ATTO.ABILITATO_SI_NO,
      DPA_TIPO_ATTO.IN_ESERCIZIO,
      DPA_TIPO_ATTO.PATH_MOD_1,
      DPA_TIPO_ATTO.EXT_MOD_1,
      DPA_TIPO_ATTO.PATH_MOD_2,
      DPA_TIPO_ATTO.EXT_MOD_2,
      DPA_TIPO_ATTO.PATH_MOD_SU,
      DPA_TIPO_ATTO.PATH_MOD_EXC,
      DPA_TIPO_ATTO.PATH_ALL_1,
      DPA_TIPO_ATTO.GG_SCADENZA,
      DPA_TIPO_ATTO.GG_PRE_SCADENZA,
      DPA_TIPO_ATTO.CHA_PRIVATO,
      DPA_TIPO_ATTO.ID_AMM,
      DPA_TIPO_ATTO.COD_CLASS,
      DPA_TIPO_ATTO.COD_MOD_TRASM,
      DPA_TIPO_ATTO.IPERDOCUMENTO,
      DPA_TIPO_ATTO.PATH_XSD_ASSOCIATO,
      DPA_TIPO_ATTO.CHA_INVIO_CONSERVAZIONE,
      DPA_TIPO_ATTO.CHA_PROCEDIMENTALE,
      DPA_ASSOCIAZIONE_TEMPLATES.DOC_NUMBER,
      DPA_TIPO_ATTO.ID_CONTESTO_PROCEDURALE,
      (
      SELECT VALORE_OGGETTO_DB
      FROM
      DPA_ASSOCIAZIONE_TEMPLATES DPA_TD,
      DPA_OGGETTI_CUSTOM DPA_OC,
      DPA_TIPO_OGGETTO DPA_TO
      WHERE
      DPA_TD.SYSTEM_ID = DPA_ASSOCIAZIONE_TEMPLATES.SYSTEM_ID
      AND
      DPA_TD.ID_OGGETTO = DPA_OC.SYSTEM_ID
      AND
      DPA_OC.ID_TIPO_OGGETTO = DPA_TO.SYSTEM_ID
      AND
      DPA_TO.DESCRIZIONE &lt; &gt; 'CasellaDiSelezione'
      ) AS VALORE_OGGETTO_DB,
      DPA_ASSOCIAZIONE_TEMPLATES.CODICE_DB,
      DPA_ASSOCIAZIONE_TEMPLATES.MANUAL_INSERT,
      DPA_ASSOCIAZIONE_TEMPLATES.ANNO,
      DPA_ASSOCIAZIONE_TEMPLATES.ID_AOO_RF,
      DPA_ASSOCIAZIONE_TEMPLATES.VALORE_SC,
      DPA_ASSOCIAZIONE_TEMPLATES.ANNO_ACC,
      (
      SELECT DTA_INS
      FROM
      DPA_ASSOCIAZIONE_TEMPLATES DPA_TD,
      DPA_OGGETTI_CUSTOM DPA_OC,
      DPA_TIPO_OGGETTO DPA_TO
      WHERE
      DPA_TD.SYSTEM_ID = DPA_ASSOCIAZIONE_TEMPLATES.SYSTEM_ID
      AND
      DPA_TD.ID_OGGETTO = DPA_OC.SYSTEM_ID
      AND
      DPA_OC.ID_TIPO_OGGETTO = DPA_TO.SYSTEM_ID
      AND
      DPA_TO.DESCRIZIONE &lt; &gt; 'CasellaDiSelezione'
      ) AS DTA_INS,
      (
      SELECT DTA_ANNULLAMENTO
      FROM
      DPA_ASSOCIAZIONE_TEMPLATES DPA_TD,
      DPA_OGGETTI_CUSTOM DPA_OC,
      DPA_TIPO_OGGETTO DPA_TO
      WHERE
      DPA_TD.SYSTEM_ID = DPA_ASSOCIAZIONE_TEMPLATES.SYSTEM_ID
      AND
      DPA_TD.ID_OGGETTO = DPA_OC.SYSTEM_ID
      AND
      DPA_OC.ID_TIPO_OGGETTO = DPA_TO.SYSTEM_ID
      AND
      DPA_TO.DESCRIZIONE &lt; &gt; 'CasellaDiSelezione'
      ) AS DTA_ANNULLAMENTO,
      DPA_OGGETTI_CUSTOM.CAMPO_DI_RICERCA,
      DPA_OGGETTI_CUSTOM.CAMPO_OBBLIGATORIO,
      DPA_OGGETTI_CUSTOM.DESCRIZIONE,
      DPA_OGGETTI_CUSTOM.MULTILINEA,
      DPA_OGGETTI_CUSTOM.NUMERO_DI_CARATTERI,
      DPA_OGGETTI_CUSTOM.NUMERO_DI_LINEE,
      DPA_OGGETTI_CUSTOM.ORIZZONTALE_VERTICALE,
      DPA_OGGETTI_CUSTOM.RESET_ANNO,
      DPA_OGGETTI_CUSTOM.FORMATO_CONTATORE,
      DPA_OGGETTI_CUSTOM.CHA_PERMANENTE,
      DPA_OGGETTI_CUSTOM.CHA_PERMANENTE_ONNICOMPRENSIVA,
      DPA_OGGETTI_CUSTOM.RICERCA_CORR,
      DPA_OGGETTI_CUSTOM.ID_R_DEFAULT,
      DPA_OGGETTI_CUSTOM.CAMPO_COMUNE,
      DPA_OGGETTI_CUSTOM.CHA_TIPO_TAR,
      DPA_OGGETTI_CUSTOM.CONTA_DOPO,
      DPA_OGGETTI_CUSTOM.REPERTORIO,
      DPA_OGGETTI_CUSTOM.DA_VISUALIZZARE_RICERCA,
      DPA_OGGETTI_CUSTOM.FORMATO_ORA,
      DPA_OGGETTI_CUSTOM.TIPO_LINK,
      DPA_OGGETTI_CUSTOM.TIPO_OBJ_LINK,
      DPA_OGGETTI_CUSTOM.MODULO_SOTTOCONTATORE,
      DPA_OGGETTI_CUSTOM.CHA_CONSOLIDAMENTO,
      DPA_OGGETTI_CUSTOM.CHA_CONSERVAZIONE,
      DPA_OGGETTI_CUSTOM.CHA_CONS_REPERTORIO,
      DPA_OGG_CUSTOM_COMP.POSIZIONE,
      DPA_OGG_CUSTOM_COMP.CAMPO_XML_ASSOC,
      DPA_OGG_CUSTOM_COMP.OPZIONI_XML_ASSOC,
      DPA_TIPO_OGGETTO.DESCRIZIONE AS DESCRIZIONE_TIPO
      FROM DPA_TIPO_ATTO, DPA_ASSOCIAZIONE_TEMPLATES, DPA_OGGETTI_CUSTOM, DPA_OGG_CUSTOM_COMP,
      DPA_TIPO_OGGETTO --,DPA_EXT_APPS
      WHERE
      DPA_TIPO_ATTO.SYSTEM_ID = @idTemplate@
      --AND
      --(DPA_EXT_APPS.SYSTEM_ID = DPA_TIPO_ATTO.SISTEMA_PROPRIETARIO OR DPA_TIPO_ATTO.SISTEMA_PROPRIETARIO IS NULL)
      AND
      DPA_TIPO_ATTO.SYSTEM_ID = DPA_ASSOCIAZIONE_TEMPLATES.ID_TEMPLATE
      @docNumber@
      AND
      DPA_ASSOCIAZIONE_TEMPLATES.ID_OGGETTO = DPA_OGGETTI_CUSTOM.SYSTEM_ID
      AND
      DPA_OGGETTI_CUSTOM.SYSTEM_ID = DPA_OGG_CUSTOM_COMP.ID_OGG_CUSTOM
      AND
      DPA_OGGETTI_CUSTOM.ID_TIPO_OGGETTO = DPA_TIPO_OGGETTO.SYSTEM_ID
      AND
      DPA_OGG_CUSTOM_COMP.ID_TEMPLATE = @idTemplate@
      ORDER BY DPA_OGG_CUSTOM_COMP.POSIZIONE
    </value>
  </query>

  <query>
    <name>PD_GET_TEMPLATE_FASC</name>
    <value>
      SELECT
      DISTINCT(DPA_ASS_TEMPLATES_FASC.ID_OGGETTO) AS SYSTEM_ID_OGG_CUSTOM,
      DPA_TIPO_FASC.SYSTEM_ID AS SYSTEM_ID_TIPO_FASC,
      DPA_ASS_TEMPLATES_FASC.ID_TEMPLATE AS SYSTEM_ID_TEMPLATE,
      DPA_OGG_CUSTOM_COMP_FASC.SYSTEM_ID AS SYSTEM_ID_OGG_CUSTOM_COMP,
      DPA_TIPO_OGGETTO_FASC.SYSTEM_ID AS SYSTEM_ID_TIPO_OGGETTO,
      DPA_TIPO_FASC.VAR_DESC_FASC,
      DPA_TIPO_FASC.ABILITATO_SI_NO,
      DPA_TIPO_FASC.IN_ESERCIZIO,
      DPA_TIPO_FASC.PATH_MOD_1,
      DPA_TIPO_FASC.PATH_MOD_2,
      DPA_TIPO_FASC.GG_SCADENZA,
      DPA_TIPO_FASC.GG_PRE_SCADENZA,
      DPA_TIPO_FASC.CHA_PRIVATO,
      DPA_TIPO_FASC.ID_AMM,
      DPA_TIPO_FASC.IPERFASCICOLO,
      DPA_TIPO_FASC.CHA_PROCEDIMENTALE,
      DPA_ASS_TEMPLATES_FASC.ID_PROJECT,
      (
      SELECT VALORE_OGGETTO_DB
      FROM
      DPA_ASS_TEMPLATES_FASC DPA_TF,
      DPA_OGGETTI_CUSTOM_FASC DPA_OC,
      DPA_TIPO_OGGETTO_FASC DPA_TO
      WHERE
      DPA_TF.SYSTEM_ID = DPA_ASS_TEMPLATES_FASC.SYSTEM_ID
      AND
      DPA_TF.ID_OGGETTO = DPA_OC.SYSTEM_ID
      AND
      DPA_OC.ID_TIPO_OGGETTO = DPA_TO.SYSTEM_ID
      AND
      DPA_TO.DESCRIZIONE &lt; &gt; 'CasellaDiSelezione'
      ) AS VALORE_OGGETTO_DB,
      DPA_ASS_TEMPLATES_FASC.CODICE_DB,
      DPA_ASS_TEMPLATES_FASC.MANUAL_INSERT,
      DPA_ASS_TEMPLATES_FASC.ANNO,
      DPA_ASS_TEMPLATES_FASC.ID_AOO_RF,
      DPA_ASS_TEMPLATES_FASC.ANNO_ACC,
      (
      SELECT DTA_INS
      FROM
      DPA_ASS_TEMPLATES_FASC DPA_TF,
      DPA_OGGETTI_CUSTOM_FASC DPA_OC,
      DPA_TIPO_OGGETTO_FASC DPA_TO
      WHERE
      DPA_TF.SYSTEM_ID = DPA_ASS_TEMPLATES_FASC.SYSTEM_ID
      AND
      DPA_TF.ID_OGGETTO = DPA_OC.SYSTEM_ID
      AND
      DPA_OC.ID_TIPO_OGGETTO = DPA_TO.SYSTEM_ID
      AND
      DPA_TO.DESCRIZIONE &lt; &gt; 'CasellaDiSelezione'
      ) AS DTA_INS,
      DPA_OGGETTI_CUSTOM_FASC.CAMPO_DI_RICERCA,
      DPA_OGGETTI_CUSTOM_FASC.CAMPO_OBBLIGATORIO,
      DPA_OGGETTI_CUSTOM_FASC.DESCRIZIONE,
      DPA_OGGETTI_CUSTOM_FASC.MULTILINEA,
      DPA_OGGETTI_CUSTOM_FASC.NUMERO_DI_CARATTERI,
      DPA_OGGETTI_CUSTOM_FASC.NUMERO_DI_LINEE,
      DPA_OGGETTI_CUSTOM_FASC.ORIZZONTALE_VERTICALE,
      DPA_OGGETTI_CUSTOM_FASC.RESET_ANNO,
      DPA_OGGETTI_CUSTOM_FASC.FORMATO_CONTATORE,
      DPA_OGGETTI_CUSTOM_FASC.RICERCA_CORR,
      DPA_OGGETTI_CUSTOM_FASC.ID_R_DEFAULT,
      DPA_OGGETTI_CUSTOM_FASC.CAMPO_COMUNE,
      DPA_OGGETTI_CUSTOM_FASC.CHA_TIPO_TAR,
      DPA_OGGETTI_CUSTOM_FASC.CONTA_DOPO,
      DPA_OGGETTI_CUSTOM_FASC.REPERTORIO,
      DPA_OGGETTI_CUSTOM_FASC.DA_VISUALIZZARE_RICERCA,
      DPA_OGGETTI_CUSTOM_FASC.FORMATO_ORA,
      DPA_OGGETTI_CUSTOM_FASC.TIPO_LINK,
      DPA_OGGETTI_CUSTOM_FASC.TIPO_OBJ_LINK,
      DPA_OGG_CUSTOM_COMP_FASC.POSIZIONE,
      DPA_TIPO_OGGETTO_FASC.DESCRIZIONE AS DESCRIZIONE_TIPO
      FROM DPA_TIPO_FASC, DPA_ASS_TEMPLATES_FASC, DPA_OGGETTI_CUSTOM_FASC, DPA_OGG_CUSTOM_COMP_FASC, DPA_TIPO_OGGETTO_FASC
      WHERE
      DPA_TIPO_FASC.SYSTEM_ID = @idTemplate@
      AND
      DPA_TIPO_FASC.SYSTEM_ID = DPA_ASS_TEMPLATES_FASC.ID_TEMPLATE
      @idProject@
      AND
      DPA_ASS_TEMPLATES_FASC.ID_OGGETTO = DPA_OGGETTI_CUSTOM_FASC.SYSTEM_ID
      AND
      DPA_OGGETTI_CUSTOM_FASC.SYSTEM_ID = DPA_OGG_CUSTOM_COMP_FASC.ID_OGG_CUSTOM
      AND
      DPA_OGGETTI_CUSTOM_FASC.ID_TIPO_OGGETTO = DPA_TIPO_OGGETTO_FASC.SYSTEM_ID
      AND
      DPA_OGG_CUSTOM_COMP_FASC.ID_TEMPLATE = @idTemplate@
      ORDER BY DPA_OGG_CUSTOM_COMP_FASC.POSIZIONE
    </value>
  </query>
  <query>
    <name>S_CAMPI_COMUNI_DOC_FASC</name>
    <value>
      SELECT TOP @pageSize@ *
      FROM
      (
      SELECT TOP @pageSize@ *
      FROM
      (
      SELECT TOP @totalRows@ *
      FROM
      (
      SELECT
      A.SYSTEM_ID AS SYSTEM_ID,
      A.DESCRIPTION AS DESCRIPTION,
      A.CHA_TIPO_PROJ AS TIPO,
      A.VAR_CODICE AS CODICE_SEGNATURA,
      convert(nvarchar (10), A.DTA_CREAZIONE, 103) AS DATA_CREAZIONE,
      A.DTA_CREAZIONE AS DTA_ORDER
      FROM
      project a
      WHERE
      EXISTS (select 'x' from security as  e  WITH (nolock)  where a.system_id=e.thing and e.PERSONORGROUP in ( @idPeople@, @idGruppo@) and e.ACCESSRIGHTS>0)
      AND (a.id_amm IS NULL OR a.id_amm = @idAmm@ )
      AND a.cha_tipo_proj = 'F'
      @condIdRegistri@
      @condIdTitolari@
      @condProfilazioneFascicoli@
      UNION
      SELECT
      A.SYSTEM_ID AS SYSTEM_ID,
      A.VAR_PROF_OGGETTO AS DESCRIPTION,
      A.CHA_TIPO_PROTO AS TIPO,
      ISNULL(A.VAR_SEGNATURA, A.DOCNUMBER) AS CODICE_SEGNATURA,
      convert(nvarchar (10), A.CREATION_TIME, 103) AS DATA_CREAZIONE,
      A.CREATION_TIME AS DTA_ORDER
      FROM
      PROFILE a LEFT JOIN dpa_tipo_atto ta on a.id_tipo_atto = ta.system_id
      WHERE
      (@dbUser@.checkSecurityDocumento(A.SYSTEM_ID, @idPeople@, @idGruppo@, @idRuoloPubblico@,'D') > 0)
      AND
      (
      ( cha_tipo_proto in ('A','P','I') AND CHA_DA_PROTO='1' AND ID_DOCUMENTO_PRINCIPALE IS NULL )
      OR
      ( cha_tipo_proto in ('G') AND CHA_DA_PROTO='0' AND ID_DOCUMENTO_PRINCIPALE IS NOT NULL )
      OR
      ( cha_tipo_proto in ('G') AND CHA_DA_PROTO='0' AND ID_DOCUMENTO_PRINCIPALE IS NULL )
      OR
      ( cha_tipo_proto in ('P') AND CHA_DA_PROTO='0' AND ID_DOCUMENTO_PRINCIPALE IS NULL )
      OR
      ( cha_tipo_proto in ('A') AND CHA_DA_PROTO='0' AND ID_DOCUMENTO_PRINCIPALE IS NULL )
      OR
      ( cha_tipo_proto in ('I') AND CHA_DA_PROTO='0' AND ID_DOCUMENTO_PRINCIPALE IS NULL )
      )
      AND
      ISNULL(A.CHA_IN_CESTINO,'0')='0'
      @condIdRegistri@
      AND (ISNULL(A.DTA_PROTO,A.CREATION_TIME) BETWEEN  convert(datetime,'@startDateDoc@',103)  AND  convert(datetime,'@endDateDoc@',103) )
      @condProfilazioneDocumenti@
      ) AS X
      ORDER BY  X.DTA_ORDER DESC
      ) AS Y
      ORDER BY  Y.DTA_ORDER ASC
      ) AS Z
      ORDER BY  Z.DTA_ORDER DESC
    </value>
  </query>
  <query>
    <name>S_COUNT_CAMPI_COMUNI_DOC_FASC</name>
    <value>
      SELECT COUNT(*) FROM
      (
      SELECT
      A.SYSTEM_ID AS SYSTEM_ID
      FROM
      project a
      WHERE
      EXISTS (select 'x' from security as e   where a.system_id=e.thing and e.PERSONORGROUP in ( @idPeople@, @idGruppo@) and e.ACCESSRIGHTS>0)
      AND (a.id_amm IS NULL OR a.id_amm = @idAmm@ )
      AND a.cha_tipo_proj = 'F'
      @condIdRegistri@
      @condIdTitolari@
      @condProfilazioneFascicoli@
      UNION
      SELECT
      A.SYSTEM_ID AS SYSTEM_ID
      FROM
      PROFILE a LEFT JOIN dpa_tipo_atto ta on a.id_tipo_atto = ta.system_id
      WHERE
      (@dbUser@.checkSecurityDocumento(A.SYSTEM_ID, @idPeople@, @idGruppo@, @idRuoloPubblico@,'D') > 0)
      AND
      (
      ( cha_tipo_proto in ('A','P','I') AND CHA_DA_PROTO='1' AND ID_DOCUMENTO_PRINCIPALE IS NULL )
      OR
      ( cha_tipo_proto in ('G') AND CHA_DA_PROTO='0' AND ID_DOCUMENTO_PRINCIPALE IS NOT NULL )
      OR
      ( cha_tipo_proto in ('G') AND CHA_DA_PROTO='0' AND ID_DOCUMENTO_PRINCIPALE IS NULL )
      OR
      ( cha_tipo_proto in ('P') AND CHA_DA_PROTO='0' AND ID_DOCUMENTO_PRINCIPALE IS NULL )
      OR
      ( cha_tipo_proto in ('A') AND CHA_DA_PROTO='0' AND ID_DOCUMENTO_PRINCIPALE IS NULL )
      OR
      ( cha_tipo_proto in ('I') AND CHA_DA_PROTO='0' AND ID_DOCUMENTO_PRINCIPALE IS NULL )
      )
      AND
      ISNULL(A.CHA_IN_CESTINO,'0')='0'
      @condIdRegistri@
      AND (ISNULL(A.DTA_PROTO,A.CREATION_TIME) BETWEEN  convert(datetime,'@startDateDoc@',103)  AND  convert(datetime,'@endDateDoc@',103) )
      @condProfilazioneDocumenti@
      ) ALIAS_TABLE
    </value>
  </query>
  <query>
    <name>S_GET_COUNT_TRASMISSIONI_FASCICOLO</name>
    <value>
      select    count(t.system_id)
      from    dpa_trasmissione t,
      project p
      where    p.system_id=t.ID_PROJECT and
      t.id_project = @idProject@
      and t.dta_invio is not null
    </value>
  </query>
  <query>
    <name>I_DPADtaArrivo</name>
    <value>
      INSERT INTO DPA_DATA_ARRIVO_STO
      (
      @param1@
      )
      VALUES (@param2@, (select dta_arrivo from VERSIONS where DOCNUMBER=@param3@))
    </value>
  </query>
  <query>
    <name>S_STORICO_DTA_ARRIVO</name>
    <value>
      SELECT SYSTEM_ID, ID_PEOPLE, ID_GROUP,  DTA_ARRIVO, DTA_MODIFICA
      FROM DPA_DATA_ARRIVO_STO
      WHERE DOCNUMBER= @param1@ order by DTA_MODIFICA desc
    </value>
  </query>
  <query>
    <name>S_GET_CONTROLLATO_FOLDER</name>
    <value>
      select p1.CHA_CONTROLLATO from PROJECT p1, PROJECT p2
      where p1.SYSTEM_ID=p2.ID_PARENT and p2.SYSTEM_ID = @system_id@
    </value>
  </query>
  <query>
    <name>S_GET_CONTROLLATO_FASC</name>
    <value>
      select CHA_CONTROLLATO from PROJECT
      where SYSTEM_ID=@system_id@
    </value>
  </query>
  <query>
    <name>S_TRASM_UTENTE_DA_SINGOLA</name>
    <value>
      SELECT *
      FROM DPA_TRASM_UTENTE WHERE ID_TRASM_SINGOLA = @idTrasmSingola@ AND ID_PEOPLE = @idPeople@
    </value>
  </query>
  <query>
    <name>S_TRASM_TUTTE_UTENTE_DA_SINGOLA</name>
    <value>
      SELECT *
      FROM DPA_TRASM_UTENTE WHERE ID_TRASM_SINGOLA = @idTrasmSingola@
    </value>
  </query>
  <query>
    <name>S_UTENTI_RUOLO_SOTTOPOSTO</name>
    <value>
      SELECT A.SYSTEM_ID, A.FULL_NAME, B.DTA_FINE FROM PEOPLE A, PEOPLEGROUPS B WHERE B.PEOPLE_SYSTEM_ID=A.SYSTEM_ID AND B.GROUPS_SYSTEM_ID = @idRuolo@
    </value>
  </query>
  <query>
    <name>I_DPA_TIMESTAMP_DOC</name>
    <value>
      INSERT INTO DPA_TIMESTAMP_DOC
      (
      @colID@
      DOC_NUMBER,
      VERSION_ID,
      ID_PEOPLE,
      DTA_CREAZIONE,
      DTA_SCADENZA,
      NUM_SERIE,
      S_N_CERTIFICATO,
      ALG_HASH,
      SOGGETTO,
      PAESE,
      TSR_FILE
      )
      values
      (
      @id@
      @docNumber@,
      @versionId@,
      @idPeople@,
      @dataCreazione@,
      @dataScadenza@,
      '@numSerie@',
      '@snCertificato@',
      '@algHash@',
      '@soggetto@',
      '@paese@',
      null
      )
    </value>
  </query>
  <query>
    <name>S_DPA_TIMESTAMP_DOC</name>
    <value>
      SELECT *
      FROM DPA_TIMESTAMP_DOC
      WHERE
      VERSION_ID = @versionId@
      AND
      DOC_NUMBER = @docNumber@
      ORDER BY DTA_CREAZIONE DESC
    </value>
  </query>
  <query>
    <name>S_DPA_TIMESTAMP_DOC_LASTVER_LITE</name>
    <value>
      SELECT *
      FROM DPA_TIMESTAMP_DOC
      WHERE
      VERSION_ID = DOCSADM.getmaxver(@docNumber@)
      AND
      DOC_NUMBER = @docNumber@
      ORDER BY DTA_CREAZIONE DESC
    </value>
  </query>
  <query>
    <name>S_J_PROJECT_NO_SECURITY2</name>
    <value>
      SELECT /*+ INDEX (A) */
      A.SYSTEM_ID, A.DESCRIPTION, A.CHA_TIPO_PROJ, A.VAR_CODICE,
      A.ID_AMM,A.NUM_LIVELLO, A.CHA_TIPO_FASCICOLO, A.ID_FASCICOLO, A.ID_PARENT,
      A.VAR_COD_ULTIMO, DOCSADM.checksecurity(a.system_id, @param4@, @param5@, @idRuoloPubblico@, 'F') as SICUREZZA,
      @param1@ AS DTA_APERTURA,@param2@ AS DTA_CHIUSURA,
      A.CHA_STATO, A.ID_TIPO_PROC, A.VAR_NOTE, A.ID_REGISTRO,DOCSADM.getaccessrightsProject(@param4@,@param5@, @idRuoloPubblico@,A.system_id) AS ACCESSRIGHTS, A.CARTACEO, ID_TITOLARIO, A.NUM_FASCICOLO,
      A.AUTHOR, A.ID_RUOLO_CREATORE, A.ID_UO_CREATORE, DOCSADM.getFascPrimaria(@param3@, A.SYSTEM_ID) as CHA_FASC_PRIMARIA, A.CHA_CONSENTI_CLASS, a.CHA_CONSENTI_FASC, A.COD_EXT_APP
      FROM PROJECT A
      WHERE A.CHA_TIPO_PROJ = 'F'
      AND A.SYSTEM_ID IN
      (SELECT A.ID_FASCICOLO FROM PROJECT A, PROJECT_COMPONENTS B
      WHERE A.SYSTEM_ID=B.PROJECT_ID AND B.LINK=@param3@)
      ORDER BY SICUREZZA DESC, A.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>I_DPA_NOTIFICA</name>
    <value>
      INSERT INTO DPA_NOTIFICA
      (
      @var_systemid@
      ID_TIPO_NOTIFICA,
      DOCNUMBER,
      VAR_MITTENTE,
      VAR_TIPO_DESTINATARIO,
      VAR_DESTINATARIO,
      VAR_RISPOSTE,
      VAR_OGGETTO,
      VAR_GESTIONE_EMITTENTE,
      VAR_ZONA,
      VAR_GIORNO_ORA,
      VAR_IDENTIFICATIVO,
      VAR_MSGID,
      VAR_TIPO_RICEVUTA,
      VAR_CONSEGNA,
      VAR_RICEZIONE,
      VAR_ERRORE_ESTESO,
      VAR_ERRORE_RICEVUTA
      )
      VALUES
      (
      @systemid@
      @idtiponotifica@,
      @docnumber@,
      '@mittente@',
      '@tipoDestinatario@',
      '@destinatario@',
      '@risposte@',
      '@oggetto@',
      '@gestioneemittente@',
      '@zona@',
      @giorno@,
      '@identificativo@',
      '@msgid@',
      '@tiporicevuta@',
      '@consegna@',
      '@ricezione@',
      '@erroreesteso@',
      '@errorericevuta@'
      )
    </value>
  </query>
  <query>
    <name>S_VERIFICA_PRESENZA_DPA_NOTIFICA</name>
    <value>
      select * from DPA_NOTIFICA
      where
      ID_TIPO_NOTIFICA = @idtiponotifica@ AND
      DOCNUMBER = @docnumber@ AND
      VAR_MITTENTE = '@mittente@' AND
      VAR_RISPOSTE = '@risposte@' AND
      VAR_OGGETTO = '@oggetto@' AND
      VAR_GESTIONE_EMITTENTE = '@gestioneemittente@' AND
      VAR_ZONA = '@zona@' AND
      VAR_GIORNO_ORA = @giorno@ AND
      VAR_IDENTIFICATIVO = '@identificativo@' AND
      VAR_MSGID = '@msgid@' AND
      VAR_TIPO_RICEVUTA = '@tiporicevuta@' AND
      VAR_CONSEGNA = '@consegna@' AND
      VAR_RICEZIONE = '@ricezione@' AND
      VAR_ERRORE_ESTESO like  '@erroreesteso@' AND
      VAR_ERRORE_RICEVUTA = '@errorericevuta@'
    </value>
  </query>
  <query>
    <name>U_DPA_NOTIFICA</name>
    <value>
      UPDATE DPA_NOTIFICA SET
      ID_TIPO_NOTIFICA = @idtiponotifica@,
      DOCNUMBER= @docnumber@,
      VAR_MITTENTE='@mittente@',
      VAR_TIPO_DESTINATARIO ='@tipoDestinatario@',
      VAR_DESTINATARIO='@destinatario@',
      VAR_RISPOSTE='@risposte@',
      VAR_OGGETTO='@oggetto@',
      VAR_GESTIONE_EMITTENTE='@gestioneemittente@',
      VAR_ZONA='@zona@',
      VAR_GIORNO_ORA=@giorno@,
      VAR_IDENTIFICATIVO=  '@identificativo@',
      VAR_MSGID='@msgid@',
      VAR_TIPO_RICEVUTA='@tiporicevuta@',
      VAR_CONSEGNA='@consegna@',
      VAR_RICEZIONE='@ricezione@',
      VAR_ERRORE_ESTESO='@erroreesteso@',
      VAR_ERRORE_RICEVUTA ='@errorericevuta@'
      WHERE
      SYSTEM_ID = @systemid@
    </value>
  </query>
  <query>
    <name>I_DPA_TIPO_NOTIFICA</name>
    <value>
      INSERT INTO DPA_TIPO_NOTIFICA
      (
      @var_systemid@
      VAR_CODICE_NOTIFICA,
      VAR_DESCRIZIONE
      )
      VALUES
      (
      @systemid@
      '@codicenotifica@',
      '@descrizione@'
      )
    </value>
  </query>
  <query>
    <name>U_DPA_TIPO_NOTIFICA</name>
    <value>
      UPDATE DPA_TIPO_NOTIFICA SET
      VAR_CODICE_NOTIFICA = '@codicenotifica@',
      VAR_DESCRIZIONE = '@descrizione@'
      WHERE
      SYSTEM_ID = @systemid@
    </value>
  </query>
  <query>
    <name>S_DPA_TIPO_NOTIFICA_BY_CODICE</name>
    <value>
      SELECT * FROM DPA_TIPO_NOTIFICA
      WHERE VAR_CODICE_NOTIFICA = '@codicenotifica@'
    </value>
  </query>
  <query>
    <name>S_DPA_NOTIFICA</name>
    <value>
      SELECT * FROM DPA_NOTIFICA
      WHERE DOCNUMBER = @docnumber@
    </value>
  </query>
  <query>
    <name>S_DPA_TIPO_NOTIFICA_BY_SYSTEM_ID</name>
    <value>
      SELECT * FROM DPA_TIPO_NOTIFICA
      WHERE SYSTEM_ID = @systemid@
    </value>
  </query>
  <query>
    <name>D_DPA_NOTIFICA</name>
    <value>
      DELETE FROM DPA_NOTIFICA
      WHERE DOCNUMBER = @docnumber@
    </value>
  </query>
  <query>
    <name>I_Apps_No_Gen</name>
    <value>
      INSERT INTO APPS
      (

      APPLICATION,
      DESCRIPTION,
      FILING_SCHEME,
      DEFAULT_EXTENSION,
      MIME_TYPE
      ) VALUES (

      @application@,
      @description@,
      @filing_scheme@,
      @default_extension@,
      @mime_type@
      )
    </value>
  </query>
  <query>
    <name>IS_DOC_OR_FASC_IN_TODOLIST</name>
    <value>
      SELECT * FROM DPA_TODOLIST WHERE ID_PEOPLE_DEST = @idUtente@ and ID_TRASM_UTENTE = @idTrasmissione@
    </value>
  </query>
  <query>
    <name>I_DPA_NOTIFICA</name>
    <value>
      INSERT INTO DPA_NOTIFICA
      (
      @var_systemid@
      ID_TIPO_NOTIFICA,
      DOCNUMBER,
      VAR_MITTENTE,
      VAR_TIPO_DESTINATARIO,
      VAR_DESTINATARIO,
      VAR_RISPOSTE,
      VAR_OGGETTO,
      VAR_GESTIONE_EMITTENTE,
      VAR_ZONA,
      VAR_GIORNO_ORA,
      VAR_IDENTIFICATIVO,
      VAR_MSGID,
      VAR_TIPO_RICEVUTA,
      VAR_CONSEGNA,
      VAR_RICEZIONE,
      VAR_ERRORE_ESTESO,
      VAR_ERRORE_RICEVUTA
      )
      VALUES
      (
      @systemid@
      @idtiponotifica@,
      @docnumber@,
      '@mittente@',
      '@tipoDestinatario@',
      '@destinatario@',
      '@risposte@',
      '@oggetto@',
      '@gestioneemittente@',
      '@zona@',
      @giorno@,
      '@identificativo@',
      '@msgid@',
      '@tiporicevuta@',
      '@consegna@',
      '@ricezione@',
      '@erroreesteso@',
      '@errorericevuta@'
      )
    </value>
  </query>
  <query>
    <name>U_DPA_NOTIFICA</name>
    <value>
      UPDATE DPA_NOTIFICA SET
      ID_TIPO_NOTIFICA = @idtiponotifica@,
      DOCNUMBER= @docnumber@,
      VAR_MITTENTE='@mittente@',
      VAR_TIPO_DESTINATARIO ='@tipoDestinatario@',
      VAR_DESTINATARIO='@destinatario@',
      VAR_RISPOSTE='@risposte@',
      VAR_OGGETTO='@oggetto@',
      VAR_GESTIONE_EMITTENTE='@gestioneemittente@',
      VAR_ZONA='@zona@',
      VAR_GIORNO_ORA=@giorno@,
      VAR_IDENTIFICATIVO=  '@identificativo@',
      VAR_MSGID='@msgid@',
      VAR_TIPO_RICEVUTA='@tiporicevuta@',
      VAR_CONSEGNA='@consegna@',
      VAR_RICEZIONE='@ricezione@',
      VAR_ERRORE_ESTESO='@erroreesteso@',
      VAR_ERRORE_RICEVUTA ='@errorericevuta@'
      WHERE
      SYSTEM_ID = @systemid@
    </value>
  </query>
  <query>
    <name>I_DPA_TIPO_NOTIFICA</name>
    <value>
      INSERT INTO DPA_TIPO_NOTIFICA
      (
      @var_systemid@
      VAR_CODICE_NOTIFICA,
      VAR_DESCRIZIONE
      )
      VALUES
      (
      @systemid@
      '@codicenotifica@',
      '@descrizione@'
      )
    </value>
  </query>
  <query>
    <name>U_DPA_TIPO_NOTIFICA</name>
    <value>
      UPDATE DPA_TIPO_NOTIFICA SET
      VAR_CODICE_NOTIFICA = '@codicenotifica@',
      VAR_DESCRIZIONE = '@descrizione@'
      WHERE
      SYSTEM_ID = @systemid@
    </value>
  </query>
  <query>
    <name>S_DPA_TIPO_NOTIFICA_BY_CODICE</name>
    <value>
      SELECT * FROM DPA_TIPO_NOTIFICA
      WHERE VAR_CODICE_NOTIFICA = '@codicenotifica@'
    </value>
  </query>
  <query>
    <name>S_DPA_NOTIFICA</name>
    <value>
      SELECT * FROM DPA_NOTIFICA
      WHERE DOCNUMBER = @docnumber@
    </value>
  </query>
  <query>
    <name>S_DPA_TIPO_NOTIFICA_BY_SYSTEM_ID</name>
    <value>
      SELECT * FROM DPA_TIPO_NOTIFICA
      WHERE SYSTEM_ID = @systemid@
    </value>
  </query>
  <query>
    <name>D_DPA_NOTIFICA</name>
    <value>
      DELETE FROM DPA_NOTIFICA
      WHERE DOCNUMBER = @docnumber@
    </value>
  </query>
  <query>
    <name>S_DPADettGlob6</name>
    <value>
      SELECT
      VAR_INDIRIZZO,
      VAR_CAP,
      VAR_PROVINCIA,
      VAR_CITTA,
      VAR_LOCALITA,
      VAR_TELEFONO,
      VAR_TELEFONO2,
      var_note,
      var_cod_fisc, VAR_COD_PI
      FROM DPA_DETT_GLOBALI
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>VERIFY_DOC_NO_MITT</name>
    <value>
      SELECT  COUNT(*)
      FROM dpa_doc_arrivo_par d, PROFILE c, dpa_el_registri e
      WHERE d.id_mitt_dest = 0
      AND c.system_id = d.id_profile
      AND (SELECT COUNT (*)
      FROM dpa_doc_arrivo_par f
      WHERE f.id_profile = c.system_id
      AND @where@
      AND id_mitt_dest != 0) = 0
      AND c.id_registro = e.system_id
      AND e.id_amm = @idAmm@
      @tipoDoc@
    </value>
  </query>
  <query>
    <name>VERIFY_DOC_NO_DEST</name>
    <value>
      SELECT  COUNT(*)
      FROM dpa_doc_arrivo_par d, PROFILE c, dpa_el_registri e
      WHERE d.id_mitt_dest = 0
      AND c.system_id = d.id_profile
      AND (SELECT COUNT (*)
      FROM dpa_doc_arrivo_par f
      WHERE f.id_profile = c.system_id
      AND @where@
      AND id_mitt_dest != 0) = 0
      AND c.id_registro = e.system_id
      AND e.id_amm = @idAmm@
      @tipoDoc@
    </value>
  </query>
  <query>
    <name>VERIFY_DOC_NO_CC</name>
    <value>
      SELECT  COUNT(*)
      FROM dpa_doc_arrivo_par d, PROFILE c, dpa_el_registri e
      WHERE d.id_mitt_dest = 0
      AND c.system_id = d.id_profile
      AND (SELECT COUNT (*)
      FROM dpa_doc_arrivo_par f
      WHERE f.id_profile = c.system_id
      AND @where@
      AND id_mitt_dest != 0) = 0
      AND c.id_registro = e.system_id
      AND e.id_amm = @idAmm@
      @tipoDoc@
    </value>
  </query>
  <query>
    <name>S_GET_COUNT_ROWS_RICERCA_DOCUMENTI_MASSIVE_OPERATIONS</name>
    <value>
      SELECT A.SYSTEM_ID,codice
      FROM
      (
      SELECT distinct top @rowCount@
      A.SYSTEM_ID,(case when a.num_proto is not null then a.num_proto when a.num_proto is null then a.docnumber end) as codice
      FROM    PROFILE a
      @from@
      WHERE @security@
      @filters@
      @unionStampe@
      ) as a
    </value>
  </query>
  <query>
    <name>S_ACCESS_RIGHTS</name>
    <value>
      SELECT
      DOCSADM.getAccessRightsProject(@param1@,@param2@,@idRuoloPubblico@,@param3@) AS ACCESSRIGHTS
      FROM PROJECT A
      WHERE A.system_id=@param3@
    </value>
  </query>
  <query>
    <name>S_ACCESS_RIGHTS_DOC</name>
    <value>
      SELECT
      DOCSADM.getAccessRights(@param1@,@param2@,@idRuoloPubblico@,@param3@) AS ACCESSRIGHTS
      FROM PROFILE A WITH(NOLOCK)
      WHERE A.system_id=@param3@
    </value>
  </query>
  <query>
    <name>GET_SMART_CLIENT_CONFIGURATIONS_PER_USER</name>
    <value>
      SELECT  p.IS_ENABLED_SMART_CLIENT as user_config_enabled, p.CHA_TIPO_COMPONENTI as user_tipo_components,
      p.smart_client_pdf_conv_on_scan as user_pdf_conv_enabled,
      a.IS_ENABLED_SMART_CLIENT as admin_config_enabled, a.CHA_TIPO_COMPONENTI as admin_tipo_components,
      a.smart_client_pdf_conv_on_scan as admin_pdf_conv_enabled
      FROM    people p WITH(NOLOCK)
      LEFT JOIN dpa_amministra a WITH(NOLOCK) on p.id_amm = a.system_id
      WHERE  p.system_id = @idPeople@
    </value>
  </query>
  <!--migrazione massiva della tdl-->
  <query>
    <name>S_TODOLIST_MIGRAZIONE</name>
    <value>
      SELECT
      ID_TRASMISSIONE, ID_TRASM_SINGOLA, ID_TRASM_UTENTE, DTA_INVIO,
      DTAINVIO, DTA_SCAD_DESC, DTA_SCAD_ASC, DTA_VISTA, UT_MITT, RUOLO_MITT,
      UT_DEST, RAG_TRASM, VAR_NOTE_GEN, VAR_NOTE_SING, DTA_SCADENZA,
      DTA_SCAD_CHAR,
      ID_PROFILE, SEGNA_DOCNUMBER, OGGETTO_MITTENTE, TIPO_PROTO, DTA_DOC, NUM_PROTO,
      ID_PROJECT, DESC_FASC, COD_FASC, DTA_CREAZ, NUM_FASC,
      ID_PEOPLE_MITT, ID_RUOLO_MITT, ID_RAGIONE_TRASM,
      ID_RUOLO_DEST, ID_PEOPLE_DEST, CHA_TIPO_TRASM,@dbuser@.Vardescribe(ID_PROFILE,'PROFILE_CHA_IMG') AS CHA_IMG,
      @dbuser@.Vardescribe(ID_PROFILE,'COMPONENTS_CHA_FIRMATO') AS CHA_FIRMATO,
      ID_PEOPLE_DELEGATO
      FROM
      (
      SELECT      ID_TRASMISSIONE,
      ID_TRASM_SINGOLA,
      ID_TRASM_UTENTE,
      DTA_INVIO,
      --TO_CHAR(DTA_INVIO,'dd/mm/yyyy') AS DTAINVIO,
      convert(nvarchar (10), DTA_INVIO, 103) AS DTAINVIO,
      ISNULL(DTA_SCADENZA,CONVERT(DATE,'01/01/1753',103)) AS DTA_SCAD_DESC,
      ISNULL(DTA_SCADENZA,CONVERT(DATE,'01/01/2100',103)) AS DTA_SCAD_ASC,
      ISNULL(DTA_VISTA,CONVERT(DATE,'01/01/1753',103)) AS DTA_VISTA,
      @dbuser@.Vardescribe(ID_PEOPLE_MITT, 'PEOPLENAME') AS UT_MITT,
      @dbuser@.Vardescribe(ID_RUOLO_MITT, 'GROUPNAME') AS RUOLO_MITT,
      @dbuser@.Vardescribe(ID_PEOPLE_DEST, 'PEOPLENAME') AS UT_DEST,
      @dbuser@.Vardescribe(ID_RAGIONE_TRASM, 'RAGIONETRASM') AS RAG_TRASM,
      VAR_NOTE_GEN,
      VAR_NOTE_SING,
      DTA_SCADENZA,
      --TO_CHAR(DTA_SCADENZA,'DD/MM/YYYY') AS DTA_SCAD_CHAR,
      convert(nvarchar(10), DTA_SCADENZA, 103) AS DTA_SCAD_CHAR,
      ID_PROFILE,
      @dbuser@.Vardescribe(ID_PROFILE, 'SEGNATURA_DOCNUMBER')AS SEGNA_DOCNUMBER,
      @dbuser@.Vardescribe(ID_PROFILE, 'OGGETTO_MITTENTE')AS OGGETTO_MITTENTE,
      @dbuser@.Vardescribe(ID_PROFILE, 'CHA_TIPO_PROTO')AS TIPO_PROTO,
      @dbuser@.Vardescribe(ID_PROFILE, 'DATADOC') AS DTA_DOC,
      @dbuser@.vardescribe(ID_PROFILE, 'NUMPROTO') AS NUM_PROTO,
      ID_PEOPLE_MITT AS ID_PEOPLE_MITT,
      ID_RUOLO_MITT AS ID_RUOLO_MITT,
      ID_RAGIONE_TRASM AS ID_RAGIONE_TRASM,
      ID_RUOLO_DEST AS ID_RUOLO_DEST,
      ID_PEOPLE_DEST AS ID_PEOPLE_DEST,
      CHA_TIPO_TRASM AS CHA_TIPO_TRASM,
      @dbuser@.Vardescribe(ID_PROFILE,'PROFILE_CHA_IMG') AS CHA_IMG,
      @dbuser@.Vardescribe(ID_PROFILE,'COMPONENTS_CHA_FIRMATO') AS CHA_FIRMATO,
      ID_PROJECT,
      @dbuser@.Vardescribe(ID_PROJECT, 'DESC_FASC')AS DESC_FASC,
      @dbuser@.Vardescribe(ID_PROJECT, 'CODFASC') AS COD_FASC,
      @dbuser@.Vardescribe(ID_PROJECT, 'DTA_CREAZ') AS DTA_CREAZ,
      @dbuser@.Vardescribe(ID_PROJECT, 'NUM_FASC') AS NUM_FASC,
      ID_PEOPLE_DELEGATO
      FROM        DPA_TODOLIST
      WHERE      @docORFasc@
      ((ID_PEOPLE_DEST = @idPeople@ and ID_RUOLO_DEST = @idGruppo@) OR
      (ID_PEOPLE_DEST = @idPeople@ AND ID_RUOLO_DEST = 0))
      ) A
    </value>
  </query>
  <query>
    <name>DOCUMENTI_R_W_SENZA_RISALITA</name>
    <value>
      SELECT p.system_id AS ID, s.accessrights AS diritti
      FROM PROFILE p WITH(NOLOCK), security as s  WITH (nolock)
      WHERE s.PERSONORGROUP in (select g.SYSTEM_ID from GROUPS g where group_id = '@codice_ruolo@')
      AND p.cha_privato = '1'
      AND s.accessrights IN (255, 63)
      and nvl(p.CHA_IN_CESTINO,'0') != '1'
      AND s.thing = p.system_id
    </value>
  </query>
  <query>
    <name>DOCUMENTI_R_W_CON_RISALITA</name>
    <value>
      SELECT p.system_id AS ID, s.accessrights AS diritti
      FROM PROFILE p WITH(NOLOCK), security as s  WITH (nolock)
      WHERE s.personorgroup IN (SELECT g.id_gruppo
      FROM dpa_corr_globali g)
      AND s.PERSONORGROUP in (select g.SYSTEM_ID from GROUPS g where group_id = '@codice_ruolo@')
      AND p.cha_privato = '0'
      AND s.accessrights IN (255, 63)
      and nvl(p.CHA_IN_CESTINO,'0') != '1'
      AND s.thing = p.system_id
    </value>
  </query>
  <query>
    <name>DOCUMENTI_R_SENZA_RISALITA</name>
    <value>
      SELECT p.system_id AS ID, s.accessrights AS diritti
      FROM PROFILE p WITH(NOLOCK), security as s  WITH (nolock)
      WHERE s.personorgroup IN (SELECT g.id_gruppo
      FROM dpa_corr_globali g)
      AND s.PERSONORGROUP in (select g.SYSTEM_ID from GROUPS g where group_id = '@codice_ruolo@')
      AND p.cha_privato = '1'
      AND s.accessrights IN (45)
      and nvl(p.CHA_IN_CESTINO,'0') != '1'
      AND s.thing = p.system_id
    </value>
  </query>
  <query>
    <name>DOCUMENTI_R_CON_RISALITA</name>
    <value>
      SELECT p.system_id AS ID, s.accessrights AS diritti
      FROM PROFILE p WITH(NOLOCK), security as s  WITH (nolock)
      WHERE s.personorgroup IN (SELECT g.id_gruppo
      FROM dpa_corr_globali g)
      AND s.PERSONORGROUP in (select g.SYSTEM_ID from GROUPS g where group_id = '@codice_ruolo@')
      AND p.cha_privato = '0'
      AND s.accessrights IN (45)
      and nvl(p.CHA_IN_CESTINO,'0') != '1'
      AND s.thing = p.system_id
    </value>
  </query>
  <query>
    <name>FASCICOLI_R_W_CON_RISALITA</name>
    <value>
      SELECT p.system_id AS ID, s.accessrights AS diritti
      FROM project p, security as s  WITH (nolock)
      WHERE s.personorgroup IN (SELECT g.id_gruppo
      FROM dpa_corr_globali g)
      AND s.personorgroup  in (select g.SYSTEM_ID from GROUPS g where group_id = '@codice_ruolo@')
      AND p.cha_privato = '1'
      AND s.accessrights IN (255, 63)
      AND p.cha_tipo_fascicolo = 'P'
      AND s.thing = p.system_id
    </value>
  </query>
  <query>
    <name>FASCICOLI_R_W_SENZA_RISALITA</name>
    <value>
      SELECT p.system_id AS ID, s.accessrights AS diritti
      FROM project p, security as s  WITH (nolock)
      WHERE s.personorgroup IN (SELECT g.id_gruppo
      FROM dpa_corr_globali g)
      AND s.personorgroup in (select g.SYSTEM_ID from GROUPS g where group_id = '@codice_ruolo@')
      AND p.cha_privato = '0'
      AND s.accessrights IN (255, 63)
      AND p.cha_tipo_fascicolo = 'P'
      AND s.thing = p.system_id
    </value>
  </query>
  <query>
    <name>FASCICOLI_R_CON_RISALITA</name>
    <value>
      SELECT p.system_id AS ID, s.accessrights AS diritti
      FROM project p, security as s  WITH (nolock)
      WHERE s.personorgroup IN (SELECT g.id_gruppo
      FROM dpa_corr_globali g)
      AND s.personorgroup  in (select g.SYSTEM_ID from GROUPS g where group_id = '@codice_ruolo@')
      AND p.cha_privato = '1'
      AND s.accessrights IN (45)
      AND p.cha_tipo_fascicolo = 'P'
      AND s.thing = p.system_id
    </value>
  </query>
  <query>
    <name>FASCICOLI_R_SENZA_RISALITA</name>
    <value>
      SELECT p.system_id AS ID, s.accessrights AS diritti
      FROM project p, security as s  WITH (nolock)
      WHERE s.personorgroup IN (SELECT g.id_gruppo
      FROM dpa_corr_globali g)
      AND s.personorgroup  in (select g.SYSTEM_ID from GROUPS g where group_id = '@codice_ruolo@')
      AND p.cha_privato = '1'
      AND s.accessrights IN (45)
      AND p.cha_tipo_fascicolo = 'P'
      AND s.thing = p.system_id
    </value>
  </query>
  <!--fine migrazione massiva della tdl -->
  <query>
    <name>S_TODOLIST_MIGRAZIONE_old</name>
    <value>
      SELECT
      ID_TRASMISSIONE, ID_TRASM_SINGOLA, ID_TRASM_UTENTE, DTA_INVIO,
      DTAINVIO, DTA_SCAD_DESC, DTA_SCAD_ASC, DTA_VISTA, UT_MITT, RUOLO_MITT,
      UT_DEST, RAG_TRASM, VAR_NOTE_GEN, VAR_NOTE_SING, DTA_SCADENZA,
      DTA_SCAD_CHAR,
      ID_PROFILE, SEGNA_DOCNUMBER, OGGETTO_MITTENTE, TIPO_PROTO, DTA_DOC, NUM_PROTO,
      ID_PROJECT, DESC_FASC, COD_FASC, DTA_CREAZ, NUM_FASC,
      ID_PEOPLE_MITT, ID_RUOLO_MITT, ID_RAGIONE_TRASM,
      ID_RUOLO_DEST, ID_PEOPLE_DEST, CHA_TIPO_TRASM,Vardescribe(ID_PROFILE,'PROFILE_CHA_IMG') AS CHA_IMG,
      Vardescribe(ID_PROFILE,'COMPONENTS_CHA_FIRMATO') AS CHA_FIRMATO,
      ID_PEOPLE_DELEGATO
      FROM
      (
      SELECT      ID_TRASMISSIONE,
      ID_TRASM_SINGOLA,
      ID_TRASM_UTENTE,
      DTA_INVIO,
      TO_CHAR(DTA_INVIO,'dd/mm/yyyy') AS DTAINVIO,
      nvl(DTA_SCADENZA,to_date('01/01/1753','dd/mm/yyyy')) AS DTA_SCAD_DESC,
      nvl(DTA_SCADENZA,to_date('01/01/2100','dd/mm/yyyy')) AS DTA_SCAD_ASC,
      nvl(DTA_VISTA,to_date('01/01/1753','dd/mm/yyyy')) AS DTA_VISTA,
      Vardescribe(ID_PEOPLE_MITT, 'PEOPLENAME') AS UT_MITT,
      Vardescribe(ID_RUOLO_MITT, 'GROUPNAME') AS RUOLO_MITT,
      Vardescribe(ID_PEOPLE_DEST, 'PEOPLENAME') AS UT_DEST,
      Vardescribe(ID_RAGIONE_TRASM, 'RAGIONETRASM') AS RAG_TRASM,
      VAR_NOTE_GEN,
      VAR_NOTE_SING,
      DTA_SCADENZA,
      TO_CHAR(DTA_SCADENZA,'DD/MM/YYYY') AS DTA_SCAD_CHAR,
      ID_PROFILE,
      Vardescribe(ID_PROFILE, 'SEGNATURA_DOCNUMBER')AS SEGNA_DOCNUMBER,
      Vardescribe(ID_PROFILE, 'OGGETTO_MITTENTE')AS OGGETTO_MITTENTE,
      Vardescribe(ID_PROFILE, 'CHA_TIPO_PROTO')AS TIPO_PROTO,
      Vardescribe(ID_PROFILE, 'DATADOC') AS DTA_DOC,
      vardescribe(ID_PROFILE, 'NUMPROTO') AS NUM_PROTO,
      ID_PEOPLE_MITT AS ID_PEOPLE_MITT,
      ID_RUOLO_MITT AS ID_RUOLO_MITT,
      ID_RAGIONE_TRASM AS ID_RAGIONE_TRASM,
      ID_RUOLO_DEST AS ID_RUOLO_DEST,
      ID_PEOPLE_DEST AS ID_PEOPLE_DEST,
      CHA_TIPO_TRASM AS CHA_TIPO_TRASM,
      Vardescribe(ID_PROFILE,'PROFILE_CHA_IMG') AS CHA_IMG,
      Vardescribe(ID_PROFILE,'COMPONENTS_CHA_FIRMATO') AS CHA_FIRMATO,
      ID_PROJECT,
      Vardescribe(ID_PROJECT, 'DESC_FASC')AS DESC_FASC,
      Vardescribe(ID_PROJECT, 'CODFASC') AS COD_FASC,
      Vardescribe(ID_PROJECT, 'DTA_CREAZ') AS DTA_CREAZ,
      Vardescribe(ID_PROJECT, 'NUM_FASC') AS NUM_FASC,
      ID_PEOPLE_DELEGATO
      FROM        DPA_TODOLIST
      WHERE      @docORFasc@
      ((ID_PEOPLE_DEST = @idPeople@ and ID_RUOLO_DEST = @idGruppo@) OR
      (ID_PEOPLE_DEST = @idPeople@ AND ID_RUOLO_DEST = 0))
      )
    </value>
  </query>
  <query>
    <name>S_ROOTFOLDER_FASC</name>
    <value>
      SELECT SYSTEM_ID FROM PROJECT WHERE ID_FASCICOLO = @param1@
    </value>
  </query>
  <query>
    <name>TITOLARIO_CHIUDI_NODI</name>
    <value>
      UPDATE PROJECT
      SET
      PROJECT.CHA_STATO = 'C',
      PROJECT.DTA_CHIUSURA = GETDATE()
      WHERE
      PROJECT.CHA_TIPO_FASCICOLO = 'G'
      AND
      (PROJECT.DTA_CHIUSURA IS NULL OR PROJECT.DTA_CHIUSURA = '')
      AND
      PROJECT.ID_TITOLARIO IN
      (
      SELECT
      SYSTEM_ID
      FROM PROJECT
      WHERE
      PROJECT.ID_AMM = @idAmm@
      AND
      PROJECT.CHA_STATO = 'A'
      AND
      PROJECT.ID_PARENT = 0
      AND
      PROJECT.CHA_TIPO_PROJ = 'T'
      AND
      PROJECT.ID_TITOLARIO = 0
      AND
      PROJECT.VAR_CODICE = 'T'
      )
    </value>
  </query>
  <query>
    <name>I_DPA_TRASMISSIONE_insertTrasmissioneDtaInvio</name>
    <value>
      INSERT INTO DPA_TRASMISSIONE ( @param1@ID_RUOLO_IN_UO,
      ID_PEOPLE,
      CHA_TIPO_OGGETTO,
      ID_PROFILE,
      ID_PROJECT,VAR_NOTE_GENERALI,
      CHA_SALVATA_CON_CESSIONE,
      ID_PEOPLE_DELEGATO,dta_invio)
      VALUES ( @param2@@param3@,@param4@,'@param5@',@param6@,@param7@,'@param8@','@cessione@', @delegato@,@dta_invio@)
    </value>
  </query>
  <query>
    <name>S_GET_LDAP_USER_CONFIG_BY_NAME</name>
    <value>
      select p.ldap_id_sync,
      p.ldap_never_sync,
      p.ldap_authenticated
      from people p
      where p.user_id = '@userName@'
    </value>
  </query>
  <!--modelli di delega-->
  <query>
    <name>S_COUNT_MODELLI_DELEGA</name>
    <value>
      SELECT COUNT(*) FROM DPA_MODELLI_DELEGA A LEFT OUTER JOIN DPA_CORR_GLOBALI C ON A.ID_RUOLO_DELEGANTE=C.SYSTEM_ID,DPA_CORR_GLOBALI B WHERE A.ID_PEOPLE_DELEGATO=B.SYSTEM_ID AND A.ID_PEOPLE_DELEGANTE = @idUtente@  @param1@
    </value>
  </query>
  <query>
    <name>S_GET_MODELLI_DELEGA</name>
    <value>
      SELECT A.*,B.VAR_DESC_CORR AS FULL_NAME,C.VAR_DESC_CORR FROM DPA_MODELLI_DELEGA A LEFT OUTER JOIN DPA_CORR_GLOBALI C ON A.ID_RUOLO_DELEGANTE=C.SYSTEM_ID,DPA_CORR_GLOBALI B WHERE A.ID_PEOPLE_DELEGATO=B.SYSTEM_ID AND A.ID_PEOPLE_DELEGANTE = @idUtente@  @param1@
    </value>
  </query>
  <query>
    <name>S_GET_MODELLI_DELEGA_PAGING</name>
    <value>
      SELECT * FROM (
      SELECT TOP @pageSize@ * FROM
      (
      SELECT TOP @rowNum@ A.*,B.VAR_DESC_CORR AS FULL_NAME,C.VAR_DESC_CORR FROM DPA_MODELLI_DELEGA A LEFT OUTER JOIN DPA_CORR_GLOBALI C ON A.ID_RUOLO_DELEGANTE=C.SYSTEM_ID,DPA_CORR_GLOBALI B WHERE A.ID_PEOPLE_DELEGATO=B.SYSTEM_ID AND A.ID_PEOPLE_DELEGANTE = @idUtente@  @param1@ ORDER BY A.SYSTEM_ID
      ) AS T1 ORDER BY SYSTEM_ID DESC
      ) AS T2 ORDER BY SYSTEM_ID
    </value>
  </query>
  <query>
    <name>S_GET_MODELLI_DELEGA_BY_ID</name>
    <value>
      SELECT A.*,B.VAR_DESC_CORR AS FULL_NAME,C.VAR_DESC_CORR FROM DPA_MODELLI_DELEGA A LEFT OUTER JOIN DPA_CORR_GLOBALI C ON A.ID_RUOLO_DELEGANTE=C.SYSTEM_ID,DPA_CORR_GLOBALI B WHERE A.ID_PEOPLE_DELEGATO=B.SYSTEM_ID AND A.SYSTEM_ID = @idModello@
    </value>
  </query>
  <query>
    <name>I_INSERT_MODELLO_DELEGA</name>
    <value>
      INSERT INTO DPA_MODELLI_DELEGA (@colId@ID_PEOPLE_DELEGANTE,ID_RUOLO_DELEGANTE,ID_PEOPLE_DELEGATO,ID_RUOLO_DELEGATO,DTA_INIZIO,DTA_FINE,INTERVALLO,NOME) VALUES (@id@@insertList@)
    </value>
  </query>
  <query>
    <name>U_UPDATE_MODELLO_DELEGA</name>
    <value>
      UPDATE DPA_MODELLI_DELEGA SET ID_PEOPLE_DELEGATO=@idDelegato@,
      ID_RUOLO_DELEGATO=@idRuoloDelegato@,
      ID_RUOLO_DELEGANTE=@idRuoloDelegante@,
      DTA_INIZIO=@dataInizio@,
      DTA_FINE=@dataFine@,
      INTERVALLO=@intervallo@,
      NOME=@nome@ WHERE SYSTEM_ID=@idModello@
    </value>
  </query>
  <query>
    <name>D_DELETE_MODELLO_DELEGA</name>
    <value>
      DELETE FROM DPA_MODELLI_DELEGA WHERE SYSTEM_ID IN (@idModelli@)
    </value>
  </query>
  <!--fine modelli di delega-->
  <query>
    <name>COUNT_PROJECT_MASSIVE_OPERATION_UNION</name>
    <value>
      SELECT * from (
      Select a.system_id,a.var_codice
      FROM project a
      @tblCL1@
      WHERE @security@
      AND (a.id_amm IS NULL OR a.id_amm = @idAmm@ )
      AND a.cha_tipo_proj = 'F'
      @idReg@
      @whereTlbCL1@
      @guiFilters@
      UNION
      SELECT a.system_id,a.var_codice
      FROM project a
      @tblCL1@
      WHERE @security@
      AND (a.id_amm IS NULL OR a.id_amm = @idAmm@ )
      AND a.cha_tipo_proj = 'F'
      @idReg@
      @whereTlbCL1@
      @guiFilters1@
      )
    </value>
  </query>
  <query>
    <name>COUNT_PROJECT_MASSIVE_OPERATION</name>
    <value>
      SELECT a.system_id,a.var_codice
      FROM project a @tblCL1@
      WHERE
      @security@
      AND (a.id_amm IS NULL OR a.id_amm = @idAmm@ )
      AND a.cha_tipo_proj = 'F'
      @idReg@
      @whereTlbCL1@
      @guiFilters@
    </value>
  </query>
  <query>
    <name>S_DISSERVIZIO</name>
    <value>
      SELECT
      SYSTEM_ID
      ,STATO
      ,TESTO_NOTIFICA
      ,TESTO_EMAIL_NOTIFICA
      ,TESTO_PAG_CORTESIA
      ,TESTO_EMAIL_RIPRESA
      ,NOTIFICATO
      FROM DPA_DISSERVIZI
    </value>
  </query>
  <query>
    <name>I_DISSERVIZIO</name>
    <value>
      INSERT INTO DPA_DISSERVIZI
      (STATO
      ,TESTO_NOTIFICA
      ,TESTO_EMAIL_NOTIFICA
      ,TESTO_PAG_CORTESIA
      ,TESTO_EMAIL_RIPRESA
      ,NOTIFICATO)
      VALUES
      ('@stato@'
      ,'@notifica@'
      ,'@email@'
      ,'@cortesia@'
      ,'@ripresa@'
      ,'@notificato@')
    </value>
  </query>
  <query>
    <name>U_DISSERVIZIO</name>
    <value>
      UPDATE DPA_DISSERVIZI
      SET TESTO_NOTIFICA = '@notifica@'
      ,TESTO_EMAIL_NOTIFICA = '@email@'
      ,TESTO_PAG_CORTESIA = '@cortesia@'
      ,TESTO_EMAIL_RIPRESA = '@ripresa@'
      WHERE SYSTEM_ID = '@systemid@'
    </value>
  </query>
  <query>
    <name>U_STATO_DISSERVIZIO</name>
    <value>
      UPDATE DPA_DISSERVIZI
      SET STATO = '@stato@'
      WHERE SYSTEM_ID = '@systemid@'
    </value>
  </query>
  <query>
    <name>D_DISSERVIZIO</name>
    <value>
      DELETE FROM DPA_DISSERVIZI
      WHERE SYSTEM_ID = '@systemid@'
    </value>
  </query>
  <query>
    <name>U_NOTIFICA_ALL_UTENTE</name>
    <value>
      update PEOPLE set ACCETTAZIONE_DISSERV = '@accettaz@'
    </value>
  </query>
  <query>
    <name>U_NOTIFICA_UTENTE</name>
    <value>
      update PEOPLE set ACCETTAZIONE_DISSERV = '@accettaz@'
      where SYSTEM_ID = '@systemId@'
    </value>
  </query>
  <query>
    <name>S_STATO_NOTIFICA_UTENTE</name>
    <value>
      select ACCETTAZIONE_DISSERV from PEOPLE
      where SYSTEM_ID = '@systemId@'
    </value>
  </query>
  <query>
    <name>S_LISTA_MAIL_UTENTI</name>
    <value>
      select EMAIL_ADDRESS
      from PEOPLE where ID_AMM = '@idAmm@'
    </value>
  </query>
  <query>
    <name>U_NOTIFICA_DISSERVIZIO</name>
    <value>
      UPDATE DPA_DISSERVIZI
      SET NOTIFICATO = '@notificato@'
      WHERE SYSTEM_ID = '@systemId@'
    </value>
  </query>
  <query>
    <name>S_LISTA_TITOLI</name>
    <value>
      SELECT VAR_TITOLO
      FROM DPA_QUALIFICA_CORRISPONDENTE
      WHERE DTA_FINE_VALIDITA IS NULL
    </value>
  </query>

  <query>
    <name>S_ESISTE_FASC_PRIMARIA</name>
    <value>
      select count(*) from PROJECT_COMPONENTS
      where LINK=@link@ and CHA_FASC_PRIMARIA='1'
    </value>
  </query>
  <query>
    <name>S_GET_FASC_PRIMARIA</name>
    <value>
      select DESCRIPTION, DOCSADM.checksecurity(a.system_id, @idPeople@, @idGruppo@, @idRuoloPubblico@, 'F') as SICUREZZA, A.VAR_CODICE
      from PROJECT A
      where A.SYSTEM_ID IN
      (SELECT A.ID_FASCICOLO FROM PROJECT A, PROJECT_COMPONENTS B
      WHERE A.SYSTEM_ID=B.PROJECT_ID AND B.LINK=@idProfile@ and CHA_FASC_PRIMARIA='1')
    </value>
  </query>
  <query>
    <name>S_GET_FASCICOLI_FASC_PRIMARIA</name>
    <value>
      SELECT *
      FROM PROJECT_COMPONENTS
      WHERE
      LINK = @param1@
    </value>
  </query>
  <query>
    <name>U_PROJECT_COMPONENTS_CHA_FASC_PRIMARIA</name>
    <value>
      UPDATE PROJECT_COMPONENTS SET CHA_FASC_PRIMARIA = '1'
      WHERE PROJECT_ID = @param1@ and link=@param2@
    </value>
  </query>
  <query>
    <name>ANNULLA_FASCICOLAZIONE_PRIMARIA</name>
    <value>
      UPDATE PROJECT_COMPONENTS SET CHA_FASC_PRIMARIA='0'
      WHERE
      LINK = @param1@ and CHA_FASC_PRIMARIA='1'
    </value>
  </query>
  <query>
    <name>NUOVA_FASCICOLAZIONE_PRIMARIA</name>
    <value>
      UPDATE PROJECT_COMPONENTS SET CHA_FASC_PRIMARIA='1'
      WHERE
      LINK = @param1@ and PROJECT_ID in (select system_id from PROJECT where ID_FASCICOLO = @idProject@)
    </value>
  </query>
  <query>
    <name>I_PUBBLICAZIONI_DOCUMENTI</name>
    <value>
      INSERT INTO PUBBLICAZIONI_DOCUMENTI(
      @var_systemid@
      ID_PROFILE,
      ID_TIPO_DOCUMENTO,
      ID_USER,
      ID_RUOLO,
      DATA_DOC_PUBBLICATO,
      DATA_PUBBLICAZIONE_DOCUMENTO,
      ESITO_PUBBLICAZIONE,
      ERRORE_PUBBLICAZIONE)
      VALUES
      (
      @systemid@
      @id_profile@,
      @id_tipo_documento@,
      null,
      null,
      @data_doc_pubblicato@,
      @data_pubblicazione_documento@,
      @esito_pubblicazione@,
      @errore_pubblicazione@
      )
    </value>
  </query>
  <query>
    <name>U_PUBBLICAZIONI_DOCUMENTI</name>
    <value>
      UPDATE PUBBLICAZIONI_DOCUMENTI SET
      DATA_PUBBLICAZIONE_DOCUMENTO=@data_pubblicazione_documento@,
      ESITO_PUBBLICAZIONE=@esito_pubblicazione@,
      ERRORE_PUBBLICAZIONE=@errore_pubblicazione@
      WHERE
      ID_PROFILE = @id_profile@ and
      ID_TIPO_DOCUMENTO = @id_tipo_documento@
    </value>
  </query>
  <query>
    <name>U_PUBBLICAZIONI_DOCUMENTI_GENERALE</name>
    <value>
      UPDATE PUBBLICAZIONI_DOCUMENTI SET
      DATA_PUBBLICAZIONE_DOCUMENTO=@data_pubblicazione_documento@,
      DATA_DOC_PUBBLICATO =@data_doc_pubblicato@,
      ESITO_PUBBLICAZIONE=@esito_pubblicazione@,
      ERRORE_PUBBLICAZIONE=@errore_pubblicazione@
      WHERE
      ID_PROFILE = @id_profile@ and
      ID_TIPO_DOCUMENTO = @id_tipo_documento@
    </value>
  </query>
  <query>
    <name>S_PUBBLICAZIONI_DOCUMENTI_BY_ID_PROFILE</name>
    <value>
      SELECT * FROM PUBBLICAZIONI_DOCUMENTI WHERE
      ID_PROFILE=@id_profile@
      and ID_TIPO_DOCUMENTO =@id_tipo_documento@
    </value>
  </query>
  <query>
    <name>S_PUBBLICAZIONI_DOCUMENTI</name>
    <value>
      SELECT * FROM PUBBLICAZIONI_DOCUMENTI WHERE
      ESITO_PUBBLICAZIONE=@esito_pubblicazione@
      and ID_TIPO_DOCUMENTO =@id_tipo_documento@
    </value>
  </query>
  <query>
    <name>S_PUBBLICAZIONI_DOCUMENTI_MAX</name>
    <value>
      select max(cv.DATA_DOC_PUBBLICATO) as massimo
      from Pubblicazioni_documenti cv where
      ID_TIPO_DOCUMENTO = @id_tipo_documento@
    </value>
  </query>
  <query>
    <name>S_ESISTE_DOCUMENTO</name>
    <value>
      select ID_TIPO_DOCUMENTO
      from PUBBLICAZIONI_DOCUMENTI
      where id_tipo_documento = @id_tipo_documento@
    </value>
  </query>
  <query>
    <name>S_PUBBLICAZIONE_DOCUMENTI_BY_ID_PROFILE</name>
    <value>
      select *
      from PUBBLICAZIONI_DOCUMENTI
      where id_profile = @id_profile@
    </value>
  </query>
  <query>
    <name>GSF_Docs_Stato_Finale_list</name>
    <value>
      SELECT DISTINCT
      P.SYSTEM_ID as ID_DOC,
      P.DOCNAME as SEGNATURA,
      P.ID_OGGETTO,
      @dbUser@.corrcat(P.SYSTEM_ID, P.CHA_TIPO_PROTO) as MITTDEST,
      O.VAR_DESC_OGGETTO as DESC_OGGETTO,
      P.ID_TIPO_ATTO as  ID_TIPOLOGIA,
      TA.VAR_DESC_ATTO AS TIPOLOGIA
      FROM
      DPA_DIAGRAMMI D,
      DPA_STATI S,
      PROFILE P,
      PEOPLE PL,
      DPA_OGGETTARIO O,
      DPA_TIPO_ATTO TA
      WHERE
      D.ID_STATO = S.SYSTEM_ID
      AND
      P.AUTHOR=PL.SYSTEM_ID
      AND
      STATO_FINALE = 1
      AND
      D.Doc_number = P.DOCNUMBER
      AND
      TA.SYSTEM_ID=P.ID_TIPO_ATTO
      AND
      O.SYSTEM_ID=P.ID_OGGETTO
      @IdDocumento@
      @paramNumAnnoProto@
      @paramIdRegistro@
      @paramIdTipologia@
      @paramProtocollati@
      @paramWhereIdAmministrazione@
      @paramWhereContatori@
    </value>
  </query>
  <query>
    <name>GSF_Docs_Stato_Finale_Unlocked_list</name>
    <value>
      SELECT DISTINCT
      P.SYSTEM_ID as ID_DOC,
      P.DOCNAME as SEGNATURA,
      P.ID_OGGETTO,
      @dbUser@.corrcat(P.SYSTEM_ID, P.CHA_TIPO_PROTO) as MITTDEST,
      O.VAR_DESC_OGGETTO as DESC_OGGETTO,
      P.ID_TIPO_ATTO as  ID_TIPOLOGIA,
      TA.VAR_DESC_ATTO AS TIPOLOGIA
      FROM
      DPA_DIAGRAMMI D,
      DPA_STATI S,
      PROFILE P,
      PEOPLE PL,
      DPA_OGGETTARIO O,
      DPA_TIPO_ATTO TA
      WHERE
      D.ID_STATO = S.SYSTEM_ID
      AND
      P.AUTHOR=PL.SYSTEM_ID
      AND
      STATO_FINALE = 1
      AND
      D.Doc_number = P.DOCNUMBER
      AND
      TA.SYSTEM_ID=P.ID_TIPO_ATTO
      AND
      O.SYSTEM_ID=P.ID_OGGETTO
      AND
      P.CHA_UNLOCKED_FINAL_STATE='1'
      @IdDocumento@
      @paramNumAnnoProto@
      @paramIdRegistro@
      @paramIdTipologia@
      @paramProtocollati@
      @paramWhereIdAmministrazione@
      @paramWhereContatori@
    </value>
  </query>

  <query>
    <name>GSF_Modifica_Doc_Stato_Finale</name>
    <value>
      update SECURITY
      set ACCESSRIGHTS = @accessRights@
      where THING = @IdDoc@
      and PERSONORGROUP = @IdRuolo@
    </value>
  </query>

  <query>
    <name>GSF_Update_Stato_Doc_Stato_Finale_Sbloccato</name>
    <value>

      update PROFILE
      set CHA_UNLOCKED_FINAL_STATE = '1'
      where
      system_id = @IdDoc@
    </value>
  </query>
  <query>
    <name>GSF_Update_Stato_Doc_Stato_Finale_Bloccato</name>
    <value>
      update PROFILE
      set CHA_UNLOCKED_FINAL_STATE = '0'
      where
      system_id = @IdDoc@
      and
      (
      select COUNT(*)
      from SECURITY
      where THING = @IdDoc@
      and ACCESSRIGHTS > 45
      ) = 0
    </value>
  </query>
  <query>
    <name>S_DISSERVIZIO</name>
    <value>
      SELECT
      SYSTEM_ID
      ,STATO
      ,TESTO_NOTIFICA
      ,TESTO_EMAIL_NOTIFICA
      ,TESTO_PAG_CORTESIA
      ,TESTO_EMAIL_RIPRESA
      ,NOTIFICATO
      FROM DPA_DISSERVIZI
    </value>
  </query>
  <query>
    <name>I_DISSERVIZIO</name>
    <value>
      INSERT INTO DPA_DISSERVIZI
      (STATO
      ,TESTO_NOTIFICA
      ,TESTO_EMAIL_NOTIFICA
      ,TESTO_PAG_CORTESIA
      ,TESTO_EMAIL_RIPRESA
      ,NOTIFICATO)
      VALUES
      ('@stato@'
      ,'@notifica@'
      ,'@email@'
      ,'@cortesia@'
      ,'@ripresa@'
      ,'@notificato@')
    </value>
  </query>
  <query>
    <name>U_DISSERVIZIO</name>
    <value>
      UPDATE DPA_DISSERVIZI
      SET TESTO_NOTIFICA = '@notifica@'
      ,TESTO_EMAIL_NOTIFICA = '@email@'
      ,TESTO_PAG_CORTESIA = '@cortesia@'
      ,TESTO_EMAIL_RIPRESA = '@ripresa@'
      WHERE SYSTEM_ID = @systemid@
    </value>
  </query>
  <query>
    <name>U_STATO_DISSERVIZIO</name>
    <value>
      UPDATE DPA_DISSERVIZI
      SET STATO = '@stato@'
      WHERE SYSTEM_ID = @systemid@
    </value>
  </query>
  <query>
    <name>D_DISSERVIZIO</name>
    <value>
      DELETE FROM DPA_DISSERVIZI
      WHERE SYSTEM_ID = @systemid@
    </value>
  </query>
  <query>
    <name>U_NOTIFICA_ALL_UTENTE</name>
    <value>
      update PEOPLE set ACCETTAZIONE_DISSERV = '@accettaz@'
    </value>
  </query>
  <query>
    <name>U_NOTIFICA_UTENTE</name>
    <value>
      update PEOPLE set ACCETTAZIONE_DISSERV = '@accettaz@'
      where SYSTEM_ID = @systemId@
    </value>
  </query>
  <query>
    <name>S_STATO_NOTIFICA_UTENTE</name>
    <value>
      select ACCETTAZIONE_DISSERV from PEOPLE
      where SYSTEM_ID = '@systemId@'
    </value>
  </query>
  <query>
    <name>S_LISTA_MAIL_UTENTI</name>
    <value>
      select EMAIL_ADDRESS
      from PEOPLE where ID_AMM = @idAmm@
    </value>
  </query>
  <query>
    <name>U_NOTIFICA_DISSERVIZIO</name>
    <value>
      UPDATE DPA_DISSERVIZI
      SET NOTIFICATO = '@notificato@'
      WHERE SYSTEM_ID = @systemId@
    </value>
  </query>
  <query>
    <name>S_EXP_COUNT_FASC</name>
    <value>
      select  d.SYSTEM_ID, d.VAR_DESC_CORR, p.CHA_STATO, count(*) as TOT
      from @param1@
    </value>
  </query>
  <query>
    <name>S_RUOLI_SOTTOPOSTI_UO</name>
    <value>
      select p.system_ID from dpa_corr_globali p
      where id_amm = '@param3@' AND p.id_uo @param4@
    </value>
  </query>
  <query>
    <name>S_EXP_COUNT_FASC_DESCR</name>
    <value>
      SELECT   d.system_id, d.var_desc_corr, p1.var_codice, p1.description, COUNT (*)
      FROM @param1@
    </value>
  </query>
  <query>
    <name>S_GET_DOCUMENT_CONSOLIDATION_STATE</name>
    <value>
      SELECT P.CONSOLIDATION_STATE,
      P.CONSOLIDATION_AUTHOR,
      P.CONSOLIDATION_ROLE,
      P.CONSOLIDATION_DATE
      FROM PROFILE P WITH(NOLOCK)
      WHERE (P.SYSTEM_ID = @idDocument@ AND P.DOCNUMBER = @idDocument@) OR (P.DOCNUMBER = @idDocument@ AND P.SYSTEM_ID!=@idDocument@) OR (P.SYSTEM_ID=@idDocument@ AND P.DOCNUMBER!=@idDocument@)
    </value>
  </query>
  <query>
    <name>S_SET_DOCUMENT_CONSOLIDATION_STATE</name>
    <value>
      UPDATE  PROFILE
      SET     CONSOLIDATION_STATE = '@state@',
      CONSOLIDATION_AUTHOR = @author@,
      CONSOLIDATION_ROLE = @role@,
      CONSOLIDATION_DATE = @date@
      WHERE   SYSTEM_ID = @idDocument@
    </value>
  </query>
  <query>
    <name>I_INSERT_CONSOLIDATED_DOCUMENT</name>
    <value>
      INSERT INTO DPA_CONSOLIDATED_DOCS
      SELECT
      p.SYSTEM_ID AS ID,
      p.DOCNAME,
      p.CREATION_DATE,
      p.DOCUMENTTYPE,
      p.AUTHOR,
      @userdb@.getpeoplename (p.author) AS AUTHOR_NAME,
      p.ID_RUOLO_CREATORE,
      @userdb@.getDescCorr(p.id_ruolo_creatore) AS RUOLO_CREATORE,
      p.NUM_PROTO,
      p.NUM_ANNO_PROTO,
      p.DTA_PROTO,
      p.ID_PEOPLE_PROT,
      @userdb@.getpeoplename (p.id_people_prot) AS PEOPLE_PROT,
      p.ID_RUOLO_PROT,
      @userdb@.getDescCorr(p.id_ruolo_prot) AS RUOLO_PROT,
      p.ID_REGISTRO,
      @userdb@.GetCodReg(p.id_registro) AS REGISTRO,
      p.CHA_TIPO_PROTO,
      p.VAR_PROTO_IN,
      p.DTA_PROTO_IN,
      p.DTA_ANNULLA,
      p.ID_OGGETTO,
      p.VAR_PROF_OGGETTO,
      @userdb@.corrcat (p.system_id, p.cha_tipo_proto) AS MITT_DEST,
      p.ID_DOCUMENTO_PRINCIPALE
      FROM profile p WITH(NOLOCK)
      WHERE p.system_id = @idDocument@ AND p.consolidation_state = 2
    </value>
  </query>
  <query>
    <name>SAVE_GRID_SETTINGS</name>
    <value>
      INSERT INTO DPA_GRIDS
      (
      @colID@
      USER_ID_CREATORE,
      ROLE_ID_CREATORE,
      ADMINISTRATION_ID,
      SERIALIZED_GRID,
      TYPE_GRID,
      CHA_VISIBILE_A_UTENTE_O_RUOLO,
      IS_SEARCH_GRID,
      GRID_NAME
      )
      values
      (
      @id@
      @userId@,
      @roleId@,
      @administrationId@,
      null,
      '@typeGrid@',
      '@visibility@',
      '@searchGrid@',
      '@gridName@'
      )
    </value>
  </query>
  <query>
    <name>LOAD_GRID_SETTINGS</name>
    <value>
      SELECT * FROM DPA_GRIDS WHERE SYSTEM_ID = @gridId@
    </value>
  </query>
  <query>
    <name>GET_STANDARD_GRID_FOR_USER</name>
    <value>
      SELECT * FROM DPA_GRIDS
      WHERE
      USER_ID_CREATORE = @userId@
      AND
      ROLE_ID_CREATORE = @roleId@
      AND
      ADMINISTRATION_ID = @administrationId@
      AND
      TYPE_GRID = '@typeGrid@'
      AND
      SEARCH_ID = -1
      ORDER BY SYSTEM_ID DESC
    </value>
  </query>
  <query>
    <name>GET_GRID_FROM_SEARCH_ID</name>
    <value>
      SELECT * FROM DPA_GRIDS
      WHERE
      (
      USER_ID_CREATORE = @userId@
      OR
      ROLE_ID_CREATORE = @roleId@
      )
      AND
      ADMINISTRATION_ID = @administrationId@
      AND
      SYSTEM_ID = @gridId@
    </value>
  </query>
  <query>
    <name>EXIST_GRID_FOR_RAPID_SEARCH</name>
    <value>
      SELECT COUNT(*) FROM DPA_GRIDS
      WHERE
      USER_ID = @userId@
      AND
      ROLE_ID = @roleId@
      AND
      ADMINISTRATION_ID = @adminId@
      AND
      SEARCH_ID = @searchId@
    </value>
  </query>
  <query>
    <name>S_HAS_DOCUMENT_VERSIONS_FULL_VISIBILITY</name>
    <value>
      select @userdb@.hasVersionsFullVisibility(@idProfile@, @idPeople@, @idGroup@)
    </value>
  </query>
  <query>
    <name>S_GET_COUNT_ROWS_RICERCA_DOCUMENTI_IN_FASCICOLO_MASSIVE_OPERATION</name>
    <value>
      SELECT SYSTEM_ID, CODICE
      FROM
      ( SELECT TOP @totalRows@
      B.LINK as SYSTEM_ID,
      (case when a.num_proto is not null then a.num_proto when a.num_proto is null then a.docnumber end) as CODICE
      FROM  PROJECT_COMPONENTS B, PROFILE A @param6@
      WHERE  B.PROJECT_ID= @param2@
      AND  @security@
      AND B.LINK=A.SYSTEM_ID
      AND isnull(CHA_IN_CESTINO,'0')='0'
      AND @dbuser@.Getidamm(A.AUTHOR) = (SELECT ID_AMM FROM PEOPLE WHERE SYSTEM_ID = @idPeople@)
      @param5@
      ) as B
    </value>
  </query>
  <query>
    <name>PD_GET_VALUES_CONTATORI_DOC</name>
    <value>
      select
      dpa_contatori_doc.system_id,
      dpa_contatori_doc.id_ogg,
      dpa_contatori_doc.id_tipologia,
      dpa_contatori_doc.id_aoo,
      dpa_contatori_doc.id_rf,
      dpa_contatori_doc.valore,
      dpa_contatori_doc.abilitato,
      dpa_contatori_doc.anno,
      dpa_contatori_doc.valore_sc,
      (select var_codice from dpa_el_registri where system_id = dpa_contatori_doc.id_aoo or system_id = dpa_contatori_doc.id_rf) as codice_rf_aoo,
      nvl((select var_desc_registro from dpa_el_registri where system_id = dpa_contatori_doc.id_aoo or system_id = dpa_contatori_doc.id_rf),'Contatore di Tipologia') as desc_rf_aoo
      from dpa_contatori_doc
      where
      dpa_contatori_doc.id_ogg = @idOggettoCustom@
      and
      (
      dpa_contatori_doc.id_aoo in (select system_id from dpa_el_registri)
      or
      dpa_contatori_doc.id_rf in (select system_id from dpa_el_registri)
      or
      dpa_contatori_doc.id_aoo = 0
      or
      dpa_contatori_doc.id_rf = 0
      )
      order by dpa_contatori_doc.system_id
    </value>
  </query>
  <query>
    <name>S_GET_CODICE_CLASSIFICA</name>
    <value>
      select A.VAR_CODICE
      from PROJECT A
      where A.SYSTEM_ID IN

      (SELECT TOP 1 A.ID_FASCICOLO FROM PROJECT A, PROJECT_COMPONENTS B
      WHERE A.SYSTEM_ID=B.PROJECT_ID AND B.LINK=@idProfile@ ORDER BY CHA_FASC_PRIMARIA DESC, DTA_CLASS DESC)
    </value>
  </query>

  <query>
    <name>PD_DELETE_CONT_DOC</name>
    <value>
      delete dpa_contatori_doc where system_id = @system_id@
    </value>
  </query>
  <query>
    <name>GET_MAX_DTA_REGISTRAZIONE</name>
    <value>
      select max(CONVERT(DATE,valore_oggetto_db,103)) AS DTA_REGISTRAZIONE
      from dpa_associazione_templates
      where
      id_template = @idTemplate@
      and
      id_oggetto = @idOggetto@
      and
      valore_oggetto_db &lt;&gt; ''
      and
      doc_number in
      (
      select doc_number from dpa_associazione_templates where id_template = @idTemplate@ and doc_number is not null and id_aoo_rf = @idAooRf@
      )
    </value>
  </query>
  <query>
    <name>GET_DOC_MODEL_NAME</name>
    <value>
      SELECT t.var_desc_atto
      FROM dpa_tipo_atto t
      WHERE t.system_id = @modelId@
    </value>
  </query>
  <query>
    <name>GET_PRJ_MODEL_NAME</name>
    <value>
      SELECT t.var_desc_fasc
      FROM dpa_tipo_fasc t
      WHERE t.system_id = @modelId@
    </value>
  </query>
  <query>
    <name>S_PROFILE_ANNULLAMENTO_SYSTEM_ID</name>
    <value>SELECT system_id FROM PROFILE WITH(NOLOCK) WHERE SYSTEM_ID=@systemId@ AND DTA_ANNULLA IS NOT NULL</value>
  </query>
  <query>
    <name>EXIST_GRID_PERSONALIZATION_FUNCTION</name>
    <value>
      SELECT COUNT (f.disabled)
      FROM dpa_anagrafica_funzioni f
      WHERE f.cod_funzione = 'GRID_PERSONALIZATION' AND f.disabled = 'N'
    </value>
  </query>
  <query>
    <name>S_J_PROFILE__SECURITY__OGGETTARIO_NO_SECURITY</name>
    <value>
      SELECT DISTINCT @param1@
      FROM PROFILE A WITH(NOLOCK)
      @param2@
      WHERE
      @param3@
      ORDER BY @param4@
    </value>
  </query>
  <query>
    <name>S_VERIFICA_CODICE_CORRETTO</name>
    <value>
      SELECT *
      FROM dpa_corr_globali c, dpa_dett_globali dc
      WHERE c.var_cod_rubrica = '@var_cod_rubrica@'
      AND dc.id_corr_globali = c.system_id
      AND c.dta_fine IS NULL
      AND c.cha_tipo_urp = 'U'
      AND c.cha_tipo_ie = 'I'
      AND dc.var_note = 'pubblicazione'
    </value>
  </query>
  <query>
    <name>S_CODICE_CORRETTO_BY_ID</name>
    <value>
      SELECT *
      FROM dpa_corr_globali c, dpa_dett_globali dc
      WHERE c.system_id = @system_id@
      AND dc.id_corr_globali = c.system_id
      AND c.dta_fine IS NULL
      AND c.cha_tipo_urp = 'U'
      AND c.cha_tipo_ie = 'I'
      AND dc.var_note = 'pubblicazione'
    </value>
  </query>
  <query>
    <name>S_CODICE_CORRETTO</name>
    <value>
      SELECT *
      FROM dpa_corr_globali c, dpa_dett_globali dc
      WHERE c.var_cod_rubrica = '@var_cod_rubrica@'
      AND c.dta_fine IS NULL
      AND c.cha_tipo_urp = 'U'
      AND c.cha_tipo_ie = 'I'
    </value>
  </query>
  <query>
    <name>S_EREDITA_RAGIONE_TRASM_SINGOLA</name>
    <value>
      SELECT p.CHA_EREDITA FROM DPA_RAGIONE_TRASM p,
      DPA_TRASM_SINGOLA s WHERE s.system_id = @id_trasm@ AND p.SYSTEM_ID=s.ID_RAGIONE
    </value>
  </query>
  <query>
    <name>S_MITTENTE_BY_TRASMISSIONE</name>
    <value>
      SELECT r.ID_AMM, r.ID_GRUPPO,r.SYSTEM_ID as ID_CORR_GLOBALE_RUOLO, t.ID_PEOPLE, e.num_livello
      FROM  DPA_CORR_GLOBALI r, DPA_TRASMISSIONE t, dpa_tipo_ruolo e
      where t.SYSTEM_ID = @id_trasm@ and t.ID_RUOLO_IN_UO = r.SYSTEM_ID AND e.system_id = r.id_tipo_ruolo
    </value>
  </query>
  <query>
    <name>GET_STANDARD_GRID_ID</name>
    <value>
      SELECT system_id FROM DPA_GRIDS
      WHERE
      USER_ID = @userId@
      AND
      ROLE_ID = @roleId@
      AND
      ADMINISTRATION_ID = @administrationId@
      AND
      TYPE_GRID = '@gridType@'
      AND
      SEARCH_ID = -1
      ORDER BY SYSTEM_ID DESC
    </value>
  </query>
  <query>
    <name>S_DPACorrGlobaliRuolo</name>
    <value>
      with gerarchia as
      (select    cgbase.*, 0 as level
      FROM dpa_corr_globali as cgbase
      WHERE cgbase.cha_tipo_ie = 'I'
      @paramdtafine1@
      and cgbase.CHA_TIPO_URP='U'
      and cgbase.system_id = @param2@
      UNION ALL
      select    cg.*, level +1
      FROM dpa_corr_globali cg INNER JOIN gerarchia g on cg.ID_PARENT = g.SYSTEM_ID
      WHERE cg.cha_tipo_ie = 'I'
      and cg.CHA_TIPO_URP='U'
      @paramdtafine2@
      )
      select * from gerarchia
    </value>
  </query>
  <query>
    <name>U_SECURITY_ACCESSRIGHTS_DOCUMENTO</name>
    <value>
      UPDATE SECURITY SET ACCESSRIGHTS = 63 where ACCESSRIGHTS = 255
      and CHA_TIPO_DIRITTO = 'F' and thing = @idProfile@
    </value>
  </query>
  <query>
    <name>I_SECURITY_SELECT_MODIFICATA</name>
    <value>
      INSERT INTO SECURITY (THING, PERSONORGROUP, ACCESSRIGHTS, ID_GRUPPO_TRASM, CHA_TIPO_DIRITTO)
      (SELECT DISTINCT @param1@, personorgroup, accessrights, @param2@, 'F'
      FROM security  WITH (nolock) , dpa_l_ruolo_reg b, dpa_corr_globali c
      WHERE personorgroup = c.id_gruppo
      AND c.system_id = b.id_ruolo_in_uo
      @param8@
      AND thing = @param5@
      AND NOT personorgroup IN (SELECT personorgroup
      FROM security  WITH (nolock)
      WHERE thing = @param1@)
      UNION
      SELECT DISTINCT @param1@, personorgroup, accessrights, @param2@, 'F'
      FROM security  WITH (nolock) ,
      dpa_l_ruolo_reg b,
      dpa_corr_globali c,
      peoplegroups d
      WHERE personorgroup = d.people_system_id
      AND d.dta_fine IS NULL
      AND c.id_gruppo = d.groups_system_id
      AND c.system_id = b.id_ruolo_in_uo
      AND accessrights != 0
      @param9@
      AND thing = @param5@
      AND NOT personorgroup IN (SELECT personorgroup
      FROM security  WITH (nolock)
      WHERE thing = @param1@)
      )
    </value>
  </query>
  <query>
    <name>I_SECURITY_SELECT_MODIFICATA_SEMPL</name>
    <value>
      INSERT INTO SECURITY (THING, PERSONORGROUP, ACCESSRIGHTS, ID_GRUPPO_TRASM, CHA_TIPO_DIRITTO)
      (SELECT DISTINCT @param1@, personorgroup, accessrights, @param2@, 'F'
      FROM security  WITH (nolock) , dpa_l_ruolo_reg b, dpa_corr_globali c
      WHERE personorgroup = c.id_gruppo
      AND c.system_id = b.id_ruolo_in_uo
      AND thing = @param5@
      AND NOT personorgroup IN (SELECT personorgroup
      FROM security  WITH (nolock)
      WHERE thing = @param1@)
      )
    </value>
  </query>
  <query>
    <name>S_GET_ULTIMA_NOTA_INSERITA_TUTTI</name>
    <value>
      SELECT TOP 1 N.SYSTEM_ID,
      N.TESTO
      FROM    DPA_NOTE N
      WHERE   N.TIPOOGGETTOASSOCIATO = '@tipoOggetto@' AND
      N.IDOGGETTOASSOCIATO = @idOggetto@ AND
      (N.TIPOVISIBILITA = 'T')
      ORDER BY N.DATACREAZIONE DESC
    </value>
  </query>
  <query>
    <name>S_GET_SECURITY_PROFILE_SEMPL</name>
    <value>
      SELECT DISTINCT a.system_id, a.var_cod_rubrica, a.id_registro, a.id_amm,
      c.var_desc_ruolo, b.cha_tipo_diritto, b.personorgroup,
      b.hide_doc_versions, b.accessrights, a.id_uo, a.cha_tipo_corr,
      a.cha_tipo_ie, a.cha_tipo_urp, a.var_desc_corr,
      d.var_desc_corr AS desc_uo, d.cha_tipo_ie AS cha_tipo_uo,
      d.var_cod_rubrica AS var_cod_uo,
      b.ts_inserimento,
      b.var_note_sec,
      (select count(*) from dpa_role_history where original_corr_id = A.Original_Id and action != 'C') as ShowHistory,
      a.dta_fine
      FROM dpa_corr_globali a,
      security as b   ,
      dpa_tipo_ruolo c,
      dpa_corr_globali d
      WHERE a.id_gruppo = b.personorgroup
      AND c.system_id = a.id_tipo_ruolo
      AND d.system_id = a.id_uo
      AND b.thing NOT IN (
      SELECT system_id
      FROM PROFILE p WITH(NOLOCK)
      WHERE p.system_id = b.thing
      AND ISNULL (p.cha_in_cestino, '0') = '1')
      AND b.thing = @param1@
      AND (b.accessrights >= 0 OR b.cha_tipo_diritto = 'P')
      ORDER BY b.accessrights DESC, a.id_uo ASC
    </value>
  </query>
  <query>
    <name>S_GET_SECURITY_PROFILE_SEMPL_PEOPLE</name>
    <value>
      SELECT DISTINCT c.system_id, c.id_registro, c.id_amm, a.var_nome,
      a.var_cognome, c.var_cod_rubrica, b.cha_tipo_diritto,
      b.accessrights, a.system_id as personorgroup, b.hide_doc_versions, c.cha_tipo_corr,
      c.cha_tipo_ie, c.cha_tipo_urp, c.var_desc_corr
      FROM people a, security as b  WITH (nolock) , dpa_corr_globali c
      WHERE a.system_id = b.personorgroup
      AND c.id_people = a.system_id
      AND b.thing = @param1@
      AND (b.accessrights > 0 OR b.cha_tipo_diritto = 'P')
      AND c.id_amm = @param2@
    </value>
  </query>
  <query>
    <name>S_GET_SECURITY_PROFILE_SEMPL_RUOLI_DELETE</name>
    <value>
      SELECT DISTINCT a.system_id, a.var_cod_rubrica, a.id_registro, a.id_amm,
      c.var_desc_ruolo, b.cha_tipo_diritto, b.note, b.personorgroup,
      b.hide_doc_versions, b.accessrights, a.id_uo, a.cha_tipo_corr,
      a.cha_tipo_ie, a.cha_tipo_urp, a.var_desc_corr,
      d.var_desc_corr AS desc_uo, d.cha_tipo_ie AS cha_tipo_uo,
      d.var_cod_rubrica AS var_cod_uo
      FROM dpa_corr_globali a, deleted_security as b  , dpa_tipo_ruolo c, dpa_corr_globali d
      WHERE a.id_gruppo = b.personorgroup
      AND c.system_id = a.id_tipo_ruolo
      AND d.system_id = a.id_uo
      AND b.thing = @param1@
      AND (b.accessrights >= 0 OR b.cha_tipo_diritto = 'P')
      And Not Exists (Select 'x' From security as sec  WITH (nolock)  Where sec.thing = b.thing and sec.personorgroup = b.personorgroup And sec.accessrights > 20)
      ORDER BY b.accessrights DESC, a.id_uo ASC
    </value>
  </query>
  <query>
    <name>S_GET_SECURITY_PROFILE_SEMPL_FASC</name>
    <value>
      SELECT
      DISTINCT a.system_id, a.var_cod_rubrica, a.id_registro, a.id_amm,
      c.var_desc_ruolo, b.cha_tipo_diritto, b.accessrights, a.id_uo,
      b.personorgroup, b.accessrights, a.id_uo, a.cha_tipo_corr,
      a.cha_tipo_ie, a.cha_tipo_urp, a.var_desc_corr,
      d.var_desc_corr AS desc_uo, d.cha_tipo_ie AS cha_tipo_uo,
      d.var_cod_rubrica AS var_cod_uo,  b.ts_inserimento, b.var_note_sec,
      (select count(*) from dpa_role_history where original_corr_id = A.Original_Id and action != 'C') as ShowHistory,
      a.dta_fine
      FROM dpa_corr_globali a, security as b  WITH (nolock) , dpa_tipo_ruolo c, dpa_corr_globali d
      WHERE b.thing = @param1@
      AND a.id_gruppo = b.personorgroup
      AND c.system_id = a.id_tipo_ruolo
      AND d.SYSTEM_ID = a.id_uo
      ORDER BY b.accessrights DESC, a.id_uo ASC
    </value>
  </query>
  <query>
    <name>S_GET_SECURITY_PROFILE_SEMPL_FASC_UTENTI</name>
    <value>
      SELECT DISTINCT c.system_id, c.id_registro, c.id_amm, a.var_nome,
      a.var_cognome, c.var_cod_rubrica, b.cha_tipo_diritto,
      b.personorgroup, b.accessrights, a.disabled,
      c.cha_tipo_corr, c.cha_tipo_ie,
      c.cha_tipo_urp, c.var_desc_corr
      FROM people a, security as b  WITH (nolock) , dpa_corr_globali c
      WHERE b.thing = @param1@
      AND a.system_id = b.personorgroup
      AND c.id_people = a.system_id
      AND c.cha_tipo_urp &lt;&gt; 'L'
    </value>
  </query>
  <query>
    <name>S_GET_SECURITY_FASC_SEMPL_RUOLI_DELETE</name>
    <value>
      SELECT DISTINCT a.system_id, a.var_cod_rubrica, a.id_registro, a.id_amm,
      c.var_desc_ruolo, b.cha_tipo_diritto, b.accessrights, a.id_uo,
      b.note, b.personorgroup, a.cha_tipo_corr,
      a.cha_tipo_ie, a.cha_tipo_urp, a.var_desc_corr,
      d.var_desc_corr AS desc_uo, d.cha_tipo_ie AS cha_tipo_uo,
      d.var_cod_rubrica AS var_cod_uo
      FROM dpa_corr_globali a, deleted_security as b WITH (nolock) , dpa_tipo_ruolo c, dpa_corr_globali d
      WHERE b.thing = @param1@
      AND a.id_gruppo = b.personorgroup
      AND c.system_id = a.id_tipo_ruolo
      AND d.system_id = a.id_uo
      And Not Exists (Select 'x' From security as sec  WITH (nolock)  Where sec.thing = b.thing and sec.personorgroup = b.personorgroup And sec.accessrights > 20)
      ORDER BY b.accessrights DESC, a.id_uo ASC
    </value>
  </query>
  <query>
    <name>S_GET_SECURITY_PROFILE_SEMPL_FASC_UTENTI_DELETE</name>
    <value>
      SELECT DISTINCT c.system_id, c.id_registro, c.id_amm, a.var_nome,
      a.var_cognome, c.var_cod_rubrica, b.cha_tipo_diritto,
      b.accessrights, a.disabled,
      a.system_id AS personorgroup,
      c.cha_tipo_corr, c.cha_tipo_ie, c.cha_tipo_urp,
      c.var_desc_corr
      FROM people a, deleted_security b, dpa_corr_globali c
      WHERE b.thing = @param1@
      AND a.system_id = b.personorgroup
      AND c.id_people = a.system_id
      AND c.cha_tipo_urp &lt;&gt; 'L'
    </value>
  </query>
  <query>
    <name>S_GET_DISPOSITIVI_STAMPA_ETICHETTA</name>
    <value>
      SELECT
      Id,
      Code,
      Description
      FROM DPA_DISPOSITIVI_STAMPA
    </value>
  </query>
  <query>
    <name>S_GET_DISPOSITIVO_STAMPA_UTENTE</name>
    <value>
      select p.ID_DISPOSITIVO_STAMPA AS DISPOSITIVO_PEOPLE,
      a.ID_DISPOSITIVO_STAMPA AS DISPOSITIVO_AMMINISTRA
      from DOCSADM.PEOPLE p
      left join DOCSADM.DPA_AMMINISTRA a on P.ID_AMM = A.SYSTEM_ID
      where p.SYSTEM_ID = @idPeople@
    </value>
  </query>
  <query>
    <name>S_GET_ID_FASC_OR_SOTTOFASC_DA_ID_DOC</name>
    <value>
      select
      ID_FASCICOLO AS ID_FASC_OR_SOTTOFASC, 'F' AS FAR_OR_SOTTOFASC
      from PROJECT where SYSTEM_ID
      in(
      select PC.PROJECT_ID
      from PROJECT_COMPONENTS as PC
      where PC.LINK = @idProfile@
      )
      and ID_FASCICOLO = id_parent
      UNION
      select
      SYSTEM_ID AS ID_FASC_OR_SOTTOFASC, 'SF' AS FAR_OR_SOTTOFASC
      from PROJECT where SYSTEM_ID
      in(
      select PC.PROJECT_ID
      from PROJECT_COMPONENTS as PC
      where PC.LINK = @idProfile@
      )
      and ID_FASCICOLO != id_parent
    </value>
  </query>
  <query>
    <name>S_TRASMISSIONE_SINGOLA_LITE</name>
    <value>
      SELECT b.system_id, a.cha_tipo_oggetto, a.id_profile, a.id_project,
      b.cha_tipo_trasm, b.cha_tipo_dest, b.cha_set_eredita, d.cha_eredita,
      d.cha_tipo_diritti, d.cha_tipo_dest AS cha_tipo_dest_rag, a.id_people,
      a.id_ruolo_in_uo, g.id_gruppo, b.id_corr_globale, d.cha_tipo_ragione,
      d.system_id as id_ragione, (Select P.ID_AMM from people p where system_id = a.id_people) as id_amm_people
      FROM dpa_trasm_singola b,
      dpa_trasmissione a,
      dpa_trasm_utente c,
      dpa_ragione_trasm d,
      dpa_corr_globali g
      WHERE a.system_id = @param1@
      AND c.system_id = @param2@
      AND b.id_trasmissione = a.system_id
      AND c.id_trasm_singola = b.system_id
      AND g.system_id = a.id_ruolo_in_uo
      AND d.system_id = b.id_ragione
    </value>
  </query>
  <query>
    <name>S_TRASM_TUTTE_DEST_UTENTE_DA_SINGOLA</name>
    <value>
      SELECT a.system_id, a.id_people, d.full_name
      FROM dpa_trasm_utente a, people d
      WHERE a.id_trasm_singola = @idTrasmSingola@ AND id_people = d.system_id
    </value>
  </query>
  <query>
    <name>S_TIPO_DEST_FROM_TRASM_SING</name>
    <value>
      select cha_tipo_dest from dpa_trasm_singola where system_id = @id_trasm@
    </value>
  </query>
  <query>
    <name>S_RIC_DOC_EXPORT</name>
    <value>
      SELECT
      A.SYSTEM_ID, A.DOCNUMBER, A.DTA_ANNULLA, A.VAR_PROF_OGGETTO AS VAR_DESC_OGGETTO,
      A.ID_REGISTRO, A.CHA_TIPO_PROTO, A.CHA_EVIDENZA, A.NUM_ANNO_PROTO,
      ISNULL(A.DTA_PROTO,A.CREATION_TIME) AS DATA,
      convert(nvarchar (10), A.CREATION_TIME, 103) AS CREATION_DATE,
      A.NUM_PROTO, A.VAR_SEGNATURA, convert(nvarchar (10), A.DTA_PROTO, 103) AS DTA_PROTO,
      @dbuser@.getchaimg(A.DOCNUMBER) AS CHA_IMG , A.CHA_PRIVATO, A.CHA_PERSONALE, @dbuser@.getInADL(A.SYSTEM_ID,'D',@idGruppo@,@idPeople@) AS IN_ADL,
      A.ID_DOCUMENTO_PRINCIPALE, @dbuser@.getInConservazione(A.SYSTEM_ID, null,'D', @idPeople@, @idGruppo@) AS IN_CONSERVAZIONE, A.CHA_IN_ARCHIVIO,
      a.id_tipo_atto as ID_TIPO_ATTO, ta.var_desc_atto as DESC_TIPO_ATTO, @dbuser@.getPeopleUserId (a.AUTHOR) as AUTHOR, a.prot_tit as PROT_TIT,
      @dbuser@.getchafirmato(A.DOCNUMBER) as CHA_FIRMATO, @dbuser@.getchatipofirma(A.DOCNUMBER) as CHA_TIPO_FIRMA, @dbuser@.getchatipofirma(A.DOCNUMBER) as CHA_TIPO_FIRMA,  @dbuser@.corrcat(A.system_id, A.cha_tipo_proto) as MITT_DEST, @dbuser@.GetContatoreDoc(a.system_id, @tipo_doc@) as CONTATORE,
      @dbuser@.getContatoreDocOrdinamento(a.system_id, @tipo_doc@) as contatore_ordinamento
      @customFieldFilter@
      FROM PROFILE a WITH(NOLOCK)
      LEFT JOIN dpa_tipo_atto ta on a.id_tipo_atto = ta.system_id
      @from@
      WHERE @security@
      @filters@
      @unionStampe@
      @doc@
      ORDER BY  @order@
    </value>
  </query>
  <query>
    <name>S_J_DPA_TRASMISSIONE__TRASM_SINGOLA__TRASM_UTENTE3</name>
    <value>
      SELECT /*+index(c) index(b) index(a) */ @param1@,
      ISNULL(@dbuser@.Vardescribe(id_profile,'SEGNATURA_CODFASC'),@dbuser@.Vardescribe(id_project,'CODFASC')) ID_SEGN_CODFASC,
      ISNULL(@dbuser@.Vardescribe(id_profile,'DATADOC'),@dbuser@.Vardescribe(id_project,'DATA_CREAZ')) DATA_DOC_FASC,
      z.var_desc_corr, e.full_name, f.var_desc_corr AS desc_ruolo_mitt,
      g.cha_tipo_ragione, g.var_desc_ragione, g.cha_eredita,
      g.cha_tipo_diritti, h.FULL_NAME as desc_destinatario, f.var_codice as cod_ruolo_mitt,
      e.user_id, g.cha_risposta,
      g.cha_tipo_dest AS tipo_dest_rag, g.var_note, g.cha_tipo_risposta,
      g.var_notifica_trasm, g.var_testo_msg_notifica_doc,
      g.var_testo_msg_notifica_fasc, g.cha_cede_diritti,
      g.cha_mantieni_lett
      FROM   DPA_TRASM_UTENTE C,DPA_TRASM_SINGOLA B,DPA_TRASMISSIONE A, dpa_corr_globali z,
      people e,
      dpa_corr_globali f,
      dpa_ragione_trasm g,
      people h
      @param2@
      WHERE @param3@
      AND z.system_id = b.id_corr_globale
      AND e.system_id = a.id_people
      AND f.system_id = a.id_ruolo_in_uo
      AND g.system_id = b.id_ragione
      AND h.system_id = c.id_people
      ORDER BY @orderCondition@, C.SYSTEM_ID DESC
    </value>
  </query>
  <query>
    <name>S_J_DPA_TRASMISSIONE__TRASM_SINGOLA__TRASM_UTENTE_EXPORT</name>
    <value>
      SELECT /*+ index (A INDX_TRASM3) */ A.ID_RUOLO_IN_UO, A.ID_PEOPLE, A.CHA_TIPO_OGGETTO,
      A.ID_PROFILE, A.ID_PROJECT,@param1@ AS DTA_INVIO_F,
      A.VAR_NOTE_GENERALI,B.ID_RAGIONE, B.ID_TRASMISSIONE,
      B.ID_TRASM_UTENTE, B.CHA_TIPO_DEST,B.ID_CORR_GLOBALE,
      B.HIDE_DOC_VERSIONS,B.VAR_NOTE_SING, B.CHA_TIPO_TRASM,@param2@ AS DTA_SCADENZA,
      C.SYSTEM_ID AS ID_TRASMISSIONE_UTENTE, C.ID_PEOPLE AS ID_DESTINATARIO,
      @param3@ AS DTA_VISTA,CHA_VISTA,@param4@ AS DTA_ACCETTATA,CHA_ACCETTATA,
      @param5@ AS DTA_RIFIUTATA,CHA_RIFIUTATA,C.VAR_NOTE_RIF, C.VAR_NOTE_ACC,
      C.ID_TRASM_SINGOLA, C.CHA_VALIDA, C.DTA_RIMOZIONE_TODOLIST AS DTA_RIMOSSA_TDL, A.CHA_SALVATA_CON_CESSIONE,
      A.ID_PEOPLE_DELEGATO AS ID_PEOPLE_DELEGATO, C.ID_PEOPLE_DELEGATO AS DELEGATO_UTENTE, C.CHA_ACCETTATA_DELEGATO AS ACCETTATA_DELEGATO, C.CHA_VISTA_DELEGATO AS VISTA_DELEGATO, C.CHA_RIFIUTATA_DELEGATO AS RIFIUTATA_DELEGATO,
      ISNULL(@dbuser@.Vardescribe(id_profile,'SEGNATURA_CODFASC'),@dbuser@.Vardescribe(id_project,'CODFASC')) ID_SEGN_CODFASC,
      ISNULL(@dbuser@.Vardescribe(id_profile,'DATADOC'),@dbuser@.Vardescribe(id_project,'DATA_CREAZ')) DATA_DOC_FASC,
      z.var_desc_corr, e.full_name, f.var_desc_corr AS desc_ruolo_mitt,
      g.cha_tipo_ragione, g.var_desc_ragione, g.cha_eredita,
      g.cha_tipo_diritti, h.FULL_NAME as desc_destinatario, f.var_codice as cod_ruolo_mitt,
      e.user_id, g.cha_risposta,
      g.cha_tipo_dest AS tipo_dest_rag, g.var_note, g.cha_tipo_risposta,
      g.var_notifica_trasm, g.var_testo_msg_notifica_doc,
      g.var_testo_msg_notifica_fasc, g.cha_cede_diritti,
      g.cha_mantieni_lett,
      g.CHA_PROC_RES,
      g.CHA_FASC_OBBLIGATORIA
      FROM DPA_TRASMISSIONE A, DPA_TRASM_SINGOLA B, DPA_TRASM_UTENTE C,
      dpa_corr_globali z,
      people e,
      dpa_corr_globali f,
      dpa_ragione_trasm g,
      people h @param7@
      WHERE A.SYSTEM_ID=B.ID_TRASMISSIONE AND B.SYSTEM_ID=C.ID_TRASM_SINGOLA
      @param6@
      AND z.system_id = b.id_corr_globale
      AND e.system_id = a.id_people
      AND f.system_id = a.id_ruolo_in_uo
      AND g.system_id = b.id_ragione
      AND h.system_id = c.id_people
      ORDER BY @orderCondition@, B.ID_TRASMISSIONE DESC
    </value>
  </query>
  <query>
    <name>S_RIC_DOC_VELOCE_EXPORT</name>
    <value>
      SELECT TOP @rowCount@ * FROM (
      SELECT TOP @rowCount@ * FROM (
      SELECT DISTINCT TOP @rowCount@
      A.SYSTEM_ID, A.DOCNUMBER, A.DTA_ANNULLA, A.VAR_PROF_OGGETTO AS VAR_DESC_OGGETTO, A.ID_REGISTRO,
      A.CHA_TIPO_PROTO, A.CHA_EVIDENZA, A.NUM_ANNO_PROTO, ISNULL(A.DTA_PROTO,A.CREATION_TIME) AS DATA,
      convert(nvarchar (10), A.CREATION_TIME, 103) AS CREATION_DATE,
      A.NUM_PROTO, A.VAR_SEGNATURA, convert(nvarchar (10), A.DTA_PROTO, 103) AS DTA_PROTO,
      @dbuser@.getchaimg(A.DOCNUMBER) AS CHA_IMG , @dbuser@.corrcat(A.system_id, A.cha_tipo_proto) as MITT_DEST, A.CHA_PRIVATO, A.CHA_PERSONALE, @dbuser@.getInADL(A.SYSTEM_ID,'D',@idGruppo@,@idPeople@) AS IN_ADL,
      A.ID_DOCUMENTO_PRINCIPALE,
      @dbuser@.getInConservazione(A.SYSTEM_ID, null,'D', @idPeople@, @idGruppo@) AS IN_CONSERVAZIONE,
      a.id_tipo_atto as ID_TIPO_ATTO, ta.var_desc_atto as DESC_TIPO_ATTO, @dbuser@.getPeopleUserId (a.AUTHOR) as AUTHOR,
      @dbuser@.getchafirmato(A.DOCNUMBER) as CHA_FIRMATO,
      @dbuser@.getchatipofirma(A.DOCNUMBER) as CHA_TIPO_FIRMA
      FROM PROFILE a WITH(NOLOCK)
      LEFT JOIN dpa_tipo_atto ta on a.id_tipo_atto = ta.system_id
      WHERE @security@
      @filters@
      and isnull(dta_proto,creation_date) between convert(datetime,'@dataInizioAnno@',103) and getdate()
      @unionStampe@
      @doc@
      ORDER BY @order@
      ) AS A ORDER BY @reverseOrder@
      ) AS A ORDER BY @order@
    </value>
  </query>
  <query>
    <name>S_FASCICOLI_PAGING_EXPORT</name>
    <value>
      SELECT
      a.system_id, a.description, a.cha_tipo_proj, a.var_codice,
      a.id_amm, a.num_livello,a.cha_tipo_fascicolo, a.id_fascicolo,
      a.id_parent,a.var_cod_ultimo,a.var_note,@dtaAp@ AS dta_apertura,
      @dtaCh@ AS dta_chiusura,a.cha_stato, a.id_tipo_proc, a.id_registro ,
      @dbuser@.getcodreg(a.id_registro) as codReg,a.id_uo_lf,A.DTA_UO_LF,
      a.dta_creazione, a.cartaceo,a.cha_privato,a.ID_UO_REF,
      @dbuser@.getAccessRightsProject(@idPeo@,@idGrp@,@idRuoloPubblico@,a.system_id) as accessrights,
      @dbuser@.getCodtit(a.id_parent) as codTit, convert(nvarchar (10), a.dta_scadenza, 103) AS DTA_SCADENZA,
      @dbuser@.getInConservazione(null, a.system_id,'F', @idPeo@, @idGrp@) AS IN_CONSERVAZIONE, a.CHA_IN_ARCHIVIO,
      a.AUTHOR, a.ID_RUOLO_CREATORE, a.ID_UO_CREATORE,
      @dbuser@.GetContatoreFasc(a.system_id, @tipoContatore@) as CONTATORE,
      @dbuser@.getContatoreFascContatore(a.system_id, @tipoContatore@) as contatore_ordinamento,
      a.NUM_FASCICOLO, a.cha_controllato, a.cha_consenti_class, a.CHA_CONSENTI_FASC, a.ID_RUOLO_CHIUSURA, a.ID_UO_CHIUSURA, a.ID_AUTHOR_CHIUSURA,
      a.DTA_APERTURA AS DTA_APERTURA_ORDER,
      a.DTA_CHIUSURA AS DTA_CHIUSURA_ORDER, a.id_titolario, @adl@
      @customFieldForOrder@
      FROM project a @tblCL1@
      WHERE @security@
      AND (a.id_amm IS NULL OR a.id_amm = @idAmm@ )
      AND a.cha_tipo_proj = 'F'
      @idReg@
      @whereTlbCL1@
      @guiFilters@
      @idFasc@
      order by @customOrder@
    </value>
  </query>
  <query>
    <name>S_EXPORT_TRASM_MODEL</name>
    <value>
      SELECT 'MT_' + CONVERT(char, mt.system_id) as system_id, mt.nome, md.cha_tipo_mitt_dest,
      cg.var_desc_corr, cg.cha_tipo_urp, mt.cha_tipo_oggetto,
      r.var_desc_registro, rt.var_desc_ragione, cg.dta_fine,
      cg.cha_disabled_trasm
      FROM dpa_modelli_trasm mt INNER JOIN dpa_modelli_mitt_dest md
      ON mt.system_id = md.id_modello
      LEFT OUTER JOIN dpa_corr_globali cg ON md.id_corr_globali = cg.system_id
      INNER JOIN dpa_el_registri r ON mt.id_registro = r.system_id
      LEFT OUTER JOIN dpa_ragione_trasm rt ON md.id_ragione = rt.system_id
      WHERE mt.id_amm = @ammId@
      @filterCond@
      ORDER BY mt.system_id
    </value>
  </query>
  <query>
    <name>S_EXPORT_TRASM_MODEL_UTENTE</name>
    <value>
      SELECT 'MT_' + CONVERT(char, mt.system_id) as system_id, mt.nome, md.cha_tipo_mitt_dest, cg.var_desc_corr,
      cg.cha_tipo_urp, mt.cha_tipo_oggetto, r.var_desc_registro,
      rt.var_desc_ragione, cg.dta_fine, cg.cha_disabled_trasm
      FROM dpa_modelli_trasm mt INNER JOIN dpa_modelli_mitt_dest md
      ON mt.system_id = md.id_modello
      LEFT OUTER JOIN dpa_corr_globali cg ON md.id_corr_globali =
      cg.system_id
      INNER JOIN dpa_el_registri r ON mt.id_registro = r.system_id
      LEFT OUTER JOIN dpa_ragione_trasm rt ON md.id_ragione = rt.system_id
      WHERE mt.system_id IN (
      SELECT mt.system_id
      FROM dpa_modelli_trasm mt INNER JOIN dpa_modelli_mitt_dest md
      ON mt.system_id = md.id_modello
      WHERE mt.id_amm = @ammId@
      AND (mt.id_people = @idPeople@ OR mt.id_people IS NULL)
      AND md.cha_tipo_mitt_dest = 'M'
      AND mt.SINGLE = '0'
      AND (md.id_corr_globali = @idCorr@ OR md.id_corr_globali = 0)
      AND NOT EXISTS (
      SELECT dpa_ass_diagrammi.id_mod_trasm
      FROM dpa_ass_diagrammi
      WHERE md.id_modello =
      dpa_ass_diagrammi.id_mod_trasm))
      @filterCond@
      ORDER BY mt.system_id
    </value>
  </query>
  <query>
    <name>S_REPORT_ROLES_DISABLED</name>
    <value>
      SELECT   cg.var_codice AS codice, cg.var_desc_corr descrizione,
      @dbuser@.getcoduo (cg.id_uo) AS uo_appartenenza
      FROM dpa_corr_globali cg
      WHERE    cg.id_amm = @ammId@
      AND cg.cha_tipo_ie = 'I'
      AND cg.dta_fine IS NOT NULL
      AND cg.cha_tipo_urp = 'R'
      ORDER BY 1, 2
    </value>
  </query>
  <query>
    <name>S_REPORT_ROLES_INHIBITED</name>
    <value>
      SELECT   cg.var_codice AS codice, cg.var_desc_corr descrizione,
      @dbuser@.getcoduo (cg.id_uo) AS uo_appartenenza
      FROM dpa_corr_globali cg
      WHERE cg.id_amm = @ammId@
      AND cg.cha_tipo_urp = 'R'
      AND cg.cha_tipo_ie = 'I'
      AND cg.cha_disabled_trasm != '0'
      ORDER BY 1, 2
    </value>
  </query>
  <query>
    <name>S_REPORT_ROLES_WOUT_USERS</name>
    <value>
      SELECT   cg.var_codice AS codice, cg.var_desc_corr descrizione,
      @dbuser@.getcoduo (cg.id_uo) AS uo_appartenenza
      FROM dpa_corr_globali cg
      WHERE cg.id_amm = @ammId@
      AND cg.cha_tipo_urp = 'R'
      AND cg.cha_tipo_ie = 'I'
      AND cg.dta_fine IS NULL
      AND NOT EXISTS (
      SELECT 'x'
      FROM GROUPS g, people p, peoplegroups pg
      WHERE pg.groups_system_id = g.system_id
      AND pg.people_system_id = p.system_id
      AND cg.id_gruppo = g.system_id)
      ORDER BY 1, 2
    </value>
  </query>
  <query>
    <name>S_REPORT_ROLES_WOUT_REGS_OR_RF</name>
    <value>
      SELECT cg.var_codice AS codice, cg.var_desc_corr descrizione,
      @dbuser@.getcoduo (cg.id_uo) AS uo_appartenenza
      FROM dpa_corr_globali cg
      WHERE cg.id_amm = @ammId@
      AND cg.cha_tipo_urp = 'R'
      AND cg.cha_tipo_ie = 'I'
      AND cg.dta_fine IS NULL
      AND NOT EXISTS (
      SELECT 'x'
      FROM dpa_l_ruolo_reg lrr
      WHERE lrr.id_ruolo_in_uo = cg.system_id)
    </value>
  </query>
  <query>
    <name>S_REPORT_WOUT_FUNCTIONS</name>
    <value>
      SELECT   cg.var_codice AS codice, cg.var_desc_corr descrizione,
      @dbuser@.getcoduo (cg.id_uo) AS uo_appartenenza
      FROM dpa_corr_globali cg
      WHERE cg.id_amm = @ammId@
      AND cg.cha_tipo_urp = 'R'
      AND cg.cha_tipo_ie = 'I'
      AND cg.dta_fine IS NULL
      AND NOT EXISTS (SELECT 'x'
      FROM dpa_tipo_f_ruolo tfr
      --, dpa_corr_globali cg
      WHERE  tfr.id_ruolo_in_uo = cg.system_id)
      ORDER BY 1, 2
    </value>
  </query>
  <query>
    <name>S_REPORT_UO_WOUT_ROLES</name>
    <value>
      SELECT cg_uo.var_codice AS codice, cg_uo.var_desc_corr descrizione,
      @dbuser@.getcoduo (cg_uo.id_uo) AS uo_appartenenza
      FROM dpa_corr_globali cg_uo
      WHERE
      cg_uo.id_amm = @ammId@
      AND cg_uo.CHA_TIPO_URP = 'U'
      AND cg_uo.cha_tipo_ie = 'I'
      AND cg_uo.DTA_FINE is null
      AND NOT EXISTS  (SELECT   'x'
      FROM dpa_corr_globali cg_ruoli
      WHERE cg_uo.system_id = cg_ruoli.id_uo
      )
      ORDER BY 1, 2
    </value>
  </query>
  <query>
    <name>S_REPORT_WOUT_RF</name>
    <value>
      SELECT cg_uo.var_codice AS codice, cg_uo.var_desc_corr descrizione,
      @dbuser@.getcoduo (cg_uo.id_uo) AS uo_appartenenza
      FROM dpa_corr_globali cg_uo
      WHERE
      cg_uo.id_amm = @ammId@
      and cg_uo.CHA_TIPO_URP = 'U'
      AND cg_uo.cha_tipo_ie = 'I'
      and cg_uo.DTA_FINE is null
      and not exists  (SELECT   'x'
      FROM dpa_corr_globali cg_ruoli
      WHERE cg_uo.system_id = cg_ruoli.id_uo
      and cg_ruoli.CHA_RIFERIMENTO = '1'
      )
      ORDER BY 1, 2
    </value>
  </query>
  <query>
    <name>S_IS_CORR_IN_LISTA_DISTR</name>
    <value>
      select var_codice, var_desc_corr, @dbuser@.getPeopleName(id_people_liste) as prop, @dbuser@.getCodRuolo(id_gruppo_liste) as ruolo from dpa_corr_globali
      where cha_tipo_urp = 'L' and
      system_id in (select id_lista_dpa_corr from dpa_liste_distr where id_dpa_corr = @param1@)
    </value>
  </query>
  <query>
    <name>S_FIND_MODELLI</name>
    <value>
      SELECT dpa_modelli_trasm.system_id idmodello,
      dpa_modelli_trasm.nome,
      dpa_modelli_mitt_dest.system_id idmittdest,
      dpa_ragione_trasm.cha_tipo_dest tipotrasmissione,
      dpa_modelli_mitt_dest.id_corr_globali idcorrispondente,
      dpa_tipo_ruolo.num_livello numerolivello,
      dpa_modelli_mitt_dest.cha_tipo_mitt_dest mittdest
      FROM dpa_modelli_trasm,
      dpa_modelli_mitt_dest,
      dpa_ragione_trasm,
      dpa_corr_globali,
      dpa_tipo_ruolo
      WHERE dpa_modelli_mitt_dest.cha_tipo_urp = 'R'
      AND dpa_modelli_trasm.id_amm = @ammId@
      AND dpa_modelli_trasm.system_id = dpa_modelli_mitt_dest.id_modello
      AND dpa_modelli_mitt_dest.id_ragione = dpa_ragione_trasm.system_id
      AND dpa_modelli_mitt_dest.id_corr_globali = dpa_corr_globali.system_id
      AND dpa_corr_globali.id_tipo_ruolo = dpa_tipo_ruolo.system_id
      @filterCond@
      ORDER BY dpa_modelli_trasm.system_id
    </value>
  </query>
  <query>
    <name>S_FIND_MODELLI_USER</name>
    <value>
      SELECT   dpa_modelli_trasm.system_id idmodello, dpa_modelli_trasm.nome,
      dpa_modelli_mitt_dest.system_id idmittdest,
      dpa_ragione_trasm.cha_tipo_dest tipotrasmissione,
      dpa_modelli_mitt_dest.id_corr_globali idcorrispondente,
      dpa_tipo_ruolo.num_livello numerolivello,
      dpa_modelli_mitt_dest.cha_tipo_mitt_dest mittdest
      FROM dpa_modelli_trasm,
      dpa_modelli_mitt_dest,
      dpa_ragione_trasm,
      dpa_corr_globali,
      dpa_tipo_ruolo
      WHERE dpa_modelli_mitt_dest.cha_tipo_urp = 'R'
      AND dpa_modelli_trasm.system_id = dpa_modelli_mitt_dest.id_modello
      AND dpa_modelli_mitt_dest.id_ragione = dpa_ragione_trasm.system_id
      AND dpa_modelli_mitt_dest.id_corr_globali = dpa_corr_globali.system_id
      AND dpa_corr_globali.id_tipo_ruolo = dpa_tipo_ruolo.system_id
      @filterCond@
      AND dpa_modelli_trasm.system_id IN (
      SELECT mt.system_id
      FROM dpa_modelli_trasm mt, dpa_modelli_mitt_dest md
      WHERE mt.system_id = md.id_modello
      AND mt.id_amm = @ammId@
      AND (mt.id_people = @idPeople@ OR mt.id_people IS NULL)
      AND md.cha_tipo_mitt_dest = 'M'
      AND mt.SINGLE = '0'
      AND (md.id_corr_globali = @corrId@ OR md.id_corr_globali = 0)
      AND NOT EXISTS (
      SELECT dpa_ass_diagrammi.id_mod_trasm
      FROM dpa_ass_diagrammi
      WHERE md.id_modello =
      dpa_ass_diagrammi.id_mod_trasm))
      ORDER BY dpa_modelli_trasm.system_id
    </value>
  </query>
  <query>
    <name>IS_USER_ADMINISTRATOR</name>
    <value>
      SELECT p.cha_amministratore
      FROM people p
      WHERE p.system_id = @userId@
    </value>
  </query>
  <query>
    <name>DELETE_DESTINATARI_MODELLO_FIND_AND_REPLACE</name>
    <value>
      DELETE FROM dpa_modelli_dest_con_notifica WHERE id_modello_mitt_dest = @modelloMittDest@ AND id_modello = @idModello@
    </value>
  </query>
  <query>
    <name>INSERT_DESTINATARI_MODELLO_FIND_AND_REPLACE</name>
    <value>
      INSERT into dpa_modelli_dest_con_notifica(system_id, id_modello_mitt_dest, id_people, id_modello)
      VALUES (@id@, @idModelloMittDest@, @idPeople@, @idModello@)
    </value>
  </query>
  <query>
    <name>UPDATE_MODELLO_FIND_AND_REPLACE</name>
    <value>
      UPDATE dpa_modelli_mitt_dest
      SET id_corr_globali = @idCorrGlobale@
      @copyNote@
      WHERE system_id = @idMittDest@ AND id_corr_globali = @oldIdCorrGlobali@
    </value>
  </query>
  <query>
    <name>GET_MITT_MODELLO_FIND_AND_REPLACE</name>
    <value>
      SELECT tr.num_livello numerolivello, cg.system_id
      FROM dpa_corr_globali cg, dpa_tipo_ruolo tr
      WHERE cg.id_tipo_ruolo = tr.system_id
      AND cg.system_id IN (
      SELECT md.id_corr_globali
      FROM dpa_modelli_mitt_dest md
      WHERE md.id_modello = @modelId@
      AND md.cha_tipo_mitt_dest = 'M')
    </value>
  </query>
  <query>
    <name>GET_STATI_DG_PER_RICERCA</name>
    <value>
      select distinct(dpa_diagrammi.id_stato), dpa_stati.var_descrizione
      from dpa_diagrammi, dpa_stati
      where
      dpa_diagrammi.id_diagramma = @idDiagramma@
      and
      dpa_diagrammi.id_stato = dpa_stati.system_id
      and
      (dpa_stati.non_ricercabile &lt;&gt; 1 or dpa_stati.non_ricercabile is null)
      @docOrFasc@
      order by dpa_stati.var_descrizione asc
    </value>
  </query>
  <query>
    <name>CDC_REPORT_DECRETI_IN_ESAME</name>
    <value>
      SELECT
      vardescribe (vm.system_id, 'SEGNATURA_DOCNUMBER') AS Segnatura,
      getvaloreoggettodb (953,
      vm.system_id,
      'Controllo Preventivo SCCLA',
      'Num. Decreto'
      ) AS NumDec,
      getvaloreoggettodb_tipodata
      (953,
      vm.system_id,
      'Controllo Preventivo SCCLA',
      'Data decreto'
      ) AS DataDec,
      vm.var_prof_oggetto AS Oggetto,
      NVL (vm.dta_arrivo, dta_protocollo) AS DataArrivo,
      vm.tipologia AS Tip, descuo (primo_revisore) AS PrimoRevisore,
      descuo (vm.secondo_revisore) AS SecondoRevisore,
      descuo (magistrato_istruttore) AS MagistratoIstruttore,
      vm.data_primo_rilievo AS DataPrimoRilievo,
      getvaloreoggettodb_tipodata
      (953,
      vm.system_id,
      'Controllo Preventivo SCCLA',
      'Data ritorno primo rilievo'
      ) AS DataRitPrimoRil,
      floor(SYSDATE - NVL (vm.dta_arrivo, dta_protocollo)) AS Giac,
      vm.data_scadenza_controllo AS DataScadContr,
      getvaloreoggettodb_tipodata
      (953,
      vm.system_id,
      'Controllo Preventivo SCCLA',
      'Data scadenza Amministrazione'
      ) AS DataScadAmm
      FROM v_cdc_controllo_preventivo vm
      WHERE vm.personorgroup IN (@ufficio@)
      AND vm.stato = 'In esame'
      @filterCond@
    </value>
  </query>
  <query>
    <name>CDC_REPORT_DECRETI_PERVENUTI_IN_INT_TEMPORALE</name>
    <value>
      SELECT vm.system_id,
      vardescribe (vm.system_id, 'SEGNATURA_DOCNUMBER') AS segnatura,
      getvaloreoggettodb (953,
      vm.system_id,
      'Controllo Preventivo SCCLA',
      'Num. Decreto'
      ) AS numdec,
      getvaloreoggettodb_tipodata
      (953,
      vm.system_id,
      'Controllo Preventivo SCCLA',
      'Data decreto'
      ) AS DataDec,
      vm.var_prof_oggetto AS oggetto,
      NVL (vm.dta_arrivo, dta_protocollo) AS dataarrivo, vm.tipologia AS tip,
      descuo (primo_revisore) AS primorevisore,
      descuo (vm.secondo_revisore) AS secondorevisore,
      descuo (magistrato_istruttore) AS magistratoistruttore, vm.stato as stato,
      vm.data_primo_rilievo AS dataprimorilievo,
      getvaloreoggettodb_tipodata
      (953,
      vm.system_id,
      'Controllo Preventivo SCCLA',
      'Data ritorno primo rilievo'
      ) AS dataritornoprimorilievo,
      vm.data_secondo_rilievo,
      floor(SYSDATE - NVL (vm.dta_arrivo, dta_protocollo)) AS giac,
      vm.data_restituz_amministrazione AS datarestamm,
      vm.data_registrazione AS datareg,
      vm.data_scadenza_controllo AS datascadcontrollo,
      getvaloreoggettodb_tipodata
      (953,
      vm.system_id,
      'Controllo Preventivo SCCLA',
      'Data scadenza Amministrazione'
      ) AS datascadamm
      FROM v_cdc_controllo_preventivo vm
      WHERE vm.personorgroup IN (@ufficio@)
      @filterCond@
    </value>
  </query>
  <query>
    <name>UPDATE_GRID_SETTINGS</name>
    <value>
      UPDATE DPA_GRIDS
      SET IS_ACTIVE = '@isActive@',
      GRID_NAME = '@gridName@',
      CHA_VISIBILE_A_UTENTE_O_RUOLO = '@visibility@'
      WHERE SYSTEM_ID = '@gridId@'
    </value>
  </query>
  <query>
    <name>REMOVE_GRID</name>
    <value>
      DELETE DPA_GRIDS
      WHERE SYSTEM_ID = @gridId@
    </value>
  </query>
  <query>
    <name>GET_DEFINED_GRIDS</name>
    <value>
      SELECT a.system_id, a.grid_name, a.role_id_creatore, a.user_id_creatore,
      a.type_grid, b.grid_id AS is_preferred, a.CHA_VISIBILE_A_UTENTE_O_RUOLO, a.is_search_grid
      FROM dpa_grids a LEFT JOIN dpa_ass_grids b ON b.grid_id = a.system_id AND b.USER_ID = @userId@ AND b.ROLE_ID = @roleId@
      WHERE  a.type_grid = '@typeGrid@'
      AND a.is_search_grid = 'N'
      AND a.administration_id = @administrationId@
      AND (   (    a.cha_visibile_a_utente_o_ruolo = 'U'
      AND  a.user_id_creatore = @userId@
      )
      OR (    a.cha_visibile_a_utente_o_ruolo = 'R'
      AND a.role_id_creatore = @roleId@
      )
      )
      order by a.grid_name
    </value>
  </query>
  <query>
    <name>S_DPA_SALVA_RICERCHE_COUNT_NAME_MODIFY</name>
    <value>
      select count(*)
      from DPA_SALVA_RICERCHE
      where VAR_DESCRIZIONE = '@param1@' and (id_people = @idPeople@ or id_gruppo = @idGruppo@) and var_pagina_ric = '@pagina@' and system_id != @idRicerca@
    </value>
  </query>
  <query>
    <name>U_DPA_MODIFICA_RICERCHE</name>
    <value>
      update dpa_salva_ricerche set var_descrizione = '@descrizione@' , id_people = @idPeople@ , id_gruppo= @idGruppo@ , grid_id= @grid_id@  where  system_id = @idRicerca@
    </value>
  </query>
  <query>
    <name>GET_GRID_FOR_USER_CUSTUM</name>
    <value>
      SELECT a.system_id, b.user_id, a.type_grid, a.serialized_grid,
      a.cha_visibile_a_utente_o_ruolo, a.grid_name, b.role_id
      FROM dpa_grids a, dpa_ass_grids b
      WHERE a.type_grid = '@typeGrid@'
      AND b.grid_id = a.system_id
      AND a.administration_id = @idAmm@
      AND b.USER_ID = @idUser@
      AND b.ROLE_ID = @idRole@
    </value>
  </query>
  <query>
    <name>REMOVE_PREFERRED_GRID</name>
    <value>
      DELETE FROM DPA_ASS_GRIDS
      WHERE
      USER_ID = @userId@
      AND
      ROLE_ID= @roleId@
      AND
      ADMINISTRATION_ID = @administrationId@
      AND
      TYPE_GRID = '@typeGrid@'
    </value>
  </query>
  <query>
    <name>INSERT_DPA_ASS_GRIDS</name>
    <value>
      INSERT INTO DPA_ASS_GRIDS
      (
      GRID_ID,
      USER_ID,
      ROLE_ID,
      ADMINISTRATION_ID,
      TYPE_GRID
      )
      values
      (
      @gridId@,
      @userId@,
      @roleId@,
      @administrationId@,
      '@typeGrid@'
      )
    </value>
  </query>
  <query>
    <name>REMOVE_PREFERRED_GRID_BY_ID</name>
    <value>
      DELETE FROM DPA_ASS_GRIDS
      WHERE
      GRID_ID = @gridId@
    </value>
  </query>
  <query>
    <name>REMOVE_PREFERRED_GRID_BY_TYPE</name>
    <value>
      DELETE FROM DPA_ASS_GRIDS
      WHERE
      USER_ID = @idPeople@
      AND ROLE_ID = @idGruppo@
      AND ADMINISTRATION_ID = @idAmm@
      AND TYPE_GRID = '@type@'
    </value>
  </query>
  <query>
    <name>UPDATE_GRID_BY_ID</name>
    <value>
      UPDATE DPA_GRIDS
      SET
      CHA_VISIBILE_A_UTENTE_O_RUOLO = '@visibility@',
      GRID_NAME = '@gridName@'
      WHERE SYSTEM_ID = @gridId@ AND ADMINISTRATION_ID = @administrationId@
    </value>
  </query>
  <query>
    <name>SAVE_GRID_SEARCH_SETTINGS</name>
    <value>
      INSERT INTO DPA_GRIDS
      (
      @colID@
      USER_ID_CREATORE,
      ROLE_ID_CREATORE,
      ADMINISTRATION_ID,
      SERIALIZED_GRID,
      TYPE_GRID,
      IS_SEARCH_GRID,
      GRID_NAME
      )
      values
      (
      @id@
      @userId@,
      @roleId@,
      @administrationId@,
      null,
      '@typeGrid@',
      '@searchGrid@',
      '@gridName@'
      )
    </value>
  </query>
  <query>
    <name>GET_DEFINED_GRIDS_ONLY_ROLE</name>
    <value>
      SELECT a.system_id, a.grid_name, a.role_id_creatore, a.user_id_creatore,
      a.type_grid, b.grid_id AS is_preferred, a.CHA_VISIBILE_A_UTENTE_O_RUOLO, a.is_search_grid
      FROM dpa_grids a LEFT JOIN dpa_ass_grids b ON b.grid_id = a.system_id AND b.USER_ID = @userId@ AND b.ROLE_ID = @roleId@
      WHERE  a.type_grid = '@typeGrid@'
      AND a.is_search_grid = 'N'
      AND a.administration_id = @administrationId@
      AND a.cha_visibile_a_utente_o_ruolo = 'R'
      AND a.role_id_creatore = @roleId@
      order by a.grid_name
    </value>
  </query>
  <!--Emilio 16 Gennaio 2013 Modificata per Ricerca in Conservazione-->
  <query>
    <name>S_RIC_DOC_CUSTOM</name>
    <value>
      @with@
      SELECT   Row, SYSTEM_ID, DOCNUMBER, DTA_ANNULLA,VAR_DESC_OGGETTO, ID_REGISTRO, cha_tipo_proto,
      CHA_EVIDENZA, NUM_ANNO_PROTO, DATA, CREATION_DATE, NUM_PROTO, VAR_SEGNATURA, DTA_PROTO, ARCHIVE_DATE as dta_archiviazione,
      @dbuser@.getchaimg(DOCNUMBER) AS CHA_IMG,CHA_PRIVATO,CHA_PERSONALE,
      @dbuser@.getInADL(a.system_id, 'D', @idGruppo@,  @idPeople@) AS IN_ADL,
      @dbuser@.getInADL(a.system_id, 'D', @idGruppo@,  0) AS IN_ADLROLE,
      ID_DOCUMENTO_PRINCIPALE,
      @dbuser@.getInConservazione(a.system_id,NULL,'D',@idPeople@,@idGruppo@) AS IN_CONSERVAZIONE,
      CHA_IN_ARCHIVIO, ID_TIPO_ATTO, DESC_TIPO_ATTO, @dbuser@.getPeopleUserId (AUTHOR) as code_author,
      PROT_TIT, @dbuser@.getchafirmato(DOCNUMBER) as CHA_FIRMATO,
      @dbuser@.getchatipofirma(DOCNUMBER) as CHA_TIPO_FIRMA,
      @dbuser@.gettestoultimanota('D',a.system_id,@idGruppo@,@idPeople@,@idGruppo@) as ULTIMA_NOTA,
      @dbuser@.GETCODREG(id_registro) as cod_registro,
      @dbuser@.corrcatricevuta(system_id, cha_tipo_proto) as MITT_DEST,
      @dbuser@.getpeoplename (author) AS desc_autore,
      @dbuser@.getdesccorr (id_ruolo_creatore) AS desc_ruolo_autore,
      @dbuser@.getcodruolobyidcorr(id_ruolo_creatore) AS cod_ruolo_autore,
      @dbuser@.classcat(system_id) as COD_FASCICOLI,
      @dbuser@.getdataarrivodoc (DOCNUMBER) AS data_arrivo,
      @dbuser@.getdiagrammistato (docnumber, 'D') AS stato,
      @dbuser@.corrcatbytipo(docnumber, cha_tipo_proto, 'M') as mittenti,
      @dbuser@.corrcatbytipo(docnumber, cha_tipo_proto, 'D') as destinatari,
      @dbuser@.getEsitoPubblicazione(system_id) as pubblicazione,
      @dbuser@.esisteNotaVisibile('D',a.system_id,@idGruppo@,@idPeople@,@idGruppo@) AS esiste_nota,
      a.cha_cod_t_a, a.COD_EXT_APP,a.in_librofirma,
      @dbuser@.getCODICE_CDC(A.ID_CENTRO_DI_COSTO) AS ID_CENTRO_DI_COSTO,
      @dbuser@.getObiettivo(A.ID_OBIETTIVO) AS ID_OBIETTIVO,
      @dbuser@.getTipoComunicazione(A.ID_TIPO_COMUNICAZIONE) AS ID_TIPO_COMUNICAZIONE,
      @dbuser@.getImpronta(a.docnumber) as impronta,
      convert(nvarchar (10), @dbuser@.GetDateInADL (a.system_id, 'D', @idGruppo@, @idPeople@), 103) AS dta_ins_adl,
      @dbuser@.getEsitoSpedizione(a.system_id) AS esito_spedizione,
      @dbuser@.getCountRicevuteInterop(a.system_id, @tipoRicevutaInteroperante@) AS count_ric_interop
      @contatore@
      @valoriCustom@
      @conservazione@
      @esibizione@
      @stato_cons@
      FROM
      (SELECT  ROW_NUMBER() OVER (ORDER BY @order@)
      AS Row, a.SYSTEM_ID, A.DOCNUMBER, A.DTA_ANNULLA,
      A.VAR_PROF_OGGETTO AS VAR_DESC_OGGETTO,
      A.ID_REGISTRO, A.CHA_TIPO_PROTO,
      A.CHA_EVIDENZA, A.NUM_ANNO_PROTO,
      ISNULL(A.DTA_PROTO,A.CREATION_TIME) AS DATA,
      convert(nvarchar (10), A.CREATION_TIME, 103) AS CREATION_TIME,
      convert(nvarchar (10), A.CREATION_TIME, 103) AS CREATION_DATE,
      A.NUM_PROTO, A.VAR_SEGNATURA,
      convert(nvarchar (10), A.DTA_PROTO, 103) AS DTA_PROTO,
      A.CHA_PRIVATO, A.CHA_PERSONALE,
      A.ID_DOCUMENTO_PRINCIPALE, A.ID_CENTRO_DI_COSTO,A.ID_OBIETTIVO,A.ID_TIPO_COMUNICAZIONE ,
      A.CHA_IN_ARCHIVIO,a.id_tipo_atto as ID_TIPO_ATTO,
      ta.var_desc_atto as DESC_TIPO_ATTO, a.AUTHOR,
      a.prot_tit as PROT_TIT, a.ID_RUOLO_CREATORE,a.ARCHIVE_DATE, a.cha_cod_t_a, a.COD_EXT_APP, a.ext, a.in_librofirma
      FROM PROFILE A WITH(NOLOCK) LEFT JOIN dpa_tipo_atto ta on a.id_tipo_atto = ta.system_id
      @fromOther@
      @from@
      WHERE @security@
      @filters@
      AND @dbuser@.Getidamm(A.AUTHOR) = (SELECT ID_AMM FROM PEOPLE WHERE SYSTEM_ID = @idPeople@)
      @listDocuments@
      @ricVeloce@
      @stampe@
      )AS a
      @paging@
      @unionStampe@
    </value>
  </query>
  <query>
    <name>S_GET_COUNT_ROWS_RICERCA_DOCUMENTI_MASSIVE_OPERATIONS_CUSTOM</name>
    <value>
      @with@
      SELECT A.SYSTEM_ID,codice
      FROM
      (
      SELECT /*+INDEX(a)*/
      A.SYSTEM_ID,(case when a.num_proto is not null then a.num_proto when a.num_proto is null then a.docnumber end) as codice
      FROM    PROFILE a WITH(NOLOCK) @fromOther@
      @from@
      WHERE @security@
      @filters@
      AND @dbuser@.Getidamm(A.AUTHOR) = (SELECT ID_AMM FROM PEOPLE WHERE SYSTEM_ID = @idPeople@)
      @stampe@
      @unionStampe@
      ) as a
    </value>
  </query>
  <!--Emilio 16 Gennaio 2013 Modificata per Ricerca in Conservazione-->
  <query>
    <name>S_GET_COUNT_ROWS_RICERCA_DOCUMENTI_CUSTOM</name>
    <value>
      SELECT COUNT(A.SYSTEM_ID)
      FROM
      (
      SELECT /*+INDEX(a)*/
      A.SYSTEM_ID
      FROM    PROFILE a WITH(NOLOCK) @fromOther@
      @from@
      WHERE @security@
      @filters@
      @stampe@
      @unionStampe@
      ) as a
    </value>
  </query>
  <query>
    <name>S_GET_COUNT_ROWS_RICERCA_DOCUMENTI_VELOCE_CUSTOM</name>
    <value>
      SELECT a.SYSTEM_ID, a.codice
      FROM
      (
      SELECT /*+INDEX(a)*/ TOP @rowCount@
      A.SYSTEM_ID, (case when a.num_proto is not null then a.num_proto when a.num_proto is null then a.docnumber end) as codice
      FROM    PROFILE a  WITH(NOLOCK)
      WHERE @security@
      @filters@
      and isnull(dta_proto,creation_date) between    convert(datetime,'@dataInizioAnno@',103) and getdate()
      @unionStampe@
      ORDER BY @order@
      ) AS A
    </value>
  </query>
  <query>
    <name>S_FASCICOLI_PAGING_CUSTOM</name>
    <value>
      SELECT Row,
      system_id, description, cha_tipo_proj, var_codice,
      id_amm, num_livello,cha_tipo_fascicolo, id_fascicolo,
      id_parent,var_cod_ultimo,var_note, dta_apertura,
      dta_chiusura,cha_stato, id_tipo_proc, id_registro,
      id_uo_lf,DTA_UO_LF,
      dta_creazione, cartaceo,cha_privato,ID_UO_REF,
      DTA_SCADENZA,
      CHA_IN_ARCHIVIO,AUTHOR,
      ID_RUOLO_CREATORE, ID_UO_CREATORE, cha_controllato, cha_consenti_class, a.CHA_CONSENTI_FASC,
      ID_RUOLO_CHIUSURA, ID_UO_CHIUSURA, ID_AUTHOR_CHIUSURA,
      DTA_APERTURA_ORDER,DTA_CHIUSURA_ORDER, id_titolario,
      num_fasc, NUM_MESI_CONSERVAZIONE,
      desc_tipo_atto,COD_EXT_APP,
      ID_TIPO_FASC,
      @dbuser@.getinadl (a.system_id, 'F', @idGruppo@, @idPeople@) AS in_adl,
      @dbuser@.getinadl (a.system_id, 'F', @idGruppo@, '0') AS in_adlrole,
      @dbuser@.getaccessrightsProject (@idGruppo@, @idPeople@,@idRuoloPubblico@, a.system_id) AS accessrights,
      @dbuser@.getcodtit (a.id_parent) AS codtit,
      @dbuser@.getinconservazione (NULL,
      a.system_id,
      'F',
      @idPeople@,
      @idGruppo@
      ) AS in_conservazione,
      @dbuser@.getcodreg(a.id_registro) as AOO,
      @dbuser@.gettestoultimanota ('F',a.system_id, @idGruppo@,@idPeople@,@idGruppo@) as ultima_nota,
      @dbuser@.getdiagrammistato (a.system_id, 'F') AS stato,
      @dbuser@.getDescTitolario(a.id_titolario) as cod_titolario,
      @dbuser@.getpeoplename (a.author) as desc_autore,
      @dbuser@.getdesccorr(a.id_ruolo_creatore) as desc_ruolo,
      @dbuser@.getdesccorr(a.id_uo_creatore) as desc_uo,
      @dbuser@.getdesccorr(a.id_uo_lf) as desc_coll,
      @dbuser@.esisteNotaVisibile('F',a.system_id,@idGruppo@,@idPeople@,@idGruppo@) AS esiste_nota,
      a.cha_cod_t_a,
      convert(nvarchar (10), @dbuser@.GetDateInADL (a.system_id, 'F', @idGruppo@, @idPeople@), 103) AS dta_ins_adl
      @conservazione@
      @esibizione@
      @contatore@
      @valoriCustom@
      FROM
      (SELECT  ROW_NUMBER() OVER (ORDER BY @order@)
      AS Row,
      a.system_id, a.description, a.cha_tipo_proj, a.var_codice,
      a.id_amm, a.num_livello,a.cha_tipo_fascicolo, a.id_fascicolo,
      a.id_parent,a.var_cod_ultimo,a.var_note, @dtaAp@ AS dta_apertura,
      @dtaCh@ AS dta_chiusura,a.cha_stato, a.id_tipo_proc, a.id_registro ,
      a.id_uo_lf,A.DTA_UO_LF,
      a.dta_creazione, a.cartaceo,a.cha_privato,a.ID_UO_REF,
      convert(nvarchar (10), a.dta_scadenza, 103) AS DTA_SCADENZA,
      a.CHA_IN_ARCHIVIO,a.AUTHOR,
      a.ID_RUOLO_CREATORE, a.ID_UO_CREATORE, a.cha_controllato, a.cha_consenti_class, a.CHA_CONSENTI_FASC,
      a.ID_RUOLO_CHIUSURA, a.ID_UO_CHIUSURA, a.ID_AUTHOR_CHIUSURA,
      a.DTA_APERTURA AS DTA_APERTURA_ORDER,
      a.DTA_CHIUSURA AS DTA_CHIUSURA_ORDER, a.id_titolario,
      a.num_fascicolo as num_fasc, a.NUM_MESI_CONSERVAZIONE,
      ta.var_desc_fasc AS desc_tipo_atto,
      a.ID_TIPO_FASC, a.COD_EXT_APP,
      a.cha_cod_t_a
      FROM project a LEFT JOIN dpa_tipo_fasc ta on a.ID_TIPO_FASC = ta.system_id
      @tblCL1@
      WHERE
      @security@
      AND (a.id_amm IS NULL OR a.id_amm = @idAmm@)
      AND a.cha_tipo_proj = 'F'
      @listDocuments@
      @idReg@
      @whereTlbCL1@
      @guiFilters@
      )a
      @paging@
    </value>
  </query>
  <!--Lnr 14/01/2012 Aggiunta query-->
  <query>
    <name>S_GET_COUNT_ITEMS_CONSERVAZIONE</name>
    <value>
      select ac.cha_stato as stato, count(ac.system_id) totale
      from dpa_area_conservazione ac
      inner join dpa_amministra a on ac.id_amm = a.system_id
      where a.var_codice_amm = '@codiceAmministrazione@'
      group by ac.cha_stato
    </value>
  </query>
  <query>
    <name>S_FASCICOLI_GET_OBJECT_BY_SYSTEM_ID</name>
    <value>
      SELECT
      system_id, description, cha_tipo_proj, var_codice,
      id_amm, num_livello,cha_tipo_fascicolo, id_fascicolo,
      id_parent,var_cod_ultimo,var_note, dta_apertura,
      dta_chiusura,cha_stato, id_tipo_proc, id_registro,
      id_uo_lf,DTA_UO_LF,
      dta_creazione, cartaceo,cha_privato,ID_UO_REF,
      DTA_SCADENZA,
      CHA_IN_ARCHIVIO,AUTHOR,
      ID_RUOLO_CREATORE, ID_UO_CREATORE, cha_controllato, cha_consenti_class, a.CHA_CONSENTI_FASC,
      ID_RUOLO_CHIUSURA, ID_UO_CHIUSURA, ID_AUTHOR_CHIUSURA,
      DTA_APERTURA_ORDER,DTA_CHIUSURA_ORDER, id_titolario,
      num_fasc, NUM_MESI_CONSERVAZIONE,
      desc_tipo_atto,
      ID_TIPO_FASC,
      @dbuser@.getinadl (a.system_id, 'F', @idGruppo@, @idPeople@) AS in_adl,
      @dbuser@.getinadl (a.system_id, 'F', @idGruppo@, '0') AS in_adlrole,
      @dbuser@.getaccessrightsProject (@idGruppo@, @idPeople@,@idRuoloPubblico@, a.system_id) AS accessrights,
      @dbuser@.getcodtit (a.id_parent) AS codtit,
      @dbuser@.getinconservazione (NULL,
      a.system_id,
      'F',
      @idPeople@,
      @idGruppo@
      ) AS in_conservazione,
      @dbuser@.getcodreg(a.id_registro) as AOO,
      @dbuser@.gettestoultimanota ('F',a.system_id, @idGruppo@,@idPeople@,@idGruppo@) as ultima_nota,
      @dbuser@.getdiagrammistato (a.system_id, 'F') AS stato,
      @dbuser@.getDescTitolario(a.id_titolario) as cod_titolario,
      @dbuser@.getpeoplename (a.author) as desc_autore,
      @dbuser@.getdesccorr(a.id_ruolo_creatore) as desc_ruolo,
      @dbuser@.getdesccorr(a.id_uo_creatore) as desc_uo,
      @dbuser@.getdesccorr(a.id_uo_lf) as desc_coll,
      @dbuser@.esisteNotaVisibile('D',a.system_id,@idGruppo@,@idPeople@,@idGruppo@) AS esiste_nota,
      cha_cod_t_a
      FROM
      (SELECT
      a.system_id, a.description, a.cha_tipo_proj, a.var_codice,
      a.id_amm, a.num_livello,a.cha_tipo_fascicolo, a.id_fascicolo,
      a.id_parent,a.var_cod_ultimo,a.var_note, @dtaAp@ AS dta_apertura,
      @dtaCh@ AS dta_chiusura,a.cha_stato, a.id_tipo_proc, a.id_registro ,
      a.id_uo_lf,A.DTA_UO_LF,
      a.dta_creazione, a.cartaceo,a.cha_privato,a.ID_UO_REF,
      convert(nvarchar (10), a.dta_scadenza, 103) AS DTA_SCADENZA,
      a.CHA_IN_ARCHIVIO,a.AUTHOR,
      a.ID_RUOLO_CREATORE, a.ID_UO_CREATORE, a.cha_controllato, a.cha_consenti_class, a.CHA_CONSENTI_FASC,
      a.ID_RUOLO_CHIUSURA, a.ID_UO_CHIUSURA, a.ID_AUTHOR_CHIUSURA,
      a.DTA_APERTURA AS DTA_APERTURA_ORDER,
      a.DTA_CHIUSURA AS DTA_CHIUSURA_ORDER, a.id_titolario,
      a.num_fascicolo as num_fasc, a.NUM_MESI_CONSERVAZIONE,
      ta.var_desc_fasc AS desc_tipo_atto,
      a.ID_TIPO_FASC,
      a.cha_cod_t_a
      FROM project a LEFT JOIN dpa_tipo_fasc ta on a.ID_TIPO_FASC = ta.system_id
      WHERE
      (a.id_amm IS NULL OR a.id_amm = @idAmm@)
      AND a.cha_tipo_proj = 'F'
      AND a.system_id = @systemId@)a
    </value>
  </query>
  <query>
    <name>S_J_PROFILE_SECURITY_PROJECT_COMPONENTS_DOCUMENTTYPES_NEW_CUSTOM</name>
    <value>
      SELECT   Row, SYSTEM_ID, DOCNUMBER, DTA_ANNULLA,VAR_DESC_OGGETTO, ID_REGISTRO, cha_tipo_proto,
      CHA_EVIDENZA, NUM_ANNO_PROTO, DATA, CREATION_DATE, NUM_PROTO, VAR_SEGNATURA, DTA_PROTO, ARCHIVE_DATE as dta_archiviazione,
      @dbuser@.getchaimg(DOCNUMBER) AS CHA_IMG,CHA_PRIVATO,CHA_PERSONALE,
      @dbuser@.getInADL(a.system_id, 'D', @idGruppo@,  @idPeople@) AS IN_ADL,
      @dbuser@.getInADL(a.system_id, 'D', @idGruppo@,  '0') AS IN_ADLROLE,
      ID_DOCUMENTO_PRINCIPALE,
      @dbuser@.getInConservazione(a.system_id,NULL,'D',@idPeople@,@idGruppo@) AS IN_CONSERVAZIONE,
      CHA_IN_ARCHIVIO, ID_TIPO_ATTO, DESC_TIPO_ATTO, @dbuser@.getPeopleUserId (AUTHOR) as code_author,
      PROT_TIT, @dbuser@.getchafirmato(DOCNUMBER) as CHA_FIRMATO,
      @dbuser@.getchatipofirma(DOCNUMBER) as CHA_TIPO_FIRMA,
      @dbuser@.gettestoultimanota('D',a.system_id,@idGruppo@,@idPeople@,@idGruppo@) as ULTIMA_NOTA,
      @dbuser@.GETCODREG(id_registro) as cod_registro,
      @dbuser@.CORRCAT(system_id, cha_tipo_proto) as MITT_DEST,
      @dbuser@.getpeoplename (author) AS desc_autore,
      @dbuser@.getdesccorr (id_ruolo_creatore) AS desc_ruolo_autore,
      @dbuser@.getcodruolobyidcorr(id_ruolo_creatore) AS cod_ruolo_autore,
      @dbuser@.classcat(system_id) as COD_FASCICOLI,
      @dbuser@.getdataarrivodoc (DOCNUMBER) AS data_arrivo,
      @dbuser@.getdiagrammistato (docnumber, 'D') AS stato,
      @dbuser@.corrcatbytipo(docnumber, cha_tipo_proto, 'M') as mittenti,
      @dbuser@.corrcatbytipo(docnumber, cha_tipo_proto, 'D') as destinatari,
      @dbuser@.getEsitoPubblicazione(system_id) as pubblicazione,
      @dbuser@.esisteNotaVisibile('D',a.system_id,@idGruppo@,@idPeople@,@idGruppo@) AS esiste_nota,
      a.cha_cod_t_a, a.COD_EXT_APP, a.in_librofirma, a.cha_task_status,
      @dbuser@.getCODICE_CDC(A.ID_CENTRO_DI_COSTO) AS ID_CENTRO_DI_COSTO,
      @dbuser@.getObiettivo(A.ID_OBIETTIVO) AS ID_OBIETTIVO,
      @dbuser@.getTipoComunicazione(A.ID_TIPO_COMUNICAZIONE) AS ID_TIPO_COMUNICAZIONE,
      @dbuser@.getImpronta(a.docnumber) as impronta,
      convert(nvarchar (10), @dbuser@.GetDateInADL (a.system_id, 'D', @idGruppo@, @idPeople@), 103) AS dta_ins_adl,
      @dbuser@.getEsitoSpedizione(a.system_id) AS esito_spedizione,
      @dbuser@.getCountRicevuteInterop(a.system_id, @tipoRicevutaInteroperante@) AS count_ric_interop,
      @dbuser@.getStatoConservazione(a.system_id) as StatoConservazione
      @contatore@
      @valoriCustom@
      FROM
      (SELECT  ROW_NUMBER() OVER (ORDER BY @order@)
      AS Row, a.SYSTEM_ID, A.DOCNUMBER, A.DTA_ANNULLA,
      A.VAR_PROF_OGGETTO AS VAR_DESC_OGGETTO,
      A.ID_REGISTRO, A.CHA_TIPO_PROTO,
      A.CHA_EVIDENZA, A.NUM_ANNO_PROTO,
      convert(nvarchar (10),
      ISNULL(A.DTA_PROTO,A.CREATION_TIME), 103) AS DATA,
      convert(nvarchar (10),
      A.CREATION_TIME, 103) AS CREATION_DATE,
      A.NUM_PROTO, A.VAR_SEGNATURA,
      convert(nvarchar (10), A.DTA_PROTO, 103) AS DTA_PROTO,
      A.CHA_PRIVATO, A.CHA_PERSONALE,
      A.ID_DOCUMENTO_PRINCIPALE, A.COD_EXT_APP,A.ID_CENTRO_DI_COSTO,A.ID_OBIETTIVO,A.ID_TIPO_COMUNICAZIONE,
      A.CHA_IN_ARCHIVIO,a.id_tipo_atto as ID_TIPO_ATTO,
      ta.var_desc_atto as DESC_TIPO_ATTO, a.AUTHOR,
      a.prot_tit as PROT_TIT, a.ID_RUOLO_CREATORE,a.ARCHIVE_DATE, a.cha_cod_t_a, a.in_librofirma, a.cha_task_status
      FROM PROFILE A WITH(NOLOCK) LEFT JOIN dpa_tipo_atto ta on a.id_tipo_atto = ta.system_id, PROJECT_COMPONENTS B, DOCUMENTTYPES D @param6@
      WHERE B.PROJECT_ID= @param2@ AND B.LINK=A.SYSTEM_ID AND B.TYPE = 'D' AND A.DOCUMENTTYPE=D.SYSTEM_ID
      AND @security@
      AND ISNULL(CHA_IN_CESTINO,'0')='0'
      AND @dbuser@.Getidamm(A.AUTHOR) = (SELECT ID_AMM FROM PEOPLE WHERE SYSTEM_ID = @idPeople@)
      @param5@
      @listDocuments@
      )a
      @paging@
    </value>
  </query>
  <query>
    <name>GET_ALL_GRIDS</name>
    <value>
      select system_id, type_grid, serialized_grid from dpa_grids
    </value>
  </query>
  <query>
    <name>S_DPA_TRASM_SyIDTrRic_LITE</name>
    <value>
      SELECT /*+index(c) index(b) index(a) */
      @param1@
      FROM @param2@
      WHERE @param3@
      ORDER BY @orderCondition@, c.system_id desc
    </value>
  </query>
  <query>
    <name>S_J_DPA_TRASMISSIONE__TRASM_SINGOLA__TRASM_UTENTE4</name>
    <value>
      SELECT /*+index(c) index(b) index(a) */ @param1@,
      ISNULL(@dbuser@.Vardescribe(a.id_profile,'SEGNATURA_CODFASC'),@dbuser@.Vardescribe(id_project,'CODFASC')) ID_SEGN_CODFASC,
      ISNULL(@dbuser@.Vardescribe(a.id_profile,'DATADOC'),@dbuser@.Vardescribe(id_project,'DATA_CREAZ')) DATA_DOC_FASC,
      @dbuser@.getdesccorr(id_corr_globale) as var_desc_corr, @dbuser@.getpeoplename(a.id_people) as full_name, @dbuser@.getdesccorr(a.id_ruolo_in_uo) AS desc_ruolo_mitt,
      g.cha_tipo_ragione, g.var_desc_ragione, g.cha_eredita,
      g.cha_tipo_diritti, @dbuser@.getpeoplename(c.id_people) as desc_destinatario, @dbuser@.getcodruolobyidcorr(a.id_ruolo_in_uo) as cod_ruolo_mitt, g.cha_risposta,
      g.cha_tipo_dest AS tipo_dest_rag, g.var_note, g.cha_tipo_risposta,
      g.var_notifica_trasm, g.var_testo_msg_notifica_doc,
      g.var_testo_msg_notifica_fasc, g.cha_cede_diritti,
      g.cha_mantieni_lett, @dbuser@.GETPEOPLEUSERID(a.id_people) as USER_ID
      @otherField@
      FROM   DPA_TRASM_UTENTE C,DPA_TRASM_SINGOLA B,DPA_TRASMISSIONE A,
      dpa_ragione_trasm g
      @otherTable@
      @param2@
      WHERE @param3@
      AND g.system_id = b.id_ragione
      @otherFilter@
      ORDER BY @orderCondition@, C.SYSTEM_ID DESC
    </value>
  </query>
  <query>
    <name>S_ALL_DESTINATARI_TRASMISSIONI</name>
    <value>
      SELECT /*+index(c) index(b) index(a) */ a.id_trasm_singola as system_id, a.id_people, @dbuser@.getpeoplename(a.ID_PEOPLE) as full_name
      FROM dpa_trasm_utente a
      WHERE @listaTrasm@ order by a.id_trasm_singola
    </value>
  </query>
  <query>
    <name>S_J_DPA_TRASMISSIONE__TRASM_SINGOLA__TRASM_UTENTE_EXPORT2</name>
    <value>
      SELECT /*+ index (A INDX_TRASM3) */ A.ID_RUOLO_IN_UO, A.ID_PEOPLE, A.CHA_TIPO_OGGETTO,
      A.ID_PROFILE, A.ID_PROJECT,@param1@ AS DTA_INVIO_F,
      A.VAR_NOTE_GENERALI,B.ID_RAGIONE, B.ID_TRASMISSIONE,
      B.ID_TRASM_UTENTE, B.CHA_TIPO_DEST,B.ID_CORR_GLOBALE,
      B.HIDE_DOC_VERSIONS,B.VAR_NOTE_SING, B.CHA_TIPO_TRASM,@param2@ AS DTA_SCADENZA,
      C.SYSTEM_ID AS ID_TRASMISSIONE_UTENTE, C.ID_PEOPLE AS ID_DESTINATARIO,
      @param3@ AS DTA_VISTA,CHA_VISTA,@param4@ AS DTA_ACCETTATA,CHA_ACCETTATA,
      @param5@ AS DTA_RIFIUTATA,CHA_RIFIUTATA,C.VAR_NOTE_RIF, C.VAR_NOTE_ACC,
      C.ID_TRASM_SINGOLA, C.CHA_VALIDA, C.DTA_RIMOZIONE_TODOLIST AS DTA_RIMOSSA_TDL, A.CHA_SALVATA_CON_CESSIONE,
      A.ID_PEOPLE_DELEGATO AS ID_PEOPLE_DELEGATO, C.ID_PEOPLE_DELEGATO AS DELEGATO_UTENTE, C.CHA_ACCETTATA_DELEGATO AS ACCETTATA_DELEGATO, C.CHA_VISTA_DELEGATO AS VISTA_DELEGATO, C.CHA_RIFIUTATA_DELEGATO AS RIFIUTATA_DELEGATO,
      ISNULL(@dbuser@.Vardescribe(id_profile,'SEGNATURA_CODFASC'),@dbuser@.Vardescribe(id_project,'CODFASC')) ID_SEGN_CODFASC,
      ISNULL(@dbuser@.Vardescribe(id_profile,'DATADOC'),@dbuser@.Vardescribe(id_project,'DATA_CREAZ')) DATA_DOC_FASC,
      @dbuser@.getdesccorr(id_corr_globale) as var_desc_corr, @dbuser@.getpeoplename(a.id_people) as full_name, @dbuser@.getdesccorr(a.id_ruolo_in_uo) AS desc_ruolo_mitt,
      g.cha_tipo_ragione, g.var_desc_ragione, g.cha_eredita,
      g.cha_tipo_diritti, @dbuser@.getpeoplename(c.id_people) as desc_destinatario, @dbuser@.getcodruolobyidcorr(a.id_ruolo_in_uo) as cod_ruolo_mitt, g.cha_risposta,
      g.cha_tipo_dest AS tipo_dest_rag, g.var_note, g.cha_tipo_risposta,
      g.var_notifica_trasm, g.var_testo_msg_notifica_doc,
      g.var_testo_msg_notifica_fasc, g.cha_cede_diritti,
      g.cha_mantieni_lett, @dbuser@.GETPEOPLEUSERID(a.id_people) as USER_ID
      @otherField@
      FROM DPA_TRASMISSIONE A, DPA_TRASM_SINGOLA B, DPA_TRASM_UTENTE C, dpa_ragione_trasm g
      @otherTable@
      @param7@
      WHERE A.SYSTEM_ID=B.ID_TRASMISSIONE AND B.SYSTEM_ID=C.ID_TRASM_SINGOLA
      @param6@
      AND g.system_id = b.id_ragione
      @otherFilter@
      ORDER BY @orderCondition@, B.ID_TRASMISSIONE DESC
    </value>
  </query>
  <query>
    <name>S_DPA_TRASM_SyIDTrEff_LITE</name>
    <value>
      SELECT      DISTINCT    /*+index(c) index(b) index(a) */
      A.SYSTEM_ID AS ID_TRASM, A.DTA_INVIO, B.ID_TRASMISSIONE AS ID_TRASM_SINGOLA, B.ID_RAGIONE
      FROM @param2@
      WHERE @param3@
      ORDER BY @orderCondition@
    </value>
  </query>
  <query>
    <name>U_RIFF_MITT</name>
    <value>
      UPDATE PROFILE
      SET CHA_RIFF_MITT='@riferimento@'
      WHERE SYSTEM_ID=@systemId@
    </value>
  </query>
  <query>
    <name>COPY_VISIBILITY</name>
    <value>
      insert  /*+ parallel(security,4) append */  into security (thing, accessrights, personorgroup, cha_tipo_diritto, var_note_sec)
      (
      SELECT
      DISTINCT(thing),
      accessrights,
      @idGruppoRuoloDestinatario@ as PERSONORGROUP,
      'A' as CHA_TIPO_DIRITTO,
      'ACQUISITO PER COPIA VISIBILITA' as VAR_NOTE_SEC
      FROM security  WITH (nolock) , @objType@
      WHERE
      security.thing = @objType@.system_id
      @projectSelect@
      AND
      personorgroup = @idGruppoRuoloOrigine@
      AND
      accessrights > 20
      @condizioneDocFasc@
      @condizioneIdRegistro@
      @condizioneAtipicita@
      @codizioneVisibilita@
      --Condizione di non esistenza
      AND NOT EXISTS
      (
      select 'x' from security  WITH (nolock)  where thing = @objType@.system_id and personorgroup = @idGruppoRuoloDestinatario@
      )
      )
    </value>
  </query>
  <query>
    <name>GET_ID_GRUPPO_RUOLI_SUP_NEW</name>
    <value>
      SELECT
      dpa_corr_globali.id_gruppo
      FROM dpa_corr_globali
      INNER JOIN dpa_tipo_ruolo
      ON dpa_corr_globali.id_tipo_ruolo = dpa_tipo_ruolo.system_id
      WHERE dpa_corr_globali.id_uo IN
      (SELECT dpa_corr_globali.system_id
      FROM dpa_corr_globali
      WHERE dpa_corr_globali.dta_fine IS NULL
      CONNECT BY PRIOR dpa_corr_globali.id_parent = dpa_corr_globali.system_id
      START WITH dpa_corr_globali.system_id =
      (SELECT dpa_corr_globali.id_uo
      FROM dpa_corr_globali
      WHERE dpa_corr_globali.id_gruppo = @idGruppoRuoloDestinatario@
      )
      )
      AND dpa_corr_globali.CHA_TIPO_URP = 'R'
      AND dpa_corr_globali.ID_AMM = @idAmm@
      AND dpa_corr_globali.DTA_FINE IS NULL
      AND dpa_tipo_ruolo.num_livello &lt;
      (SELECT dpa_tipo_ruolo.num_livello
      FROM dpa_corr_globali
      INNER JOIN dpa_tipo_ruolo
      ON dpa_corr_globali.id_tipo_ruolo = dpa_tipo_ruolo.system_id
      WHERE dpa_corr_globali.id_gruppo  = @idGruppoRuoloDestinatario@
      )
    </value>
  </query>
  <query>
    <name>GET_ID_GRUPPO_RUOLI_SUP</name>
    <value>
      WITH T AS
      (
      SELECT
      dpa_corr_globali.id_gruppo,
      DPA_CORR_GLOBALI.ID_UO, DPA_CORR_GLOBALI.ID_PARENT,
      DPA_CORR_GLOBALI.VAR_CODICE
      FROM dpa_corr_globali
      INNER JOIN dpa_tipo_ruolo
      ON dpa_corr_globali.id_tipo_ruolo = dpa_tipo_ruolo.system_id
      WHERE dpa_corr_globali.id_uo IN
      (SELECT dpa_corr_globali.system_id
      FROM dpa_corr_globali
      WHERE dpa_corr_globali.dta_fine IS NULL
      --CONNECT BY PRIOR dpa_corr_globali.id_parent = dpa_corr_globali.system_id
      AND dpa_corr_globali.system_id =
      (SELECT dpa_corr_globali.id_uo
      FROM dpa_corr_globali
      WHERE dpa_corr_globali.id_gruppo = @idGruppoRuoloDestinatario@
      )
      )
      AND dpa_corr_globali.CHA_TIPO_URP = 'R'
      AND dpa_corr_globali.ID_AMM = @idAmm@
      AND dpa_corr_globali.DTA_FINE IS NULL
      AND dpa_tipo_ruolo.num_livello &lt;=
      (SELECT dpa_tipo_ruolo.num_livello
      FROM dpa_corr_globali
      INNER JOIN dpa_tipo_ruolo
      ON dpa_corr_globali.id_tipo_ruolo = dpa_tipo_ruolo.system_id
      WHERE dpa_corr_globali.id_gruppo  = @idGruppoRuoloDestinatario@

      )

      UNION ALL

      (SELECT CG.ID_GRUPPO, CG.ID_PARENT, CG.ID_UO, CG.VAR_CODICE
      FROM  T, DPA_CORR_GLOBALI CG
      WHERE CG.DTA_FINE IS NULL
      AND CG.SYSTEM_ID IN (SELECT SYSTEM_ID FROM DPA_CORR_GLOBALI WHERE ID_UO =
      (SELECT ID_PARENT FROM DPA_CORR_GLOBALI WHERE (SYSTEM_ID = T.ID_UO OR SYSTEM_ID = T.ID_PARENT )))
      )
      )
      select DISTINCT ID_GRUPPO, VAR_CODICE from T WHERE T.ID_PARENT != 0

    </value>
  </query>
  <query>
    <name>GET_ID_DOC_OR_FASC_COPY_VIS</name>
    <value>
      SELECT @optmizerMode@
      DISTINCT(thing)
      FROM security  WITH (nolock) , @objType@
      WHERE
      security.thing = @objType@.system_id
      AND
      personorgroup = @idGruppoRuoloOrigine@
      AND
      accessrights > 20
      @condizioneDocFasc@
      @condizioneIdRegistro@
      @condizioneAtipicita@
      @codizioneVisibilita@
    </value>
  </query>
  <query>
    <name>I_DPA_OBJECTS_SYNC_PENDING</name>
    <value>
      insert into DPA_OBJECTS_SYNC_PENDING (ID_DOC_OR_FASC, TYPE, ID_GRUPPO_TO_SYNC)
      (
      SELECT @optmizerMode@
      DISTINCT(thing),
      '@typeDocOrFasc@',
      @idGruppoRuoloDestinatario@
      FROM security  WITH (nolock) , @objType@
      WHERE
      security.thing = @objType@.system_id
      AND
      personorgroup = @idGruppoRuoloOrigine@
      AND
      accessrights > 20
      @condizioneDocFasc@
      @condizioneIdRegistro@
      @condizioneAtipicita@
      @codizioneVisibilita@
      --Condizione di non esistenza
      AND NOT EXISTS
      (
      select 'x' from DPA_OBJECTS_SYNC_PENDING where ID_DOC_OR_FASC = @objType@.system_id and ID_GRUPPO_TO_SYNC = @idGruppoRuoloDestinatario@
      )
      )
    </value>
  </query>
  <query>
    <name>D_DPA_OBJECTS_SYNC_PENDING</name>
    <value>
      delete from DPA_OBJECTS_SYNC_PENDING where ID_DOC_OR_FASC = @idDocOrFasc@
    </value>
  </query>
  <query>
    <name>GET_ROLE_TYPE_ID</name>
    <value>
      Select Id_Tipo_Ruolo
      From Dpa_Corr_Globali
      where cha_tipo_urp = 'R' and Id_Gruppo = @idGroup@
    </value>
  </query>
  <query>
    <name>COUNT_DELEGHE_ATTIVE_E_IN_ESERCIZIO_UTENTE</name>
    <value>
      SELECT COUNT(*)
      FROM dpa_deleghe d
      WHERE (d.id_people_delegato = @idPeople@ AND d.cha_in_esercizio = 1) -- L'utente sta esercitando delle deleghe
      OR     (    d.id_people_delegante = @idPeople@
      AND d.id_ruolo_delegante = @idRole@
      AND d.cha_in_esercizio = 1
      ) -- L'utente ha delegato qualcuno
      AND d.data_decorrenza &lt; GETDATE()
      AND (d.data_scadenza &gt;  GETDATE() OR d.data_scadenza IS NULL)
    </value>
  </query>
  <query>
    <name>CHECK_IF_ROLE_HAS_TRANSMISSIONS</name>
    <value>
      select count(system_id_tx)
      from v_trasmissione
      where id_corr_globale_dest = @roleIdCorrGlobali@
      And dta_vista is null
    </value>
  </query>
  <query>
    <name>S_GET_ROLE_HISTORY</name>
    <value>
      SELECT original_corr_id,
      action,
      role_description,
      action_date,
      docsadm.GETCORRDESCRIPTION(uo_id) as uo_description_,
      docsadm.getroletypedescription(role_type_id) as role_type_description_,
      role_id
      FROM dpa_role_history
      WHERE original_corr_id in( SELECT original_id FROM dpa_corr_globali WHERE system_id = @idCorrGlobali@)
      ORDER BY action_date DESC
    </value>
  </query>
  <query>
    <name>UPDATE_ID_CORR_GLOB_IN_TRANSMISSION_MODELS</name>
    <value>
      update dpa_modelli_mitt_dest
      set id_corr_globali = @newCorrGlobId@
      where cha_tipo_mitt_dest = 'D' and id_corr_globali = @oldCorrGlobId@
    </value>
  </query>
  <query>
    <name>S_GET_UO_ID_FROM_ROLE_CORR_GLOB</name>
    <value>
      SELECT id_uo
      FROM dpa_corr_globali
      WHERE system_id = @idCorrGlobRole@
    </value>
  </query>
  <query>
    <name>S_GET_ROLE_CHAIN_ID_CORR_GLOBALI</name>
    <value>
      WITH Chain(system_id) AS
      (
      SELECT SYSTEM_ID
      FROM DPA_CORR_GLOBALI WITH(NOLOCK)
      WHERE SYSTEM_ID = @idCorrGlob@
      UNION ALL
      SELECT cg.SYSTEM_ID
      FROM DPA_CORR_GLOBALI as cg WITH(NOLOCK), Chain
      WHERE Chain.system_id = cg.ID_OLD)
      SELECT * FROM Chain
    </value>
  </query>
  <query>
    <name>S_GET_ROLE_CHAIN_ID_CORR_GLOBALI_IN_CLAUSOLE</name>
    <value>
      SELECT * FROM Chain
    </value>
  </query>
  <query>
    <name>S_GET_ROLE_CHAIN_ID_CORR_GLOBALI_OUT_CLAUSOLE</name>
    <value>
      WITH Chain(system_id) AS
      (
      SELECT ID_OLD
      FROM DPA_CORR_GLOBALI
      WHERE SYSTEM_ID = @idCorrGlob@
      UNION ALL
      SELECT cg.SYSTEM_ID
      FROM DPA_CORR_GLOBALI as cg, Chain
      WHERE Chain.system_id = cg.ID_OLD)
    </value>
  </query>
  <query>
    <name>S_GET_ROLE_INFO</name>
    <value>
      SELECT var_codice, var_desc_corr, id_tipo_ruolo, id_uo , Cha_Disabled_Trasm, Cha_Riferimento, Cha_Responsabile, Cha_Segretario
      FROM dpa_corr_globali
      WHERE system_id = @idCorrGlobRole@
    </value>
  </query>
  <query>
    <name>CHECK_IF_ROLE_DISABLED</name>
    <value>
      SELECT dta_fine FROM dpa_corr_globali WHERE system_id = @authorCorrGlob@
    </value>
  </query>
  <query>
    <name>U_LISTS_OWNER</name>
    <value>
      UPDATE dpa_corr_globali
      SET id_gruppo_liste = @newIdGroup@
      WHERE id_gruppo_liste = @oldIdGroup@
    </value>
  </query>
  <query>
    <name>S_COD_UTILIZZATO</name>
    <value>
      Select var_desc_corr + ' (' + var_codice + ')' As Descr, dta_fine
      From dpa_corr_globali
      Where var_codice = '@codice@' And system_id != @corrId@
    </value>
  </query>
  <query>
    <name>S_LOGIN_CENTRO_SERVIZI_CONSERVAZIONE</name>
    <value>
      SELECT
      SYSTEM_ID
      FROM PEOPLE
      WHERE
      user_Id = '@param1@'
      --MEV CS 1.4 Esibizione
      --AND ABILITATO_CENTRO_SERVIZI = '1'
      AND (ABILITATO_CENTRO_SERVIZI = '1' OR ABILITATO_ESIBIZIONE = '1')
      AND (ID_AMM=@param2@ OR ID_AMM IS NULL)
    </value>
  </query>
  <query>
    <name>U_UPDATE_ITEM_CONSERVAZIONE_VERIFICA_FIRMA</name>
    <value>
      UPDATE DPA_ITEMS_CONSERVAZIONE
      SET VALIDAZIONE_FIRMA = '@esitoValidazioneFirma@'
      WHERE SYSTEM_ID = @systemId@
    </value>
  </query>
  <query>
    <name>PD_SET_DTA_ANNULLAMENTO_REPERTORIO_DOC</name>
    <value>
      UPDATE DPA_ASSOCIAZIONE_TEMPLATES
      SET DTA_ANNULLAMENTO = getDate()
      WHERE ID_OGGETTO = @idOggetto@ AND DOC_NUMBER = @docNumber@
    </value>
  </query>
  <query>
    <name>PD_INS_STORICO_DOC</name>
    <value>
      INSERT INTO DPA_PROFIL_STO
      (
      ID_TEMPLATE,
      DTA_MODIFICA,
      ID_PROFILE,
      ID_OGG_CUSTOM,
      ID_PEOPLE,
      ID_RUOLO_IN_UO,
      VAR_DESC_MODIFICA
      )
      VALUES
      (
      @idTemplate@,
      @dtaModifica@,
      @idProfile@,
      @idOggCustom@,
      @idPeople@,
      @idRuoloInUo@,
      '@varDescModifica@'
      )
    </value>
  </query>
  <query>
    <name>S_AMM_GET_ROLE</name>
    <value>
      SELECT
      a.system_id AS IDCORRGLOBALE,
      a.id_gruppo AS IDGRUPPO,
      a.id_tipo_ruolo AS IDTIPORUOLO,
      a.var_codice AS CODICE,
      a.var_cod_rubrica AS CODICERUBRICA,
      a.var_desc_corr AS DESCRIZIONE,
      a.cha_riferimento AS DIRIFERIMENTO,
      a.id_amm AS IDAMMINISTRAZIONE,
      a.cha_responsabile as RESPONSABILE,
      a.id_peso_org as IDPESO,
      a.CHA_SEGRETARIO as SEGRETARIO,
      b.NUM_LIVELLO as NUM_LIVELLO,
      a.CHA_DISABLED_TRASM
      FROM
      DPA_CORR_GLOBALI a, DPA_TIPO_RUOLO b
      WHERE
      a.cha_tipo_urp = 'R'
      AND a.cha_tipo_ie = 'I'
      AND a.dta_fine is null
      AND a.system_id = @corrGlob@
    </value>
  </query>
  <query>
    <name>U_CHA_TIPO_DIRITTO_SECURITY_DOC</name>
    <value>
      UPDATE SECURITY SET CHA_TIPO_DIRITTO = 'T' WHERE THING = @thing@ AND PERSONORGROUP = @personorgroup@ AND CHA_TIPO_DIRITTO = 'A'
    </value>
  </query>
  <query>
    <name>U_CHA_TIPO_DIRITTO_SECURITY_FASC</name>
    <value>
      UPDATE SECURITY SET CHA_TIPO_DIRITTO = 'T' WHERE THING IN (
      SELECT LINK FROM PROJECT_COMPONENTS PG WHERE PG.PROJECT_ID IN(
      SELECT SYSTEM_ID FROM PROJECT WHERE ID_FASCICOLO = @idFascicolo@ AND CHA_TIPO_PROJ = 'C'))
      AND PERSONORGROUP = @personorgroup@ AND CHA_TIPO_DIRITTO = 'A'
    </value>
  </query>
  <query>
    <name>AMM_U_MAIL_FOR_REGISTRO_MAIL</name>
    <value>
      UPDATE DPA_CORR_GLOBALI
      SET VAR_EMAIL = '@VAR_EMAIL_REGISTRO@'
      WHERE CHA_TIPO_URP = 'U' and CHA_TIPO_IE ='I' and VAR_CODICE_AOO = '@VAR_CODICE@'
    </value>
  </query>
  <query>
    <name>S_DPA_TIPO_NOTIFICA</name>
    <value>
      SELECT * FROM DPA_TIPO_NOTIFICA
    </value>
  </query>
  <query>
    <name>S_DPA_NOTIFICA2</name>
    <value>
      (SELECT
      (CASE
      WHEN
      n.var_errore_ricevuta != 'nessuno' OR
      n.var_errore_esteso IS NOT NULL
      THEN tn.var_descrizione || ' - ' || n.var_errore_ricevuta
      ELSE (Case When substr(n.var_mittente, 0, 4) = 'http' Then tn.var_codice_notifica Else tn.var_descrizione End)
      END) as tipo,
      n.var_destinatario as destinatario,
      (CASE WHEN
      tn.var_descrizione = 'email di eccezione'  or
      tn.var_descrizione = 'email di errore'
      then n.var_oggetto
      else
      (
      (Case When substr(n.var_mittente, 0, 4) = 'http' Then tn.var_codice_notifica || ' inviata il ' || n.var_giorno_ora Else
      tn.var_descrizione ||
      ' è stata inviata il ''' ||
      n.var_giorno_ora ||
      '''. Il destinatario ''' ||
      n.var_destinatario ||
      ''' ha una mail di tipo: ''' ||
      decode(n.var_tipo_destinatario,'esterno','non certificata','certificata') ||
      '''. Il codice identificatore del messaggio è: ''' ||
      n.var_identificativo || '''.'
      End)
      ) END) as dettagli
      FROM dpa_notifica n  JOIN dpa_tipo_notifica tn ON n.id_tipo_notifica=tn.system_id
      WHERE @docnumber@ @filterCond@
      )
      @unionConfermaRicevute@
    </value>
  </query>
  <query>
    <name>S_DPA_NOTIFICA3</name>
    <value>
      SELECT n.SYSTEM_ID,
      n.VAR_MITTENTE,
      n.VAR_TIPO_DESTINATARIO,
      n.VAR_DESTINATARIO,
      n.VAR_RISPOSTE,
      n.VAR_OGGETTO,
      n.VAR_GESTIONE_EMITTENTE,
      n.VAR_ZONA,
      n.VAR_GIORNO_ORA,
      n.VAR_IDENTIFICATIVO,
      n.VAR_MSGID,
      n.VAR_TIPO_RICEVUTA,
      n.VAR_CONSEGNA,
      n.VAR_RICEZIONE,
      n.VAR_ERRORE_ESTESO,
      n.DOCNUMBER,
      n.ID_TIPO_NOTIFICA,
      n.VAR_ERRORE_RICEVUTA
      FROM dpa_notifica n
      JOIN dpa_tipo_notifica tn
      ON n.id_tipo_notifica=tn.system_id
      WHERE @docnumber@ @filterCond@
    </value>
  </query>
  <query>
    <name>S_DPA_NOTIFICA_ISALLEGATOPEC</name>
    <value>
      SELECT '1'
      FROM (profile p join versions v on p.docnumber=v.docnumber and v.version_id=@version_id@)
      left join dpa_notifica n on v.version_id=n.version_id
      WHERE
      n.version_id=@version_id@ OR p.var_prof_oggetto LIKE 'Ricevuta di ritorno delle Mail%'
    </value>
  </query>

  <query>
    <name>S_DPA_NOTIFICA_ISALLEGATOIS</name>
    <value>
      SELECT '1'
      FROM (profile p join versions v on p.docnumber=v.docnumber and v.version_id=@version_id@)
      left join dpa_notifica n on v.version_id=n.version_id
      WHERE
      n.version_id=@version_id@ OR ( p.var_prof_oggetto = 'Ricevuta di avvenuta consegna'
      OR p.var_prof_oggetto = 'Ricevuta di mancata consegna')
    </value>
  </query>

  <query>
    <name>GETCODICECORRISPONDENTE</name>
    <value>
      SELECT   d.var_cod_rubrica, d.*
      FROM dpa_corr_globali d
      WHERE var_desc_corr in
      (SELECT valore_oggetto_db
      FROM dpa_associazione_templates t
      WHERE t.id_template = @IDTEMPLATE@
      AND doc_number = @DOCNUMBER@
      AND id_oggetto = @IDOGGETTO@)
      AND cha_tipo_ie = 'I' and dta_fine is null
      ORDER BY dta_inizio
    </value>
  </query>
  <query>
    <name>U_DISABLE_ENABLE_ALL_PROF_HISTORY</name>
    <value>
      Update DPA_OGG_CUSTOM_COMP@fasc@
      Set Enabledhistory = @value@
      where id_ogg_custom in (
      Select Oc.System_Id
      from Dpa_Oggetti_Custom@fasc@ Oc
      Inner Join Dpa_Ogg_Custom_Comp@fasc@ Toc
      On Oc.System_Id = Toc.Id_Ogg_Custom
      and Toc.Id_Template = @idTemplate@
      )
    </value>
  </query>
  <query>
    <name>U_ENABLE_DISABLE_PROF_HISTORY_SELECTIVE</name>
    <value>
      Update DPA_OGG_CUSTOM_COMP@fasc@
      Set Enabledhistory = @value@
      where id_ogg_custom in (
      @idList@
      )
    </value>
  </query>
  <query>
    <name>S_HISTORY_PROF_STATE</name>
    <value>
      Select oc.system_id, occ.enabledhistory, oc.descrizione, @dbUser@.getSeOggAttivo(oc.system_id, @idTemplate@) as attivo
      From dpa_ogg_custom_comp@fasc@ occ
      Inner Join dpa_oggetti_custom@fasc@ oc
      On occ.id_ogg_custom = oc.system_id
      Inner Join dpa_tipo_oggetto@fasc@ tyo
      On oc.id_tipo_oggetto = tyo.system_id
      Where tyo.descrizione != 'Contatore'
      And id_template = @idTemplate@
      Order By occ.posizione
    </value>
  </query>
  <query>
    <name>S_REGISTERED_REGISTRIES_MIN_INFO_DOC</name>
    <value>
      Select
      distinct(oc.system_id) As CounterId,
      oc.descrizione As CounterDescription,
      ta.var_desc_atto As TipologyDescription,
      'D' As Typology,
      Case ta.in_esercizio When 'SI' Then 'true' Else 'false' End  As TipologyEnabled,
      (Select Top(1) SettingsType From dpa_registri_repertorio Where CounterId = oc.system_id) As Settings
      From dpa_tipo_atto ta
      Inner Join dpa_ogg_custom_comp occ
      On ta.system_id = occ.id_template
      Inner Join dpa_oggetti_custom oc
      On occ.id_ogg_custom = oc.system_id
      Where ta.id_amm = @administrationId@
      And oc.system_id in
      (Select r.counterid From dpa_registri_repertorio r)
      Order By CounterId Asc
    </value>
  </query>
  <query>
    <name>S_REGISTERED_REGISTRIES_MIN_INFO_PRJ</name>
    <value>
      Select
      distinct(oc.system_id) As CounterId,
      oc.descrizione As CounterDescription,
      ta.var_desc_fasc As TipologyDescription,
      'F' As Typology,
      Case ta.in_esercizio When 'SI' Then 'true' Else 'false' End  As TipologyEnabled,
      (Select Top(1) SettingsType From dpa_registri_repertorio Where CounterId = oc.system_id) As Settings
      From dpa_tipo_fasc ta
      Inner Join dpa_ogg_custom_comp_fasc occ
      On ta.system_id = occ.id_template
      Inner Join dpa_oggetti_custom_fasc oc
      On occ.id_ogg_custom = oc.system_id
      Where ta.id_amm = @administrationId@
      And oc.system_id in
      (Select r.counterid From dpa_registri_repertorio r)
      Order By CounterId Asc
    </value>
  </query>
  <query>
    <name>S_REGISTRY_SETTINGS</name>
    <value>
      Select
      RegistryId As RegistryId,
      RfId As RFId,
      (Select var_desc_registro From dpa_el_registri Where system_id = isnull(registryid, rfid)) As RegistryOrRfDescription,
      rolerespid As RoleRespId,
      PrinterRoleRespId As PrinterRoleRespId,
      PrinterUserRespId As PrinterUserRespId,
      (Select var_desc_corr From dpa_corr_globali Where id_gruppo = PrinterRoleRespId And dta_fine Is Null) + ' - ' + (Select var_desc_corr From dpa_corr_globali Where id_people = PrinterUserRespId And dta_fine Is Null) As RoleAndUserDescription,
      CounterState As CounterState,
      Printfreq As PrintFrequency,
      convert(varchar, dtastart, 103) As DateAutomaticPrintStart,
      convert(varchar, dtafinish, 103) As DateAutomaticPrintFinish,
      convert(varchar, dtanextAutomaticprint, 103) As DateNextAutomaticPrint,
      convert(varchar, dtalastprint, 103) As DateLastPrint,
      LastPrintedNumber As LastPrintedNumber,
      RespRights
      From dpa_registri_repertorio
      Where CounterId = @counterId@
      @filter@
    </value>
  </query>
  <query>
    <name>S_USER_MIN_INFO</name>
    <value>
      Select full_name, system_id
      From people
      Where system_id In (
      Select people_system_id
      From peoplegroups
      Where groups_system_id = @idGroup@)
    </value>
  </query>
  <query>
    <name>S_GET_USERS_IN_ROLE_BY_IDCORRGLOBALE</name>
    <value>
      select b.id_people,b.VAR_DESC_CORR from dpa_corr_globali a, dpa_corr_globali b, peoplegroups g where a.system_id = @idCorrGlobali@ and a.ID_GRUPPO = g.GROUPS_SYSTEM_ID and g.PEOPLE_SYSTEM_ID = b.ID_PEOPLE
    </value>
  </query>
  <query>
    <name>S_REGISTER_SETTINGS_MINIMAL_INFO</name>
    <value>
      Select
      RegistryId,
      (Select var_desc_registro From dpa_el_registri Where system_id = isnull(registryid, rfid)) As RegistryOrRfDescription,
      RfId,
      (Select var_desc_corr From dpa_corr_globali Where id_gruppo = PrinterRoleRespId And dta_fine Is Null) + ' - ' + (Select var_desc_corr From dpa_corr_globali Where id_people = PrinterUserRespId And dta_fine Is Null) As RoleAndUserDescription,
      SettingsType As Settings,
      CounterState As CounterState
      From dpa_registri_repertorio
      Where CounterId = @counterId@
      And TipologyKind = 'D'
    </value>
  </query>
  <query>
    <name>REPORT_REGISTRI_REPERTORIO_NUOVI</name>
    <value>
      SELECT * FROM (
      Select
      isnull(p.var_segnatura, p.docnumber) As IdDoc,
      p.var_prof_oggetto As Oggetto_Documento,
      oc.descrizione As Descrizione_Campo_Profilato,
      asstemp.valore_oggetto_db As Valore,
      ta.id_amm As IdAmm,
      (select dta_ins from dpa_associazione_templates where doc_number =p.docnumber and id_oggetto in (select system_id from dpa_oggetti_custom where
      ID_TIPO_OGGETTO in(select system_id from dpa_tipo_oggetto where tipo='Contatore'))) as
      Data_Di_Repertorio,
      assTemp.dta_annullamento As Data_Annullamento,
      --c.var_impronta As "Impronta",
      @dbuser@.getimprontawithallegati(p.docnumber) as "Impronta",
      p.docnumber As DocNumber,
      (Select tobj.descrizione  From dpa_tipo_oggetto tobj Where tobj.system_id = oc.id_tipo_oggetto) As ObjType,
      occ.enabledhistory As EnabledHistory,
      Occ.Id_Ogg_Custom as ObjectId,
      dpa_amm.VAR_CODICE_AMM as COD_AMM
      From profile p WITH(NOLOCK)
      Inner Join dpa_tipo_atto ta
      On ta.system_id = p.id_tipo_atto
      Inner Join dpa_associazione_templates assTemp
      On p.id_tipo_atto = assTemp.id_template And assTemp.doc_number = p.docnumber
      Inner Join dpa_oggetti_custom oc
      On assTemp.id_oggetto = oc.system_id
      Inner Join dpa_ogg_custom_comp occ
      On oc.system_id = occ.id_ogg_custom and OCC.ID_TEMPLATE = TA.SYSTEM_ID
      Inner Join components c
      On c.docnumber = p.docnumber
      Inner Join versions v
      On v.version = (SELECT MAX (VERSION) FROM versions WHERE versions.docnumber = p.docnumber AND VERSION &lt;&gt; 0) And v.docnumber = p.docnumber and V.VERSION_ID = C.VERSION_ID
      Inner Join DPA_AMMINISTRA dpa_amm
      on dpa_amm.SYSTEM_ID = ta.ID_AMM
      Where
      p.cha_tipo_proto IN ('A', 'P', 'I', 'G')
      And p.docnumber in (
      Select assTemp1.doc_number
      From dpa_associazione_templates assTemp1
      Where id_oggetto = @idCounter@
      And  convert(int, valore_oggetto_db) >= @firstNumber@
      And AssTemp.Anno = convert(int, '@year@')
      And assTemp1.id_aoo_rf in (@registryRfList@))
      --ORDER BY Data_Di_Repertorio asc, mv.doc_number asc, mv.system_id_ogg_custom asc
      ) A WHERE A.DATA_DI_REPERTORIO between convert(DATETIME, '01/01/@year@', 103)
      and convert(DATETIME, '31/12/@year@', 103)
      ORDER BY A.Data_Di_Repertorio asc
    </value>
  </query>
  <query>
    <name>S_GET_SEGNATURA_REPERTORIO</name>
    <value>
      SELECT
      c.formato_contatore as formato_contatore,
      at.valore_oggetto_db as valore_database,
      convert(varchar, at.anno, 121) + '' as anno,
      at.codice_db as codice_db,
      --convert(varchar, at.dta_ins, 121) + '' as data_inserimento,
      convert(varchar, at.dta_ins, 103) + ' ' + convert(varchar(8), at.dta_ins, 114) as data_inserimento,
      convert(varchar, at.id_aoo_rf, 121) + '' as id_aoo_rf,
      convert(varchar, at.dta_annullamento, 121) as data_annullamento,
      t.VAR_DESC_ATTO as TIPOLOGIA,
      DOCSADM.classcat(at.Doc_Number) as CLASSIFICA
      FROM dpa_associazione_templates at, dpa_oggetti_custom c,
      DPA_TIPO_ATTO t

      WHERE doc_number=@docnumber@ AND
      at.id_oggetto=c.system_id and c.repertorio=1 AND at.ID_TEMPLATE = t.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>S_GET_SEGNATURA_REPERTORIO_SIMPLE</name>
    <value>
      SELECT
      c.formato_contatore as FORMATO_CONTATORE,
      at.valore_oggetto_db as CONTATORE,
      at.anno as ANNO,
      at.codice_db as CODICE_UO,
      at.dta_ins as DATA_INSERIMENTO,
      at.id_aoo_rf as ID_AOO_RF,
      at.dta_annullamento as DATA_ANNULLAMENTO,
      t.VAR_DESC_ATTO as TIPOLOGIA,
      DOCSADM.classcat(at.Doc_Number) as CLASSIFICA,
      c.CHA_PERMANENTE_ONNICOMPRENSIVA AS ONNICOMPENSIVA,
      c.CHA_PERMANENTE AS IS_PERMANENTE
      FROM dpa_associazione_templates at, dpa_oggetti_custom c,
      DPA_TIPO_ATTO t
      WHERE doc_number= @docnumber@ AND
      at.id_oggetto=c.system_id and c.repertorio=1 AND at.ID_TEMPLATE = t.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>S_GET_COUNTER_PRINT_INFO</name>
    <value>
      Select
      CounterState
      From dpa_registri_repertorio
      Where CounterId = @counterId@ And RegistryId @registryId@ And RfId @rfId@
    </value>
  </query>
  <query>
    <name>I_SAVE_PRINT_REPERTORIO</name>
    <value>
      INSERT
      INTO DPA_STAMPA_REPERTORI
      (
      ID_REPERTORIO,
      NUM_REP_START,
      NUM_REP_END,
      NUM_ANNO,
      DOCNUMBER,
      DTA_STAMPA,
      RegistryId
      )
      VALUES
      (
      @counterId@,
      @numStart@,
      @numEnd@,
      @year@,
      @docNumber@,
      getDate(),
      @registryId@
      )
    </value>
  </query>
  <query>
    <name>U_LAST_PRINTED_NUMBER_REPERTORI</name>
    <value>
      Update dpa_registri_repertorio
      Set LastPrintedNumber = @lastPrintedNumber@, DtaLastPrint = getDate()
      Where CounterId = @counterId@ And RfId @rfId@ And RegistryId @registryId@
    </value>
  </query>
  <query>
    <name>U_SAVE_REPERTORIO_STATE</name>
    <value>
      Update dpa_registri_repertorio
      Set  CounterState = '@counterState@'
      Where CounterId = @counterId@
    </value>
  </query>
  <query>
    <name>S_COUNTER_TYPOLOGY</name>
    <value>
      Select Distinct(TipologyId)
      From dpa_registri_repertorio
      Where CounterId = @counterId@
    </value>
  </query>
  <query>
    <name>REPORT_REGISTRI_REPERTORIO_MOD</name>
    <value>
      SELECT isnull(P.VAR_SEGNATURA, P.DOCNUMBER) AS IDDOC,
      P.VAR_PROF_OGGETTO                     AS OGGETTO_DOCUMENTO,
      OC.DESCRIZIONE                         AS DESCRIZIONE_CAMPO_PROFILATO,
      AMM.VAR_CODICE_AMM                     AS COD_AMM,
      ASSTEMP.VALORE_OGGETTO_DB              AS VALORE,
      TA.ID_AMM                              AS IDAMM,
      (select dta_ins from dpa_associazione_templates where doc_number =P.DOCNUMBER and id_oggetto in (select system_id from dpa_oggetti_custom where
      ID_TIPO_OGGETTO in(select system_id from dpa_tipo_oggetto where tipo='Contatore')))
      AS DATA_DI_REPERTORIO,
      ASSTEMP.DTA_ANNULLAMENTO               AS DATA_ANNULLAMENTO,
      C.VAR_IMPRONTA                         AS "Impronta",
      P.DOCNUMBER                            AS DOCNUMBER,
      (SELECT TOBJ.DESCRIZIONE
      FROM DPA_TIPO_OGGETTO TOBJ
      WHERE TOBJ.SYSTEM_ID = OC.ID_TIPO_OGGETTO
      )                  AS OBJTYPE,
      OCC.ENABLEDHISTORY AS ENABLEDHISTORY,
      OCC.ID_OGG_CUSTOM  AS OBJECTID
      FROM profile P WITH(NOLOCK)
      INNER JOIN DPA_TIPO_ATTO TA
      ON TA.SYSTEM_ID = P.ID_TIPO_ATTO
      INNER JOIN DPA_ASSOCIAZIONE_TEMPLATES ASSTEMP
      ON P.ID_TIPO_ATTO      = ASSTEMP.ID_TEMPLATE
      AND ASSTEMP.DOC_NUMBER = P.DOCNUMBER
      INNER JOIN DPA_OGGETTI_CUSTOM OC
      ON ASSTEMP.ID_OGGETTO = OC.SYSTEM_ID
      INNER JOIN DPA_OGG_CUSTOM_COMP OCC
      ON OC.SYSTEM_ID = OCC.ID_OGG_CUSTOM and OCC.ID_TEMPLATE = TA.SYSTEM_ID
      INNER JOIN COMPONENTS C
      ON C.DOCNUMBER = P.DOCNUMBER

      INNER JOIN DPA_AMMINISTRA AMM --Bug registri repertori
      ON TA.ID_AMM = AMM.SYSTEM_ID

      INNER JOIN versions V
      ON V.version =
      (SELECT MAX (version)
      FROM versions
      WHERE versions.DOCNUMBER = P.DOCNUMBER
      AND version             != 0
      )
      AND V.DOCNUMBER         = P.DOCNUMBER and V.VERSION_ID = C.VERSION_ID
      WHERE P.CHA_TIPO_PROTO IN ('A', 'P', 'I', 'G')
      AND P.CREATION_DATE     &lt; (
      CASE
      WHEN convert(varchar,
      (SELECT YEAR(DTALASTPRINT)
      FROM DPA_REGISTRI_REPERTORIO
      WHERE COUNTERID = @idCounter@
      AND RFID        @idRf@
      AND REGISTRYID @idRegistry@
      ))      = '@year@'
      THEN
      (SELECT DTALASTPRINT
      FROM DPA_REGISTRI_REPERTORIO
      WHERE COUNTERID = @idCounter@
      AND RFID        @idRf@
      AND REGISTRYID @idRegistry@
      )
      ELSE convert(datetime, '31/12/@year@', 103)
      END)
      /*Controllo per bug documenti modificati lo stesso giorno della creazione */
      AND CONVERT(DATETIME, CONVERT(DATE,P.LAST_EDIT_DATE)) > CONVERT(DATETIME, CONVERT(DATE,P.CREATION_DATE))
      AND P.DOCNUMBER    IN
      (SELECT ASSTEMP1.DOC_NUMBER
      FROM DPA_ASSOCIAZIONE_TEMPLATES ASSTEMP1
      WHERE ID_OGGETTO        = @idCounter@
      AND ASSTEMP1.ID_AOO_RF IN (@registryRfList@)
      )
      /*Condizione per estrarre i documenti modificati nell'oggetto o nei campi profilati rispetto all'ultima data di stampa*/
      AND ( (P.CHA_MOD_OGGETTO = '1'
      AND LAST_EDIT_DATE       > (
      CASE
      WHEN convert(varchar,
      (SELECT YEAR(DTALASTPRINT)
      FROM DPA_REGISTRI_REPERTORIO
      WHERE COUNTERID = @idCounter@
      AND RFID        @idRf@
      AND REGISTRYID @idRegistry@
      ))      = '@year@'
      THEN
      (SELECT DTALASTPRINT
      FROM DPA_REGISTRI_REPERTORIO
      WHERE COUNTERID = @idCounter@
      AND RFID        @idRf@
      AND REGISTRYID @idRegistry@
      )
      ELSE convert(datetime, '01/01/@year@', 103)
      END)
      AND LAST_EDIT_DATE &lt; convert(datetime, '31/12/@year@', 103))
      OR EXISTS
      (SELECT 'x'
      FROM DPA_PROFIL_STO
      WHERE ID_PROFILE = P.DOCNUMBER
      AND DTA_MODIFICA > (
      CASE
      WHEN convert(varchar,
      (SELECT YEAR(DTALASTPRINT)
      FROM DPA_REGISTRI_REPERTORIO
      WHERE COUNTERID = @idCounter@
      AND RFID        @idRf@
      AND REGISTRYID @idRegistry@
      ))      = '@year@'
      THEN
      (SELECT DTALASTPRINT
      FROM DPA_REGISTRI_REPERTORIO
      WHERE COUNTERID = @idCounter@
      AND RFID        @idRf@
      AND REGISTRYID @idRegistry@
      )
      ELSE convert(datetime, '01/01/@year@', 103)
      END)
      AND DTA_MODIFICA &lt; convert(datetime, '31/12/@year@', 103)
      )
      OR EXISTS
      (SELECT 'x'
      FROM versions v
      WHERE V.DOCNUMBER = P.DOCNUMBER And V.DTA_CREAZIONE > (
      CASE
      WHEN convert(varchar,
      (SELECT DTALASTPRINT
      FROM DPA_REGISTRI_REPERTORIO
      WHERE COUNTERID = @idCounter@
      AND RFID        @idRf@
      AND REGISTRYID @idRegistry@
      ))      = '@year@'
      THEN
      (SELECT DTALASTPRINT
      FROM DPA_REGISTRI_REPERTORIO
      WHERE COUNTERID = @idCounter@
      AND RFID        @idRf@
      AND REGISTRYID @idRegistry@
      )
      ELSE convert(datetime, '01/01/@year@', 103)
      END)
      and V.DTA_CREAZIONE &lt; convert(datetime, '31/12/@year@', 103)
      ))
      ORDER BY DATA_DI_REPERTORIO ASC, P.DOCNUMBER ASC,
      ASSTEMP.ID_OGGETTO ASC
    </value>
  </query>
  <query>
    <name>S_REPERTORIO_RESP_ID</name>
    <value>
      Select RoleRespId As RespId,
      RespRights As Rights
      From dpa_registri_repertorio
      Where CounterId = @counterId@
      And RfId @rfId@
      And RegistryId @registryId@
    </value>
  </query>
  <query>
    <name>S_NUM_REPERTORI_MODIFICATI</name>
    <value>
      Select
      Count(*) as docModificati
      From profile p
      Where
      p.cha_mod_oggetto = '1' and last_edit_date > (Select max(dta_stampa) From dpa_stampa_repertori Where id_repertorio = @counterId@ And registryid @regId@)
      Or
      exists (
      Select 'x' from dpa_profil_sto
      Where id_profile = p.docnumber
      And dta_modifica >(select max(dta_stampa) from dpa_stampa_repertori where id_repertorio = @counterId@ And registryid @regId@)
      )
      ),
      project P1
      WHERE P1.ID_FASCICOLO = thing
      OR P1.SYSTEM_ID       = THING
    </value>
  </query>
  <query>
    <name>S_REGISTERS_MINIMAL_SETTINGS</name>
    <value>
      Select
      CounterId,
      (Select descrizione From dpa_oggetti_custom Where system_id = CounterId) as CounterDescription,
      (Select var_desc_atto from dpa_tipo_atto Where system_id = TipologyId) As TipologyDescription,
      RegistryId,
      RFId,
      (Select system_id From dpa_corr_globali Where id_gruppo = PrinterRoleRespId And dta_fine Is Null) As PrinterRoleCorrGlob,
      PrinterUserRespId,
      DtaNextAutomaticPrint,
      CounterState,
      PrintFreq As PrintFrequency
      From dpa_registri_repertorio
      Where tipologykind = 'D'
      And printerrolerespid Is Not Null
      And printeruserrespid Is Not Null
      And PrintFreq != 'N'
      And DtaNextAutomaticPrint &lt;= GETDATE()
      And DtaFinish >= GETDATE()
    </value>
  </query>
  <query>
    <name>U_NEXT_AUTOMATIC_PRINT_REPERTORI</name>
    <value>
      Update dpa_registri_repertorio
      Set DtaNextAutomaticPrint = @date@
      Where CounterId = @counterId@ And registryid @registryId@ And rfid @rfId@
    </value>
  </query>
  <query>
    <name>S_DOC_TIPOLOGY_DESC_BY_DOC_NUMBER</name>
    <value>
      Select var_desc_atto
      From dpa_tipo_atto
      Where system_id = (Select Top(1) id_template From dpa_associazione_templates where doc_Number = @docNumber@)
    </value>
  </query>
  <query>
    <name>S_DOC_TIPOLOGY_DESC_BY_ID_PROFILE</name>
    <value>
      select var_desc_atto
      from dpa_tipo_atto
      where system_id in (Select id_tipo_atto From profile WITH(NOLOCK) Where system_id = @idProfile@)
    </value>
  </query>
  <query>
    <name>S_DOC_TIPOLOGY_DESC_BY_ID_PRJ</name>
    <value>
      select var_desc_fasc
      from dpa_tipo_fasc
      where system_id in (select id_tipo_fasc from project where system_id = @idPrj@)
    </value>
  </query>
  <query>
    <name>U_ALL_REPERTORIO_INSTANCES_STATE</name>
    <value>
      Update dpa_registri_repertorio
      Set CounterState = '@counterState@'
      Where CounterId = @counterId@
    </value>
  </query>
  <query>
    <name>S_REP_TO_PRINT</name>
    <value>
      select a.* from (
      Select AssTemp.Anno AS RepYear,
      Min( convert(int, AssTemp.Valore_Oggetto_Db)) AS FirstNumber,
      Max( convert(int, AssTemp.Valore_Oggetto_Db)) AS LastNumber
      From Dpa_Associazione_Templates AssTemp
      Inner Join Dpa_Oggetti_Custom OggCustom
      On AssTemp.Id_Oggetto          = OggCustom.System_Id
      Where AssTemp.Id_Aoo_Rf       In (@regRfList@)
      And Asstemp.Id_Oggetto = @counterId@
      And OggCustom.Id_Tipo_Oggetto In
      (Select System_Id
      From Dpa_Tipo_Oggetto
      Where Lower(Descrizione) = 'contatore'
      )
      And isnull(AssTemp.Dta_Ins, convert(date, '02/01/1970')) >
      (Select isnull(DtaLastPrint, convert(date, '01/01/1970'))
      From Dpa_Registri_Repertorio
      Where CounterId = @counterId@
      And RegistryId @registry@
      And RfId        @rf@
      )
      Group By AssTemp.Anno
      ) a where a.FirstNumber is not null and a.LastNumber is not null
    </value>
  </query>
  <query>
    <name>S_EXISTS_REP_TO_PRINT</name>
    <value>
      Select Count(a.col)
      From
      (Select 'x' as col
      From Dpa_Associazione_Templates AssTemp
      Inner Join Dpa_Oggetti_Custom OggCustom
      On AssTemp.Id_Oggetto          = OggCustom.System_Id
      Where AssTemp.Id_Aoo_Rf       In (@regRfList@)
      And Asstemp.Id_Oggetto = @counterId@
      And OggCustom.Id_Tipo_Oggetto In
      (Select System_Id
      From Dpa_Tipo_Oggetto
      Where Lower(Descrizione) = 'contatore'
      )
      And isnull(AssTemp.Dta_Ins, convert(date, '02/01/1970')) >
      (Select isnull(DtaLastPrint, convert(date, '01/01/1970'))
      From Dpa_Registri_Repertorio
      Where CounterId = @counterId@
      And RegistryId @registry@
      And RfId        @rf@
      )
      Group By AssTemp.Anno) a
    </value>
  </query>
  <query>
    <name>U_CHA_TIPO_DIRITTO_SECURITY</name>
    <value>
      UPDATE SECURITY SET CHA_TIPO_DIRITTO = 'T' WHERE THING = @thing@ AND PERSONORGROUP = @personorgroup@ AND CHA_TIPO_DIRITTO = 'A'
    </value>
  </query>
  <query>
    <name>U_CHA_TIPO_DIRITTO_SECURITY_DOC_IN_FOLDER</name>
    <value>
      UPDATE SECURITY SET CHA_TIPO_DIRITTO = 'T' WHERE THING IN (
      SELECT LINK FROM PROJECT_COMPONENTS PG WHERE PG.PROJECT_ID IN(
      SELECT SYSTEM_ID FROM PROJECT WHERE ID_FASCICOLO = @idFascicolo@ AND CHA_TIPO_PROJ = 'C'))
      AND PERSONORGROUP = @personorgroup@ AND CHA_TIPO_DIRITTO = 'A'
    </value>
  </query>
  <query>
    <name>COPY_VISIBILITY_FASC</name>
    <value>
      INSERT
      /*+ parallel(security,4) append */
      INTO security
      (
      THING,
      ACCESSRIGHTS,
      PERSONORGROUP,
      CHA_TIPO_DIRITTO,
      VAR_NOTE_SEC
      )
      (SELECT P1.SYSTEM_ID,
      ACCESSRIGHTS,
      @idGruppoRuoloDestinatario@,
      'A',
      'ACQUISITO PER COPIA VISIBILITA'
      FROM
      (SELECT /*+index (s) */ THING,
      ACCESSRIGHTS
      FROM security as S  WITH (nolock) ,
      project P
      where S.THING             = P.SYSTEM_ID
      AND S.PERSONORGROUP       = @idGruppoRuoloOrigine@
      @codizioneVisibilita@
      AND (P.CHA_TIPO_FASCICOLO = 'P'
      OR p.CHA_TIPO_FASCICOLO  IS NULL)
      AND S.ACCESSRIGHTS        > 20
      and P.CHA_TIPO_PROJ       = 'F'
      @regCond@
      @condizioneAtipicita@
      AND NOT EXISTS
      (SELECT /*+index (p1) */ 'x'
      FROM project p1
      WHERE P1.system_id        = P.ID_FASCICOLO
      AND P1.CHA_TIPO_FASCICOLO = 'G'
      )
      AND EXISTS
      (SELECT /*+index (t) */ 'x'
      FROM project T
      WHERE t.system_id =p.id_parent
      AND cha_tipo_proj ='T'
      AND EXISTS
      (SELECT /*+index (s) */ 'x'
      from security as S  WITH (nolock)
      WHERE s.PERSONORGROUP IN ( @idGruppoRuoloDestinatario@ )
      AND accessrights       > 20
      AND s.thing            = T.SYSTEM_ID
      )
      )
      AND NOT EXISTS
      (SELECT /*+index (s) */ 'x'
      FROM security  WITH (nolock)
      where security.THING       = P.SYSTEM_ID
      AND security.PERSONORGROUP = @idGruppoRuoloDestinatario@
      )
      ) t1,
      project P1
      WHERE P1.ID_FASCICOLO = thing
      OR P1.SYSTEM_ID       = THING
      )
    </value>
  </query>
  <query>
    <name>CALCOLA_ATIP_COPIA</name>
    <value>
      SELECT P1.SYSTEM_ID
      FROM
      (SELECT /*+index (s) */ THING
      FROM security as S  WITH (nolock) ,
      project P
      WHERE s.thing             = P.SYSTEM_ID
      AND S.PERSONORGROUP       = @idGruppoRuoloOrigine@
      @codizioneVisibilita@
      AND (P.CHA_TIPO_FASCICOLO = 'P'
      OR p.CHA_TIPO_FASCICOLO  IS NULL)
      AND S.ACCESSRIGHTS        > 20
      AND P.CHA_TIPO_PROJ       = 'F'
      @regCond@
      AND NOT EXISTS
      (SELECT /*+index (p1) */ 'x'
      FROM project p1
      WHERE P1.system_id        = P.ID_FASCICOLO
      AND P1.CHA_TIPO_FASCICOLO = 'G'
      )
      AND EXISTS
      (SELECT /*+index (t) */ 'x'
      FROM project T
      WHERE t.system_id =p.id_parent
      AND cha_tipo_proj ='T'
      AND EXISTS
      (SELECT /*+index (s) */ 'x'
      FROM security as s  WITH (nolock)
      WHERE s.PERSONORGROUP IN ( @idGruppoRuoloDestinatario@ )
      AND accessrights       > 20
      AND s.thing            = T.SYSTEM_ID
      )
      )
      ) t1,
      project P1
      WHERE P1.ID_FASCICOLO = thing
      OR P1.SYSTEM_ID       = THING
    </value>
  </query>
  <query>
    <name>COPIA_DOC_IN_FASC_COPIA_VISIB</name>
    <value>
      INSERT      /*+ parallel(security,4) append */INTO security
      (thing, accessrights, personorgroup, cha_tipo_diritto,
      var_note_sec)
      (SELECT          /*+index (security) */
      DISTINCT (LINK),
      (SELECT TOP(1) accessrights
      FROM security  WITH (nolock)
      WHERE thing = LINK
      AND personorgroup = @idGruppoRuoloOrigine@),
      @idGruppoRuoloDestinatario@ , 'A', 'ACQUISITO PER COPIA VISIBILITA'
      FROM project_components pg
      WHERE pg.project_id IN (
      SELECT /*+ index (p1) */
      p1.system_id    --, accessrights, 26177060, 'A',
      --  'ACQUISITO PER COPIA VISIBILITA'
      FROM   (SELECT /*+index (s)  index (p) */
      thing, accessrights
      FROM security as s  WITH (nolock) , project p
      WHERE s.thing = p.system_id
      AND s.personorgroup = @idGruppoRuoloOrigine@
      @codizioneVisibilita@
      AND (   p.cha_tipo_fascicolo = 'P'
      OR p.cha_tipo_fascicolo IS NULL
      )
      AND s.accessrights > 20
      AND p.cha_tipo_proj = 'F'
      @regCond@
      AND NOT EXISTS (
      SELECT /*+index (p1) */
      'x'
      FROM project p1
      WHERE p1.system_id = p.id_fascicolo
      AND p1.cha_tipo_fascicolo = 'G')
      AND EXISTS (
      SELECT /*+index (t) */
      'x'
      FROM project t
      WHERE t.system_id = p.id_parent
      AND cha_tipo_proj = 'T'
      AND EXISTS (
      SELECT /*+index (s) */
      'x'
      FROM security as s  WITH (nolock)
      WHERE s.personorgroup IN
      (@idGruppoRuoloDestinatario@)
      AND accessrights > 20
      AND s.thing =
      t.system_id))) t1,
      project p1
      WHERE p1.id_fascicolo = thing
      --OR p1.system_id = thing
      )
      @condizioneAtipicita@
      AND NOT EXISTS (
      SELECT /*+index (security) */
      'x'
      FROM security  WITH (nolock)
      WHERE personorgroup = @idGruppoRuoloDestinatario@
      AND thing = pg.LINK))
    </value>
  </query>
  <query>
    <name>CALCOLA_ATIP_COPIA_DOC_IN_FASC</name>
    <value>
      SELECT          /*+index (security) */
      DISTINCT (LINK)
      FROM project_components pg
      WHERE pg.project_id IN (
      SELECT /*+ index (p1) */
      p1.system_id    --, accessrights, 26177060, 'A',
      --  'ACQUISITO PER COPIA VISIBILITA'
      FROM   (SELECT /*+index (s)  index (p) */
      thing, accessrights
      FROM security as s  WITH (nolock) , project p
      WHERE s.thing = p.system_id
      AND s.personorgroup = @idGruppoRuoloOrigine@
      @codizioneVisibilita@
      AND (   p.cha_tipo_fascicolo = 'P'
      OR p.cha_tipo_fascicolo IS NULL
      )
      AND s.accessrights > 20
      AND p.cha_tipo_proj = 'F'
      @regCond@
      AND NOT EXISTS (
      SELECT /*+index (p1) */
      'x'
      FROM project p1
      WHERE p1.system_id = p.id_fascicolo
      AND p1.cha_tipo_fascicolo = 'G')
      AND EXISTS (
      SELECT /*+index (t) */
      'x'
      FROM project t
      WHERE t.system_id = p.id_parent
      AND cha_tipo_proj = 'T'
      AND EXISTS (
      SELECT /*+index (s) */
      'x'
      FROM security  as s  WITH (nolock)
      WHERE s.personorgroup IN
      (@idGruppoRuoloDestinatario@)
      AND accessrights > 20
      AND s.thing =
      t.system_id))) t1,
      project p1
      WHERE p1.id_fascicolo = thing
      --OR p1.system_id = thing
      )
    </value>
  </query>
  <query>
    <name>S_GET_UTENTI_DESTINATARI_TRASMISSIONI_DOCUMENTO</name>
    <value>
      SELECT	pl.SYSTEM_ID AS ID,
      PL.USER_ID AS ID_UTENTE,
      pl.FULL_NAME AS UTENTE,
      tu.DTA_VISTA AS DATA_VISTA,
      tu.DTA_ACCETTATA AS DATA_ACCETTAZIONE,
      TU.DTA_RIFIUTATA AS DATA_RIFIUTO,
      T.DTA_INVIO AS DATA_INVIO,
      rt.VAR_DESC_RAGIONE AS RAGIONE,
      T.SYSTEM_ID AS ID_TRASMISSIONE,
      Ts.CHA_TIPO_DEST AS TIPO_DESTINATARIO,
      cg.ID_GRUPPO AS ID_RUOLO_DESTINATARIO,
      cg.ID_PEOPLE AS ID_UTENTE_DESTINATARIO,
      PL.EMAIL_ADDRESS AS EMAIL_DESTINATARIO,
      PL.MATRICOLA AS MATRICOLA_DESTINATARIO
      FROM PROFILE p WITH(NOLOCK)
      inner join DPA_TRASMISSIONE t on p.SYSTEM_ID = t.ID_PROFILE
      inner join DPA_TRASM_SINGOLA ts on t.SYSTEM_ID = ts.ID_TRASMISSIONE
      inner join DPA_TRASM_UTENTE tu on ts.SYSTEM_ID = tu.ID_TRASM_SINGOLA
      inner join PEOPLE pl on tu.ID_PEOPLE = pl.SYSTEM_ID
      inner join DPA_RAGIONE_TRASM rt on ts.ID_RAGIONE = rt.SYSTEM_ID
      inner join DPA_CORR_GLOBALI cg on cg.SYSTEM_ID = ts.ID_CORR_GLOBALE
      WHERE p.SYSTEM_ID = @idDocumento@
      ORDER BY PL.FULL_NAME ASC
    </value>
  </query>
  <query>
    <name>GET_QUALIF</name>
    <value>
      SELECT SYSTEM_ID, CHA_COD, CHA_DESC, ID_AMM
      FROM DPA_QUALIFICHE
      WHERE ID_AMM = @param1@
      ORDER BY CHA_DESC ASC
    </value>
  </query>
  <query>
    <name>AMM_S_CHECK_UNIQUE_CODICE_QUALIFICA</name>
    <value>
      SELECT COUNT(Q.SYSTEM_ID)
      FROM	DPA_QUALIFICHE Q
      WHERE	Q.CHA_COD='@codiceQualifica@' AND
      Q.ID_AMM=@idAmministrazione@
    </value>
  </query>
  <query>
    <name>AMM_S_INSERT_QUALIFICA</name>
    <value>
      INSERT INTO DPA_QUALIFICHE
      (
      @colID@
      CHA_COD,
      CHA_DESC,
      ID_AMM)
      VALUES
      (
      @id@
      '@codice@',
      '@descrizione@',
      @idAmministrazione@)
    </value>
  </query>
  <query>
    <name>AMM_S_DELETE_QUALIFICA</name>
    <value>
      DELETE FROM DPA_QUALIFICHE
      WHERE
      (SYSTEM_ID=@idQualifica@) AND (ID_AMM=@idAmministrazione@)
    </value>
  </query>
  <query>
    <name>AMM_S_UPDATE_QUALIFICA</name>
    <value>
      UPDATE DPA_QUALIFICHE
      SET CHA_DESC='@descrizione@'
      WHERE
      (SYSTEM_ID=@id@)
    </value>
  </query>
  <query>
    <name>AMM_S_GET_PEOPLEGROUPS_QUALIFICHE_BY_PARAMETERS</name>
    <value>
      SELECT P.SYSTEM_ID, P.ID_AMM, P.ID_UO, P.ID_GRUPPO, P.ID_PEOPLE, Q.CHA_COD, Q.CHA_DESC
      FROM DPA_PEOPLEGROUPS_QUALIFICHE P, DPA_QUALIFICHE Q
      WHERE (P.ID_QUALIFICA = Q.SYSTEM_ID) AND (P.ID_AMM=@idAmm@)
      AND (P.ID_UO=@idUo@) AND (P.ID_GRUPPO=@idGruppo@)
      AND (P.ID_PEOPLE=@idPeople@)
      ORDER BY Q.CHA_COD ASC
    </value>
  </query>
  <query>
    <name>AMM_S_INSERT_PEOPLEGROUPS_QUALIFICHE</name>
    <value>
      INSERT INTO DPA_PEOPLEGROUPS_QUALIFICHE
      (
      @colID@
      ID_AMM,
      ID_UO,
      ID_GRUPPO,
      ID_PEOPLE,
      ID_QUALIFICA)
      VALUES
      (
      @id@
      @idAmm@,
      @idUo@,
      @idGruppo@,
      @idPeople@,
      @idQualifica@)
    </value>
  </query>
  <query>
    <name>AMM_S_DELETE_PEOPLEGROUPS_QUALIFICHE</name>
    <value>
      DELETE FROM DPA_PEOPLEGROUPS_QUALIFICHE
      WHERE
      SYSTEM_ID=@idPeopleGroups@
    </value>
  </query>
  <query>
    <name>AMM_S_DELETE_PEOPLEGROUPS_QUALIFICHE_BY_RUOLO_BY_UTENTE</name>
    <value>
      DELETE FROM DPA_PEOPLEGROUPS_QUALIFICHE
      WHERE
      ID_PEOPLE=@idPeople@ AND
      ID_GRUPPO=@idGruppo@
    </value>
  </query>
  <query>
    <name>AMM_S_CHECK_UNIQUE_PEOPLEGROUPS</name>
    <value>
      SELECT COUNT(SYSTEM_ID)
      FROM	DPA_PEOPLEGROUPS_QUALIFICHE
      WHERE	ID_AMM=@idAmm@ AND
      ID_UO=@idUo@ AND
      ID_GRUPPO=@idGruppo@ AND
      ID_PEOPLE=@idPeople@ AND
      ID_QUALIFICA=@idQualifica@
    </value>
  </query>
  <query>
    <name>AMM_S_GET_PEOPLEGROUPS_QUALIFICHE_BY_IDPEOPLE</name>
    <value>
      SELECT P.SYSTEM_ID, P.ID_AMM, P.ID_UO, P.ID_GRUPPO, P.ID_PEOPLE, Q.SYSTEM_ID AS ID_QUALIFICA, Q.CHA_COD, Q.CHA_DESC
      FROM DPA_PEOPLEGROUPS_QUALIFICHE P, DPA_QUALIFICHE Q
      WHERE (P.ID_QUALIFICA = Q.SYSTEM_ID) AND (P.ID_PEOPLE=@idPeople@)
      ORDER BY Q.CHA_DESC ASC
    </value>
  </query>
  <query>
    <name>AMM_S_GET_UTENTI_BY_CODQUALIFICA</name>
    <value>
      SELECT DISTINCT Q.SYSTEM_ID,Q.USER_ID,Q.FULL_NAME,Q.PHONE,Q.EMAIL_ADDRESS,Q.CHA_NOTIFICA,Q.ID_AMM,Q.VAR_COGNOME,Q.VAR_NOME,Q.VAR_SEDE
      FROM DPA_PEOPLEGROUPS_QUALIFICHE P, PEOPLE Q, DPA_QUALIFICHE T
      WHERE (T.CHA_COD = '@codQualifica@') AND (P.ID_PEOPLE=Q.SYSTEM_ID) AND (P.ID_QUALIFICA=T.SYSTEM_ID)
    </value>
  </query>
  <query>
    <name>PGU_GET_COUNT_ITEMS_CONSERVAZIONE</name>
    <value>
      select count(ac.system_id)
      from dpa_area_conservazione ac
      inner join dpa_amministra a on ac.id_amm = a.system_id
      where a.var_codice_amm = '@codiceAmministrazione@'
    </value>
  </query>
  <query>
    <name>I_INSERT_ISTANZA_CONSERVAZIONE</name>
    <value>
      INSERT INTO DPA_AREA_CONSERVAZIONE
      (
      @colSystemId@
      VAR_DESCRIZIONE,
      VAR_NOTE,
      ID_AMM,
      ID_PEOPLE,
      ID_RUOLO_IN_UO,
      DATA_APERTURA,
      USER_ID,
      ID_GRUPPO,
      ID_POLICY,
      VAR_TIPO_CONS,
      CHA_STATO,
      CONSOLIDA,
      ID_POLICY_VALIDAZIONE,
      VAR_FILE_CHIUSURA,
      VAR_FILE_CHIUSURA_FIRMATO,
      DATA_INVIO
      )
      VALUES
      (
      @systemId@
      '@descrizione@',
      '@note@',
      @idAmministrazione@,
      @idPeople@,
      @idRuoloInUo@,
      getDate(),
      '@userId@',
      @idGruppo@,
      @idPolicy@,
      '@tipoIstanza@',
      '@stato@',
      '@consolida@',
      @validaPolicy@,
      '',
      '',
      @dataInvio@
      )
    </value>
  </query>
  <query>
    <name>D_DELETE_ISTANZA_CONSERVAZIONE</name>
    <value>
      DELETE
      FROM DPA_AREA_CONSERVAZIONE
      WHERE SYSTEM_ID = @systemId@
      AND CHA_STATO = 'N'
    </value>
  </query>
  <query>
    <name>U_REGISTRA_ESITO_VERIFICA_SUPPORTO_RIMOVIBILE</name>
    <value>
      UPDATE DPA_SUPPORTO
      SET CHA_STATO = '@stato@',
      DATA_ULTIMA_VERIFICA = @dataUltimaVerifica@,
      ESITO_ULTIMA_VERIFICA = '@esitoUltimaVerifica@',
      PERC_VERIFICA = '@percentualeVerifica@',
      DATA_PROX_VERIFICA = @dataProssimaVerifica@,
      VERIFICHE_EFFETTUATE = @verificheEffettuate@
      WHERE SYSTEM_ID = @systemId@
    </value>
  </query>
  <query>
    <name>S_GET_STATO_SUPPORTO</name>
    <value>
      SELECT CHA_STATO
      FROM DPA_SUPPORTO
      WHERE SYSTEM_ID = @systemId@
    </value>
  </query>
  <query>
    <name>S_POLICY_CONSERVAZIONE_BY_ID_ISTANZA_CONSERVAZIONE</name>
    <value>
      SELECT ID_POLICY
      FROM DPA_AREA_CONSERVAZIONE
      WHERE SYSTEM_ID = @systemId@
    </value>
  </query>
  <query>
    <name>S_POLICY_VALID_CONSERVAZIONE_BY_ID_ISTANZA_CONSERVAZIONE</name>
    <value>
      SELECT ID_POLICY_VALIDAZIONE
      FROM DPA_AREA_CONSERVAZIONE
      WHERE SYSTEM_ID = @systemId@
    </value>
  </query>
  <query>
    <name>S_POLICY_CONSERVAZIONE</name>
    <value>
      select p.SYSTEM_ID, p.NOME,p.ARRIVO,p.CLASSIFICA,p.CONSOLIDAZIONE,p.GRIGIO,p.ID_AMM,p.ID_RF,p.ID_STATO,p.ID_TEMPLATE,p.INTERNO,p.PARTENZA,p.TIPO,p.ID_AOO,
      convert(varchar,p.DTA_DATA_CREAZIONE_DA,103) as DTA_DATA_CREAZIONE_DA,
      convert(varchar,p.DTA_DATA_CREAZIONE_A,103) as DTA_DATA_CREAZIONE_A,
      convert(varchar,p.DTA_DATA_PROTO_DA,103) as DTA_DATA_PROTO_DA,
      convert(varchar,p.DTA_DATA_PROTO_A,103) as DTA_DATA_PROTO_A,p.PERIODO_TIPO,p.P_G_GIORNI,p.P_G_ORA_HH,p.P_G_ORA_MM,p.P_M_GIORNI,p.P_M_ORA_HH,p.P_M_ORA_MM,p.P_S_LUNEDI,p.P_S_MARTEDI,p.P_S_MERCOLEDI,p.P_S_GIOVEDI,p.P_S_VENERDI,p.P_S_SABATO,p.P_S_DOMENICA,p.P_S_ORA_HH,p.P_S_ORA_MM,p.ID_RUOLO,p.ATTIVA,p.MESI_AVVISO,p.ID_PEOPLE, a.VAR_COD_RUBRICA, b.ID_GRUPPO, p.TIPO_CLASSIFICAZIONE, p.TIPO_DATA_CREAZIONE,p.TIPO_DATA_PROTO,p.ID_UO_CREATORE,p.UO_SOTTOPOSTE,p.STATO_INVIATA,p.STATO_CONVERSIONE,p.INCLUDI_SOTTONODI,p.SOLO_DIGITALI,p.SOLO_FIRMATI,p.P_A_GIORNI,p.P_A_MESE,p.P_A_ORE,p.P_A_MINUTI,p.TIPO_CONSERVAZIONE,p.MESI_AVVISO_LEGGIBILITA
      from POLICY_CONSERVAZIONE p
      LEFT JOIN DPA_CORR_GLOBALI A ON A.ID_PEOPLE = P.ID_PEOPLE
      LEFT JOIN DPA_CORR_GLOBALI B ON b.SYSTEM_ID = P.ID_RUOLO
      where p.ID_AMM=@idAmm@ and p.TIPO='@tipo@' order by p.nome asc
    </value>
  </query>
  <query>
    <name>D_DELETE_POLICY_CONSERVAZIONE</name>
    <value>
      DELETE FROM POLICY_CONSERVAZIONE
      WHERE SYSTEM_ID=@idPolicy@
    </value>
  </query>
  <query>
    <name>D_DELETE_DPA_ASS_POLICY_TYPE</name>
    <value>
      DELETE FROM DPA_ASS_POLICY_TYPE
      WHERE ID_POLICY=@idPolicy@
    </value>
  </query>
  <query>
    <name>S_POLICY_CONSERVAZIONE_BY_ID</name>
    <value>
      select p.SYSTEM_ID, p.NOME,p.ARRIVO,p.CLASSIFICA,p.CONSOLIDAZIONE,p.GRIGIO,p.ID_AMM,p.ID_RF,
      p.ID_STATO,p.ID_TEMPLATE,p.INTERNO,p.PARTENZA,p.TIPO,p.ID_AOO,
      convert(varchar(10), p.DTA_DATA_CREAZIONE_DA, 103) as DTA_DATA_CREAZIONE_DA,
      convert(varchar(10), p.DTA_DATA_CREAZIONE_A, 103) as DTA_DATA_CREAZIONE_A,
      convert(varchar(10), p.DTA_DATA_PROTO_DA, 103) as DTA_DATA_PROTO_DA,
      convert(varchar(10), p.DTA_DATA_PROTO_A, 103) as DTA_DATA_PROTO_A,

      --to_char(p.DTA_DATA_CREAZIONE_DA,'dd/mm/yyyy') as DTA_DATA_CREAZIONE_DA,
      --to_char(p.DTA_DATA_CREAZIONE_A,'dd/mm/yyyy') as DTA_DATA_CREAZIONE_A,
      --to_char(p.DTA_DATA_PROTO_DA,'dd/mm/yyyy') as DTA_DATA_PROTO_DA,
      --to_char(p.DTA_DATA_PROTO_A,'dd/mm/yyyy') as DTA_DATA_PROTO_A,
      p.PERIODO_TIPO,p.P_G_GIORNI,p.P_G_ORA_HH,p.P_G_ORA_MM,p.P_M_GIORNI,
      p.P_M_ORA_HH,p.P_M_ORA_MM,p.P_S_LUNEDI,p.P_S_MARTEDI,p.P_S_MERCOLEDI,
      p.P_S_GIOVEDI,p.P_S_VENERDI,p.P_S_SABATO,p.P_S_DOMENICA,p.P_S_ORA_HH,p.P_S_ORA_MM,
      p.ID_RUOLO,p.ATTIVA,p.MESI_AVVISO,p.ID_PEOPLE, a.VAR_COD_RUBRICA, b.ID_GRUPPO,
      p.TIPO_CLASSIFICAZIONE, p.TIPO_DATA_CREAZIONE,p.TIPO_DATA_PROTO,p.ID_UO_CREATORE,
      p.UO_SOTTOPOSTE,p.STATO_INVIATA,p.STATO_CONVERSIONE,p.INCLUDI_SOTTONODI,p.SOLO_DIGITALI,p.SOLO_FIRMATI,
      p.P_A_GIORNI,p.P_A_MESE,p.P_A_ORE,p.P_A_MINUTI,p.TIPO_CONSERVAZIONE,
      p.MESI_AVVISO_LEGGIBILITA
      from POLICY_CONSERVAZIONE p
      LEFT JOIN DPA_CORR_GLOBALI A ON A.ID_PEOPLE = P.ID_PEOPLE
      LEFT JOIN DPA_CORR_GLOBALI B ON b.SYSTEM_ID = P.ID_RUOLO
      where p.SYSTEM_ID=@idPolicy@
    </value>
  </query>
  <query>
    <name>S_FORMATI_POLICY_CONSERVAZIONE_BY_ID</name>
    <value>
      select p.system_id as id_policy,t.ID_TYPE, d.FILE_EXTENSION from policy_conservazione p, dpa_ass_policy_type t, DPA_FORMATI_DOCUMENTO d  where p.system_id = t.ID_POLICY and t.ID_TYPE=d.SYSTEM_ID and p.system_id=@idPolicy@ and d.FILE_TYPE_PRESERVATION = 1
    </value>
  </query>
  <query>
    <name>U_PERIODO_CONSERVAZIONE</name>
    <value>
      update policy_conservazione set  CONSOLIDAZIONE='@consolidazione@', PERIODO_TIPO='@periodo@', P_G_GIORNI='@numGiorni@', P_G_ORA_HH='@oraGiorni@',P_G_ORA_MM='@minutiGiorni@',P_S_LUNEDI='@lunedi@',P_S_MARTEDI='@martedi@',
      P_S_MERCOLEDI='@mercoledi@', P_S_GIOVEDI='@giovedi@', P_S_VENERDI='@venerdi@', P_S_SABATO='@sabato@', P_S_DOMENICA='@domenica@',P_S_ORA_HH='@oreSettimana@',P_S_ORA_MM='@minutiSettimana@', P_M_GIORNI = '@mesiGiorni@', P_M_ORA_HH='@oreMese@', P_M_ORA_MM='@minutiMese@',
      ID_RUOLO = @idRuolo@, MESI_AVVISO='@numMesi@',ATTIVA='@attiva@', ID_PEOPLE=@idPeople@ , STATO_INVIATA = '@statoInv@', P_A_GIORNI='@annoGiorni@', P_A_MESE='@annoMese@', P_A_ORE='@annoOre@',P_A_MINUTI='@annoMinuti@',TIPO_CONSERVAZIONE='@tipoConservazione@', MESI_AVVISO_LEGGIBILITA='@numMesiLegg@' where system_id = @idPolicy@
    </value>
  </query>
  <query>
    <name>S_J_PROJECT_FASCICOLOByID_NO_SECURITY</name>
    <value>
      SELECT DISTINCT
      A.SYSTEM_ID, A.DESCRIPTION, A.CHA_TIPO_PROJ,
      A.VAR_CODICE, A.ID_AMM,A.NUM_LIVELLO, A.CHA_TIPO_FASCICOLO,
      A.ID_FASCICOLO, A.ID_PARENT, A.VAR_COD_ULTIMO,
      A.VAR_NOTE,@param1@ AS DTA_APERTURA,
      @param2@ AS DTA_CHIUSURA,A.CHA_STATO, A.ID_TIPO_PROC, A.ID_REGISTRO,
      A.ID_UO_LF, A.DTA_UO_LF,
      A.DTA_CREAZIONE, A.CARTACEO,A.CHA_PRIVATO,ID_TITOLARIO, A.NUM_FASCICOLO, CHA_PUBBLICO,
      A.AUTHOR, A.ID_RUOLO_CREATORE, A.ID_UO_CREATORE, A.CHA_CONTROLLATO, A.CHA_COD_T_A, A.COD_EXT_APP,
      convert(nvarchar (10), a.dta_scadenza, 103) AS DTA_SCADENZA
      FROM PROJECT A
      WHERE A.SYSTEM_ID=@param3@
    </value>
  </query>
  <query>
    <name>U_POLICY_CONSERVAZIONE</name>
    <value>
      update policy_conservazione set  NOME='@nome@', CLASSIFICA=@classificazione@, ID_TEMPLATE=@template@, ID_STATO=@diagramma@,ID_RF=@rf@,ARRIVO='@arrivo@',PARTENZA='@partenza@',
      INTERNO='@interno@', GRIGIO='@grigio@', DTA_DATA_CREAZIONE_DA=@dataCDa@, DTA_DATA_CREAZIONE_A=@dataCA@, DTA_DATA_PROTO_DA=@dataPDa@,DTA_DATA_PROTO_A=@dataPA@,ID_AOO=@aoo@,TIPO_CLASSIFICAZIONE='@tipoClass@',
      ID_UO_CREATORE = @idUoCreatore@, TIPO_DATA_CREAZIONE = '@tipoDataC@', TIPO_DATA_PROTO = '@tipoDataP@', UO_SOTTOPOSTE= '@uoSott@', INCLUDI_SOTTONODI ='@sottoNodi@', SOLO_DIGITALI='@digitali@', SOLO_FIRMATI='@firmati@' where system_id = @idPolicy@
    </value>
  </query>
  <query>
    <name>U_UPDATE_STATO_SUPPORTI_RIMOVIBILI</name>
    <value>
      UPDATE DPA_SUPPORTO
      SET CHA_STATO = '@stato@'
      WHERE ID_CONSERVAZIONE = @idConservazione@
      AND ID_TIPO_SUPPORTO = (SELECT SYSTEM_ID FROM DPA_TIPO_SUPPORTO WHERE VAR_TIPO = 'RIMOVIBILE')
    </value>
  </query>
  <query>
    <name>S_GET_TIPO_ISTANZA_CONSERVAZIONE</name>
    <value>
      SELECT AC.VAR_TIPO_CONS
      FROM DPA_AREA_CONSERVAZIONE AC
      WHERE SYSTEM_ID = @systemId@
    </value>
  </query>
  <query>
    <name>S_GET_MARCA_TEMPORALE_ISTANZA_CONSERVAZIONE</name>
    <value>
      SELECT VAR_MARCA_TEMPORALE
      FROM DPA_AREA_CONSERVAZIONE
      WHERE SYSTEM_ID = @systemId@
    </value>
  </query>
  <query>
    <name>U_ISTANZA_NO_PREFERRED</name>
    <value>
      UPDATE dpa_area_conservazione
      SET IS_PREFERRED = null where ID_PEOPLE = @idPeople@ and ID_RUOLO_IN_UO = @idRuolo@
    </value>
  </query>
  <query>
    <name>U_ISTANZA_PREFERRED</name>
    <value>
      UPDATE dpa_area_conservazione
      SET IS_PREFERRED = '1' where ID_PEOPLE = @idPeople@ and ID_RUOLO_IN_UO = @idRuolo@ and system_id = @idIstanza@
    </value>
  </query>
  <query>
    <name>S_PEOPLE_CENTRO_SERVIZI</name>
    <value>
      SELECT @param1@
      FROM PEOPLE
      WHERE @param2@
      --AND ABILITATO_CENTRO_SERVIZI ='1'
      AND (ABILITATO_CENTRO_SERVIZI ='1' OR ABILITATO_ESIBIZIONE = '1')
    </value>
  </query>
  <query>
    <name>S_PEOPLE_DISABLED_CENTRO_SERVIZI</name>
    <value>
      SELECT
      ABILITATO_CENTRO_SERVIZI
      FROM PEOPLE
      WHERE
      user_Id = '@userId@'
    </value>
  </query>
  <query>
    <name>S_GET_LAST_EXECUTION_POLICY_BY_IDPOLICY</name>
    <value>
      select  top 1 *
      from
      (select p.SYSTEM_ID,p.ID_POLICY,p.ID_ISTANZA,p.ID_PRIMO_OBJ,p.ID_ULTIMO_OBJ,p.N_OBJ_CONSERVATI,

      --CONVERT(varchar ,p.START_EXECUTE_DATE,109) as START_EXECUTE_DATE,
      --CONVERT(varchar ,p.END_EXECUTE_DATE,109) as END_EXECUTE_DATE,
      CONVERT(datetime ,p.START_EXECUTE_DATE,103) as START_EXECUTE_DATE,
      CONVERT(datetime ,p.END_EXECUTE_DATE,103) as END_EXECUTE_DATE,

      p.ID_AMM from dpa_policy_esecuzione p where p.ID_POLICY=@idPolicy@
      ) t
      ORDER BY system_id DESC
    </value>
  </query>
  <query>
    <name>S_GET_COUNT_NOTIFICHE_INTEGRITA_SUPPORTI_CONSERVAZIONE</name>
    <value>
      select  count(*)
      from    dpa_supporto s
      inner join dpa_area_conservazione a on s.id_conservazione = a.system_id
      inner join dpa_tipo_supporto ts on s.id_tipo_supporto = ts.system_id
      inner join dpa_amministra amm on a.id_amm = amm.system_id
      where   ts.var_tipo = 'RIMOVIBILE'
      and s.cha_stato = 'V'
      and amm.var_codice_amm = '@codiceAmministrazione@'
      and s.data_prox_verifica &lt;= @dataConfronto@
    </value>
  </query>
  <query>
    <name>S_GET_NOTIFICHE_INTEGRITA_SUPPORTI_CONSERVAZIONE</name>
    <value>
      select  s.system_id as IdSupporto,
      s.id_conservazione as IdIstanza,
      s.data_prox_verifica as DataVerificaSupporto
      from    dpa_supporto s
      inner join dpa_area_conservazione a on s.id_conservazione = a.system_id
      inner join dpa_tipo_supporto ts on s.id_tipo_supporto = ts.system_id
      where   ts.var_tipo = 'RIMOVIBILE'
      and s.cha_stato = 'V'
      and a.ID_AMM = @idAmm@
      and s.data_prox_verifica &lt;= @dataConfronto@
    </value>
  </query>
  <query>
    <name>U_UPDATE_STATO_ISTANZA_CONSERVAZIONE</name>
    <value>
      UPDATE DPA_AREA_CONSERVAZIONE
      SET CHA_STATO = '@stato@',
      DATA_CONSERVAZIONE = @dataConservazione@
      WHERE SYSTEM_ID = @systemId@
    </value>
  </query>
  <query>
    <name>S_GET_COUNT_SUPPORTI_RIMOVIBILI_REGISTRATI</name>
    <value>
      SELECT COUNT(*)
      FROM DPA_SUPPORTO
      WHERE ID_CONSERVAZIONE = @idConservazione@
      AND ID_TIPO_SUPPORTO = (SELECT SYSTEM_ID FROM DPA_TIPO_SUPPORTO WHERE VAR_TIPO = 'RIMOVIBILE')
      AND CHA_STATO = 'R'
    </value>
  </query>
  <!--Lnr 30/01/2013 aggiunta query per recuperare l'id del supporto di una istanza di conservazione-->
  <query>
    <name>S_GET_ID_SUPPORTO_BY_ISTANZA</name>
    <value>
      SELECT DPA_SUPPORTO.SYSTEM_ID AS IDSUPPORTO
      FROM DPA_AREA_CONSERVAZIONE INNER JOIN
      DPA_SUPPORTO ON DPA_AREA_CONSERVAZIONE.SYSTEM_ID = DPA_SUPPORTO.ID_CONSERVAZIONE
      WHERE (DPA_AREA_CONSERVAZIONE.SYSTEM_ID = @idConservazione@) AND (DPA_SUPPORTO.ID_TIPO_SUPPORTO = 2)
    </value>
  </query>

  <!--Lnr 17/01/2013 aggiunta query-->
  <query>
    <name>S_GET_COUNT_SUPPORTI_RIMOVIBILI</name>
    <value>
      SELECT COUNT(*)
      FROM DPA_SUPPORTO
      WHERE ID_CONSERVAZIONE = @idConservazione@
      AND ID_TIPO_SUPPORTO = (SELECT SYSTEM_ID FROM DPA_TIPO_SUPPORTO WHERE VAR_TIPO = 'RIMOVIBILE')
    </value>
  </query>
  <query>
    <name>S_GET_DOCUMENT_FASC_WITH_POLICY</name>
    <value>
      SELECT /*+INDEX(a)*/ a.system_id, a.docnumber from profile a WITH(NOLOCK),
      dpa_corr_globali d @from@ where docsadm.getchaimg (a.docnumber)!='0'
      AND d.system_id = a.ID_UO_CREATORE and d.ID_AMM = @idAmm@
      AND a.system_id not in (select n.ID_PROFILE from DPA_DETT_POLICY_ESECUZIONE n
      where n.id_profile = a.system_id AND n.id_project IN (SELECT t.id_fascicolo FROM project t WHERE t.system_id = @idProject@)  and n.ID_POLICY=@idPolicy@ AND n.ESITO =1) @filtri@ order by a.system_id asc
    </value>
  </query>
  <query>
    <name>S_CONSERVAZIONE_GET_COUNT_NOTIFICHE_VERIFICHE_SUPPORTI</name>
    <value>
      select  count(*)
      from    dpa_supporto s
      inner join dpa_area_conservazione a on s.id_conservazione = a.system_id
      inner join dpa_tipo_supporto ts on s.id_tipo_supporto = ts.system_id
      inner join dpa_amministra amm on a.id_amm = amm.system_id
      where   s.cha_stato = 'V'
      and amm.var_codice_amm = '@codiceAmministrazione@'
      and s.data_prox_verifica &lt;= @dataConfronto@
    </value>
  </query>
  <query>
    <name>S_CONSERVAZIONE_GET_NOTIFICHE_VERIFICHE_SUPPORTI</name>
    <value>
      select  s.system_id as IdSupporto,
      s.id_conservazione as IdIstanza,
      s.data_prox_verifica as DataVerificaSupporto,
      ts.var_tipo as TipoSupporto
      from    dpa_supporto s
      inner join dpa_area_conservazione a on s.id_conservazione = a.system_id
      inner join dpa_tipo_supporto ts on s.id_tipo_supporto = ts.system_id
      where   s.cha_stato = 'V'
      and a.ID_AMM = @idAmm@
      and s.data_prox_verifica &lt;= @dataConfronto@
    </value>
  </query>
  <query>
    <name>S_CONSERVAZIONE_GET_COUNT_NOTIFICHE_VERIFICHE_SUPPORTI_REMOTI</name>
    <value>
      select  count(*)
      from    dpa_supporto s
      inner join dpa_area_conservazione a on s.id_conservazione = a.system_id
      inner join dpa_tipo_supporto ts on s.id_tipo_supporto = ts.system_id
      inner join dpa_amministra amm on a.id_amm = amm.system_id
      where   ts.var_tipo = 'REMOTO'
      and s.cha_stato = 'V'
      and amm.var_codice_amm = '@codiceAmministrazione@'
      and s.data_prox_verifica &lt;= @dataConfronto@
    </value>
  </query>
  <query>
    <name>S_CONSERVAZIONE_GET_NOTIFICHE_VERIFICHE_SUPPORTI_REMOTI</name>
    <value>
      select  s.system_id as IdSupporto,
      s.id_conservazione as IdIstanza,
      s.data_prox_verifica as DataVerificaSupporto,
      ts.var_tipo as TipoSupporto
      from    dpa_supporto s
      inner join dpa_area_conservazione a on s.id_conservazione = a.system_id
      inner join dpa_tipo_supporto ts on s.id_tipo_supporto = ts.system_id
      where   ts.var_tipo = 'REMOTO'
      and s.cha_stato = 'V'
      and a.ID_AMM = @idAmm@
      and s.data_prox_verifica &lt;= @dataConfronto@
    </value>
  </query>
  <query>
    <name>U_UPDATE_STATO_ISTANZA_CONSERVAZIONE</name>
    <value>
      UPDATE DPA_AREA_CONSERVAZIONE
      SET CHA_STATO = '@stato@',
      DATA_CONSERVAZIONE = @dataConservazione@
      WHERE SYSTEM_ID = @systemId@
    </value>
  </query>
  <query>
    <name>S_GET_COUNT_SUPPORTI_RIMOVIBILI_REGISTRATI</name>
    <value>
      SELECT COUNT(*)
      FROM DPA_SUPPORTO
      WHERE ID_CONSERVAZIONE = @idConservazione@
      AND ID_TIPO_SUPPORTO = (SELECT SYSTEM_ID FROM DPA_TIPO_SUPPORTO WHERE VAR_TIPO = 'RIMOVIBILE')
      AND CHA_STATO = 'R'
    </value>
  </query>
  <query>
    <name>I_DPA_ASS_POLICY_PROFILAZIONE</name>
    <value>
      INSERT INTO DPA_ASS_POLICY_PROFILAZIONE
      (
      ID_POLICY,
      ID_TEMPLATE,
      ID_OBJ_CUSTOM,
      VALORE
      )
      values
      (
      @id_policy@,
      @id_template@,
      @obj_id@,
      '@obj_value@'
      )
    </value>
  </query>
  <query>
    <name>D_DELETE_DPA_ASS_POLICY_PROFILAZIONE</name>
    <value>
      DELETE FROM DPA_ASS_POLICY_PROFILAZIONE
      WHERE ID_POLICY=@idPolicy@
    </value>
  </query>
  <query>
    <name>S_TEMPLATES_POLICY_CONSERVAZIONE_BY_ID</name>
    <value>
      select p.id_template,p.valore,p.ID_OBJ_CUSTOM from DPA_ASS_POLICY_PROFILAZIONE p where p.ID_POLICY=@idPolicy@
    </value>
  </query>
  <query>
    <name>PD_GET_DPA_TEMPLATE_WITH_DIAGRAMMA</name>
    <value>
      SELECT distinct  d.system_id, d.var_desc_atto, di.ID_DIAGRAMMA
      FROM dpa_tipo_atto d @doc@
      WHERE id_amm = @idAmministrazione@ AND abilitato_si_no = 1
      ORDER BY d.var_desc_atto
    </value>
  </query>
  <query>
    <name>PD_GET_DPA_TEMPLATE_FASC_WITH_DIAGRAMMA</name>
    <value>
      SELECT distinct  d.system_id, d.var_desc_fasc, di.ID_DIAGRAMMA
      FROM dpa_tipo_fasc d @doc@
      WHERE id_amm = @idAmministrazione@ AND abilitato_si_no = 1
      ORDER BY d.var_desc_fasc
    </value>
  </query>
  <query>
    <name>S_GET_PROJECT_WITH_POLICY</name>
    <value>
      SELECT /*+INDEX(a)*/ b.system_id,b.id_fascicolo,
      b.description from project b where @filtri@ order by b.system_id asc
    </value>
  </query>
  <query>
    <name>S_VERIFY_POLICY_FASC</name>
    <value>
      SELECT f.system_id FROM PROFILE f WITH(NOLOCK)
      WHERE DOCSADM.getchaimg (f.docnumber) != '0'
      AND f.system_id IN (SELECT b.LINK FROM project_components b WHERE b.LINK = @idProfile@
      AND b.TYPE = 'D' AND @filtri@)) AND f.system_id =  @idProfile@ @altro@
    </value>
  </query>
  <query>
    <name>D_ITEMS_ISTANZA_CON_POLICY_MANUALE</name>
    <value>
      DELETE FROM dpa_items_conservazione where id_conservazione = @idIstanza@
      and id_profile = @idProfile@
    </value>
  </query>
  <query>
    <name>S_FORMATI_POLICY_CONSERVAZIONE</name>
    <value>
      select p.system_id as id_policy,t.ID_TYPE, d.FILE_EXTENSION
      from policy_conservazione p, dpa_ass_policy_type t, DPA_FORMATI_DOCUMENTO d
      where p.id_amm = @idAmm@ AND p.tipo = '@tipo@' and p.system_id = t.ID_POLICY
      and t.ID_TYPE=d.SYSTEM_ID and d.FILE_TYPE_PRESERVATION = 1
    </value>
  </query>
  <query>
    <name>S_GET_FASCICOLI_DA_CODICE_NOSEC</name>
    <value>
      select p.system_id, p.var_codice, @db_user@.getdesctitolario (p.id_titolario) AS cod_titolario,
      p.description, p.ID_TITOLARIO from project p
      where var_codice = '@codFasc@' and CHA_TIPO_PROJ != 'T' and p.ID_AMM=@idAmm@ @altro@ order by p.VAR_COD_LIV1 asc
    </value>
  </query>
  <query>
    <name>S_J_PROJECT_FOLDERByID_NOSEC</name>
    <value>
      SELECT DISTINCT A.*
      FROM PROJECT A
      WHERE A.SYSTEM_ID=@param1@
    </value>
  </query>
  <query>
    <name>S_VERIFY_POLICY_STAMPE</name>
    <value>
      SELECT f.system_id FROM PROFILE f WITH(NOLOCK) WHERE @dbuser@.getchaimg (f.docnumber) != '0'
      AND f.system_id IN (SELECT a.system_id FROM PROFILE a WITH(NOLOCK),@tableFrom@ r
      WHERE a.docnumber = r.docnumber AND a.cha_tipo_proto ='@tipoStampa@' @filtri@)
      AND f.system_id = @idProfile@
    </value>
  </query>
  <query>
    <name>S_GET_STAMPE_WITH_POLICY</name>
    <value>
      SELECT /*+INDEX(a)*/ distinct(a.system_id),
      a.docnumber from profile a WITH(NOLOCK),
      @from@ where @dbuser@.getchaimg (a.docnumber)!='0'
      and @dbuser@.getIdAmm(a.author) = @idAmm@ AND a.docnumber = r.docnumber AND a.cha_tipo_proto ='@tipoStampa@'
      AND a.system_id not in (select n.ID_PROFILE from DPA_DETT_POLICY_ESECUZIONE n
      where n.id_profile = a.system_id and n.ID_POLICY=@idPolicy@ AND n.ESITO =1) @filtri@ order by a.system_id asc
    </value>
  </query>
  <query>
    <name>S_GET_DOCNUMBER_BY_VALORE_CAMPO_PROFILATO</name>
    <value>
      select  at.Doc_Number
      from	profile p
      inner join DPA_ASSOCIAZIONE_TEMPLATES at on p.docnumber = at.doc_number
      inner join DPA_TIPO_ATTO ta on at.ID_TEMPLATE = ta.SYSTEM_ID
      inner join DPA_OGGETTI_CUSTOM oc on at.ID_OGGETTO = oc.SYSTEM_ID
      where p.CHA_IN_CESTINO is null
      AND ta.VAR_DESC_ATTO = '@descrizioneTipoAtto@'
      @filtroCampiProfilati@
      order by at.Doc_Number desc
    </value>
  </query>
  <query>
    <name>S_GET_DOCNUMBER_BY_VALORE_CAMPO_PROFILATO_E_STATO</name>
    <value>
      select  at.Doc_Number
      from	PROFILE P
      inner join DPA_ASSOCIAZIONE_TEMPLATES at on p.docnumber = at.doc_number
      inner join DPA_TIPO_ATTO ta on at.ID_TEMPLATE = ta.SYSTEM_ID
      inner join DPA_OGGETTI_CUSTOM oc on at.ID_OGGETTO = oc.SYSTEM_ID
      inner join DPA_DIAGRAMMI d on d.doc_number = at.doc_number
      inner join DPA_STATI s on d.Id_stato = s.SYSTEM_ID
      where p.CHA_IN_CESTINO is null
      AND ta.VAR_DESC_ATTO = '@descrizioneTipoAtto@'
      AND s.var_descrizione = '@descrizioneStato@'
      @filtroCampiProfilati@
      order by at.Doc_Number desc
    </value>
  </query>
  <query>
    <name>S_RF_CODE_DESCRIPTION_AND_INFO</name>
    <value>
      SELECT var_cod_rubrica,
      var_desc_corr,
      var_indirizzo,
      var_citta,
      var_cap,
      var_nazione,
      var_provincia,
      var_telefono,
      var_telefono2,
      var_fax,
      var_note,
      var_cod_fisc,
      var_cod_pi,
      corrGlob.id_amm,
      @dbUser@GetCodReg(registri.id_aoo_collegata) as AOO
      FROM dpa_el_registri registri
      Inner Join dpa_corr_globali corrGlob
      On registri.system_id = corrGlob.id_rf
      LEFT OUTER JOIN dpa_dett_globali dettGlob
      ON corrglob.system_id = dettglob.id_corr_globali
      WHERE corrGlob.id_rf  = @idRf@ and corrGlob.dta_fine is null
    </value>
  </query>
  <query>
    <name>S_GET_RF_CORR_GLOB_ID_FROM_ID_RF</name>
    <value>
      Select system_id
      From dpa_corr_globali
      Where dta_fine is null And id_rf = @idRf@
    </value>
  </query>
  <query>
    <name>S_GET_UTENTI_SUPERIORI</name>
    <value>
      WITH Gerarchia (Id, UserID, Matricola, Cognome, Nome, NomeCompleto, EMail, IdAmministrazione,
      IdRuolo, CodiceRuolo, DescrizioneRuolo, RuoloResponsabile, RuoloSegretario, RuoloRiferimento,
      IdUO, CodiceUO, DescrizioneUO, ClassificaUO, IdParentUO,
      CodiceTipoRuolo, DescrizioneTipoRuolo, LivelloTipoRuolo, Gerarchia)
      AS
      (
      select p.SYSTEM_ID as Id,
      p.USER_ID as UserID,
      p.MATRICOLA as Matricola,
      p.VAR_COGNOME as Cognome,
      p.VAR_NOME AS Nome,
      p.FULL_NAME as NomeCompleto,
      p.EMAIL_ADDRESS AS EMail,
      p.ID_AMM as IdAmministrazione,
      cg.ID_GRUPPO as IdRuolo,
      cg.VAR_CODICE as CodiceRuolo,
      cg.VAR_DESC_CORR as DescrizioneRuolo,
      cg.CHA_RESPONSABILE as RuoloResponsabile,
      cg.CHA_SEGRETARIO as RuoloSegretario,
      cg.CHA_RIFERIMENTO AS RuoloRiferimento,
      cgUO.SYSTEM_ID as IdUO,
      cgUO.VAR_CODICE as CodiceUO,
      cgUO.VAR_DESC_CORR as DescrizioneUO,
      cgUO.CLASSIFICA_UO as ClassificaUO,
      cgUO.ID_PARENT as IdParentUO,
      tr.VAR_CODICE as CodiceTipoRuolo,
      tr.VAR_DESC_RUOLO as DescrizioneTipoRuolo,
      tr.num_livello as LivelloTipoRuolo,
      0 as Gerarchia
      from PEOPLE p
      inner join peoplegroups pg on p.SYSTEM_ID = pg.PEOPLE_SYSTEM_ID
      inner join DPA_CORR_GLOBALI cg on pg.groups_system_id = cg.ID_GRUPPO
      inner join DPA_TIPO_RUOLO tr on cg.ID_TIPO_RUOLO = tr.SYSTEM_ID
      inner join DPA_CORR_GLOBALI cgUO on cg.ID_UO = cgUO.SYSTEM_ID
      where tr.NUM_LIVELLO &lt;= @livSuperiori@ and
      cg.ID_UO =
      (
      select
      (CASE COUNT(tr.NUM_LIVELLO)
      WHEN 0 THEN (select cgParent.ID_PARENT from DPA_CORR_GLOBALI cgParent where cgParent.SYSTEM_ID = @myUo@)
      ELSE @myUo@
      END ) as id
      from DPA_CORR_GLOBALI cg
      inner join DPA_TIPO_RUOLO tr on cg.ID_TIPO_RUOLO = tr.SYSTEM_ID
      where ID_UO = @myUo@ and CHA_TIPO_URP = 'R' and tr.NUM_LIVELLO  &lt; @myLiv@
      )
      and cg.ID_GRUPPO != @myRole@
      and pg.DTA_FINE is null

      UNION ALL

      select p.SYSTEM_ID as Id,
      p.USER_ID as UserID,
      p.MATRICOLA as Matricola,
      p.VAR_COGNOME as Cognome,
      p.VAR_NOME AS Nome,
      p.FULL_NAME as NomeCompleto,
      p.EMAIL_ADDRESS AS EMail,
      p.ID_AMM as IdAmministrazione,
      cg.ID_GRUPPO as IdRuolo,
      cg.VAR_CODICE as CodiceRuolo,
      cg.VAR_DESC_CORR as DescrizioneRuolo,
      cg.CHA_RESPONSABILE as RuoloResponsabile,
      cg.CHA_SEGRETARIO as RuoloSegretario,
      cg.CHA_RIFERIMENTO AS RuoloRiferimento,
      cgUO.SYSTEM_ID as IdUO,
      cgUO.VAR_CODICE as CodiceUO,
      cgUO.VAR_DESC_CORR as DescrizioneUO,
      cgUO.CLASSIFICA_UO as ClassificaUO,
      cgUO.ID_PARENT as IdParentUO,
      tr.VAR_CODICE as CodiceTipoRuolo,
      tr.VAR_DESC_RUOLO as DescrizioneTipoRuolo,
      tr.num_livello as LivelloTipoRuolo,
      Gerarchia + 1 as Gerarchia
      from PEOPLE p
      inner join peoplegroups pg on p.SYSTEM_ID = pg.PEOPLE_SYSTEM_ID
      inner join DPA_CORR_GLOBALI cg on pg.groups_system_id = cg.ID_GRUPPO
      inner join DPA_TIPO_RUOLO tr on cg.ID_TIPO_RUOLO = tr.SYSTEM_ID
      inner join DPA_CORR_GLOBALI cgUO on cg.ID_UO = cgUO.SYSTEM_ID
      inner join Gerarchia g on g.IdParentUO = cguo.SYSTEM_ID
      where tr.NUM_LIVELLO &lt;	@livSuperiori@ and
      pg.DTA_FINE is null
      )
      select distinct *
      from Gerarchia
      order by Gerarchia asc, LivelloTipoRuolo desc
    </value>
  </query>
  <query>
    <name>S_GET_RUOLI_SUPERIORI</name>
    <value>
      WITH Gerarchia (IdRuolo, CodiceRuolo, DescrizioneRuolo, RuoloResponsabile, RuoloSegretario, RuoloRiferimento,
      IdUO, CodiceUO, DescrizioneUO, ClassificaUO, IdParentUO,
      LivelloTipoRuolo, Gerarchia)
      AS
      (
      select 	cg.ID_GRUPPO as IdRuolo,
      cg.VAR_CODICE as CodiceRuolo,
      cg.VAR_DESC_CORR as DescrizioneRuolo,
      cg.CHA_RESPONSABILE as RuoloResponsabile,
      cg.CHA_SEGRETARIO as RuoloSegretario,
      cg.CHA_RIFERIMENTO AS RuoloRiferimento,
      cgUO.SYSTEM_ID as IdUO,
      cgUO.VAR_CODICE as CodiceUO,
      cgUO.VAR_DESC_CORR as DescrizioneUO,
      cgUO.CLASSIFICA_UO as ClassificaUO,
      cgUO.ID_PARENT as IdParentUO,
      tr.num_livello as LivelloTipoRuolo,
      0 as Gerarchia
      from DPA_CORR_GLOBALI cg
      inner join peoplegroups pg on cg.ID_GRUPPO = pg.GROUPS_SYSTEM_ID
      inner join DPA_TIPO_RUOLO tr on cg.ID_TIPO_RUOLO = tr.SYSTEM_ID
      inner join DPA_CORR_GLOBALI cgUO on cg.ID_UO = cgUO.SYSTEM_ID
      where tr.NUM_LIVELLO &lt; @livello@
      and cg.ID_UO =
      (
      select
      (CASE COUNT(tr.NUM_LIVELLO)
      WHEN 0 THEN (select cgParent.ID_PARENT from DPA_CORR_GLOBALI cgParent where cgParent.SYSTEM_ID = @idUO@)
      ELSE @idUO@
      END ) as id
      from DPA_CORR_GLOBALI cg
      inner join DPA_TIPO_RUOLO tr on cg.ID_TIPO_RUOLO = tr.SYSTEM_ID
      where ID_UO = @idUO@ and CHA_TIPO_URP = 'R' and tr.NUM_LIVELLO  &lt; @livello@
      )
      and pg.DTA_FINE is null

      UNION ALL

      select  cg.ID_GRUPPO as IdRuolo,
      cg.VAR_CODICE as CodiceRuolo,
      cg.VAR_DESC_CORR as DescrizioneRuolo,
      cg.CHA_RESPONSABILE as RuoloResponsabile,
      cg.CHA_SEGRETARIO as RuoloSegretario,
      cg.CHA_RIFERIMENTO AS RuoloRiferimento,
      cgUO.SYSTEM_ID as IdUO,
      cgUO.VAR_CODICE as CodiceUO,
      cgUO.VAR_DESC_CORR as DescrizioneUO,
      cgUO.CLASSIFICA_UO as ClassificaUO,
      cgUO.ID_PARENT as IdParentUO,
      tr.num_livello as LivelloTipoRuolo,
      Gerarchia + 1 as Gerarchia
      from DPA_CORR_GLOBALI cg
      inner join peoplegroups pg on cg.ID_GRUPPO = pg.GROUPS_SYSTEM_ID
      inner join DPA_TIPO_RUOLO tr on cg.ID_TIPO_RUOLO = tr.SYSTEM_ID
      inner join DPA_CORR_GLOBALI cgUO on cg.ID_UO = cgUO.SYSTEM_ID
      inner join Gerarchia g on g.IdParentUO = cguo.SYSTEM_ID
      where tr.NUM_LIVELLO &lt;= @livello@
      and pg.DTA_FINE is null
      )
      select distinct *
      from Gerarchia
      order by Gerarchia asc,  LivelloTipoRuolo desc
    </value>
  </query>
  <query>
    <name>S_GET_DOCNUMBER_BY_VALORE_CAMPO_PROFILATO_E_STATO_DIVERSO_DA</name>
    <value>
      select  at.Doc_Number
      from	PROFILE p
      inner join DPA_ASSOCIAZIONE_TEMPLATES at on p.docnumber = at.doc_number
      inner join DPA_TIPO_ATTO ta on at.ID_TEMPLATE = ta.SYSTEM_ID
      inner join DPA_OGGETTI_CUSTOM oc on at.ID_OGGETTO = oc.SYSTEM_ID
      inner join DPA_DIAGRAMMI d on d.doc_number = at.doc_number
      inner join DPA_STATI s on d.Id_stato = s.SYSTEM_ID
      where p.CHA_IN_CESTINO is null
      AND ta.VAR_DESC_ATTO = '@descrizioneTipoAtto@'
      AND s.var_descrizione != '@descrizioneStato@'
      @filtroCampiProfilati@
      order by at.Doc_Number desc
    </value>
  </query>
  <query>
    <name>AMM_S_GET_MAIL_REGISTRO</name>
    <value>
      SELECT
      ID_REGISTRO,
      VAR_EMAIL_REGISTRO,
      VAR_USER_MAIL,
      VAR_PWD_MAIL,
      VAR_SERVER_SMTP,
      CHA_SMTP_SSL,
      CHA_POP_SSL,
      NUM_PORTA_SMTP,
      CHA_SMTP_STA,
      VAR_SERVER_POP,
      NUM_PORTA_POP,
      VAR_USER_SMTP,
      VAR_PWD_SMTP,
      VAR_INBOX_IMAP,
      VAR_SERVER_IMAP,
      NUM_PORTA_IMAP,
      VAR_TIPO_CONNESSIONE,
      VAR_BOX_MAIL_ELABORATE,
      VAR_MAIL_NON_ELABORATE,
      CHA_IMAP_SSL,
      VAR_SOLO_MAIL_PEC,
      CHA_RICEVUTA_PEC,
      VAR_PRINCIPALE,
      VAR_NOTE,
      VAR_MAIL_RIC_PENDENTE
      FROM
      DPA_MAIL_REGISTRI
      WHERE
      ID_REGISTRO=@idRegistro@ AND
      VAR_EMAIL_REGISTRO IS NOT NULL
      ORDER BY	VAR_PRINCIPALE DESC
    </value>
  </query>
  <query>
    <name>AMM_S_SELECT_CASELLA_PRINC_REGISTRO</name>
    <value>
      SELECT VAR_EMAIL_REGISTRO
      FROM DPA_MAIL_REGISTRI
      WHERE ID_REGISTRO=@idRegistro@ AND VAR_PRINCIPALE = '1'
    </value>
  </query>
  <query>
    <name>AMM_U_UPDATE_MAIL_REGISTRO</name>
    <value>
      UPDATE  DPA_MAIL_REGISTRI
      SET
      VAR_USER_MAIL=@userMail@,
      VAR_PWD_MAIL=@pwdMail@,
      VAR_SERVER_SMTP=@serverSmtp@,
      CHA_SMTP_SSL=@smtpSsl@,
      CHA_POP_SSL=@popSsl@,
      NUM_PORTA_SMTP=@portaSmtp@,
      CHA_SMTP_STA=@smtpSta@,
      VAR_SERVER_POP=@serverPop@,
      NUM_PORTA_POP=@portaPop@,
      VAR_USER_SMTP=@userSmtp@,
      VAR_PWD_SMTP=@pwdSmtp@,
      VAR_INBOX_IMAP=@inboxImap@,
      VAR_SERVER_IMAP=@serverImap@,
      NUM_PORTA_IMAP=@portaImap@,
      VAR_TIPO_CONNESSIONE=@tipoConnessione@,
      VAR_BOX_MAIL_ELABORATE=@boxMailElaborate@,
      VAR_MAIL_NON_ELABORATE=@mailNonElaborate@,
      CHA_IMAP_SSL=@imapSsl@,
      VAR_SOLO_MAIL_PEC=@soloMailPec@,
      CHA_RICEVUTA_PEC=@ricevutaPec@,
      VAR_PRINCIPALE=@principale@,
      VAR_NOTE = @note@,
      VAR_MAIL_RIC_PENDENTE = @mailRicPendente@
      WHERE	ID_REGISTRO=@idRegistro@ AND VAR_EMAIL_REGISTRO = @emailRegistro@
    </value>
  </query>
  <query>
    <name>AMM_I_INSERT_MAIL_REGISTRO</name>
    <value>
      INSERT INTO DPA_MAIL_REGISTRI(@param1@)
      VALUES(@param2@)
    </value>
  </query>
  <query>
    <name>AMM_D_DELETE_MAIL_REGISTRO</name>
    <value>
      DELETE FROM DPA_MAIL_REGISTRI
      WHERE ID_REGISTRO = @idRegistro@ @condEmailRegistro@
    </value>
  </query>
  <query>
    <name>AMM_D_DELETE_MAIL_IN_DPA_EL_REGISTRI</name>
    <value>
      UPDATE DPA_EL_REGISTRI
      SET @param1@
      WHERE SYSTEM_ID = @systemId@
    </value>
  </query>
  <query>
    <name>AMM_I_RIGHT_RUOLO_MAIL_REGISTRO</name>
    <value>
      INSERT INTO DPA_VIS_MAIL_REGISTRI
      VALUES(@idRegistro@,@idRuoloInUO@,@emailRegistro@, @chaConsulta@, @chaNotifica@, @chaSpedisci@)
    </value>
  </query>
  <query>
    <name>AMM_D_RIGHT_RUOLO_MAIL_REGISTRO</name>
    <value>
      DELETE FROM DPA_VIS_MAIL_REGISTRI
      WHERE ID_RUOLO_In_UO = @idRuoloInUO@ @idRegistro@ @indirizzoEmail@
    </value>
  </query>
  <query>
    <name>AMM_U_RIGHT_RUOLO_MAIL_REGISTRO</name>
    <value>
      UPDATE DPA_VIS_MAIL_REGISTRI
      SET CHA_CONSULTA = @chaConsulta@, CHA_NOTIFICA = @chaNotifica@, CHA_SPEDISCI = @chaSpedisci@
      WHERE ID_REGISTRO = @idRegistro@ AND ID_RUOLO_IN_UO = @idRuolo@ AND VAR_EMAIL_REGISTRO = @emailRegistro@
    </value>
  </query>
  <query>
    <name>AMM_S_RIGHT_RUOLO_MAIL_REGISTRO</name>
    <value>
      SELECT b.VAR_EMAIL_REGISTRO as EMAIL_REGISTRO, b.CHA_CONSULTA as CONSULTA, b.CHA_NOTIFICA as NOTIFICA, b.CHA_SPEDISCI as SPEDISCI,c.VAR_NOTE
      FROM DPA_L_RUOLO_REG a, DPA_VIS_MAIL_REGISTRI b, DPA_MAIL_REGISTRI c
      WHERE
      a.ID_RUOLO_IN_UO = @idRuolo@ AND
      a.ID_REGISTRO = @idRegistro@ AND
      a.ID_REGISTRO=b.ID_REGISTRO AND
      a.ID_RUOLO_IN_UO = b.ID_RUOLO_IN_UO AND
      b.ID_REGISTRO = c.ID_REGISTRO AND
      @compare_mail@
    </value>
  </query>
  <query>
    <name>S_PARAM_MAIL_REGISTRO_SEND</name>
    <value>
      SELECT
      r.SYSTEM_ID,
      r.VAR_CODICE,
      r.ID_AMM,
      m.VAR_USER_MAIL,
      m.VAR_PWD_MAIL,
      m.VAR_SERVER_SMTP,
      m.NUM_PORTA_SMTP,
      m.VAR_EMAIL_REGISTRO,
      a.VAR_CODICE_AMM,
      m.VAR_USER_SMTP,
      a.CHA_STR_SEGNATURA,
      m.VAR_PWD_SMTP,
      m.CHA_POP_SSL,
      m.CHA_SMTP_SSL,
      m.CHA_SMTP_STA,
      m.VAR_SERVER_IMAP,
      m.NUM_PORTA_IMAP,
      m.VAR_TIPO_CONNESSIONE,
      m.VAR_INBOX_IMAP,
      m.VAR_BOX_MAIL_ELABORATE,
      m.VAR_MAIL_NON_ELABORATE,
      m.CHA_IMAP_SSL,
      m.VAR_SOLO_MAIL_PEC,
      m.NUM_PORTA_POP,
      m.VAR_SERVER_POP
      FROM DPA_MAIL_REGISTRI m WITH(NOLOCK), DPA_EL_REGISTRI r WITH(NOLOCK), DPA_AMMINISTRA a WITH(NOLOCK)
      WHERE m.ID_REGISTRO = @systemId@ AND
      m.ID_REGISTRO = r.SYSTEM_ID AND
      m.VAR_EMAIL_REGISTRO = @casella@ AND
      r.id_amm = a.system_id
    </value>
  </query>
  <query>
    <name>S_MAIL_REGISTRO_VAR_MAIL_RIC_PENDENTE</name>
    <value>
      SELECT
      VAR_SOLO_MAIL_PEC, VAR_MAIL_RIC_PENDENTE
      FROM DPA_MAIL_REGISTRI WITH(NOLOCK)
      WHERE ID_REGISTRO = @idregistro@ AND
      VAR_EMAIL_REGISTRO = @casella@
    </value>
  </query>
  <query>
    <name>S_DOC_PEC_PENDENTE</name>
    <value>
      SELECT
      Y.VAR_SOLO_MAIL_PEC, Y.VAR_MAIL_RIC_PENDENTE
      FROM DPA_ASS_DOC_MAIL_INTEROP X WITH(NOLOCK), DPA_MAIL_REGISTRI Y WITH(NOLOCK)
      WHERE X.ID_REGISTRO= Y.ID_REGISTRO
      AND X.VAR_EMAIL_REGISTRO=Y.VAR_EMAIL_REGISTRO
      AND X.ID_PROFILE = @idDocument@
    </value>
  </query>
  <query>
    <name>S_RUOLI_VIS_CONSULTA_PEC</name>
    <value>
      SELECT distinct
      A.SYSTEM_ID,
      A.VAR_CODICE,
      A.VAR_COD_RUBRICA,
      D.VAR_DESC_RUOLO,
      A.ID_GRUPPO,
      A.ID_UO,
      D.NUM_LIVELLO,
      E.VAR_DESC_CORR
      FROM DPA_CORR_GLOBALI A,
      DPA_TIPO_RUOLO D,
      DPA_CORR_GLOBALI E,
      DPA_L_RUOLO_REG F,
      DPA_VIS_MAIL_REGISTRI V
      WHERE A.CHA_TIPO_URP = 'R'
      AND F.ID_REGISTRO = @idRegistro@
      AND D.SYSTEM_ID = A.ID_TIPO_RUOLO
      AND E.SYSTEM_ID = A.ID_UO
      AND F.ID_RUOLO_IN_UO = A.SYSTEM_ID
      AND (A.CHA_DISABLED_TRASM != '1' OR A.CHA_DISABLED_TRASM IS NULL)
      AND F.ID_RUOLO_IN_UO = v.id_ruolo_in_uo
      AND f.id_registro = v.id_registro
      @email@
      AND V.cha_notifica = '1'
    </value>
  </query>
  <query>
    <name>S_ASS_DPA_ASS_DOC_MAIL_INTEROP</name>
    <value>
      SELECT ID_REGISTRO as registro, VAR_EMAIL_REGISTRO as mail
      FROM DPA_ASS_DOC_MAIL_INTEROP
      WHERE ID_PROFILE = @docNumber@
    </value>
  </query>
  <query>
    <name>I_ASS_DPA_ASS_DOC_MAIL_INTEROP</name>
    <value>
      INSERT INTO DPA_ASS_DOC_MAIL_INTEROP
      VALUES(@systemId@ @docNumber@, @idRegistro@, @mailAddress@ )
    </value>
  </query>
  <query>
    <name>U_ASS_DPA_ASS_DOC_MAIL_INTEROP</name>
    <value>
      UPDATE DPA_ASS_DOC_MAIL_INTEROP
      SET ID_REGISTRO = @idRegistro@, VAR_EMAIL_REGISTRO = @mailAddress@
      WHERE ID_PROFILE = @docNumber@
    </value>
  </query>
  <query>
    <name>D_ASS_DPA_ASS_DOC_MAIL_INTEROP</name>
    <value>
      DELETE FROM INTO DPA_ASS_DOC_MAIL_INTEROP
      WHERE ID_PROFILE = @docNumber@ AND VAR_EMAIL_REGISTRO = @mailAddress@
    </value>
  </query>
  <query>
    <name>S_DPA_MAIL_CORR_ESTERNO</name>
    <value>
      SELECT
      m.ID_CORR as SystemId,
      m.var_email as Email,
      var_principale as Principale,
      var_note as Note
      FROM DPA_CORR_GLOBALI a, DPA_MAIL_CORR_ESTERNI m
      WHERE a.SYSTEM_ID = m.ID_CORR AND
      m.ID_CORR = @idCorrispondente@
    </value>
  </query>
  <query>
    <name>D_DPA_MAIL_CORR_ESTERNO</name>
    <value>
      DELETE DPA_MAIL_CORR_ESTERNI
      WHERE id_corr =@idCorrispondente@
    </value>
  </query>
  <query>
    <name>I_DPA_MAIL_CORR_ESTERNO</name>
    <value>
      INSERT INTO DPA_MAIL_CORR_ESTERNI
      VALUES @value@
    </value>
  </query>
  <query>
    <name>S_DOCUMENT_TYPE_DESCRIPTION_FROM_CODE</name>
    <value>
      Select
      Description,
      Type_Id,
      System_id
      From DocumentTypes
      Where type_id = '@param1@'
    </value>
  </query>
  <query>
    <name>S_ROLE_WITH_FUNCTION</name>
    <value>
      Select id_ruolo_in_uo
      From dpa_l_ruolo_reg
      Where id_registro   = @registryId@
      And id_ruolo_in_uo In
      (
      Select id_ruolo_in_uo
      From dpa_tipo_f_ruolo
      Where id_tipo_funz In
      (Select id_tipo_funzione From dpa_funzioni Where cod_funzione = '@functionName@'
      )
      )
    </value>
  </query>
  <query>
    <name>U_SET_RECEIVED_PROOF_DATA</name>
    <value>
      Update dpa_stato_invio
      Set var_proto_dest = '@receiverProtoRec@', dta_proto_dest = CONVERT(DATETIME,'@receiverProtoDate@', 105), status_c_mask ='VNVVANN', CHA_ANNULLATO = NULL, VAR_MOTIVO_ANNULLA = NULL
      Where system_id in (
      Select si.system_id
      From profile p WITH(NOLOCK)
      Inner Join dpa_stato_invio si
      On p.system_id = si.id_profile
      Where p.num_proto = @senderRecordNumber@
      And DATEADD(ms, -DATEPART(ms, dta_proto), dta_proto) = CONVERT(DATETIME,'@senderProtoDate@', 105)
      And p.id_registro = (Select system_id From dpa_el_registri Where var_codice = '@senderAooCode@' And id_amm = (Select system_id From dpa_amministra Where var_codice_amm = '@senderAdmCode@'))
      And var_codice_amm = '@receiverAdmCode@'
      And var_codice_aoo = '@receiverAooCode@'
      And var_indirizzo = '@receiverUrl@'
      And si.id_corr_globale In (@receiverCode@)
      )
    </value>
  </query>
  <query>
    <name>S_LOAD_INFO_FOR_DELIVERED_PROOF</name>
    <value>
      Select p.system_id,
      p.author,
      p.id_ruolo_creatore
      From profile p WITH(NOLOCK)
      Where system_id = @documentId@
    </value>
  </query>
  <query>
    <name>U_SET_DROPPED_PROOF_DATA</name>
    <value>
      Update dpa_stato_invio
      Set cha_annullato = '@value@', var_motivo_annulla = '@reason@', status_c_mask='@statusmask@'
      Where system_id   In
      (Select si.system_id
      From profile p WITH(NOLOCK)
      Inner Join dpa_stato_invio si
      On p.system_id    = si.id_profile
      Where p.num_proto = @senderRecordNumber@
      And DATEADD(ms, -DATEPART(ms, dta_proto), dta_proto)  = CONVERT(DATETIME, '@senderProtoDate@', 105)
      And p.id_registro =
      (Select system_id
      From dpa_el_registri
      Where var_codice = '@senderAooCode@'
      And id_amm       =
      (Select system_id
      From dpa_amministra
      Where var_codice_amm = '@senderAdmCode@'
      )
      )
      And var_codice_amm = '@receiverAdmCode@'
      And var_codice_aoo = '@receiverAooCode@'
      And var_indirizzo  = '@receiverUrl@'
      And si.id_corr_globale In (@receiverCode@)
      )
    </value>
  </query>
  <query>
    <name>S_LOAD_DOCUMENT_ID_FROM_PROTO_INFO</name>
    <value>
      Select profile.system_id
      From profile WITH(NOLOCK)
      Where dta_proto = to_date('@protoDate@', 'dd/mm/yyyy HH24:mi:ss')
      And num_proto = @numProto@
      And id_registro = (
      Select system_id From
      dpa_el_registri
      Where var_codice = '@regCode@'
      And id_amm = (
      Select system_id
      From dpa_amministra
      Where var_codice_amm = '@ammCode@'))
    </value>
  </query>
  <query>
    <name>S_LOAD_DOCUMENT_INFO_FROM_PROTO_INFO</name>
    <value>
      Select @attribute@
      From profile WITH(NOLOCK)
      Where dta_proto = to_date('@protoDate@', 'dd/mm/yyyy HH24:mi:ss')
      And num_proto = @numProto@
      And id_registro = (
      Select system_id From
      dpa_el_registri
      Where var_codice = '@regCode@'
      And id_amm = (
      Select system_id
      From dpa_amministra
      Where var_codice_amm = '@ammCode@'))
    </value>
  </query>
  <query>
    <name>S_GET_SENDER_INFO_FROM_UO_ID</name>
    <value>
      Select (Select var_codice_amm From dpa_amministra Where system_id =
      (Select id_amm From dpa_el_registri Where system_id = InteropRegistryId)) + '-' +
      (Select var_codice From dpa_el_registri Where system_id = InteropRfId)
      From dpa_corr_globali
      Where system_id = @uoId@
    </value>
  </query>
  <query>
    <name>S_RUOLI_CON_VISIBILITA_SU_DOCUMENTO</name>
    <value>
      select groups.system_id
      from security  WITH (nolock)
      Inner Join Groups
      On security.personorgroup = groups.system_id
      where thing = @idProfile@
    </value>
  </query>
  <query>
    <name>S_DPA_RUOLO_BY_CODICE</name>
    <value>
      SELECT
      CG.SYSTEM_ID,
      CG.ID_REGISTRO,
      CG.ID_AMM,
      CG.VAR_COD_RUBRICA,
      CG.VAR_DESC_CORR,
      CG.ID_OLD,
      CG.DTA_FINE,
      CG.VAR_CODICE,
      CG.ID_GRUPPO,
      CG.CHA_TIPO_CORR,
      CG.CHA_TIPO_IE,
      CG.CHA_TIPO_URP,
      CG.VAR_CODICE_AOO,
      CG.VAR_CODICE_AMM,
      CG.VAR_CODICE_ISTAT,
      CG.VAR_EMAIL,
      CG.CHA_DISABLED_TRASM
      FROM DPA_CORR_GLOBALI CG
      WHERE CG.VAR_COD_RUBRICA = '@codice@'
      AND CG.CHA_TIPO_URP='R'
    </value>
  </query>
  <query>
    <name>S_GET_LIST_UO_BY_QUALIFICHE_UTENTE</name>
    <value>
      select  distinct
      cgUO.SYSTEM_ID AS ID,
      cgUO.VAR_CODICE as CODICE,
      cgUO.VAR_DESC_CORR AS DESCRIZIONE,
      cgUO.CLASSIFICA_UO as CLASSIFICA_UO,
      cgUO.NUM_LIVELLO as LIVELLO
      from	dpa_corr_globali cgUO
      inner join DPA_PEOPLEGROUPS_QUALIFICHE pgq on cgUO.SYSTEM_ID = pgq.ID_UO
      inner join DPA_QUALIFICHE q on pgq.ID_QUALIFICA = q.SYSTEM_ID
      where	cgUO.cha_tipo_urp = 'U'
      and cgUO.DTA_FINE is null
      and q.CHA_COD in (@qualifiche@)
      order by cgUO.NUM_LIVELLO asc
    </value>
  </query>
  <query>
    <name>S_GET_UO_SUPERIORI</name>
    <value>
      WITH Gerarchia (ID, PARENT, CODICE, DESCRIZIONE, CLASSIFICA_UO, LIVELLO)
      as
      (
      select
      cgUO.SYSTEM_ID AS ID,
      cgUO.ID_PARENT AS PARENT,
      cgUO.VAR_CODICE as CODICE,
      cgUO.VAR_DESC_CORR AS DESCRIZIONE,
      cgUO.CLASSIFICA_UO as CLASSIFICA_UO,
      cgUO.NUM_LIVELLO as LIVELLO
      from	dpa_corr_globali cgUO
      where	cguo.SYSTEM_ID = @idUo@

      UNION ALL

      select
      cgUO.SYSTEM_ID AS ID,
      cgUO.ID_PARENT as PARENT,
      cgUO.VAR_CODICE as CODICE,
      cgUO.VAR_DESC_CORR AS DESCRIZIONE,
      cgUO.CLASSIFICA_UO as CLASSIFICA_UO,
      cgUO.NUM_LIVELLO as LIVELLO
      from	dpa_corr_globali cgUO
      inner join Gerarchia g on cgUO.SYSTEM_ID = g.PARENT
      )
      select *
      from Gerarchia
      order by LIVELLO desc
    </value>
  </query>
  <query>
    <name>S_GET_UO_INFERIORI</name>
    <value>
      WITH Gerarchia (ID, PARENT, CODICE, DESCRIZIONE, CLASSIFICA_UO, LIVELLO)
      as
      (
      select
      cgUO.SYSTEM_ID AS ID,
      cgUO.ID_PARENT AS PARENT,
      cgUO.VAR_CODICE as CODICE,
      cgUO.VAR_DESC_CORR AS DESCRIZIONE,
      cgUO.CLASSIFICA_UO as CLASSIFICA_UO,
      cgUO.NUM_LIVELLO as LIVELLO
      from	dpa_corr_globali cgUO
      where	cguo.SYSTEM_ID = @idUo@

      UNION ALL

      select
      cgUO.SYSTEM_ID AS ID,
      cgUO.ID_PARENT as PARENT,
      cgUO.VAR_CODICE as CODICE,
      cgUO.VAR_DESC_CORR AS DESCRIZIONE,
      cgUO.CLASSIFICA_UO as CLASSIFICA_UO,
      cgUO.NUM_LIVELLO as LIVELLO
      from	dpa_corr_globali cgUO
      inner join Gerarchia g on cgUO.ID_PARENT = g.ID
      where cgUO.DTA_FINE IS NULL
      )
      select *
      from Gerarchia
      order by LIVELLO asc
    </value>
  </query>
  <query>
    <name>S_GET_UTENTI_RESPONSABILI_AMMINISTRAZIONE</name>
    <value>
      SELECT	p.SYSTEM_ID AS ID,
      p.USER_ID AS USER_ID,
      p.VAR_COGNOME AS COGNOME,
      p.VAR_NOME AS NOME,
      p.FULL_NAME AS NOME_COMPLETO,
      p.MATRICOLA AS MATRICOLA,
      cgu.SYSTEM_ID AS ID_UO,
      CGU.VAR_CODICE AS CODICE_UO,
      CGU.VAR_DESC_CORR AS DESCRIZIONE_UO
      FROM	PEOPLE p
      inner join PEOPLEGROUPS pg on P.SYSTEM_ID = pg.PEOPLE_SYSTEM_ID
      inner join DPA_CORR_GLOBALI cgR on pg.GROUPS_SYSTEM_ID = cgr.ID_GRUPPO
      inner join DPA_CORR_GLOBALI cgU on cgR.ID_UO = cgU.SYSTEM_ID
      WHERE p.ID_AMM = @idAmministrazione@
      AND pg.DTA_FINE is null
      AND cgR.CHA_RESPONSABILE ='1'
      AND cgR.DTA_FINE IS NULL
      ORDER BY P.FULL_NAME ASC
    </value>
  </query>
  <query>
    <name>S_GET_LIST_UO_UTENTE</name>
    <value>
      select ID_UO
      from dpa_corr_globali cgR
      inner join PEOPLEGROUPS pg on cgR.ID_GRUPPO = pg.GROUPS_SYSTEM_ID
      where  pg.PEOPLE_SYSTEM_ID = @idPeople@
      and pg.DTA_FINE is null
    </value>
  </query>
  <query>
    <name>PD_GET_TEMPLATE_DOC_BY_DESC</name>
    <value>
      SELECT
      DISTINCT(DPA_ASSOCIAZIONE_TEMPLATES.ID_OGGETTO) AS SYSTEM_ID_OGG_CUSTOM,
      DPA_TIPO_ATTO.SYSTEM_ID AS SYSTEM_ID_TIPO_ATTO,
      DPA_ASSOCIAZIONE_TEMPLATES.ID_TEMPLATE AS SYSTEM_ID_TEMPLATE,
      DPA_OGG_CUSTOM_COMP.SYSTEM_ID AS SYSTEM_ID_OGG_CUSTOM_COMP,
      DPA_TIPO_OGGETTO.SYSTEM_ID AS SYSTEM_ID_TIPO_OGGETTO,
      DPA_TIPO_ATTO.VAR_DESC_ATTO,
      DPA_TIPO_ATTO.ABILITATO_SI_NO,
      DPA_TIPO_ATTO.IN_ESERCIZIO,
      DPA_TIPO_ATTO.PATH_MOD_1,
      DPA_TIPO_ATTO.EXT_MOD_1,
      DPA_TIPO_ATTO.PATH_MOD_2,
      DPA_TIPO_ATTO.EXT_MOD_2,
      DPA_TIPO_ATTO.PATH_MOD_SU,
      DPA_TIPO_ATTO.PATH_MOD_EXC,
      DPA_TIPO_ATTO.PATH_ALL_1,
      DPA_TIPO_ATTO.GG_SCADENZA,
      DPA_TIPO_ATTO.GG_PRE_SCADENZA,
      DPA_TIPO_ATTO.CHA_PRIVATO,
      DPA_TIPO_ATTO.ID_AMM,
      DPA_TIPO_ATTO.COD_CLASS,
      DPA_TIPO_ATTO.COD_MOD_TRASM,
      DPA_TIPO_ATTO.IPERDOCUMENTO,
      DPA_TIPO_ATTO.PATH_XSD_ASSOCIATO,
      DPA_ASSOCIAZIONE_TEMPLATES.DOC_NUMBER,
      (
      SELECT VALORE_OGGETTO_DB
      FROM
      DPA_ASSOCIAZIONE_TEMPLATES DPA_TD,
      DPA_OGGETTI_CUSTOM DPA_OC,
      DPA_TIPO_OGGETTO DPA_TO
      WHERE
      DPA_TD.SYSTEM_ID = DPA_ASSOCIAZIONE_TEMPLATES.SYSTEM_ID
      AND
      DPA_TD.ID_OGGETTO = DPA_OC.SYSTEM_ID
      AND
      DPA_OC.ID_TIPO_OGGETTO = DPA_TO.SYSTEM_ID
      AND
      DPA_TO.DESCRIZIONE &lt; &gt; 'CasellaDiSelezione'
      ) AS VALORE_OGGETTO_DB,
      DPA_ASSOCIAZIONE_TEMPLATES.CODICE_DB,
      DPA_ASSOCIAZIONE_TEMPLATES.MANUAL_INSERT,
      DPA_ASSOCIAZIONE_TEMPLATES.ANNO,
      DPA_ASSOCIAZIONE_TEMPLATES.ID_AOO_RF,
      DPA_ASSOCIAZIONE_TEMPLATES.VALORE_SC,
      (
      SELECT DTA_INS
      FROM
      DPA_ASSOCIAZIONE_TEMPLATES DPA_TD,
      DPA_OGGETTI_CUSTOM DPA_OC,
      DPA_TIPO_OGGETTO DPA_TO
      WHERE
      DPA_TD.SYSTEM_ID = DPA_ASSOCIAZIONE_TEMPLATES.SYSTEM_ID
      AND
      DPA_TD.ID_OGGETTO = DPA_OC.SYSTEM_ID
      AND
      DPA_OC.ID_TIPO_OGGETTO = DPA_TO.SYSTEM_ID
      AND
      DPA_TO.DESCRIZIONE &lt; &gt; 'CasellaDiSelezione'
      ) AS DTA_INS,
      (
      SELECT DTA_ANNULLAMENTO
      FROM
      DPA_ASSOCIAZIONE_TEMPLATES DPA_TD,
      DPA_OGGETTI_CUSTOM DPA_OC,
      DPA_TIPO_OGGETTO DPA_TO
      WHERE
      DPA_TD.SYSTEM_ID = DPA_ASSOCIAZIONE_TEMPLATES.SYSTEM_ID
      AND
      DPA_TD.ID_OGGETTO = DPA_OC.SYSTEM_ID
      AND
      DPA_OC.ID_TIPO_OGGETTO = DPA_TO.SYSTEM_ID
      AND
      DPA_TO.DESCRIZIONE &lt; &gt; 'CasellaDiSelezione'
      ) AS DTA_ANNULLAMENTO,
      DPA_OGGETTI_CUSTOM.CAMPO_DI_RICERCA,
      DPA_OGGETTI_CUSTOM.CAMPO_OBBLIGATORIO,
      DPA_OGGETTI_CUSTOM.DESCRIZIONE,
      DPA_OGGETTI_CUSTOM.MULTILINEA,
      DPA_OGGETTI_CUSTOM.NUMERO_DI_CARATTERI,
      DPA_OGGETTI_CUSTOM.NUMERO_DI_LINEE,
      DPA_OGGETTI_CUSTOM.ORIZZONTALE_VERTICALE,
      DPA_OGGETTI_CUSTOM.RESET_ANNO,
      DPA_OGGETTI_CUSTOM.FORMATO_CONTATORE,
      DPA_OGGETTI_CUSTOM.CHA_PERMANENTE,
      DPA_OGGETTI_CUSTOM.CHA_PERMANENTE_ONNICOMPRENSIVA,
      DPA_OGGETTI_CUSTOM.RICERCA_CORR,
      DPA_OGGETTI_CUSTOM.ID_R_DEFAULT,
      DPA_OGGETTI_CUSTOM.CAMPO_COMUNE,
      DPA_OGGETTI_CUSTOM.CHA_TIPO_TAR,
      DPA_OGGETTI_CUSTOM.CONTA_DOPO,
      DPA_OGGETTI_CUSTOM.REPERTORIO,
      DPA_OGGETTI_CUSTOM.DA_VISUALIZZARE_RICERCA,
      DPA_OGGETTI_CUSTOM.FORMATO_ORA,
      DPA_OGGETTI_CUSTOM.TIPO_LINK,
      DPA_OGGETTI_CUSTOM.TIPO_OBJ_LINK,
      DPA_OGGETTI_CUSTOM.MODULO_SOTTOCONTATORE,
      DPA_OGG_CUSTOM_COMP.POSIZIONE,
      DPA_OGG_CUSTOM_COMP.CAMPO_XML_ASSOC,
      DPA_OGG_CUSTOM_COMP.OPZIONI_XML_ASSOC,
      DPA_TIPO_OGGETTO.DESCRIZIONE AS DESCRIZIONE_TIPO
      FROM DPA_TIPO_ATTO, DPA_ASSOCIAZIONE_TEMPLATES, DPA_OGGETTI_CUSTOM, DPA_OGG_CUSTOM_COMP, DPA_TIPO_OGGETTO
      WHERE
      DPA_TIPO_ATTO.VAR_DESC_ATTO = '@descrizioneTemplate@'
      AND
      DPA_TIPO_ATTO.SYSTEM_ID = DPA_ASSOCIAZIONE_TEMPLATES.ID_TEMPLATE
      @docNumber@
      AND
      DPA_ASSOCIAZIONE_TEMPLATES.ID_OGGETTO = DPA_OGGETTI_CUSTOM.SYSTEM_ID
      AND
      DPA_OGGETTI_CUSTOM.SYSTEM_ID = DPA_OGG_CUSTOM_COMP.ID_OGG_CUSTOM
      AND
      DPA_OGGETTI_CUSTOM.ID_TIPO_OGGETTO = DPA_TIPO_OGGETTO.SYSTEM_ID
      AND
      DPA_OGG_CUSTOM_COMP.ID_TEMPLATE = DPA_TIPO_ATTO.SYSTEM_ID
      ORDER BY DPA_OGG_CUSTOM_COMP.POSIZIONE
    </value>
  </query>
  <query>
    <name>CDC_COUNT_TIPO_OGG_FROM_TIPOLOGIA</name>
    <VALUE>
      Select count(*)
      From DPA_TIPO_ATTO, DPA_OGG_CUSTOM_COMP, DPA_OGGETTI_CUSTOM, DPA_TIPO_OGGETTO
      Where DPA_TIPO_OGGETTO.Tipo = '@oggetto@'
      And DPA_OGGETTI_CUSTOM.ID_TIPO_OGGETTO = DPA_TIPO_OGGETTO.SYSTEM_ID
      And DPA_OGGETTI_CUSTOM.SYSTEM_ID = DPA_OGG_CUSTOM_COMP.ID_OGG_CUSTOM
      And DPA_OGG_CUSTOM_COMP.ID_TEMPLATE = DPA_TIPO_ATTO.SYSTEM_ID
      And DPA_TIPO_ATTO.VAR_DESC_ATTO = '@tipologia@'
    </VALUE>
  </query>
  <query>
    <name>CDC_COUNT_TIPO_OGG_FROM_TIPOLOGIA_FASC</name>
    <VALUE>
      Select count(*)
      From DPA_TIPO_FASC, DPA_OGG_CUSTOM_COMP_FASC, DPA_OGGETTI_CUSTOM_FASC, DPA_TIPO_OGGETTO_FASC
      Where DPA_TIPO_OGGETTO_FASC.Tipo = '@oggetto@'
      And DPA_OGGETTI_CUSTOM_FASC.ID_TIPO_OGGETTO = DPA_TIPO_OGGETTO_FASC.SYSTEM_ID
      And DPA_OGGETTI_CUSTOM_FASC.SYSTEM_ID = DPA_OGG_CUSTOM_COMP_FASC.ID_OGG_CUSTOM
      And DPA_OGG_CUSTOM_COMP_FASC.ID_TEMPLATE = DPA_TIPO_FASC.SYSTEM_ID
      And DPA_TIPO_FASC.SYSTEM_ID = @tipologia@
    </VALUE>
  </query>
  <query>
    <name>S_ACTUAL_CORR_CODE_BY_CODE</name>
    <value>
      With n(system_id, var_cod_rubrica, dta_fine) As
      (Select system_id, var_cod_rubrica, DTA_FINE
      From DPA_CORR_GLOBALI
      Where VAR_COD_RUBRICA = '@corrCode@'
      Union All
      Select cg.system_id, cg.var_cod_rubrica, cg.DTA_FINE
      From DPA_CORR_GLOBALI as cg, n
      Where n.system_id = cg.ID_OLD)
      Select var_cod_rubrica From n where n.dta_fine is null
    </value>
  </query>
  <query>
    <name>S_CORR_IDS_BY_ID</name>
    <value>
      With n(id_old, system_id) As
      (Select id_old, SYSTEM_ID
      From DPA_CORR_GLOBALI
      Where VAR_COD_RUBRICA IN (@corrsCode@)
      Union All
      Select cg.id_old, cg.system_id
      From DPA_CORR_GLOBALI As cg, n
      Where n.id_old = cg.SYSTEM_ID)
      Select system_id From n
    </value>
  </query>
  <query>
    <name>S_GET_UTENTI_IN_ORGANIGRAMMA</name>
    <value>
      SELECT *
      FROM @dbUser@.vw_utenti_in_organigramma(@idUo@, '@codiceQualifica@')
      @customFilters@
    </value>
  </query>
  <query>
    <name>AMM_S_GET_PEOPLE_CON_QUALIFICA</name>
    <value>
      SELECT	DISTINCT
      P.SYSTEM_ID AS ID_UTENTE,
      P.USER_ID AS USER_NAME,
      p.VAR_COGNOME AS COGNOME,
      p.VAR_NOME AS NOME,
      P.FULL_NAME AS NOME_COMPLETO,
      P.MATRICOLA AS MATRICOLA,
      PQ.SYSTEM_ID AS ID_PEOPLEGROUPS
      FROM	PEOPLE P
      INNER JOIN DPA_PEOPLEGROUPS_QUALIFICHE PQ ON P.SYSTEM_ID = PQ.ID_PEOPLE
      INNER JOIN DPA_QUALIFICHE Q ON PQ.ID_QUALIFICA = Q.SYSTEM_ID
      WHERE P.DISABLED = 'N'
      AND Q.CHA_COD = '@codiceQualifica@'
      @customParams@
      ORDER BY P.FULL_NAME ASC
    </value>
  </query>
  <query>
    <name>S_GET_FASCICOLI_DA_CODICE_CONSEC</name>
    <value>
      select p.system_id, p.var_codice, @dbUser@.getdesctitolario (p.id_titolario) AS cod_titolario, p.description, p.ID_TITOLARIO from project p where var_codice = '@codFasc@' and p.ID_AMM=@idAmm@ and EXISTS (select 'x' from security as e  WITH (nolock)  where p.system_id=e.thing and e.PERSONORGROUP in ( @idPeople@, @idGruppo@) and e.ACCESSRIGHTS>0) @altro@ order by p.VAR_COD_LIV1 asc
    </value>
  </query>
  <query>
    <name>S_GET_REGISTRO_BY_CODICE</name>
    <value>
      SELECT @param1@
      FROM DPA_EL_REGISTRI
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>PD_GET_TEMPLATE_FASC_BY_DESC</name>
    <value>
      SELECT
      DISTINCT(DPA_ASS_TEMPLATES_FASC.ID_OGGETTO) AS SYSTEM_ID_OGG_CUSTOM,
      DPA_TIPO_FASC.SYSTEM_ID AS SYSTEM_ID_TIPO_FASC,
      DPA_ASS_TEMPLATES_FASC.ID_TEMPLATE AS SYSTEM_ID_TEMPLATE,
      DPA_OGG_CUSTOM_COMP_FASC.SYSTEM_ID AS SYSTEM_ID_OGG_CUSTOM_COMP,
      DPA_TIPO_OGGETTO_FASC.SYSTEM_ID AS SYSTEM_ID_TIPO_OGGETTO,
      DPA_TIPO_FASC.VAR_DESC_FASC,
      DPA_TIPO_FASC.ABILITATO_SI_NO,
      DPA_TIPO_FASC.IN_ESERCIZIO,
      DPA_TIPO_FASC.PATH_MOD_1,
      DPA_TIPO_FASC.PATH_MOD_2,
      DPA_TIPO_FASC.GG_SCADENZA,
      DPA_TIPO_FASC.GG_PRE_SCADENZA,
      DPA_TIPO_FASC.CHA_PRIVATO,
      DPA_TIPO_FASC.ID_AMM,
      DPA_TIPO_FASC.IPERFASCICOLO,
      DPA_ASS_TEMPLATES_FASC.ID_PROJECT,
      (
      SELECT VALORE_OGGETTO_DB
      FROM
      DPA_ASS_TEMPLATES_FASC DPA_TF,
      DPA_OGGETTI_CUSTOM_FASC DPA_OC,
      DPA_TIPO_OGGETTO_FASC DPA_TO
      WHERE
      DPA_TF.SYSTEM_ID = DPA_ASS_TEMPLATES_FASC.SYSTEM_ID
      AND
      DPA_TF.ID_OGGETTO = DPA_OC.SYSTEM_ID
      AND
      DPA_OC.ID_TIPO_OGGETTO = DPA_TO.SYSTEM_ID
      AND
      DPA_TO.DESCRIZIONE &lt; &gt; 'CasellaDiSelezione'
      ) AS VALORE_OGGETTO_DB,
      DPA_ASS_TEMPLATES_FASC.CODICE_DB,
      DPA_ASS_TEMPLATES_FASC.MANUAL_INSERT,
      DPA_ASS_TEMPLATES_FASC.ANNO,
      DPA_ASS_TEMPLATES_FASC.ID_AOO_RF,
      (
      SELECT DTA_INS
      FROM
      DPA_ASS_TEMPLATES_FASC DPA_TF,
      DPA_OGGETTI_CUSTOM_FASC DPA_OC,
      DPA_TIPO_OGGETTO_FASC DPA_TO
      WHERE
      DPA_TF.SYSTEM_ID = DPA_ASS_TEMPLATES_FASC.SYSTEM_ID
      AND
      DPA_TF.ID_OGGETTO = DPA_OC.SYSTEM_ID
      AND
      DPA_OC.ID_TIPO_OGGETTO = DPA_TO.SYSTEM_ID
      AND
      DPA_TO.DESCRIZIONE &lt; &gt; 'CasellaDiSelezione'
      ) AS DTA_INS,
      DPA_OGGETTI_CUSTOM_FASC.CAMPO_DI_RICERCA,
      DPA_OGGETTI_CUSTOM_FASC.CAMPO_OBBLIGATORIO,
      DPA_OGGETTI_CUSTOM_FASC.DESCRIZIONE,
      DPA_OGGETTI_CUSTOM_FASC.MULTILINEA,
      DPA_OGGETTI_CUSTOM_FASC.NUMERO_DI_CARATTERI,
      DPA_OGGETTI_CUSTOM_FASC.NUMERO_DI_LINEE,
      DPA_OGGETTI_CUSTOM_FASC.ORIZZONTALE_VERTICALE,
      DPA_OGGETTI_CUSTOM_FASC.RESET_ANNO,
      DPA_OGGETTI_CUSTOM_FASC.FORMATO_CONTATORE,
      DPA_OGGETTI_CUSTOM_FASC.CHA_PERMANENTE,
      DPA_OGGETTI_CUSTOM_FASC.CHA_PERMANENTE_ONNICOMPRENSIVA,
      DPA_OGGETTI_CUSTOM_FASC.RICERCA_CORR,
      DPA_OGGETTI_CUSTOM_FASC.ID_R_DEFAULT,
      DPA_OGGETTI_CUSTOM_FASC.CAMPO_COMUNE,
      DPA_OGGETTI_CUSTOM_FASC.CHA_TIPO_TAR,
      DPA_OGGETTI_CUSTOM_FASC.CONTA_DOPO,
      DPA_OGGETTI_CUSTOM_FASC.REPERTORIO,
      DPA_OGGETTI_CUSTOM_FASC.DA_VISUALIZZARE_RICERCA,
      DPA_OGGETTI_CUSTOM_FASC.FORMATO_ORA,
      DPA_OGGETTI_CUSTOM_FASC.TIPO_LINK,
      DPA_OGGETTI_CUSTOM_FASC.TIPO_OBJ_LINK,
      DPA_OGG_CUSTOM_COMP_FASC.POSIZIONE,
      DPA_TIPO_OGGETTO_FASC.DESCRIZIONE AS DESCRIZIONE_TIPO
      FROM DPA_TIPO_FASC, DPA_ASS_TEMPLATES_FASC, DPA_OGGETTI_CUSTOM_FASC, DPA_OGG_CUSTOM_COMP_FASC, DPA_TIPO_OGGETTO_FASC
      WHERE
      DPA_TIPO_FASC.VAR_DESC_FASC = '@descrizione@'
      AND
      DPA_TIPO_FASC.SYSTEM_ID = DPA_ASS_TEMPLATES_FASC.ID_TEMPLATE
      @idProject@
      AND
      DPA_ASS_TEMPLATES_FASC.ID_OGGETTO = DPA_OGGETTI_CUSTOM_FASC.SYSTEM_ID
      AND
      DPA_OGGETTI_CUSTOM_FASC.SYSTEM_ID = DPA_OGG_CUSTOM_COMP_FASC.ID_OGG_CUSTOM
      AND
      DPA_OGGETTI_CUSTOM_FASC.ID_TIPO_OGGETTO = DPA_TIPO_OGGETTO_FASC.SYSTEM_ID
      AND
      DPA_OGG_CUSTOM_COMP_FASC.ID_TEMPLATE = DPA_TIPO_FASC.SYSTEM_ID
      ORDER BY DPA_OGG_CUSTOM_COMP_FASC.POSIZIONE
    </value>
  </query>
  <query>
    <name>PD_GET_DPA_TEMPLATE_2_BY_DESC</name>
    <value>
      SELECT *
      FROM DPA_TIPO_ATTO
      WHERE
      VAR_DESC_ATTO = '@descrizioneTemplate@'
    </value>
  </query>
  <query>
    <name>S_VERIFICA_GESTIONE_CHIAVI</name>
    <value>
      select abilitato_chiavi_config from people where system_id = @idPeople@
    </value>
  </query>
  <query>
    <name>S_GET_UO_SUPERIORI_BY_UTENTE</name>
    <value>
      WITH Gerarchia (ID, CODICE, DESCRIZIONE, PARENT, CLASSIFICA_UO, LIVELLO)         as
      (
      select cgUO.SYSTEM_ID,
      cgUO.VAR_CODICE,
      cgUO.VAR_DESC_CORR,
      cgUO.ID_PARENT,
      cgUO.CLASSIFICA_UO,
      0 as LIVELLO
      from PEOPLE p
      inner join PEOPLEGROUPS pg on p.SYSTEM_ID = pg.PEOPLE_SYSTEM_ID
      inner join DPA_CORR_GLOBALI cgRuoli on pg.GROUPS_SYSTEM_ID = cgRuoli.ID_GRUPPO
      inner join DPA_CORR_GLOBALI cgUO on cgRuoli.ID_UO = cgUO.SYSTEM_ID
      where
      (p.SYSTEM_ID = @user@
      or p.USER_ID = '@user@'
      or p.MATRICOLA = '@user@'
      )
      and pg.DTA_FINE is null
      and cgUO.DTA_FINE is null

      UNION ALL

      select cgUO.SYSTEM_ID,
      cgUO.VAR_CODICE,
      cgUO.VAR_DESC_CORR,
      cgUO.ID_PARENT,
      cgUO.CLASSIFICA_UO,
      LIVELLO + 1 as LIVELLO
      from   DPA_CORR_GLOBALI cgUO
      inner join Gerarchia g on cgUO.SYSTEM_ID = g.PARENT
      where  cgUO.DTA_FINE is null
      )
      select *
      from Gerarchia
      @customFilters@
    </value>
  </query>
  <query>
    <name>S_People_PIS</name>
    <value>
      SELECT P.SYSTEM_ID, P.USER_ID, P.ID_AMM, P.VAR_COGNOME, P.VAR_NOME, P.VAR_TELEFONO, P.EMAIL_ADDRESS, P.FROM_EMAIL_ADDRESS, P.CHA_NOTIFICA, P.CHA_AMMINISTRATORE,P.CHA_NOTIFICA_CON_ALLEGATO,P.VAR_SEDE,P.MATRICOLA
      FROM PEOPLE P, DPA_AMMINISTRA A
      WHERE USER_ID='@userName@' and A.VAR_CODICE_AMM='@codiceAmm@' and P.ID_AMM=A.SYSTEM_ID AND NOT(P.DISABLED='Y')
    </value>
  </query>
  <query>
    <name>S_DPADETTGLOBALIBYID</name>
    <value>
      select
      d.VAR_INDIRIZZO,d.VAR_CAP,d.VAR_PROVINCIA,d.VAR_NAZIONE,d.VAR_COD_FISC,d.VAR_TELEFONO,d.VAR_FAX,d.VAR_NOTE,d.VAR_CITTA, d.VAR_COD_PI, d.VAR_LOCALITA
      from dpa_dett_globali d where d.ID_CORR_GLOBALI=@idCorr@
    </value>
  </query>
  <query>
    <name>S_GET_UTENTI_IN_UO_CON_QUALIFICA</name>
    <value>
      SELECT distinct
      u.ID_UTENTE,
      u.USER_ID,
      u.COGNOME,
      u.NOME,
      u.NOME_COMPLETO,
      u.MATRICOLA,
      pgq.SYSTEM_ID as ID_ASSOCIAZIONE_QUALIFICA,
      pgq.ID_GRUPPO as ID_ASSOCIAZIONE_GRUPPO
      FROM @dbUser@.vw_utenti_in_organigramma(@idUO@, '@codiceQualificaDiscriminante@') u
      inner join DPA_PEOPLEGROUPS_QUALIFICHE pgq on u.ID_UTENTE = pgq.ID_PEOPLE
      inner join DPA_QUALIFICHE q on pgq.ID_QUALIFICA = q.SYSTEM_ID
      where q.CHA_COD = '@codiceQualifica@'
    </value>
  </query>
  <query>
    <name>MODELLI_TRASM_UTENTI_CON_NOTIFICA_SOLO_NOTIFICA</name>
    <value>
      select
      p.system_id as ID,
      p.user_id as CODICE,
      p.FULL_NAME as UTENTE,
      cg.VAR_DESC_CORR as RUOLO,
      @dbuser@.getflagnotifica(@id_mod_mitt_dest@,p.system_id) as FLAG_NOTIFICA,
      p.var_cognome
      from
      people p,
      peoplegroups pg,
      dpa_corr_globali cg
      where
      cg.system_id = @id_corr_glob_ruolo@
      and cg.id_gruppo = pg.groups_system_id
      and pg.PEOPLE_SYSTEM_ID = p.system_id
      and pg.DTA_FINE is null
      and  @dbuser@.getflagnotifica(@id_mod_mitt_dest@,p.system_id)=1
      order by p.var_cognome asc
    </value>
  </query>
  <query>
    <name>S_GET_CONTATORI_DOCUMENTI_PER_TIPOLOGIA</name>
    <value>
      SELECT TA.VAR_DESC_ATTO AS DESCRIZIONE,
      CASE
      WHEN T1.TOTALE IS NULL THEN 0
      ELSE T1.TOTALE
      END AS TOTALE
      FROM DPA_TIPO_ATTO TA
      LEFT OUTER JOIN
      (
      SELECT TA.VAR_DESC_ATTO AS DESCRIZIONE,
      COUNT(*) AS TOTALE
      FROM DPA_TIPO_ATTO TA
      INNER JOIN PROFILE P ON TA.SYSTEM_ID = P.ID_TIPO_ATTO
      INNER JOIN PEOPLE PL ON P.AUTHOR = PL.SYSTEM_ID
      INNER JOIN PEOPLEGROUPS PG ON PL.SYSTEM_ID = PG.PEOPLE_SYSTEM_ID
      INNER JOIN DPA_CORR_GLOBALI CGR ON PG.GROUPS_SYSTEM_ID = CGR.ID_GRUPPO
      INNER JOIN DPA_CORR_GLOBALI CGUO ON CGR.ID_UO = CGUO.SYSTEM_ID
      WHERE
      CGR.DTA_FINE IS NULL
      AND CGUO.DTA_FINE IS NULL
      AND CGUO.SYSTEM_ID = @idUO@
      AND P.CREATION_DATE BETWEEN @dataInizio@ AND @dataFine@
      GROUP BY TA.VAR_DESC_ATTO
      ) T1
      ON TA.VAR_DESC_ATTO = T1.DESCRIZIONE
      WHERE TA.VAR_DESC_ATTO IN (@descrizioneTipiDocumento@)
      ORDER BY TA.VAR_DESC_ATTO ASC
    </value>
  </query>
  <query>
    <name>S_GET_DATI_SEGNATURA_TIMBRO</name>
    <value>
      select a.VAR_SEGNATURA, @dbuser@.GetCodReg(a.ID_REGISTRO) as COD_REG, @dbuser@.GETcodUO(a.ID_UO_CREATORE) as UO_CREATORE, d.VAR_CODICE_AMM,
      a.NUM_ANNO_PROTO as ANNO, convert(datetime,a.dta_proto,103) AS DTA_PROTO, convert(datetime,a.dta_proto,108) AS ORA_PROTO, a.CHA_TIPO_PROTO,
      a.NUM_PROTO, @dbuser@.CountAllegati_BY_DocNumber(a.DOCNUMBER) as allegati, @dbuser@.classcat(a.SYSTEM_ID) cod_fasc, a.DOCNUMBER, @dbuser@.Getcodicerfbyprofileid(a.system_id) as COD_RF
      from profile a WITH(NOLOCK), dpa_amministra d where a.system_id=@system_id@ and d.SYSTEM_ID = @dbuser@.Getidamm(a.ID_PEOPLE_PROT)
    </value>
  </query>
  <query>
    <name>S_GET_GERARCHIA_RUBRICA</name>
    <value>
      SELECT
      @dbUser@.getGerarchia(a.id_amm,a.var_cod_rubrica,a.cha_tipo_urp,d.system_id,a.CHA_TIPO_IE) as gerarchia
      FROM DPA_CORR_GLOBALI a, PEOPLE b, PEOPLEGROUPS c, GROUPS d
      WHERE
      a.id_people = b.system_id
      AND b.system_id = c.PEOPLE_SYSTEM_ID
      AND c.GROUPS_SYSTEM_ID = d.system_id
      AND a.cha_tipo_ie = '@tipo@'
      AND a.id_amm = @idAmm@
      AND a.dta_fine IS NULL
      AND c.dta_fine IS NULL
      AND b.user_id = '@codice@'
    </value>
  </query>

  <query>
    <name>S_DPA_UTENTE_APPLICAZIONI</name>
    <value>
      SELECT SYSTEM_ID,VAR_CODE,DESCRIPTION
      FROM DPA_EXT_APPS, DPA_REL_PEOPLE_EXTAPPS
      WHERE DPA_EXT_APPS.SYSTEM_ID = DPA_REL_PEOPLE_EXTAPPS.ID_EXT_APP
      AND DPA_REL_PEOPLE_EXTAPPS.ID_PEOPLE = @idUtente@
    </value>
  </query>
  <query>
    <name>S_DPA_APPLICAZIONI</name>
    <value>
      SELECT SYSTEM_ID,VAR_CODE,DESCRIPTION
      FROM DPA_EXT_APPS
    </value>
  </query>
  <query>
    <name>I_DPA_APPLICAZIONE</name>
    <value>
      INSERT INTO DPA_EXT_APPS
      (@paramA@ VAR_CODE,DESCRIPTION)
      VALUES
      (@paramB@ '@param1@','@param2@')
    </value>
  </query>
  <query>
    <name>U_DPA_APPLICAZIONE</name>
    <value>
      UPDATE DPA_EXT_APPS SET VAR_CODE = '@param1@', DESCRIPTION = '@param2@' WHERE SYSTEM_ID = @param3@
    </value>
  </query>
  <query>
    <name>D_DPA_APPLICAZIONE</name>
    <value>
      DELETE DPA_EXT_APPS WHERE SYSTEM_ID = @param1@
    </value>
  </query>
  <query>
    <name>I_DPA_REL_APP_UTENTE</name>
    <value>
      INSERT INTO DPA_REL_PEOPLE_EXTAPPS
      (ID_PEOPLE,ID_EXT_APP)
      VALUES (@param1@,@param2@)
    </value>
  </query>
  <query>
    <name>I_DPA_REL_APP_UTENTI</name>
    <value>
      INSERT INTO DPA_REL_PEOPLE_EXTAPPS
      (ID_EXT_APP,ID_PEOPLE)
      SELECT (@param1@, SYSTEM_ID FROM PEOPLE WHERE SYSTEM_ID IN (@param2@))
    </value>
  </query>
  <query>
    <name>D_DPA_REL_APP_UTENTE</name>
    <value>
      DELETE DPA_REL_PEOPLE_EXTAPPS WHERE ID_EXT_APP = @param1@
    </value>
  </query>
  <query>
    <name>I_EXTEND_VISIBILITY</name>
    <value>
      INSERT
      INTO SECURITY
      (
      THING,
      PERSONORGROUP,
      ACCESSRIGHTS,
      ID_GRUPPO_TRASM,
      CHA_TIPO_DIRITTO,
      HIDE_DOC_VERSIONS,
      TS_INSERIMENTO,
      VAR_NOTE_SEC
      )
      (SELECT @documentId@,
      cg4.id_gruppo,
      63,
      NULL,
      'A',
      NULL,
      to_timestamp(sysdate),
      NULL
      FROM dpa_corr_globali cg4
      INNER JOIN dpa_tipo_ruolo
      ON cg4.id_tipo_ruolo = dpa_tipo_ruolo.system_id
      WHERE Exists
      (SELECT 'x'
      FROM dpa_corr_globali cg3
      WHERE cg3.dta_fine              IS NULL and cg4.id_uo = cg3.system_id
      CONNECT BY PRIOR cg3.id_parent = cg3.system_id
      START WITH cg3.system_id       =
      (SELECT cg2.id_uo FROM dpa_corr_globali cg2 WHERE cg2.id_gruppo = @roleId@
      )
      )
      AND cg4.CHA_TIPO_URP           = 'R'
      AND cg4.ID_AMM                 = @idAmministrazione@
      AND cg4.DTA_FINE              IS NULL
      AND dpa_tipo_ruolo.num_livello &lt;
      (SELECT dpa_tipo_ruolo.num_livello
      FROM dpa_corr_globali cg1
      INNER JOIN dpa_tipo_ruolo
      ON cg1.id_tipo_ruolo = dpa_tipo_ruolo.system_id
      WHERE cg1.id_gruppo  = @roleId@
      )
      AND NOT EXISTS
      (SELECT 'x'
      FROM security  WITH (nolock)
      WHERE thing       = @documentId@
      AND personorgroup = cg4.id_gruppo
      )
      )
    </value>
  </query>
  <!-- Laura 17 Dicembre -->
  <query>
    <name>DPA_PROFILE_DATA_BY_DOCNAME</name>
    <value>
      SELECT SYSTEM_ID , DOCNUMBER FROM PROFILE WITH(NOLOCK) WHERE VAR_SEGNATURA ='@docname@'
    </value>
  </query>
  <query>
    <name>UPDATE_VERSION_NUM_DOC</name>
    <value>
      UPDATE
      VERSIONS
      SET NUM_PAGE_FILE = @numberOfPage@,
      UTENTE = '@utente@'
      WHERE VERSION_ID= @versionId@ AND
      DOCNUMBER = @docnumber@
    </value>
  </query>
  <query>
    <name>V_PROTO_PREGRESSI</name>
    <value>
      SELECT NUM_PROTO AS PROTOCOLLATO FROM PROFILE WHERE ID_REGISTRO = @param1@ AND YEAR(DTA_PROTO) = '@param3@' AND  NUM_PROTO @param2@
      UNION
      SELECT ID_NUM_PROTO_EXCEL AS PROTOCOLLATO FROM DPA_ASS_PREGRESSI WHERE ID_REGISTRO = @param1@ AND ID_NUM_PROTO_EXCEL @param2@ AND ESITO IS NULL
    </value>
  </query>
  <!--Emilio 22 Ottobre-->
  <query>
    <name>S_GET_CONTROLLATO_FOLDER_COM</name>
    <value>
      select p1.VAR_CODICE from PROJECT p1, PROJECT p2
      where p1.SYSTEM_ID=p2.ID_PARENT and p2.SYSTEM_ID = @system_id@
    </value>
  </query>
  <query>
    <name>S_UTE_RUOL_BY_COD</name>
    <value>
      SELECT P.SYSTEM_ID AS ID_PEOPLE, G.SYSTEM_ID AS ID_RUOLO
      FROM PEOPLE P, GROUPS G, PEOPLEGROUPS PG
      WHERE P.USER_ID = '@param1@'
      AND G.GROUP_ID = '@param2@'
      AND PG.GROUPS_SYSTEM_ID = G.SYSTEM_ID
      AND PG.PEOPLE_SYSTEM_ID = P.SYSTEM_ID
      AND P.ID_AMM = @param3@
    </value>
  </query>
  <query>
    <name>S_GET_REPORT_PREGRESSO_BY_SYSTEMID</name>
    <value>
      select p.SYSTEM_ID, p.ID_AMM, p.ID_UTENTE_CREATORE, p.ID_RUOLO_CREATORE, convert(datetime,p.DATA_ESECUZIONE,103) as DATA_ESECUZIONE, convert(datetime,p.DATA_FINE,103) as DATA_FINE, p.NUM_DOC
      from DPA_PREGRESSI p
      where p.SYSTEM_ID = @system_id@
    </value>
  </query>
  <!--Emilio 22 Ottobre-->
  <query>
    <name>I_SECURITY_SELECT_MODIFICATA_COM</name>
    <value>
      INSERT INTO SECURITY (THING, PERSONORGROUP, ACCESSRIGHTS, ID_GRUPPO_TRASM, CHA_TIPO_DIRITTO)
      (SELECT DISTINCT @param1@, personorgroup, accessrights, @param2@, 'F'
      FROM security  WITH (nolock) , dpa_l_ruolo_reg b, dpa_corr_globali c
      WHERE c.system_id = b.id_ruolo_in_uo
      @param8@
      AND thing = @param5@
      AND NOT personorgroup IN  (SELECT personorgroup
      FROM security  WITH (nolock)
      WHERE thing = @param1@)
      UNION
      SELECT DISTINCT @param1@, personorgroup, accessrights, @param2@, 'F'
      FROM security  WITH (nolock) ,
      dpa_l_ruolo_reg b,
      dpa_corr_globali c,
      peoplegroups d
      WHERE d.dta_fine IS NULL
      AND c.id_gruppo = d.groups_system_id
      AND c.system_id = b.id_ruolo_in_uo
      AND accessrights != 0
      @param9@
      AND thing = @param5@
      AND NOT personorgroup IN (SELECT personorgroup
      FROM security  WITH (nolock)
      WHERE thing = @param1@)
      )
    </value>
  </query>
  <query>
    <name>S_GET_ITEM_REPORT_PREGRESSO_BY_SYSTEMID</name>
    <value>
      select a.SYSTEM_ID, a.ID_PREGRESSO, a.ID_REGISTRO, a.ID_DOCUMENTO, a.ID_UTENTE, a.ID_RUOLO, a.TIPO_OPERAZIONE, convert(datetime,a.DATA,103) as DATA, a.ERRORE, a.ESITO, a.ID_NUM_PROTO_EXCEL
      from DPA_ASS_PREGRESSI a
      where a.ID_PREGRESSO = @id_report@ and a.ESITO IS NOT NULL
      order by a.DATA asc
    </value>
  </query>
  <!--Emilio 6 Novembre-->
  <query>
    <name>VerificaMatricola</name>
    <value>
      SELECT USER_ID
      from PEOPLE
      where MATRICOLA = @MATRICOLA@
    </value>
  </query>
  <query>
    <name>S_GET_ALL_REPORT_PREGRESSO</name>
    <value>
      /* Formatted on 2012/07/23 15:59 (Formatter Plus v4.8.8) */
      SELECT   p.system_id, p.id_amm, p.id_utente_creatore, p.id_ruolo_creatore,
      TO_CHAR (p.data_esecuzione,      'dd/mm/yyyy HH24:mi:ss'      ) AS data_esecuzione,
      TO_CHAR (p.data_fine, 'dd/mm/yyyy HH24:mi:ss') AS data_fine,
      p.num_doc,
      p.descrizione,
      SUM (CASE a.esito
      WHEN 'W'
      THEN 1
      ELSE 0
      END)
      + SUM (CASE a.esito
      WHEN 'E'
      THEN 1
      ELSE 0
      END)
      + SUM (CASE a.esito
      WHEN 'S'
      THEN 1
      ELSE 0
      END) AS elaborati,
      SUM (CASE a.esito
      WHEN 'W'
      THEN 1
      ELSE 0
      END)
      + SUM (CASE a.esito
      WHEN 'E'
      THEN 1
      ELSE 0
      END) AS errori
      FROM dpa_pregressi p, dpa_ass_pregressi a
      WHERE p.id_amm =  @id_amm@ AND p.system_id = a.id_pregresso(+) AND p.id_amm =  @id_amm@
      @daAmm@
      GROUP BY (p.system_id,
      p.id_amm,
      p.id_utente_creatore,
      p.id_ruolo_creatore,
      p.data_esecuzione,
      p.data_fine,
      p.num_doc,
      p.descrizione
      )
      ORDER BY (p.system_id) DESC
    </value>
  </query>
  <!--Emilio Mev Misurazione Obiettivi-->
  <query>
    <name>S_COD_LIV_OBIETTIVO</name>
    <value>
      SELECT ( case
      when MAX(CONVERT(int,LTRIM(SUBSTRING (CAST(var_cod_liv1 as varchar),LEN(var_cod_liv1)-3, LEN(var_cod_liv1))))) is null
      then 1
      else MAX(CONVERT(int,LTRIM(SUBSTRING (CAST(var_cod_liv1 as varchar),LEN(var_cod_liv1)-3, LEN(var_cod_liv1))))) + 1
      end )as TOT
      FROM OBIETTIVI
      WHERE var_cod_liv1 LIKE '@param1@%'
      AND cha_tipo_proj = 'T'
      AND id_amm = @param2@
      AND num_livello = @param3@
      @param4@
    </value>
  </query>
  <query>
    <name>S_GET_ALLEGATI_ITEM_REPORT_PREGRESSI_BY_SYSTEMID</name>
    <value>
      select a.SYSTEM_ID, a.ID_ITEM, a.ERRORE, a.ESITO
      from DPA_ASS_ALLEGATO a
      where a.ID_ITEM = @id_item@
      order by a.SYSTEM_ID asc
    </value>
  </query>
  <query>
    <name>OBIETTIVO_SET_ATTIVO</name>
    <value>
      UPDATE OBIETTIVI
      SET CHA_STATO = 'A',DTA_ATTIVAZIONE = GETDATE(),DTA_APERTURA = GETDATE()
      WHERE
      SYSTEM_ID = @systemId@
    </value>
  </query>
  <query>
    <name>S_GET_ID_ITEM_DPA_ASS_PREGRESSI</name>
    <value>
      select a.SYSTEM_ID
      from DPA_ASS_PREGRESSI a
      where a.ID_PREGRESSO = @id_report@
      order by a.SYSTEM_ID asc
    </value>
  </query>
  <query>
    <name>OBIETTIVO_SET_CESSATO</name>
    <value>
      UPDATE OBIETTIVI
      SET DTA_CESSAZIONE = GETDATE(),
      CHA_STATO = 'C',
      DTA_CHIUSURA = GETDATE()
      WHERE
      ID_AMM = @idAmm@
      AND CHA_STATO = 'A'
      AND ID_PARENT = 0
      AND ID_OBIETTIVO = 0
      AND VAR_CODICE = 'T'
    </value>
  </query>
  <query>
    <name>I_DPA_PREGRESSI</name>
    <value>
      INSERT INTO DPA_PREGRESSI
      (@paramA@ ID_AMM, ID_UTENTE_CREATORE, ID_RUOLO_CREATORE, DATA_ESECUZIONE, DATA_FINE, NUM_DOC, DESCRIZIONE)
      VALUES
      (
      @paramB@
      @id_amm@,
      @id_utente_creatore@,
      @id_ruolo_creatore@,
      @data_esecuzione@,
      @data_fine@,
      @num_doc@,
      '@descrizione@'
      )
    </value>
  </query>
  <query>
    <name>OBIETTIVO_CHIUDI_NODI</name>
    <value>
      UPDATE OBIETTIVI
      SET
      OBIETTIVI.CHA_STATO = 'C',
      OBIETTIVI.DTA_CHIUSURA = GETDATE(),
      OBIETTIVI.DTA_CESSAZIONE = GETDATE()
      WHERE
      (OBIETTIVI.DTA_CHIUSURA IS NULL OR OBIETTIVI.DTA_CHIUSURA = '')
      AND
      OBIETTIVI.ID_OBIETTIVO IN
      (
      SELECT
      SYSTEM_ID
      FROM OBIETTIVI
      WHERE
      OBIETTIVI.ID_AMM = @idAmm@
      AND
      OBIETTIVI.CHA_STATO = 'A'
      AND
      OBIETTIVI.ID_PARENT = 0
      AND
      OBIETTIVI.ID_OBIETTIVO = 0
      AND
      OBIETTIVI.VAR_CODICE = 'T'
      )
    </value>
  </query>
  <query>
    <name>I_DPA_ASS_PREGRESSI</name>
    <value>
      INSERT INTO DPA_ASS_PREGRESSI
      (@paramA@ ID_PREGRESSO, ID_REGISTRO, ID_UTENTE, ID_RUOLO, TIPO_OPERAZIONE, DATA, ID_NUM_PROTO_EXCEL)
      VALUES
      (
      @paramB@
      @id_pregresso@,
      @id_registro@,
      @id_utente@,
      @id_ruolo@,
      '@tipo_operazione@',
      @data@,
      '@id_num_proto_excel@'
      )
    </value>
  </query>
  <query>
    <name>OBIETTIVO_EXIST_IN_DEF</name>
    <value>
      SELECT SYSTEM_ID FROM OBIETTIVI
      WHERE
      ID_AMM = @idAmm@
      AND
      ID_PARENT = 0
      AND
      CHA_STATO = 'D'
    </value>
  </query>
  <query>
    <name>I_DPA_ASS_ALLEGATO</name>
    <value>
      INSERT INTO DPA_ASS_ALLEGATO
      (@paramA@ ID_ITEM, ERRORE, ESITO)
      VALUES
      (
      @paramB@
      @id_item@,
      '@errore@',
      '@esito@'
      )
    </value>
  </query>
  <query>
    <name>OBIETTIVO_GET_ALL_DEF</name>
    <value>
      select distinct
      b.id_registro as REGISTRO, isnull ((select DISTINCT a.var_desc_registro FROM DPA_EL_REGISTRI A WHERE A.SYSTEM_ID = B.ID_REGISTRO),'Nodi Comuni') as AOO ,
      b.id_obiettivo as OBIETTIVO  , isnull ((select DISTINCT a.VAR_CODICE FROM DPA_EL_REGISTRI A WHERE A.SYSTEM_ID = B.ID_REGISTRO),'CODCOM') as CODICEAOO  from OBIETTIVI b
      where b.ID_PARENT in (select DISTINCT system_id from OBIETTIVI where CHA_STATO='D')
      @condReg@
    </value>
  </query>
  <query>
    <name>D_DELETE_ALLEGATO_ITEM_REPORT_PREGRESSI</name>
    <value>
      DELETE FROM DPA_ASS_ALLEGATO
      WHERE ID_ITEM=@id_item@
    </value>
  </query>
  <query>
    <name>S_NODO_OBIETTIVI_SECURITY_2</name>
    <value>
      SELECT DISTINCT
      a.system_id as IDRECORD,
      a.var_codice as CODICE,
      a.description as DESCRIZIONE,
      a.num_livello as LIVELLO,
      a.id_registro as REGISTRO,
      a.id_parent as IDPARENT,
      a.var_cod_liv1 as CODLIV,
      a.cha_stato as STATO,
      a.dta_attivazione as DATA_ATTIVAZIONE,
      a.dta_cessazione as DATA_CESSAZIONE,
      a.num_mesi_conservazione as NUMMESICONSERVAZIONE,
      (SELECT count(b.system_id)
      FROM OBIETTIVI b
      WHERE b.id_amm = @idAmm@
      AND b.id_parent = a.system_id
      ) as FIGLIO
      FROM OBIETTIVI a
      WHERE a.system_id = @systemIdTit@
      ORDER BY a.var_cod_liv1
    </value>
  </query>
  <query>
    <name>D_DELETE_ITEM_REPORT_PREGRESSI</name>
    <value>
      DELETE FROM DPA_ASS_PREGRESSI
      WHERE ID_PREGRESSO=@id_pregresso@
    </value>
  </query>
  <query>
    <name>S_NODO_OBIETTIVI_SECURITY</name>
    <value>
      SELECT DISTINCT
      a.system_id as IDRECORD,a.var_codice as CODICE,a.description as DESCRIZIONE,a.num_livello as LIVELLO,a.id_registro as REGISTRO,a.id_parent as IDPARENT,a.var_cod_liv1 as CODLIV, isnull(a.num_mesi_conservazione,0) as NUMMESICONSERVAZIONE,
      (SELECT count(b.system_id)
      FROM OBIETTIVI b
      WHERE b.id_amm = @param1@
      AND b.id_parent = a.system_id
      ) as FIGLIO
      FROM OBIETTIVI a
      WHERE a.id_amm = @param1@
      AND a.id_parent = @param2@
      AND (a.id_registro is null or a.id_registro = @param4@)
      ORDER BY a.var_cod_liv1
    </value>
  </query>
  <query>
    <name>D_DELETE_REPORT_PREGRESSI</name>
    <value>
      DELETE FROM DPA_PREGRESSI
      WHERE SYSTEM_ID=@system_id@
    </value>
  </query>
  <query>
    <name>S_NODO_OBIETTIVI_NO_SECURITY</name>
    <value>
      SELECT DISTINCT
      a.system_id as IDRECORD,a.var_codice as CODICE,a.description as DESCRIZIONE,a.num_livello as LIVELLO,a.id_registro as REGISTRO,a.id_parent as IDPARENT,a.var_cod_liv1 as CODLIV, isnull(a.num_mesi_conservazione,0) as NUMMESICONSERVAZIONE,
      (SELECT count(b.system_id)
      FROM OBIETTIVI b
      WHERE b.id_amm = @param1@
      AND b.id_parent = a.system_id
      ) as FIGLIO
      FROM OBIETTIVI a
      WHERE a.id_amm = @param1@
      AND a.id_parent = @param2@
      AND (a.id_registro is null or a.id_registro = @param4@)
      ORDER BY a.var_cod_liv1
    </value>
  </query>
  <query>
    <name>U_ITEM_REPORT_PREGRESSI</name>
    <value>
      update DPA_ASS_PREGRESSI set ID_DOCUMENTO=@id_documento@, ERRORE='@errore@', ESITO='@esito@' WHERE SYSTEM_ID=@system_id@
    </value>
  </query>
  <query>
    <name>S_NODO_OBIETTIVI_PADRE</name>
    <value>
      SELECT
      id_parent as PADRE
      FROM OBIETTIVI
      WHERE system_id = @param1@
    </value>
  </query>
  <query>
    <name>U_REPORT_PREGRESSI</name>
    <value>
      update DPA_PREGRESSI set DATA_FINE=@data_fine@ WHERE SYSTEM_ID=@system_id@
    </value>
  </query>
  <query>
    <name>OBIETTIVI_GET_OBIETTIVI_UTILI</name>
    <value>
      SELECT P.*, A.VAR_CODICE_AMM FROM OBIETTIVI P, DPA_AMMINISTRA A
      WHERE
      P.ID_AMM = @idAmm@
      AND
      P.ID_OBIETTIVO = 0
      AND
      P.ID_PARENT = 0
      AND
      P.ID_AMM = A.SYSTEM_ID
      AND
      P.CHA_STATO &lt; &gt; 'D'
      ORDER BY P.CHA_STATO, P.DTA_CESSAZIONE DESC
    </value>
  </query>

  <query>
    <name>U_ALLEGATO_ITEM_REPORT_PREGRESSI</name>
    <value>
      update DPA_ASS_ALLEGATO set ID_ITEM=@id_item@, ERRORE='@errore@', ESITO='@esito@' WHERE SYSTEM_ID=@system_id@
    </value>
  </query>
  <query>
    <name>S_FILTRO_RIC_OB_DOCSPA_NO_SECURITY</name>
    <value>
      SELECT
      DISTINCT A.system_id as ID, A.var_codice as CODICE, A.description as DESCRIZIONE, A.num_livello as LIVELLO, A.id_parent as IDPARENT
      FROM OBIETTIVI A  @paramFrom@
      @param1@
      @param2@
      AND A.id_amm = @param3@
      AND (A.id_registro is null or A.id_registro = @param5@)
      AND ID_OBIETTIVO = @param6@
      @paramNote@
      @paramIndice@
      ORDER BY num_livello
    </value>
  </query>
  <query>
    <name>S_GET_DETTAGLIO_DOCUMENTO_NO_SECURITY_BY_NUM_PROTO_E_REG</name>
    <value>
      SELECT   /*+ NO_INDEX(A INDX_PROFILE41) */
      a.system_id,
      a.docnumber,
      a.docname,
      a.status,
      a.docserver_loc,
      a.PATH,
      @creationDate@ AS creation_date,
      @creationTime@ as creation_time,
      a.id_registro,
      a.cha_tipo_proto,
      a.id_oggetto,
      a.num_proto,
      a.num_anno_proto,
      a.var_proto_eme,
      @dta_proto_eme@ as dta_proto_eme,
      a.cha_assegnato,
      a.var_cognome_eme,
      a.var_nome_eme,
      a.id_parent,
      @dta_proto@ as dta_proto,
      a.cha_mod_oggetto,
      a.cha_mod_mitt_dest,
      a.cha_mod_mitt_int,
      a.var_proto_in,
      a.id_annullatore,
      a.var_aut_annulla,
      a.cha_invio_conferma,
      @dta_proto_in@ as dta_proto_in,
      @dta_annulla@ as dta_annulla,
      a.var_segnatura,
      a.cha_da_proto,
      a.var_note,
      a.cha_fascicolato,
      a.id_tipo_atto,
      a.cha_privato,
      a.cha_evidenza,
      a.var_prof_oggetto AS var_desc_oggetto,
      a.id_people_prot,
      a.id_ruolo_prot,
      a.id_uo_prot,
      '255' as accessrights,
      d.type_id,
      d.description,
      d.system_id AS sys_doctypes,
      a.author,
      a.id_ruolo_creatore,
      a.id_uo_creatore,
      a.cha_interop,
      a.dta_scadenza,
      a.cha_personale,
      a.cha_in_cestino,
      a.id_documento_principale,
      a.prot_tit,
      a.num_in_fasc,
      a.id_fasc_prot_tit,
      a.num_prot_tit,
      a.id_titolario,
      a.cha_riff_mitt,
      a.id_people_delegato,
      a.CHA_DOCUMENTO_DA_PEC,
      a.LAST_FORWARD,
      a.PRINTS_NUM,
      a.CHA_COD_T_A,
      <!--GIORDANO IACOZZILLI Gestione dell'icona della copia del docuemnto/fascicolo in deposito.-->
      A.CHA_IN_ARCHIVIO,
      <!--**************************************  FINE  ******************************************-->
      a.COD_EXT_APP,
      a.IN_LIBROFIRMA
      FROM PROFILE a,
      DOCUMENTTYPES d
      WHERE @docNumber@ and
      a.documenttype=d.system_id
    </value>
  </query>
  <query>
    <name>D_DELETE_PROFILE_FROM_DOCNUMER</name>
    <value>
      delete from profile where docnumber = @docNumer@
    </value>
  </query>
  <query>
    <name>D_DELETE_PROFILE_FROM_COMPONENTS</name>
    <value>
      delete from components where docnumber = @docNumer@
    </value>
  </query>
  <query>
    <name>D_DELETE_PROFILE_FROM_VERSIONS</name>
    <value>
      delete from versions where docnumber = @docNumer@
    </value>
  </query>
  <query>
    <name>D_DELETE_PROFILE_FROM_DOCARRIVOPAR</name>
    <value>
      delete from dpa_doc_arrivo_par where id_profile = @docNumer@
    </value>
  </query>
  <query>
    <name>D_DELETE_PROFILE_FROM_DPA_NOTE</name>
    <value>
      delete from dpa_note where tipooggettoassociato = 'D' and idoggettoassociato= @docNumer@
    </value>
  </query>

  <query>
    <name>S_GET_APPLICATION_NAME</name>
    <value>
      SELECT TOP 1 ID_VERSIONS_U
      FROM DPA_DOCSPA
      ORDER BY SYSTEM_ID DESC
    </value>
  </query>
  <query>
    <name>S_GET_LOGIN_MESSAGE</name>
    <value>
      select top 1 var_messaggio_login from dpa_docspa
      order by system_id desc
    </value>
  </query>
  <query>
    <name>U_LOGIN_MESSAGE</name>
    <value>
      UPDATE dpa_docspa
      SET VAR_MESSAGGIO_LOGIN='@msg@'
      where system_id = (select max(system_id) from dpa_docspa)
    </value>
  </query>
  <query>
    <name>GET_TIPO_COMPONENTI</name>
    <value>
      SELECT CHA_TIPO_COMPONENTI, DESCRIZIONE FROM TIPO_COMPONENTI
    </value>
  </query>
  <query>
    <name>S_PEOPLE_CENTRO_SERVIZI_GLOBALI</name>
    <value>
      SELECT @param1@
      FROM PEOPLE P, DPA_CORR_GLOBALI A
      WHERE @param2@
      --AND P.ABILITATO_CENTRO_SERVIZI ='1' AND A.ID_PEOPLE = P.SYSTEM_ID AND A.ID_AMM = P.ID_AMM
      AND (P.ABILITATO_CENTRO_SERVIZI ='1' OR P.ABILITATO_ESIBIZIONE = '1') AND A.ID_PEOPLE = P.SYSTEM_ID AND A.ID_AMM = P.ID_AMM
    </value>
  </query>
  <query>
    <name>S_People_GLOBALI</name>
    <value>
      SELECT @param1@
      FROM PEOPLE P WITH (nolock), DPA_CORR_GLOBALI A WITH (nolock)
      WHERE @param2@ AND NOT(P.DISABLED='Y') AND A.ID_PEOPLE = P.SYSTEM_ID AND A.ID_AMM = P.ID_AMM
    </value>
  </query>
  <query>
    <name>S_CORRESPONDENT_DETAILS</name>
    <value>
      SELECT  SYSTEM_ID, ID_CORR_GLOBALI, VAR_INDIRIZZO, VAR_CAP, VAR_PROVINCIA
      , VAR_NAZIONE, VAR_TELEFONO, VAR_TELEFONO2, VAR_FAX, VAR_NOTE, VAR_COD_FISC
      , VAR_CITTA, VAR_LOCALITA, VAR_LUOGO_NASCITA, DTA_NASCITA
      , VAR_TITOLO, VAR_COD_PI, VAR_COD_IPA, VAR_COD_FISCALE
      FROM  DPA_DETT_GLOBALI
      WHERE ID_CORR_GLOBALI=@param1@
    </value>
  </query>
  <query>
    <name>PD_GET_TEMPLATES_DOC_LITE_BY_ROLE</name>
    <value>
      SELECT distinct  d.system_id, d.var_desc_atto, di.ID_DIAGRAMMA
      FROM dpa_vis_tipo_doc vis , dpa_tipo_atto d LEFT JOIN dpa_ass_diagrammi di ON di.ID_TIPO_DOC= d.SYSTEM_ID
      WHERE id_amm = @idAmm@
      AND abilitato_si_no = '1'
      AND d.SYSTEM_ID= vis.ID_TIPO_DOC
      AND vis.ID_RUOLO = @idRuolo@
      AND vis.DIRITTI != '0'
      ORDER BY d.var_desc_atto
    </value>
  </query>
  <query>
    <name>PD_GET_TEMPLATES_FASC_LITE_BY_ROLE</name>
    <value>
      SELECT distinct  d.system_id, d.var_desc_fasc, di.ID_DIAGRAMMA
      FROM dpa_vis_tipo_fasc vis , dpa_tipo_fasc d LEFT JOIN dpa_ass_diagrammi di ON di.ID_TIPO_FASC= d.SYSTEM_ID
      WHERE id_amm = @idAmm@
      AND abilitato_si_no = '1'
      AND d.SYSTEM_ID= vis.ID_TIPO_FASC
      AND vis.ID_RUOLO = @idRuolo@
      AND vis.DIRITTI != '0'
      ORDER BY d.var_desc_fasc
    </value>
  </query>
  <query>
    <name>S_LOG_FASC_FILTER</name>
    <value>
      SELECT *
      FROM
      (
      SELECT distinct(A.SYSTEM_ID), A.USERID_OPERATORE, A.ID_PEOPLE_OPERATORE,@dbuser@.getpeoplename(id_people_operatore) AS people_Desc,
      A.DTA_AZIONE AS DTA_AZIONE, A.ID_GRUPPO_OPERATORE, @dbuser@.getdescruolo(A.ID_GRUPPO_OPERATORE) AS RUOLO_DESC,A.ID_AMM,
      A.VAR_DESC_OGGETTO, A.VAR_COD_AZIONE,A.VAR_DESC_AZIONE,A.CHA_ESITO,A.DESC_PRODUCER
      FROM DPA_LOG A, DPA_ANAGRAFICA_LOG B, DPA_LOG_ATTIVATI C
      WHERE @param1@
      AND A.VAR_OGGETTO IN ('FOLDER', 'FASCICOLO')
      AND A.VAR_COD_AZIONE = B.VAR_CODICE
      AND B.SYSTEM_ID = C.SYSTEM_ID_ANAGRAFICA
      @param3@
      UNION ALL
      SELECT distinct(A.SYSTEM_ID), A.USERID_OPERATORE, A.ID_PEOPLE_OPERATORE,@dbuser@.getpeoplename(id_people_operatore) AS people_Desc,
      A.DTA_AZIONE AS DTA_AZIONE, A.ID_GRUPPO_OPERATORE,@dbuser@.getdescruolo(A.ID_GRUPPO_OPERATORE) AS RUOLO_DESC,A.ID_AMM,
      A.VAR_DESC_OGGETTO, A.VAR_COD_AZIONE,A.VAR_DESC_AZIONE,A.CHA_ESITO,A.DESC_PRODUCER
      FROM DPA_LOG_STORICO A, DPA_ANAGRAFICA_LOG B, DPA_LOG_ATTIVATI C
      WHERE @param1@
      AND A.VAR_OGGETTO IN ('FOLDER', 'FASCICOLO')
      AND A.VAR_COD_AZIONE = B.VAR_CODICE
      AND B.SYSTEM_ID = C.SYSTEM_ID_ANAGRAFICA
      @param3@
      ) A
      ORDER BY A.SYSTEM_ID DESC
    </value>
  </query>
  <query>
    <name>S_LOG_DOC_FILTER</name>
    <value>
      SELECT *
      FROM
      (
      SELECT distinct(A.SYSTEM_ID), A.USERID_OPERATORE, A.ID_PEOPLE_OPERATORE,@docsadm@.getpeoplename(id_people_operatore) people_Desc,
      A.DTA_AZIONE AS DTA_AZIONE, @docsadm@.getdescruolo(A.ID_GRUPPO_OPERATORE) RUOLO_DESC,A.ID_AMM,
      A.VAR_DESC_OGGETTO, A.VAR_COD_AZIONE,A.CHA_ESITO, A.VAR_DESC_AZIONE
      FROM DPA_LOG A, DPA_ANAGRAFICA_LOG B, DPA_LOG_ATTIVATI C
      WHERE A.ID_OGGETTO = '@param1@'
      AND A.VAR_OGGETTO = '@param2@'
      AND A.VAR_COD_AZIONE &lt;&gt; 'OPEN_DET_DOC'
      AND A.VAR_COD_AZIONE = B.VAR_CODICE
      AND B.SYSTEM_ID = C.SYSTEM_ID_ANAGRAFICA
      @param3@
      UNION ALL
      SELECT distinct(A.SYSTEM_ID), A.USERID_OPERATORE, A.ID_PEOPLE_OPERATORE,@docsadm@.getpeoplename(id_people_operatore) people_Desc,
      A.DTA_AZIONE AS DTA_AZIONE, @docsadm@.getdescruolo(A.ID_GRUPPO_OPERATORE) RUOLO_DESC, A.ID_AMM,
      A.VAR_DESC_OGGETTO, A.VAR_COD_AZIONE,A.CHA_ESITO, A.VAR_DESC_AZIONE
      FROM DPA_LOG_STORICO A, DPA_ANAGRAFICA_LOG B, DPA_LOG_ATTIVATI C
      WHERE A.ID_OGGETTO = '@param1@'
      AND A.VAR_OGGETTO = '@param2@'
      AND A.VAR_COD_AZIONE &lt;&gt; 'OPEN_DET_DOC'
      AND A.VAR_COD_AZIONE = B.VAR_CODICE
      AND B.SYSTEM_ID = C.SYSTEM_ID_ANAGRAFICA
      @param3@
      ) A
      ORDER BY A.SYSTEM_ID DESC
    </value>

  </query>
  <query>
    <name>S_GET_DOCUMENT_TAB</name>
    <value>
      Select (
      SELECT COUNT (b.Project_id)
      FROM project_components b
      WHERE b.LINK = @documentId@) AS prj,
      (SELECT COUNT (a.system_id)
      FROM dpa_trasmissione a
      WHERE a.id_profile = @documentId@) AS trans,
      (SELECT COUNT(*)
      FROM DELETED_SECURITY s
      WHERE THING = @documentId@
      And Not Exists (Select 'x' From security sec Where sec.thing = s.thing And sec.accessrights > 20 And sec.personorgroup = s.personorgroup)) as deleteSecurity
    </value>
  </query>

  <!--laura 21 febbraio 2013 inserimento parametri @dbUser@, @idAmm, e nome tabella-->
  <query>
    <name>S_GET_SECURITY_PROFILE_SEMPL_WITH_FILTERS</name>
    <value>
      SELECT   *
      FROM (SELECT a.system_id, a.var_cod_rubrica, a.id_amm, a.var_desc_corr,
      b.cha_tipo_diritto as cha_tipo_diritto, a.id_people, a.id_gruppo, b.accessrights as accessrights,
      a.id_uo, a.cha_tipo_corr, a.cha_tipo_ie, a.cha_tipo_urp,
      @dbUser@.descuo (a.id_uo) AS desc_uo, a.cha_system_role as diSistema,
      @dbUser@.getcodrubricacorr (a.id_uo) AS var_cod_uo, b.ts_inserimento,
      b.var_note_sec as note,b.PERSONORGROUP,
      (SELECT COUNT (*)
      FROM dpa_role_history
      WHERE original_corr_id = a.original_id
      AND action != 'C') AS showhistory,
      a.dta_fine, '0' AS rimosso,
      (CASE
      WHEN b.accessrights = 0
      THEN 256
      ELSE b.accessrights
      END
      ) AS orderAcc,
      --Aggiunto per Ordinamento MEV ACL
      (CASE
      WHEN b.accessrights = 0 THEN 256 --Proprietario
      WHEN b.accessrights = 63 AND b.CHA_TIPO_DIRITTO = 'A' AND b.VAR_NOTE_SEC IS NULL THEN 63 -- Acquisito
      WHEN b.accessrights = 45 AND b.CHA_TIPO_DIRITTO = 'A' AND b.VAR_NOTE_SEC IS NULL THEN 45 -- Acquisito
      WHEN b.CHA_TIPO_DIRITTO = 'T' THEN 35 --Trasmesso
      WHEN b.CHA_TIPO_DIRITTO = 'F' THEN 30 --Inserimento in Fascicolo
      WHEN b.accessrights = 20 AND b.CHA_TIPO_DIRITTO = 'A' THEN 15 --Attesa di Accettazione
      --WHEN b.CHA_TIPO_DIRITTO = 'A' AND b.accessrights = 20 AND b.VAR_NOTE_SEC = 'ACQUISITO PER COPIA VISIBILITA' THEN 10 --Acquisito per copia Visibilita
      WHEN b.CHA_TIPO_DIRITTO = 'A' AND b.VAR_NOTE_SEC = 'ACQUISITO PER COPIA VISIBILITA' THEN 10 --Acquisito per copia Visibilita
      ELSE b.accessrights
      END
      ) AS orderTipo
      --End MEV
      FROM dpa_corr_globali a, security b
      WHERE a.id_amm = @idAmm@
      AND (   a.id_people = b.personorgroup
      OR a.id_gruppo = b.personorgroup
      )
      AND b.thing = @idProfile@
      @query1@
      UNION
      SELECT a.system_id, a.var_cod_rubrica, a.id_amm, a.var_desc_corr,
      d.cha_tipo_diritto as cha_tipo_diritto, a.id_people, a.id_gruppo, d.accessrights as accessrights,
      a.id_uo, a.cha_tipo_corr, a.cha_tipo_ie, a.cha_tipo_urp,
      @dbUser@.descuo (a.id_uo) AS desc_uo, a.cha_system_role as diSistema,
      @dbUser@.getcodrubricacorr (a.id_uo) AS var_cod_uo, d.dta_revoca,
      d.note as note,d.PERSONORGROUP,
      (SELECT COUNT (*)
      FROM dpa_role_history
      WHERE original_corr_id = a.original_id
      AND action != 'C') AS showhistory,
      a.dta_fine, '1' AS rimosso,
      (CASE
      WHEN d.accessrights = 0
      THEN 256
      ELSE d.accessrights
      END
      ) AS orderAcc,

      -- Mev Editing ACL
      (CASE
      WHEN d.accessrights = 0 THEN 256
      ELSE d.accessrights
      END
      ) AS orderTipo
      -- End MEV

      FROM dpa_corr_globali a, deleted_security d
      WHERE a.id_amm = @idAmm@
      AND (   a.id_people = d.personorgroup
      OR a.id_gruppo = d.personorgroup
      )
      AND d.thing = @idProfile@
      @query2@
      ) e
      ORDER BY rimosso asc,

      --MEV Editing ACL
      orderTipo DESC,
      --decode(cha_tipo_diritto,'P','A',
      --'A','B',
      --'T','C',
      --'F','F') asc,
      --End MEV

      orderAcc desc,
      cha_tipo_urp desc
    </value>
  </query>

  <query>
    <name>S_FILTRO_RIC_OB_DOCSPA</name>
    <value>
      SELECT
      DISTINCT A.system_id as ID, A.var_codice as CODICE, A.description as DESCRIZIONE, A.num_livello as LIVELLO, A.id_parent as IDPARENT
      FROM OBIETTIVI A  @paramFrom@
      WHERE
      A.cha_tipo_proj = 'T'
      @param1@
      @param2@
      AND A.id_amm = @param3@
      AND (A.id_registro is null or A.id_registro = @param5@)
      AND ID_OBIETTIVO = @param6@
      @paramNote@
      @paramIndice@
      ORDER BY num_livello
    </value>
  </query>
  <query>
    <name>S_GET_DESCRIZIONE_OBIETTIVO_BY_CODICE</name>
    <value>
      SELECT
      DISTINCT A.description as DESCRIZIONE
      FROM OBIETTIVI A
      WHERE A.var_codice = '@param1@'
      AND A.id_amm = @param2@
      AND (A.id_registro is null or A.id_registro = @param3@)
      AND ID_OBIETTIVO in (select system_id from obiettivi where cha_stato = 'A' and num_livello = 0)
    </value>
  </query>
  <query>
    <name>S_GET_ID_OBIETTIVO_BY_CODICE</name>
    <value>
      SELECT
      DISTINCT A.System_id as ID
      FROM OBIETTIVI A
      WHERE A.var_codice = '@param1@'
      AND A.id_amm = @param2@
      AND (A.id_registro is null or A.id_registro = @param3@)
      AND ID_OBIETTIVO in (select system_id from obiettivi where cha_stato = 'A' and num_livello = 0)
    </value>
  </query>
  <query>
    <name>AMM_S_GET_COUNT_DOCUMENTI_OBIETTIVO</name>
    <value>
      SELECT	COUNT(*)
      FROM 	PROFILE PR
      WHERE	PR.ID_OBIETTIVO=@idObiettivo@
    </value>
  </query>
  <query>
    <name>OBIETTIVO_BY_SYSTEM_ID</name>
    <value>
      SELECT O.*, A.VAR_CODICE_AMM FROM OBIETTIVI O, DPA_AMMINISTRA A
      WHERE O.SYSTEM_ID = @systemId@ AND O.ID_AMM = A.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>OBIETTIVO_GET_ALL</name>
    <value>
      SELECT DISTINCT
      (select var_codice from DPA_EL_REGISTRI where SYSTEM_ID = a.ID_REGISTRO) as CODICEAOO,
      (select var_desc_registro from DPA_EL_REGISTRI where SYSTEM_ID = a.ID_REGISTRO) as AOO,
      a.system_id as IDRECORD,
      a.var_codice as CODICE,
      a.description as DESCRIZIONE,
      a.num_livello as LIVELLO,
      a.id_registro as REGISTRO,
      a.id_parent as IDPARENT,
      a.var_cod_liv1 as CODLIV,
      cha_rw as RW,(SELECT count(b.system_id)
      FROM OBIETTIVI b
      WHERE b.id_amm = @idAmministrazione@
      AND b.id_parent = a.system_id
      ) as FIGLIO,
      a.NUM_MESI_CONSERVAZIONE as NUMMESICONSERVAZIONE,
      a.ID_TIPO_FASC,
      a.CHA_BLOCCA_FASC,
      a.ID_OBIETTIVO,
      a.CHA_STATO,
      a.DTA_ATTIVAZIONE,
      a.DTA_CESSAZIONE,
      a.VAR_NOTE,
      a.CHA_BLOCCA_FIGLI,
      a.CHA_CONTA_PROT_TIT,
      a.NUM_PROT_TIT,
      a.CHA_CONSENTI_CLASS
      FROM  OBIETTIVI a
      WHERE a.id_amm = @idAmministrazione@
      AND a.id_parent = @idParentObiettivo@
      ORDER BY AOO
    </value>
  </query>
  <query>
    <name>S_FILTRO_RIC_OB</name>
    <value>
      SELECT
      system_id as ID, var_codice as CODICE, description as DESCRIZIONE, num_livello as LIVELLO, id_parent as IDPARENT, id_obiettivo as IDOBIETTIVO
      FROM OBIETTIVI
      @param1@
      @param2@
      AND id_amm = @param3@
      ORDER BY num_livello,var_cod_liv1
    </value>
  </query>
  <query>
    <name>S_NODO_PADRE_OBIETTIVO</name>
    <value>
      SELECT
      id_parent as PADRE
      FROM OBIETTIVI
      WHERE system_id = @param1@
    </value>
  </query>
  <query>
    <name>AMM_S_GET_NODI_RUOLO_OBIETTIVO</name>
    <value>
      SELECT DISTINCT
      C.id_gruppo AS ID_RUOLO,
      C.var_codice AS CODICE_RUOLO,
      C.var_desc_corr AS DESCRIZIONE_RUOLO,
      S.personorgroup AS GRUPPOASSOCIATO
      FROM 	   	DPA_CORR_GLOBALI C LEFT OUTER JOIN
      (SELECT personorgroup FROM SECURITY  WITH (nolock)  WHERE thing = @idNodoObiettivo@ AND accessrights IN(255,47,63)) S
      ON C.id_gruppo = S.personorgroup,
      DPA_L_RUOLO_REG RR
      WHERE 		RR.ID_RUOLO_IN_UO=C.system_id AND
      RR.ID_REGISTRO @idRegistro@ AND
      C.DTA_FINE IS NULL
      ORDER BY	C.var_desc_corr
    </value>
  </query>
  <query>
    <name>GET_NODI_OBIETTIVO</name>
    <value>
      SELECT * FROM OBIETTIVI O, DPA_AMMINISTRA A
      WHERE A.SYSTEM_ID = O.ID_AMM AND O.ID_OBIETTIVO = @idObiettivo@
    </value>
  </query>
  <query>
    <name>GET_NODO_OBIETTIVO</name>
    <value>
      SELECT * FROM OBIETTIVO O, DPA_AMMINISTRA A
      WHERE A.SYSTEM_ID = O.ID_AMM AND P.SYSTEM_ID = @idObiettivo@
    </value>
  </query>
  <query>
    <name>AMM_S_GET_ID_OBIETTIVO_PADRE</name>
    <value>
      SELECT O.ID_PARENT, O.NUM_LIVELLO
      FROM   OBIETTIVI O
      WHERE  O.SYSTEM_ID=@idObiettivo@
    </value>
  </query>
  <query>
    <name>AMM_EXIST_RUOLO_IN_OBIETTIVO</name>
    <value>
      SELECT  COUNT(S.THING)
      FROM 	SECURITY as S
      WHERE	S.THING=@idObiettivo@ AND
      PERSONORGROUP=@idGruppo@
    </value>
  </query>
  <query>
    <name>AMM_EXIST_RUOLO_IN_OBIETTIVO_FIGLIO</name>
    <value>
      SELECT  COUNT(S.THING)
      FROM 	SECURITY as S
      WHERE	S.THING IN
      (
      SELECT O.SYSTEM_ID
      FROM   OBIETTIVI O
      WHERE  O.ID_PARENT=@idObiettivo@)
      AND PERSONORGROUP=@idGruppo@
    </value>
  </query>
  <query>
    <name>AMM_U_NODO_OBIETTIVO</name>
    <value>
      UPDATE	OBIETTIVI
      SET 	DESCRIPTION=@Descrizione@,
      CHA_RW=@CreazioneFascicoliAbilitata@,
      ID_REGISTRO=@IDRegistro@,
      NUM_MESI_CONSERVAZIONE=@NumeroMesiConservazione@,
      ID_TIPO_FASC=@idTipoFascicolo@,
      CHA_BLOCCA_FASC = @bloccaFascicolo@,
      VAR_NOTE = @note@,
      CHA_BLOCCA_FIGLI = @bloccaFigli@,
      CHA_CONTA_PROT_TIT = @contatoreAttivo@,
      CHA_CONSENTI_CLASS = @bloccaClass@
      @numProtTit@
      WHERE	SYSTEM_ID=@IDObiettivo@
    </value>
  </query>
  <query>
    <name>AMM_S_IS_RUOLO_OWNER_DOCUMENTI_OBIETTIVO</name>
    <value>
      SELECT COUNT(S.THING)
      FROM   SECURITY as S  ,
      PROJECT_COMPONENTS PC
      WHERE  S.THING=PC.LINK AND
      S.PERSONORGROUP IN
      (
      SELECT PEOPLE_SYSTEM_ID
      FROM   PEOPLEGROUPS
      WHERE  GROUPS_SYSTEM_ID=@idRuolo@
      ) AND
      PC.PROJECT_ID=
      (
      SELECT SYSTEM_ID
      FROM PROJECT
      WHERE ID_PARENT=
      (SELECT SYSTEM_ID
      FROM PROJECT
      WHERE ID_PARENT=@idTitolario@ AND
      CHA_TIPO_PROJ='F' AND
      CHA_TIPO_FASCICOLO='G') AND
      CHA_TIPO_PROJ='C'
      ) AND
      PC.TYPE='D'
      AND S.THING IN
      (SELECT DISTINCT PR.SYSTEM_ID FROM PROFILE PR WITH(NOLOCK),
      SECURITY as SE  WITH (nolock)  WHERE SE.PERSONORGROUP = PR.ID_PEOPLE_PROT
      AND PR.ID_RUOLO_CREATORE = (SELECT SYSTEM_ID FROM DPA_CORR_GLOBALI WHERE VAR_COD_RUBRICA = '@idRuoloCreatore@'))
    </value>
  </query>
  <query>
    <name>AMM_S_VISIBILITA_NODO_OBIETTIVO_RUOLI</name>
    <value>
      SELECT * FROM SECURITY  WITH (nolock)
      WHERE THING = @thing@
      AND PERSONORGROUP = @personorgroup@
      AND ACCESSRIGHTS = 255
      AND CHA_TIPO_DIRITTO = 'P'
    </value>
  </query>
  <query>
    <name>GET_CDC_ALL</name>
    <value>
      SELECT var_desc_corr as DESCR_UO,
      var_cod_rubrica as COD_UO,
      CDC_CODICE,
      system_id as ID_CORR_GLOBALI
      FROM  DPA_CORR_GLOBALI WITH (nolock)
      WHERE
      (CDC_CODICE != 'NULL')
      @param1@
    </value>
  </query>
  <query>
    <name>GET_CDC_BY_CODICE</name>
    <value>
      SELECT var_desc_corr as DESCR_UO,
      var_cod_rubrica as COD_UO,
      CDC_CODICE,
      system_id as ID_CORR_GLOBALI
      FROM  DPA_CORR_GLOBALI WITH (nolock)
      WHERE CDC_CODICE = '@CodiceCDC@'
      @Storico@
    </value>
  </query>
  <query>
    <name>GET_CDC_BY_IDCORRGLOB</name>
    <value>
      SELECT var_desc_corr as DESCR_UO,
      var_cod_rubrica as COD_UO,
      CDC_CODICE,
      system_id as ID_CORR_GLOBALI
      FROM  DPA_CORR_GLOBALI WITH (nolock)
      WHERE SYSTEM_ID = @IDCorrGlob@
    </value>
  </query>
  <query>
    <name>GET_CDC_BY_COD_RUBRICA</name>
    <value>
      SELECT
      DC.var_desc_corr as DESCR_UO_DC,
      A.var_desc_corr as DESCR_UO_Area,
      T.var_desc_corr as DESCR_UO_Team,
      DC.var_cod_rubrica as COD_UO_DC,
      A.var_cod_rubrica as  COD_UO_Area,
      T.var_cod_rubrica as COD_UO_Team,
      DC.CDC_CODICE as CODICE_CDC_DC,
      A.CDC_CODICE as CODICE_CDC_Area,
      T.CDC_CODICE as CODICE_CDC_Team,
      DC.system_id as system_id_DC,
      A.system_id  as system_id_Area,
      T.system_id as system_id_Team
      FROM DPA_CORR_GLOBALI as DC  WITH (nolock) ,
      DPA_CORR_GLOBALI as A  WITH (nolock) ,
      DPA_CORR_GLOBALI  as T  WITH (nolock)
      WHERE
      (DC.dta_fine is null AND  A.dta_fine is null AND  T.dta_fine is null) AND
      (DC.CHA_TIPO_URP='U' AND A.CHA_TIPO_URP='U' AND T.CHA_TIPO_URP='U') AND
      (DC.cha_tipo_ie='I'  AND A.cha_tipo_ie='I'  AND T.cha_tipo_ie='I' ) AND
      DC.SYSTEM_ID = A.ID_PARENT AND
      A.SYSTEM_ID = T.ID_PARENT AND
      (DC.CDC_CODICE != 'NULL')
      AND (DC.VAR_COD_RUBRICA = 'TEST APP' or A.VAR_COD_RUBRICA = 'TEST APP' or T.VAR_COD_RUBRICA = 'TEST APP')

    </value>
  </query>
  <query>
    <name>GET_TIPI_COMUNICAZIONE</name>
    <value>
      SELECT DISTINCT
      A.[ID_TIPO_COMUNICAZIONE]
      ,A.[DESCRIZIONE]
      FROM DPA_TIPO_COMUNICAZIONE A
      @param1@
    </value>
  </query>
  <query>
    <name>AMM_D_DELETE_OBIETTIVO_IN_SECURITY</name>
    <value>
      DELETE
      FROM	SECURITY
      WHERE	THING=@idObiettivo@
    </value>
  </query>
  <query>
    <name>AMM_D_DELETE_NODO_OBIETTIVO</name>
    <value>
      DELETE
      FROM  	OBIETTIVI
      WHERE	SYSTEM_ID=@idObiettivo@
    </value>
  </query>
  <query>
    <name>OBIETTIVO_DELETE_2</name>
    <value>
      DELETE FROM OBIETTIVI
      WHERE
      system_id = @idObiettivo@
    </value>
  </query>
  <query>
    <name>S_NODI_OBIETTIVO</name>
    <value>
      SELECT system_id FROM OBIETTIVI WHERE
      ID_OBIETTIVO = @idObiettivo@
      AND
      ID_AMM = @idAmm@
    </value>
  </query>
  <query>
    <name>AMM_D_DELETE_OBIETTIVO_IN_SECURITY</name>
    <value>
      DELETE
      FROM	SECURITY
      WHERE	THING=@idObiettivo@
    </value>
  </query>
  <query>
    <name>AMM_S_EXIST_CODICE_OBIETTIVO</name>
    <value>
      SELECT	SYSTEM_ID
      FROM	OBIETTIVI
      WHERE	VAR_CODICE = '@codiceObiettivo@'
      AND ID_AMM = @idAmministrazione@
      AND (ID_REGISTRO IS NULL OR ID_REGISTRO = @idRegistro@)
      AND ID_OBIETTIVO = @idObiettivo@
    </value>
  </query>
  <query>
    <name>S_SECURITY_GENERIC_OBIETTIVO</name>
    <value>
      SELECT @param1@
      FROM SECURITY  WITH (nolock)
      @param2@
    </value>
  </query>
  <query>
    <name>S_VISIB_RUOLO_NODI_OBIETTIVO</name>
    <value>
      SELECT
      p.system_id as IDRECORD,
      p.var_codice as CODICE,
      p.description as DESCRIZIONE,
      p.num_livello as LIVELLO,
      p.var_cod_liv1 as CODLIV,
      p.id_parent as IDPARENT
      FROM OBIETTIVI o, SECURITY as s  WITH (nolock)
      WHERE o.system_id = s.THING
      AND s.accessrights IN (255,47,63)
      AND s.PERSONORGROUP = @idgruppo@
      ORDER BY p.var_cod_liv1
    </value>
  </query>
  <query>
    <name>AMM_S_NODO_OBIETTIVO_PADRI</name>
    <value>
      select a.system_id as IDRECORD,
      a.var_codice as CODICE,
      a.description as DESCRIZIONE,
      a.num_livello as LIVELLO,
      a.id_registro as REGISTRO,
      a.id_parent as IDPARENT,
      a.var_cod_liv1 as CODLIV,
      a.cha_rw as RW,(SELECT count(b.system_id)
      FROM OBIETTIVI b
      WHERE b.id_amm = @idamm@
      AND b.id_parent = a.system_id
      ) as FIGLIO,
      a.NUM_MESI_CONSERVAZIONE as NUMMESICONSERVAZIONE,
      a.ID_TIPO_FASC,
      a.CHA_BLOCCA_FASC,
      a.ID_OBIETTIVO,
      a.CHA_STATO,
      a.DTA_ATTIVAZIONE,
      a.DTA_CESSAZIONE,
      a.VAR_NOTE,
      a.CHA_BLOCCA_FIGLI,
      a.CHA_CONTA_PROT_TIT,
      a.NUM_PROT_TIT,
      a.CHA_CONSENTI_CLASS from OBIETTIVI a where a.ID_AMM=@idamm@ and a.ID_PARENT = @idparent@ and a.SYSTEM_ID in (

      select distinct(a.ID_OBIETTIVO) from
      (
      select * from OBIETTIVI where @condreg@ CHA_STATO is null
      ) as a )

      union (select a.system_id as IDRECORD,
      a.var_codice as CODICE,
      a.description as DESCRIZIONE,
      a.num_livello as LIVELLO,
      a.id_registro as REGISTRO,
      a.id_parent as IDPARENT,
      a.var_cod_liv1 as CODLIV,
      a.cha_rw as RW,(SELECT count(b.system_id)
      FROM OBIETTIVI b
      WHERE b.id_amm = @idamm@
      AND b.id_parent = a.system_id
      ) as FIGLIO,
      a.NUM_MESI_CONSERVAZIONE as NUMMESICONSERVAZIONE,
      a.ID_TIPO_FASC,
      a.CHA_BLOCCA_FASC,
      a.ID_OBIETTIVO,
      a.CHA_STATO,
      a.DTA_ATTIVAZIONE,
      a.DTA_CESSAZIONE,
      a.VAR_NOTE,
      a.CHA_BLOCCA_FIGLI,
      a.CHA_CONTA_PROT_TIT,
      a.NUM_PROT_TIT,
      a.CHA_CONSENTI_CLASS from OBIETTIVI a where a.CHA_STATO = 'D')
    </value>
  </query>
  <query>
    <name>AMM_S_NODO_OBIETTIVO</name>
    <value>
      SELECT DISTINCT
      a.system_id as IDRECORD,
      a.var_codice as CODICE,
      a.description as DESCRIZIONE,
      a.num_livello as LIVELLO,
      a.id_registro as REGISTRO,
      a.id_parent as IDPARENT,
      a.var_cod_liv1 as CODLIV,
      cha_rw as RW,(SELECT count(b.system_id)
      FROM OBIETTIVI b
      WHERE b.id_amm = @idAmministrazione@
      AND b.id_parent = a.system_id
      ) as FIGLIO,
      a.NUM_MESI_CONSERVAZIONE as NUMMESICONSERVAZIONE,
      a.ID_TIPO_FASC,
      a.CHA_BLOCCA_FASC,
      a.ID_OBIETTIVO,
      a.CHA_STATO,
      a.DTA_ATTIVAZIONE,
      a.DTA_CESSAZIONE,
      a.VAR_NOTE,
      a.CHA_BLOCCA_FIGLI,
      a.CHA_CONTA_PROT_TIT,
      a.NUM_PROT_TIT,
      a.CHA_CONSENTI_CLASS
      FROM  OBIETTIVI a
      WHERE a.id_amm = @idAmministrazione@
      AND a.id_parent = @idParentObiettivo@
      @param1@
      ORDER BY a.var_cod_liv1
    </value>
  </query>
  <query>
    <name>AMM_S_GET_INFO_NODO_OBIETTIVO_WITH_CHILDS</name>
    <value>
      SELECT 	*
      FROM 	OBIETTIVI P
      WHERE	P.SYSTEM_ID=@idObiettivo@ OR
      P.ID_PARENT IN
      (
      SELECT 	P.SYSTEM_ID
      FROM 	OBIETTIVI P
      WHERE	P.SYSTEM_ID=@idObiettivo@ OR
      P.ID_PARENT=@idObiettivo@
      ) OR
      (P.SYSTEM_ID=@idParentObiettivo@)
    </value>
  </query>
  <query>
    <name>AMM_S_GET_COUNT_DOCUMENTI_OBIETTIVO</name>
    <value>
      SELECT	COUNT(*)
      FROM 	PROFILE PR
      WHERE	PR.ID_OBIETTIVO=@idObiettivo@
    </value>
  </query>
  <query>
    <name>D_DELETE_PROFILE_FROM_DOCNUMER</name>
    <value>
      delete from profile where docnumber = @docNumer@
    </value>
  </query>
  <query>
    <name>AMM_S_GET_RUOLI_IN_OBIETTIVO</name>
    <value>
      SELECT 	S.THING,
      S.PERSONORGROUP,
      S.ACCESSRIGHTS,
      S.CHA_TIPO_DIRITTO
      FROM 	SECURITY  as S  WITH (nolock) , GROUPS G
      WHERE	S.THING=@idObiettivo@ AND
      S.PERSONORGROUP=G.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>D_DELETE_PROFILE_FROM_COMPONENTS</name>
    <value>
      delete from components where docnumber = @docNumer@
    </value>
  </query>
  <query>
    <name>AMM_I_VISIBILITA_NODO_RUOLI_OBIETTIVI</name>
    <value>
      INSERT INTO SECURITY
      (THING, PERSONORGROUP, ACCESSRIGHTS, CHA_TIPO_DIRITTO)
      VALUES
      (@param1@, @param2@, 255, 'P')
    </value>
  </query>
  <query>
    <name>D_DELETE_PROFILE_FROM_VERSIONS</name>
    <value>
      delete from versions where docnumber = @docNumer@
    </value>
  </query>
  <query>
    <name>AMM_D_VISIBILITA_NODO_RUOLI_OBIETTIVI</name>
    <value>
      DELETE
      FROM SECURITY
      WHERE (THING=@param1@ AND PERSONORGROUP=@param2@)
    </value>
  </query>
  <query>
    <name>D_DELETE_PROFILE_FROM_DOCARRIVOPAR</name>
    <value>
      delete from dpa_doc_arrivo_par where id_profile = @docNumer@
    </value>
  </query>
  <query>
    <name>AMM_S_VISIBILITA_NODO_RUOLI_OBIETTIVI</name>
    <value>
      SELECT * FROM SECURITY  WITH (nolock)
      WHERE THING = @thing@
      AND PERSONORGROUP = @personorgroup@
      AND ACCESSRIGHTS = 255
      AND CHA_TIPO_DIRITTO = 'P'
    </value>
  </query>
  <query>
    <name>D_DELETE_PROFILE_FROM_DPA_NOTE</name>
    <value>
      delete from dpa_note where tipooggettoassociato = 'D' and idoggettoassociato= @docNumer@
    </value>
  </query>
  <query>
    <name>OBIETTIVO_INSERT</name>
    <value>
      INSERT INTO OBIETTIVI (
      @colID@
      DESCRIPTION,
      ICONIZED,
      CHA_TIPO_PROJ,
      VAR_CODICE,
      ID_AMM,
      NUM_LIVELLO,
      ID_PARENT,
      VAR_NOTE,
      DTA_APERTURA,
      CHA_STATO,
      VAR_COD_LIV1,
      CHA_RW,
      NUM_MESI_CONSERVAZIONE,
      ID_OBIETTIVO,
      DTA_ATTIVAZIONE,
      MAX_LIV_OB
      )
      VALUES(
      @id@
      '@description@',
      'Y',
      NULL,
      '@varCodice@',
      @idAmm@,
      0,
      0,
      '@varNote@',
      GETDATE(),
      'D',
      '0000',
      'W',
      0,
      0,
      GETDATE(),
      @maxLivOb@
      )
    </value>
  </query>
  <query>
    <name>S_GET_APPLICATION_NAME</name>
    <value>
      SELECT TOP 1 from (
      SELECT ID_VERSIONS_U
      FROM DPA_DOCSPA
      ORDER BY SYSTEM_ID DESC)
    </value>
  </query>
  <query>
    <name>INSERT_STORICO_OBIETTIVO</name>
    <value>
      insert into OBIETTIVI (
      @colID@
      DESCRIPTION,
      ICONIZED,
      CHA_TIPO_PROJ,
      VAR_CODICE,
      ID_AMM,
      NUM_LIVELLO,
      ID_PARENT,
      VAR_NOTE,
      DTA_APERTURA,
      CHA_STATO,
      VAR_COD_LIV1,
      CHA_RW,
      NUM_MESI_CONSERVAZIONE,
      ID_OBIETTIVO,
      DTA_ATTIVAZIONE,
      DTA_CESSAZIONE,
      MAX_LIV_OB
      )
      VALUES(
      @id@
      'Obiettivo Storico',
      'Y',
      NULL,
      (select VAR_CODICE from OBIETTIVI where CHA_STATO='A' and ID_OBIETTIVO=0),
      @idAmm@,
      0,
      0,
      (select VAR_NOTE from OBIETTIVI where CHA_STATO='A' and ID_OBIETTIVO=0),
      GETDATE(),
      'C',
      '0000',
      'W',
      0,
      0,
      GETDATE(),
      GETDATE(),
      (select MAX_LIV_OB from OBIETTIVI where CHA_STATO='A' and ID_OBIETTIVO=0))
    </value>
  </query>
  <query>
    <name>GET_TIPO_COMPONENTI</name>
    <value>
      SELECT CHA_TIPO_COMPONENTI, DESCRIZIONE FROM TIPO_COMPONENTI
    </value>
  </query>
  <query>
    <name>AMM_S_GET_COUNT_RUOLI_IN_OBIETTIVO</name>
    <value>
      SELECT 	COUNT(S.THING)
      FROM 	SECURITY as S , GROUPS G
      WHERE	S.THING=@idObiettivo@ AND
      S.PERSONORGROUP=G.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>S_PEOPLE_CENTRO_SERVIZI_GLOBALI</name>
    <value>
      SELECT @param1@
      FROM PEOPLE P, DPA_CORR_GLOBALI A
      WHERE @param2@ AND P.ABILITATO_CENTRO_SERVIZI ='1' AND A.ID_PEOPLE = P.SYSTEM_ID AND A.ID_AMM = P.ID_AMM
    </value>
  </query>
  <query>
    <name>S_DPATCanaleAllCorrDoc</name>
    <value>
      SELECT d.id_mitt_dest, a.system_id, a.description, a.type_id
      FROM DPA_DOC_ARRIVO_PAR d, DPA_T_CANALE_CORR b, DOCUMENTTYPES a
      where d.id_profile = @idProfile@ and
      (d.cha_tipo_mitt_dest = '@typeDest@' or d.cha_tipo_mitt_dest = 'F') and
      d.id_mitt_dest = b.id_corr_globale and
      b.id_documenttype = a.system_id and
      b.cha_preferito = '1'
    </value>
  </query>
  <query>
    <name>GET_NODO_OBIETTIVO_BY_CODICE</name>
    <value>
      SELECT * FROM OBIETTIVI, DPA_AMMINISTRA
      WHERE
      OBIETTIVI.ID_AMM = DPA_AMMINISTRA.SYSTEM_ID
      AND
      VAR_CODICE = '@codice@'
      AND
      OBIETTIVI.ID_AMM = @idAmm@
      @registro@
      @idObiettivo@
    </value>
  </query>
  <query>
    <name>GET_OBIETTIVO_ATTIVO</name>
    <value>
      SELECT O.*, A.VAR_CODICE_AMM FROM OBIETTIVI O, DPA_AMMINISTRA A
      WHERE
      O.CHA_STATO = 'A'
      AND
      O.ID_AMM = @idAmm@
      AND
      O.ID_OBIETTIVO = 0
      AND
      O.ID_PARENT = 0
      AND
      O.ID_AMM = A.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>S_CORRESPONDENT_DETAILS</name>
    <value>
      SELECT  SYSTEM_ID, ID_CORR_GLOBALI, VAR_INDIRIZZO, VAR_CAP, VAR_PROVINCIA
      , VAR_NAZIONE, VAR_TELEFONO, VAR_TELEFONO2, VAR_FAX, VAR_NOTE, VAR_COD_FISC
      , VAR_CITTA, VAR_LOCALITA, VAR_LUOGO_NASCITA, DTA_NASCITA
      , VAR_TITOLO, VAR_COD_PI, VAR_COD_IPA
      FROM  DPA_DETT_GLOBALI
      WHERE ID_CORR_GLOBALI=@param1@
    </value>
  </query>
  <query>
    <name>S_COD_LIV_OBIETTIVO</name>
    <value>
      SELECT ( case
      when MAX(CONVERT(int,LTRIM(SUBSTRING (CAST(var_cod_liv1 as varchar),LEN(var_cod_liv1)-3, LEN(var_cod_liv1))))) is null
      then 1
      else MAX(CONVERT(int,LTRIM(SUBSTRING (CAST(var_cod_liv1 as varchar),LEN(var_cod_liv1)-3, LEN(var_cod_liv1))))) + 1
      end )as TOT
      FROM OBIETTIVI
      WHERE var_cod_liv1 LIKE '@param1@%'
      AND id_amm = @param2@
      AND num_livello = @param3@
      @param4@
    </value>
  </query>
  <query>
    <name>PD_GET_TEMPLATES_DOC_LITE_BY_ROLE</name>
    <value>
      SELECT distinct  d.system_id, d.var_desc_atto, di.ID_DIAGRAMMA
      FROM dpa_vis_tipo_doc vis , dpa_tipo_atto d LEFT JOIN dpa_ass_diagrammi di ON di.ID_TIPO_DOC= d.SYSTEM_ID
      WHERE id_amm = @idAmm@
      AND abilitato_si_no = '1'
      AND d.SYSTEM_ID= vis.ID_TIPO_DOC
      AND vis.ID_RUOLO = @idRuolo@
      AND vis.DIRITTI != '0'
      ORDER BY d.var_desc_atto
    </value>
  </query>
  <query>
    <name>D_SECURITY_NODO_OB</name>
    <value>
      DELETE FROM SECURITY
      WHERE THING IN
      (
      SELECT system_id
      FROM OBIETTIVI WHERE
      system_id = @param1@
      OR (id_parent = @param1@)
      OR (id_parent =
      (SELECT system_id
      FROM OBIETTIVI
      WHERE id_parent = @param1@ ))
      )
    </value>
  </query>
  <query>
    <name>PD_GET_TEMPLATES_FASC_LITE_BY_ROLE</name>
    <value>
      SELECT distinct  d.system_id, d.var_desc_fasc, di.ID_DIAGRAMMA
      FROM dpa_vis_tipo_fasc vis , dpa_tipo_fasc d LEFT JOIN dpa_ass_diagrammi di ON di.ID_TIPO_FASC= d.SYSTEM_ID
      WHERE id_amm = @idAmm@
      AND abilitato_si_no = '1'
      AND d.SYSTEM_ID= vis.ID_TIPO_FASC
      AND vis.ID_RUOLO = @idRuolo@
      AND vis.DIRITTI != '0'
      ORDER BY d.var_desc_fasc
    </value>
  </query>
  <query>
    <name>D_NODO_OBIETTIVO</name>
    <value>
      DELETE FROM OBIETTIVI
      WHERE system_id = @param1@
      OR (id_parent = @param1@)
      OR (id_parent =
      (SELECT system_id
      FROM OBIETTIVI
      WHERE id_parent = @param1@))
    </value>
  </query>
  <query>
    <name>I_NODO_OBIETTIVO</name>
    <value>
      INSERT INTO OBIETTIVI
      (
      @param1@
      DESCRIPTION,
      ICONIZED,
      CHA_TIPO_PROJ,
      VAR_CODICE,
      ID_AMM,
      ID_REGISTRO,
      NUM_LIVELLO,
      CHA_TIPO_FASCICOLO,
      ID_PARENT,
      VAR_COD_LIV1,
      ETDOC_RANDOM_ID,
      DTA_APERTURA,
      CHA_STATO,
      ID_FASCICOLO,
      CHA_RW,
      DTA_ATTIVAZIONE
      )
      VALUES
      (
      @param2@
      @param3@,
      @param4@,
      @param5@,
      @param6@,
      @param7@,
      @param8@,
      @param9@,
      @param10@,
      @param11@,
      @param12@,
      @param13@,
      @param14@,
      @param15@,
      @param16@,
      @param17@,
      @param18@
      )
    </value>
  </query>
  <query>
    <name>S_TOT_CODICE_OB</name>
    <value>
      SELECT
      COUNT(*) AS TOT
      FROM OBIETTIVI
      WHERE var_codice = '@param1@'
      AND id_amm = @param2@
    </value>
  </query>
  <query>
    <name>S_NODO_BY_COD_OB</name>
    <value>
      SELECT
      SYSTEM_ID, ID_PARENT, NUM_LIVELLO
      FROM OBIETTIVI
      WHERE VAR_CODICE = '@param1@'
      AND ID_AMM = @param2@
      AND (ID_REGISTRO is null or ID_REGISTRO = @param3@)
      AND ID_OBIETTIVO = @param4@
    </value>
  </query>
  <query>
    <name>S_LOG_DOC_FILTER</name>
    <value>
      SELECT *
      FROM
      (
      SELECT distinct(A.SYSTEM_ID), A.USERID_OPERATORE, A.ID_PEOPLE_OPERATORE,@docsadm@.getpeoplename(id_people_operatore) people_Desc,
      A.DTA_AZIONE AS DTA_AZIONE, @docsadm@.getdescruolo(A.ID_GRUPPO_OPERATORE) RUOLO_DESC,A.ID_AMM,
      A.VAR_DESC_OGGETTO, A.VAR_COD_AZIONE,A.CHA_ESITO, A.VAR_DESC_AZIONE
      FROM DPA_LOG A, DPA_ANAGRAFICA_LOG B, DPA_LOG_ATTIVATI C
      WHERE A.ID_OGGETTO = '@param1@'
      AND A.VAR_OGGETTO = '@param2@'
      AND A.VAR_COD_AZIONE &lt;&gt; 'OPEN_DET_DOC'
      AND A.VAR_COD_AZIONE = B.VAR_CODICE
      AND B.SYSTEM_ID = C.SYSTEM_ID_ANAGRAFICA
      @param3@
      UNION ALL
      SELECT distinct(A.SYSTEM_ID), A.USERID_OPERATORE, A.ID_PEOPLE_OPERATORE,@docsadm@.getpeoplename(id_people_operatore) people_Desc,
      A.DTA_AZIONE AS DTA_AZIONE, @docsadm@.getdescruolo(A.ID_GRUPPO_OPERATORE) RUOLO_DESC, A.ID_AMM,
      A.VAR_DESC_OGGETTO, A.VAR_COD_AZIONE,A.CHA_ESITO, A.VAR_DESC_AZIONE
      FROM DPA_LOG_STORICO A, DPA_ANAGRAFICA_LOG B, DPA_LOG_ATTIVATI C
      WHERE A.ID_OGGETTO = '@param1@'
      AND A.VAR_OGGETTO = '@param2@'
      AND A.VAR_COD_AZIONE &lt;&gt; 'OPEN_DET_DOC'
      AND A.VAR_COD_AZIONE = B.VAR_CODICE
      AND B.SYSTEM_ID = C.SYSTEM_ID_ANAGRAFICA
      @param3@
      ) A
      ORDER BY A.SYSTEM_ID DESC
    </value>

  </query>
  <query>
    <name>S_VISIBILITA_NODO_OB_RUOLI</name>
    <value>
      SELECT
      c.id_gruppo AS IDGRUPPO, c.var_desc_corr AS RUOLO, s.personorgroup AS GRUPPOASSOCIATO
      FROM
      DPA_CORR_GLOBALI c LEFT OUTER JOIN
      (SELECT personorgroup FROM SECURITY  WITH (nolock)  WHERE thing = @param1@ AND accessrights IN(255,47,63)) s
      ON c.id_gruppo = s.personorgroup
      WHERE c.cha_tipo_urp = 'R'
      AND c.id_amm = @param2@
      AND c.cha_tipo_ie = 'I'
    </value>
  </query>
  <query>
    <name>S_NODO_OBIETTIVO</name>
    <value>
      SELECT DISTINCT
      a.system_id as IDRECORD,
      a.var_codice as CODICE,
      a.description as DESCRIZIONE,
      a.num_livello as LIVELLO,
      a.id_registro as REGISTRO,
      a.id_parent as IDPARENT,
      a.var_cod_liv1 as CODLIV,
      cha_rw as RW,(SELECT count(b.system_id)
      FROM OBIETTIVI b
      WHERE b.id_amm = @param1@
      AND b.id_parent = a.system_id
      ) as FIGLIO
      FROM OBIETTIVI a
      WHERE a.id_amm = @param1@
      AND a.id_parent = @param2@
      ORDER BY a.var_cod_liv1
    </value>
  </query>
  <query>
    <name>OBIETTIVO_UPDATE</name>
    <value>
      UPDATE OBIETTIVI SET
      VAR_NOTE = '@varNote@',
      DESCRIPTION = '@description@',
      MAX_LIV_OB = @maxLivOb@
      WHERE
      SYSTEM_ID = @systemId@
    </value>
  </query>

  <query>
    <name>S_GET_DOCUMENT_TAB</name>
    <value>
      Select (
      SELECT COUNT (b.Project_id)
      FROM project_components b
      WHERE b.LINK = @documentId@) AS prj,
      (SELECT COUNT (a.system_id)
      FROM dpa_trasmissione a
      WHERE a.id_profile = @documentId@) AS trans
      from dual
    </value>
  </query>
  <!--Laura 25 Febbraio 2013-->
  <query>
    <name>S_RICERCA_ELEMENTI_RUBRICA_PAGING</name>
    <value>
      select * from (select TOP 100 percent ROW_NUMBER() OVER (order by @orderby@) as rn, * from
      (SELECT
      DOCUMENTTYPES.DESCRIPTION as canale, a.var_cod_rubrica, a.var_desc_corr,
      (case when a.CHA_TIPO_IE='I' then 1 else 0 end) AS interno,
      a.cha_tipo_urp, a.system_id, @dbuser@getcodreg(a.ID_REGISTRO) cod_reg_rf, a.ID_REGISTRO, a.CHA_DISABLED_TRASM, a.DTA_FINE,
      a.VAR_NOME, a.VAR_COGNOME, dett.VAR_COD_FISC as VAR_COD_FISC, dett.VAR_COD_PI as VAR_COD_PI
      , a.ID_PEOPLE, a.ID_PEOPLE_LISTE, a.ID_GRUPPO_LISTE
      FROM dpa_corr_globali a LEFT JOIN DPA_DETT_GLOBALI DETT ON DETT.ID_CORR_GLOBALI=a.SYSTEM_ID @param2@
      LEFT JOIN DPA_T_CANALE_CORR ON a.system_id = DPA_T_CANALE_CORR.ID_CORR_GLOBALE
      LEFT JOIN DOCUMENTTYPES ON DPA_T_CANALE_CORR.ID_DOCUMENTTYPE = DOCUMENTTYPES.SYSTEM_ID
      WHERE
      @param1@) as a order by @orderby@) as b
      WHERE RN BETWEEN @startRow@ AND @endRow@
    </value>
  </query>
  <!--Laura 22 Febbraio 2013-->
  <query>
    <name>S_RICERCA_COUNT_ELEMENTI_RUBRICA_PAGING</name>
    <value>
      SELECT COUNT(A.SYSTEM_ID)
      FROM
      (
      SELECT distinct top 100 percent
      A.SYSTEM_ID
      FROM DOCSADM.dpa_corr_globali a LEFT JOIN DOCSADM.DPA_DETT_GLOBALI DETT ON DETT.ID_CORR_GLOBALI=a.SYSTEM_ID @param2@
      LEFT JOIN DPA_T_CANALE_CORR ON a.system_id = DPA_T_CANALE_CORR.ID_CORR_GLOBALE
      LEFT JOIN DOCUMENTTYPES ON DPA_T_CANALE_CORR.ID_DOCUMENTTYPE = DOCUMENTTYPES.SYSTEM_ID
      WHERE @param1@
      ) as a
    </value>
  </query>
  <query>
    <name>S_DAY_YEAR_BEFORE</name>
    <value>
      SELECT CONVERT(VARCHAR,(DATEADD(month, -12, GETDATE())),103) AS DAY
    </value>
  </query>
  <!-- Laura 14 Marzo-->
  <query>
    <name>S_GET_PROJECT_TAB</name>
    <value>
      Select (SELECT COUNT (a.system_id)
      FROM dpa_trasmissione a
      WHERE a.id_project = @projectId@) as trans  ,
      (SELECT COUNT(*)
      FROM DELETED_SECURITY s
      WHERE THING = @projectId@
      And Not Exists (Select 'x' From security sec Where sec.thing = s.thing And sec.accessrights > 20 And sec.personorgroup = s.personorgroup)) as deleteSecurity
    </value>
  </query>
  <query>
    <name>S_REGISTRO_DA_PEC</name>
    <value>
      select @param1@
      from profile p, dpa_ass_doc_mail_interop a, dpa_el_registri e
      where p.SYSTEM_ID = a.ID_PROFILE
      and a.ID_REGISTRO = e.SYSTEM_ID
      and p.SYSTEM_ID = @idProfile@
    </value>
  </query>
  <!-- aggiunte da Sabrina perch? mancavano nella versione sql server 30/04/2013-->
  <query>
    <name>S_GET_INFO_AMMINISTRAZIONE_BY_ID</name>
    <value>
      select var_codice_amm, var_desc_amm, var_email_res_ipa
      from dpa_amministra
      where system_id= @param1@
    </value>
  </query>
  <query>
    <name>S_J_PROJECT_FASCICOLOByID_LOW_SECURITY</name>
    <value>
      SELECT DISTINCT
      A.SYSTEM_ID, A.DESCRIPTION, A.CHA_TIPO_PROJ,
      A.VAR_CODICE, A.ID_AMM,A.NUM_LIVELLO, A.CHA_TIPO_FASCICOLO,
      A.ID_FASCICOLO, A.ID_PARENT, A.VAR_COD_ULTIMO,
      A.VAR_NOTE,@param1@ AS DTA_APERTURA,
      @param2@ AS DTA_CHIUSURA,A.CHA_STATO, A.ID_TIPO_PROC, A.ID_REGISTRO,
      A.ID_UO_LF, A.DTA_UO_LF,
      @param6@ AS DTA_CREAZIONE,
      docsadm.getaccessrightsProject(@param5@,@param4@, @idRuoloPubblico@,A.system_id) AS ACCESSRIGHTS, A.CARTACEO,A.CHA_PRIVATO,ID_TITOLARIO, A.NUM_FASCICOLO,
      A.AUTHOR, A.ID_RUOLO_CREATORE, A.ID_UO_CREATORE, A.CHA_CONTROLLATO, A.CHA_COD_T_A, A.COD_EXT_APP
      FROM PROJECT A
      WHERE A.SYSTEM_ID=@param3@
      AND  docsadm.checksecurity(A.id_titolario,@param4@,@param5@, @idRuoloPubblico@,'T' )&gt;0
      AND A.CHA_TIPO_PROJ = 'F'
    </value>
  </query>
  <query>
    <name>DELETE_UO_TIBCO</name>
    <value>
      DELETE FROM DPA_DATI_FATTURAZIONE
      WHERE codice_amm = (SELECT var_codice_amm_ipa FROM dpa_amministra WHERE system_id = @param2@ )
      AND codice_aoo = (SELECT var_codice_aoo_ipa FROM dpa_el_registri WHERE var_codice = @param3@ AND CHA_RF=0)
      AND codice_uo = @param1@
    </value>
  </query>
  <query>
    <name>S_NODO_TITOLARIO_NO_SECURITY</name>
    <value>
      SELECT DISTINCT
      a.system_id as IDRECORD,a.var_codice as CODICE,a.description as DESCRIZIONE,a.num_livello as LIVELLO,a.id_registro as REGISTRO,a.id_parent as IDPARENT,a.var_cod_liv1 as CODLIV,  ISNULL(a.num_mesi_conservazione,0) as NUMMESICONSERVAZIONE,
      (SELECT count(b.system_id)
      FROM PROJECT b
      WHERE b.cha_tipo_proj = 'T'
      AND b.id_amm = @param1@
      AND b.id_parent = a.system_id
      ) as FIGLIO
      FROM PROJECT a
      WHERE a.cha_tipo_proj = 'T'
      AND a.id_amm = @param1@
      AND a.id_parent = @param2@
      -- AND s.personorgroup = @param3@
      AND (a.id_registro is null or a.id_registro =@param4@)
      ORDER BY a.var_cod_liv1
    </value>
  </query>
  <query>
    <name>S_SMISTADOC_GET_LIST_DOCUMENTI_IN_TODO</name>
    <value>
      SELECT
      ID_PROFILE AS SYSTEM_ID,
      docsadm.Vardescribe(ID_RAGIONE_TRASM, 'TIPO_RAGIONE') AS TIPO_RAGIONE,
      docsadm.Vardescribe(ID_RAGIONE_TRASM, 'RAGIONETRASM') AS RAGIONE_TRASM,
      ID_TRASMISSIONE AS ID_TRASMISSIONE,
      ID_TRASM_SINGOLA AS ID_TRASMISSIONE_SINGOLA,
      ID_TRASM_UTENTE AS ID_TRASMISSIONE_UTENTE,
      VAR_NOTE_GEN AS NOTE_GENERALI,
      VAR_NOTE_SING AS NOTE_INDIVIDUALI,
      DTA_INVIO AS DTAINVIO ,
      isnull(A.DTA_SCADENZA,CONVERT(DATETIME,'01/01/1753',103)) AS DTA_SCAD_DESC,
      isnull(A.DTA_SCADENZA,CONVERT(DATETIME,'01/01/2100',103)) AS DTA_SCAD_ASC,
      docsadm.Vardescribe(ID_PEOPLE_MITT, 'PEOPLENAME') AS MITT_TRASM,
      docsadm.Vardescribe(ID_RUOLO_MITT, 'GROUPNAME') AS RUOLO_MITT
      FROM DPA_TODOLIST A, PROFILE B, DPA_RAGIONE_TRASM C
      WHERE ID_PROFILE &gt; 0
      AND ((ID_PEOPLE_DEST = @param1@ and ID_RUOLO_DEST =@param2@) OR (ID_PEOPLE_DEST =@param1@ AND ID_RUOLO_DEST = 0))
      AND A.ID_REGISTRO IN (@param3@) AND ID_PROFILE = B.SYSTEM_ID AND B.DTA_ANNULLA IS NULL AND C.SYSTEM_ID = A.ID_RAGIONE_TRASM AND C.CHA_CEDE_DIRITTI='N'
      AND exists (select 'x' from security s where s.thing = b.system_id and s.personorgroup in (@param1@, @param2@) and s.accessrights &gt;= 20)
      ORDER BY @order@
    </value>
  </query>
  <query>
    <name>S_SMISTADOC_GET_LIST_DOCUMENTI_IN_TODO_FILTERED</name>
    <value>
      SELECT
      ID_PROFILE AS SYSTEM_ID,
      docsadm.Vardescribe(ID_RAGIONE_TRASM, 'TIPO_RAGIONE') AS TIPO_RAGIONE,
      docsadm.Vardescribe(ID_RAGIONE_TRASM, 'RAGIONETRASM') AS RAGIONE_TRASM,
      ID_TRASMISSIONE AS ID_TRASMISSIONE,
      ID_TRASM_SINGOLA AS ID_TRASMISSIONE_SINGOLA,
      ID_TRASM_UTENTE AS ID_TRASMISSIONE_UTENTE,
      VAR_NOTE_GEN AS NOTE_GENERALI,
      VAR_NOTE_SING AS NOTE_INDIVIDUALI,
      DTA_INVIO AS DTAINVIO,
      isnull(A.DTA_SCADENZA,CONVERT(DATETIME,'01/01/1753',103)) AS DTA_SCAD_DESC,
      isnull(A.DTA_SCADENZA,CONVERT(DATETIME,'01/01/2100',103)) AS DTA_SCAD_ASC,
      docsadm.Vardescribe(ID_PEOPLE_MITT, 'PEOPLENAME') AS MITT_TRASM,
      docsadm.Vardescribe(ID_RUOLO_MITT, 'GROUPNAME') AS RUOLO_MITT
      FROM DPA_TODOLIST A
      WHERE ID_PROFILE &gt; 0
      AND ((ID_PEOPLE_DEST = @param1@ and ID_RUOLO_DEST = @param2@) OR (ID_PEOPLE_DEST = @param1@ AND ID_RUOLO_DEST = 0))AND ID_REGISTRO IN (@param3@) @filtri@
      AND exists (select 'x' from security s where s.thing = A.id_profile and s.personorgroup in (@param1@, @param2@)
      and s.accessrights &gt;= 20)
      ORDER BY @order@
    </value>
  </query>
  <query>
    <name>S_GET_MY_DOC_TODOLIST_FILTERED</name>
    <value>
      SELECT
      ID_TRASMISSIONE,
      ID_TRASM_SINGOLA,
      ID_TRASM_UTENTE,
      DTA_INVIO AS DTAINVIO,
      CONVERT(varchar,DTA_INVIO,103)AS DTA_INVIO,
      isnull(DTA_SCADENZA,CONVERT(DATETIME,'01/01/1753',103)) AS DTA_SCAD_DESC,
      isnull(DTA_SCADENZA,CONVERT(DATETIME,'01/01/2100',103)) AS DTA_SCAD_ASC,
      docsadm.Vardescribe(ID_PEOPLE_MITT, 'PEOPLENAME') AS UT_MITT,
      docsadm.Vardescribe(ID_RUOLO_MITT, 'GROUPNAME') AS RUOLO_MITT,
      docsadm.Vardescribe(ID_PEOPLE_DEST, 'PEOPLENAME') AS UT_DEST,
      docsadm.Vardescribe(ID_RAGIONE_TRASM, 'RAGIONETRASM') AS RAG_TRASM,
      VAR_NOTE_GEN,
      VAR_NOTE_SING,
      DTA_SCADENZA,
      CONVERT(varchar,DTA_SCADENZA,103)AS DTA_INVIO,
      ID_PROFILE,
      docsadm.Vardescribe(ID_PROFILE, 'SEGNATURA_DOCNUMBER')AS SEGNA_DOCNUMBER,
      docsadm.Vardescribe(ID_PROFILE, 'OGGETTO_MITTENTE')AS OGGETTO_MITTENTE,
      docsadm.Vardescribe(ID_PROFILE, 'CHA_TIPO_PROTO')AS TIPO_PROTO,
      docsadm.Vardescribe(ID_PROFILE, 'DATADOC') AS DTA_DOC,
      docsadm.vardescribe(ID_PROFILE, 'NUMPROTO') AS NUM_PROTO,
      ID_PEOPLE_MITT AS ID_PEOPLE_MITT,
      ID_RUOLO_MITT AS ID_RUOLO_MITT,
      ID_RAGIONE_TRASM AS ID_RAGIONE_TRASM,
      ID_RUOLO_DEST AS ID_RUOLO_DEST,
      ID_PEOPLE_DEST AS ID_PEOPLE_DEST,
      CHA_TIPO_TRASM AS CHA_TIPO_TRASM,
      docsadm.Vardescribe(ID_PROFILE,'PROFILE_CHA_IMG') AS CHA_IMG
      FROM DPA_TODOLIST
      WHERE ID_PROFILE &gt; 0
      AND ((ID_PEOPLE_DEST = @idPeople@ and ID_RUOLO_DEST = @idGruppo@) OR (ID_PEOPLE_DEST = @idPeople@ AND ID_RUOLO_DEST = 0))
      AND ID_REGISTRO IN (@registri@) @filtri@
      ORDER BY @order@
    </value>
  </query>
  <query>
    <name>S_GET_MY_FASC_TODOLIST</name>
    <value>
      SELECT
      ID_TRASMISSIONE,
      ID_TRASM_SINGOLA,
      ID_TRASM_UTENTE,
      DTA_INVIO AS DTAINVIO,
      CONVERT(varchar,DTA_INVIO,103)AS DTA_INVIO,
      isnull(DTA_SCADENZA,CONVERT(DATETIME,'01/01/1753',103)) AS DTA_SCAD_DESC,
      isnull(DTA_SCADENZA,CONVERT(DATETIME,'01/01/2100',103)) AS DTA_SCAD_ASC,
      docsadm.Vardescribe(ID_PEOPLE_MITT, 'PEOPLENAME') AS UT_MITT,
      docsadm.Vardescribe(ID_RUOLO_MITT, 'GROUPNAME') AS RUOLO_MITT,
      docsadm.Vardescribe(ID_PEOPLE_DEST, 'PEOPLENAME') AS UT_DEST,
      docsadm.Vardescribe(ID_RAGIONE_TRASM, 'RAGIONETRASM') AS RAG_TRASM,
      VAR_NOTE_GEN,
      VAR_NOTE_SING,
      DTA_SCADENZA,
      CONVERT(varchar,DTA_INVIO,103)AS DTA_SCAD_CHAR,
      ID_PROJECT,
      docsadm.Vardescribe(ID_PROJECT, 'DESC_FASC')AS DESC_FASC,
      docsadm.Vardescribe(ID_PROJECT, 'CODFASC') AS COD_FASC,
      ID_PEOPLE_MITT AS ID_PEOPLE_MITT,
      ID_RUOLO_MITT AS ID_RUOLO_MITT,
      ID_RAGIONE_TRASM AS ID_RAGIONE_TRASM,
      ID_RUOLO_DEST AS ID_RUOLO_DEST,
      ID_PEOPLE_DEST AS ID_PEOPLE_DEST,
      CHA_TIPO_TRASM AS CHA_TIPO_TRASM
      FROM DPA_TODOLIST
      WHERE ID_PROJECT &gt; 0 AND
      ((ID_PEOPLE_DEST = @idPeople@ AND ID_RUOLO_DEST = @idGruppo@) OR (ID_PEOPLE_DEST = @idPeople@ AND ID_RUOLO_DEST = 0))
      ORDER BY @order@
    </value>
  </query>
  <query>
    <name>S_GET_MY_FASC_TODOLIST_FILTERED</name>
    <value>
      SELECT
      ID_TRASMISSIONE,
      ID_TRASM_SINGOLA,
      ID_TRASM_UTENTE,
      DTA_INVIO AS DTAINVIO,
      CONVERT(varchar,DTA_INVIO,103)AS DTA_INVIO,
      isnull(DTA_SCADENZA,CONVERT(DATETIME,'01/01/1753',103)) AS DTA_SCAD_DESC,
      isnull(DTA_SCADENZA,CONVERT(DATETIME,'01/01/2100',103)) AS DTA_SCAD_ASC,
      docsadm.Vardescribe(ID_PEOPLE_MITT, 'PEOPLENAME') AS UT_MITT,
      docsadm.Vardescribe(ID_RUOLO_MITT, 'GROUPNAME') AS RUOLO_MITT,
      docsadm.Vardescribe(ID_PEOPLE_DEST, 'PEOPLENAME') AS UT_DEST,
      docsadm.Vardescribe(ID_RAGIONE_TRASM, 'RAGIONETRASM') AS RAG_TRASM,
      VAR_NOTE_GEN,
      VAR_NOTE_SING,
      DTA_SCADENZA,
      CONVERT(varchar,DTA_INVIO,103)AS DTA_SCAD_CHAR,
      ID_PROJECT,
      docsadm.Vardescribe(ID_PROJECT, 'DESC_FASC')AS DESC_FASC,
      docsadm.Vardescribe(ID_PROJECT, 'CODFASC') AS COD_FASC,
      ID_PEOPLE_MITT AS ID_PEOPLE_MITT,
      ID_RUOLO_MITT AS ID_RUOLO_MITT,
      ID_RAGIONE_TRASM AS ID_RAGIONE_TRASM,
      ID_RUOLO_DEST AS ID_RUOLO_DEST,
      ID_PEOPLE_DEST AS ID_PEOPLE_DEST,
      CHA_TIPO_TRASM AS CHA_TIPO_TRASM
      FROM DPA_TODOLIST
      WHERE ID_PROJECT &gt; 0 AND
      ((ID_PEOPLE_DEST = @idPeople@ AND ID_RUOLO_DEST = @idGruppo@) OR (ID_PEOPLE_DEST = @idPeople@ AND ID_RUOLO_DEST = 0)) @filtri@
      ORDER BY @order@
    </value>
  </query>
  <query>
    <name>S_GET_COUNT_UTENTI_PAGING_NODI_TITOLARIO</name>
    <value>
      SELECT COUNT(ID)
      FROM (
      SELECT  DISTINCT PL.SYSTEM_ID as ID
      FROM    PEOPLE PL
      INNER JOIN PEOPLEGROUPS PG ON PL.SYSTEM_ID = PG.PEOPLE_SYSTEM_ID
      INNER JOIN GROUPS G ON PG.GROUPS_SYSTEM_ID = G.SYSTEM_ID
      INNER JOIN SECURITY S ON S.PERSONORGROUP = G.SYSTEM_ID
      INNER JOIN PROJECT P ON P.SYSTEM_ID = S.THING
      INNER JOIN PROJECT P1 ON P.ID_TITOLARIO = P1.SYSTEM_ID
      WHERE   P.ID_AMM = @idAmministrazione@ AND
      P.CHA_TIPO_PROJ = 'T' AND
      P.ID_TITOLARIO != 0 AND
      P.VAR_CODICE IN (@codiciTitolari@) AND
      P1.DTA_CESSAZIONE IS NULL AND
      PL.DISABLED = 'N' @filters@)
      ) as p     --AGGIUNTO UN ALIAS
    </value>
  </query>
  <query>
    <name>S_GET_UTENTI_PAGING_NODI_TITOLARIO</name>
    <value>
      SELECT *
      FROM
      (
      SELECT ROW_NUMBER() OVER(ORDER BY USERID ASC) AS RN, ID, USERID, COGNOME, NOME, EMAIL, SEDE
      FROM
      (
      SELECT  DISTINCT
      PL.SYSTEM_ID AS ID,
      PL.USER_ID AS USERID,
      PL.VAR_COGNOME AS COGNOME,
      PL.VAR_NOME AS NOME,
      PL.EMAIL_ADDRESS AS EMAIL,
      PL.VAR_SEDE AS SEDE
      FROM    PEOPLE PL
      INNER JOIN PEOPLEGROUPS PG ON PL.SYSTEM_ID = PG.PEOPLE_SYSTEM_ID
      INNER JOIN GROUPS G ON PG.GROUPS_SYSTEM_ID = G.SYSTEM_ID
      INNER JOIN SECURITY S ON S.PERSONORGROUP = G.SYSTEM_ID
      INNER JOIN PROJECT P ON P.SYSTEM_ID = S.THING
      INNER JOIN PROJECT P1 ON P.ID_TITOLARIO = P1.SYSTEM_ID
      WHERE   P.ID_AMM = @idAmministrazione@ AND
      P.CHA_TIPO_PROJ = 'T' AND
      P.ID_TITOLARIO != 0 AND
      P.VAR_CODICE IN (@codiciTitolari@) AND
      P1.DTA_CESSAZIONE IS NULL AND
      PL.DISABLED = 'N' @filters@
      ) q1
      ) q2
      WHERE RN BETWEEN @start@ AND @end@
    </value>
  </query>
  <query>
    <name>GET_CHECK_INTEROP_CORRISPONDENTE</name>
    <value>
      SELECT
      A.VAR_INSERT_BY_INTEROP
      FROM
      DPA_CORR_GLOBALI A
      WHERE
      A.SYSTEM_ID=@param1@
    </value>
  </query>
  <query>
    <name>S_RICERCA_FIGLI_ELEMENTO_RUOLO</name>
    <value>
      SELECT dpa2.* FROM PEOPLEGROUPS
      INNER JOIN dpa_corr_globali ON peoplegroups.groups_system_id = dpa_corr_globali.id_gruppo
      INNER JOIN PEOPLE ON peoplegroups.people_system_id = people.system_id
      INNER JOIN dpa_corr_globali dpa2 on people.system_id = dpa2.id_people
      where PEOPLEGROUPS.DTA_FINE IS NULL AND dpa_corr_globali.system_id=@param1@
    </value>
  </query>
  <query>
    <name>S_RICERCA_FIGLI_ELEMENTO_UO</name>
    <value>
      SELECT dpa_corr_globali.* FROM dpa_corr_globali WHERE cha_tipo_urp = 'R' AND DTA_FINE IS NULL AND id_uo = @param1@
    </value>
  </query>
  <query>
    <name>S_COUNT_DOC_FASCICOLATO_2</name>
    <value>
      SELECT COUNT (*)
      FROM project_components
      WHERE LINK = @id_documento@
      AND project_id = (SELECT system_id
      FROM project
      WHERE id_fascicolo = @id_fascicolo@ AND id_parent = id_fascicolo)
    </value>
  </query>
  <query>
    <name>CHECK_MITT_DEST_MODELLO</name>
    <value>
      SELECT corr.VAR_CODICE AS  codice
      FROM DPA_MODELLI_TRASM mod JOIN DPA_MODELLI_MITT_DEST md
      ON mod.SYSTEM_ID=md.ID_MODELLO
      JOIN DPA_CORR_GLOBALI corr ON  md.ID_CORR_GLOBALI=corr.SYSTEM_ID
      WHERE md.CHA_TIPO_MITT_DEST='@tipo@'
      AND mod.SYSTEM_ID='@codice_modello@'
      AND corr.VAR_CODICE = '@codice_ruolo@'
    </value>
  </query>
  <query>
    <name>GET_CODICE_FASC</name>
    <value>
      SELECT VAR_CODICE AS codice
      FROM PROJECT
      WHERE SYSTEM_ID='@system_id@'
    </value>
  </query>
  <query>
    <name>SET_NOTE_ACCETTAZIONE_UT</name>
    <value>
      UPDATE DPA_TRASM_UTENTE SET VAR_NOTE_ACC='@note@'
      WHERE SYSTEM_ID='@system_id@'
    </value>
  </query>
  <query>
    <name>S_RICERCA_DOCUMENTI_PUBBLICAZIONE</name>
    <value>
      SELECT
      DISTINCT a.system_id,
      a.docnumber,
      a.author,
      a.id_ruolo_creatore
      From Profile A
      WHERE ( ( ( cha_tipo_proto  IN ('P') AND cha_da_proto             = '0'AND id_documento_principale IS NULL )
      Or ( Cha_Tipo_Proto         In ('A') And Cha_Da_Proto             = '0' And Id_Documento_Principale Is Null )
      OR ( cha_tipo_proto         IN ('I') AND cha_da_proto             = '0'AND id_documento_principale IS NULL ) )
      And A.Id_Tipo_Atto           = @idTipoAtto@
      AND (A.System_Id In
      (Select Dpa0.Doc_Number
      From Dpa_Associazione_Templates Dpa0, Dpa_Associazione_Templates Dpa1
      Where Dpa0.Doc_Number = Dpa1.Doc_Number
      And Dpa0.Id_Oggetto = @idTipoOggettoDataPubblicazione@
      And Dpa0.Valore_Oggetto_Db = '@dataPubblicazioneFinale@'
      And Dpa1.Id_Oggetto = @idTipoOggettoOraPubblicazione@
      and Dpa1.Valore_Oggetto_Db = '@oraPubblicazione@'
      ))
      AND isnull(a.cha_in_cestino, '0') = '0' )
      ORDER BY A.System_Id DESC
    </value>
  </query>
  <query>
    <name>S_GET_SUPPORTED_FILE_TYPES_PRESERVATION</name>
    <value>
      SELECT 	SF.SYSTEM_ID,
      SF.ID_AMMINISTRAZIONE,
      SF.FILE_TYPE_USED,
      A.VAR_CODICE_AMM AS CODICE_AMMINISTRAZIONE,
      SF.DESCRIPTION,
      SF.FILE_EXTENSION,
      SF.MAX_FILE_SIZE,
      SF.MAX_FILE_SIZE_ALERT_MODE,
      SF.CONTAINS_FILE_MODEL,
      SF.DOCUMENT_TYPE,
      SF.FILE_TYPE_SIGNATURE,
      SF.FILE_TYPE_PRESERVATION,
      SF.FILE_TYPE_VALIDATION
      FROM	DPA_FORMATI_DOCUMENTO SF,
      DPA_AMMINISTRA A
      WHERE 	SF.ID_AMMINISTRAZIONE = A.SYSTEM_ID AND
      SF.ID_AMMINISTRAZIONE = @idAmministrazione@
      --and sf.FILE_TYPE_PRESERVATION=1
      ORDER BY SF.FILE_EXTENSION
    </value>
  </query>
  <query>
    <name>S_AMM_GET_LISTA_RF</name>
    <value>
      select e.SYSTEM_ID,e.VAR_CODICE,e.VAR_DESC_REGISTRO from dpa_el_registri e where e.ID_AMM= @idAmministrazione@ and e.CHA_RF='@rf@' order by e.VAR_CODICE asc
    </value>
  </query>
  <query>
    <name>I_DPA_ASS_POLICY_TYPE</name>
    <value>
      INSERT INTO DPA_ASS_POLICY_TYPE
      (
      ID_POLICY,
      ID_TYPE
      )
      values
      (
      @id_policy@,
      @id_type@
      )
    </value>
  </query>
  <query>
    <name>I_DPA_POLICY_ESECUZIONE</name>
    <value>
      INSERT INTO DPA_POLICY_ESECUZIONE
      (
      @colID@
      ID_POLICY,
      START_EXECUTE_DATE,
      END_EXECUTE_DATE,
      N_OBJ_CONSERVATI,
      ID_ULTIMO_OBJ,
      ID_PRIMO_OBJ,
      ID_ISTANZA,
      ID_AMM
      )
      values
      (
      @id@
      @idPolicy@,
      @startExecuteDate@,
      @endExecuteDate@,
      @nDoc@,
      @idLastDocument@,
      @idFirstDocument@,
      @idIstanza@,
      @idAmm@
      )
    </value>
  </query>
  <query>
    <name>I_POLICY_CONSERVAZIONE</name>
    <value>
      INSERT INTO POLICY_CONSERVAZIONE
      (
      @colID@
      TIPO,
      ID_AMM,
      NOME,
      CLASSIFICA,
      ID_TEMPLATE,
      ID_STATO,
      ID_RF,
      ARRIVO,
      PARTENZA,
      INTERNO,
      GRIGIO,
      DTA_DATA_CREAZIONE_DA,
      DTA_DATA_CREAZIONE_A,
      DTA_DATA_PROTO_DA,
      DTA_DATA_PROTO_A,
      ID_AOO,
      TIPO_CLASSIFICAZIONE,
      ID_UO_CREATORE,
      TIPO_DATA_CREAZIONE,
      TIPO_DATA_PROTO,
      UO_SOTTOPOSTE,
      INCLUDI_SOTTONODI,
      SOLO_DIGITALI,
      SOLO_FIRMATI
      )
      values
      (
      @id@
      '@tipo@',
      @idAmm@,
      '@name@',
      @classificazione@,
      @template@,
      @diagramma@,
      @rf@,
      '@arrivo@',
      '@partenza@',
      '@interno@',
      '@grigio@',
      @dataCDa@,
      @dataCA@,
      @dataPDa@,
      @dataPA@,
      @aoo@,
      '@tipoClass@',
      @idUoCreatore@,
      '@tipoDataC@',
      '@tipoDataP@',
      '@uoSott@',
      '@sottoNodi@',
      '@digitali@',
      '@firmati@'
      )
    </value>
  </query>
  <query>
    <name>S_GET_DOCUMENT_WITH_POLICY</name>
    <value>
      SELECT /*+INDEX(a)*/ a.system_id, a.docnumber from profile a,dpa_corr_globali d @from@ where docsadm.getchaimg (a.docnumber)!='0'
      AND d.system_id = a.ID_UO_CREATORE and d.ID_AMM = @idAmm@ AND a.system_id not in (select n.ID_PROFILE from DPA_DETT_POLICY_ESECUZIONE n where n.id_profile = a.system_id and n.ID_POLICY=@idPolicy@ AND n.ESITO =1) @filtri@ order by a.system_id asc
    </value>
  </query>
  <query>
    <name>U_ISTANZA_CON_POLICY_MANUALE</name>
    <value>
      update dpa_area_conservazione set id_policy_validazione =@idPolicy@ where system_id = @idIstanza@
    </value>
  </query>
  <query>
    <name>U_ITEMS_ISTANZA_CON_POLICY_MANUALE</name>
    <value>
      UPDATE dpa_items_conservazione
      SET
      policy_valida = '@valida@' ,
      mask_validazione_policy = '@mask_validazione_policy@'
      WHERE id_conservazione = @idIstanza@ AND id_profile = @idProfile@
    </value>
  </query>
  <query>
    <name>S_VERIFY_POLICY</name>
    <value>
      SELECT f.system_id
      from profile f
      where docsadm.getchaimg (f.docnumber)!='0'
      AND f.system_id IN
      (
      SELECT a.system_id
      FROM profile a @from@
      WHERE a.system_id = a.system_id @filtri@)
      and f.system_id = @idProfile@
    </value>
  </query>
  <query>
    <name>S_DPA_CHECK_MAILBOX_ID</name>
    <value>
      SELECT max(id)
      FROM DPA_CHECK_MAILBOX WITH(NOLOCK)
      WHERE IDJOB=@idJob@ AND IDUSER=@idUser@ AND IDROLE=@idRole@ AND IDREG=@idReg@ AND MAIL='@mail@'
    </value>
  </query>
  <query>
    <name>I_DPA_JOBS</name>
    <value>
      INSERT INTO DPA_JOBS (VAR_JOB)
      VALUES('Job')
    </value>
  </query>
  <query>
    <name>S_DPA_JOBS</name>
    <value>
      SELECT max(id)
      FROM DPA_JOBS WITH(NOLOCK)
    </value>
  </query>
  <query>
    <name>S_GET_CORRISPONDENTI_BY_EMAIL2</name>
    <value>
      SELECT  a.system_id,
      a.cha_tipo_urp,
      a.id_gruppo,
      a.id_people,
      a.cha_tipo_ie
      FROM    dpa_corr_globali a
      WHERE
      (a.var_email = '@email@' AND
      a.CHA_TIPO_IE = 'I')
      AND (id_amm = @idAmministrazione@  OR id_amm IS NULL)
      AND (id_registro IS NULL OR id_registro = @idRegistro@)
      AND dta_fine IS NULL
      union
      SELECT  a.system_id,
      a.cha_tipo_urp,
      a.id_gruppo,
      a.id_people,
      a.cha_tipo_ie
      FROM    dpa_corr_globali a, dpa_mail_corr_esterni m where
      a.system_id = m.id_corr AND
      m.var_email = '@email@'
      AND (id_amm = @idAmministrazione@  OR id_amm IS NULL)
      AND (id_registro IS NULL OR id_registro = @idRegistro@ )
      AND dta_fine IS NULL
    </value>
  </query>
  <query>
    <name>I_DPA_REPORT_MAILBOX</name>
    <value>
      INSERT INTO DPA_REPORT_MAILBOX(
      ID_CHECK_MAILBOX,
      MAILID,
      TYPE,
      RECEIPT,
      DATE_MAIL,
      FROM_MAIL,
      ERROR,
      COUNT_ATTACHMENTS,
      SUBJECT)
      values(@param1@)
    </value>
  </query>
  <query>
    <name>U_RESET_ITEMS_ISTANZA_CON_POLICY</name>
    <value>
      update dpa_items_conservazione set policy_valida = '' where id_conservazione = @idIstanza@
    </value>
  </query>
  <query>
    <name>I_ITEMS_CONSERVAZIONE_WITH_POLICY</name>
    <value>
      INSERT INTO dpa_items_conservazione
      (@colID@
      id_conservazione,
      id_profile,
      id_project,
      cha_tipo_doc,
      var_oggetto,
      id_registro,
      data_ins,
      cha_stato,
      var_xml_metadati,
      cod_fasc,
      docnumber,
      cha_tipo_oggetto,
      var_tipo_atto,
      CHA_ESITO
      )
      VALUES
      (@id@
      @idConservazione@,
      @idProfile@,
      @idProject@,
      '@tipoDoc@',
      '@oggetto@',
      @idRegistro@,
      @dataInserimento@,
      '@stato@',
      null, --EMPTY_CLOB (),
      '@codFasc@',
      @docNumber@,
      '@tipoOggetto@',
      '@tipoAtto@',
      '@chaEsito@'
      )
    </value>
  </query>
  <query>
    <name>I_ITEMS_EXECUTIONS_POLICY</name>
    <value>
      INSERT INTO DPA_DETT_POLICY_ESECUZIONE
      (@colID@
      ID_POLICY,
      ID_PROFILE,
      ID_PROJECT,
      ESITO,
      ERRORE
      )
      VALUES
      (@id@
      @idPolicy@,
      @idProfile@,
      @idProject@,
      '@esito@',
      '@errore@'
      )
    </value>
  </query>
  <query>
    <name>S_REP_TO_REPAIR_PRINT</name>
    <value>
      SELECT (SELECT MIN(DPA_STAMPA_REPERTORI.NUM_REP_START) minimo FROM DPA_STAMPA_REPERTORI , COMPONENTS WHERE DPA_STAMPA_REPERTORI.DOCNUMBER = COMPONENTS.DOCNUMBER
      AND COMPONENTS.PATH IS NULL
      AND DPA_STAMPA_REPERTORI.ID_REPERTORIO = @counterId@ AND DPA_STAMPA_REPERTORI.REGISTRYID @registry@) AS FirstNumber,
      (SELECT MAX(DPA_STAMPA_REPERTORI.NUM_REP_START) massimo FROM DPA_STAMPA_REPERTORI , COMPONENTS WHERE DPA_STAMPA_REPERTORI.DOCNUMBER = COMPONENTS.DOCNUMBER
      AND COMPONENTS.PATH IS NULL
      AND DPA_STAMPA_REPERTORI.ID_REPERTORIO = @counterId@ AND DPA_STAMPA_REPERTORI.REGISTRYID @registry@) AS LastNumber,
      (SELECT distinct DPA_STAMPA_REPERTORI.NUM_ANNO FROM DPA_STAMPA_REPERTORI , COMPONENTS WHERE DPA_STAMPA_REPERTORI.DOCNUMBER = COMPONENTS.DOCNUMBER
      AND COMPONENTS.PATH IS NULL
      AND DPA_STAMPA_REPERTORI.ID_REPERTORIO = @counterId@ AND DPA_STAMPA_REPERTORI.REGISTRYID @registry@) AS RepYear
    </value>
  </query>
  <query>
    <name>S_ALL_MAIL_CORR_PROTO</name>
    <value>
      SELECT m.id_corr as idCorr, m.var_email as email, m.var_note as note, m.var_principale as principale
      FROM profile p JOIN dpa_doc_arrivo_par d ON (p.system_id= @idDoc@ and p.system_id = d.id_profile)
      JOIN dpa_mail_corr_esterni m ON(d.id_mitt_dest = m.id_corr)
      WHERE d.cha_tipo_mitt_dest != 'M'
    </value>
  </query>
  <query>
    <name>S_COUNT_NUM_CORR_IN_AMM</name>
    <value>
      SELECT count(*)
      FROM DPA_CORR_GLOBALI
      WHERE
      ID_AMM = @idAmm@ AND
      var_codice_amm = @codiceAmm@ AND
      var_cod_rubrica != @codiceCorr@ AND
      dta_fine is null
    </value>
  </query>
  <query>
    <name>S_EXISTS_STOPWORD</name>
    <value>
      Select * from ctx_stopwords
      WHERE lower(spw_word) = lower('@param1@')
    </value>
  </query>
  <query>
    <name>PD_GET_DPA_TEMPLATE_2_FASC_BY_DESC</name>
    <value>
      SELECT *
      FROM DPA_TIPO_FASC
      WHERE
      VAR_DESC_FASC = '@descrizione@'
    </value>
  </query>
  <query>
    <name>U_DATA_CREATION_DOC_GRIGIO</name>
    <value>
      update PROFILE
      set CREATION_DATE=@creation_date@,
      CREATION_TIME=@creation_time@,
      LAST_EDIT_DATE=@last_edit_date@,
      ID_VECCHIO_DOCUMENTO=@id_vecchio_documento@
      WHERE SYSTEM_ID=@system_id@
    </value>
  </query>
  <query>
    <name>V_IDVECCHIO_PREGRESSI</name>
    <value>
      SELECT CONVERT(varchar,ID_VECCHIO_DOCUMENTO)
      AS PROTOCOLLATO
      FROM PROFILE
      UNION
      SELECT
      CONVERT(varchar,ID_NUM_PROTO_EXCEL)
      AS PROTOCOLLATO
      FROM DPA_ASS_PREGRESSI
      WHERE ID_NUM_PROTO_EXCEL @param1@
      AND ESITO IS NULL
    </value>
  </query>
  <query>
    <name>U_SET_FLAG_ALLEGATI_ESTERNI</name>
    <value>
      UPDATE versions
      SET cha_allegati_esterno='1'
      WHERE version_id=@version_id@
      AND docnumber=@docnumber@
    </value>
  </query>
  <query>
    <name>U_SET_FLAG_ALLEGATI_PEC_IS_EXT</name>
    <value>
      UPDATE versions
      SET cha_allegati_esterno='@flagChar@'
      WHERE version_id=@version_id@
      AND docnumber=@docnumber@
    </value>
  </query>
  <query>
    <name>S_ALLEGATO_ESTERNO</name>
    <value>
      SELECT CHA_ALLEGATI_ESTERNO
      FROM VERSIONS
      WHERE version_id=@version_id@
    </value>
  </query>
  <query>
    <name>S_ASS_RUOLI_STATI_DIAGRAMMA</name>
    <value>
      SELECT
      ID_GRUPPO,
      ID_DIAGRAMMA,
      ID_STATO,
      CHA_NOT_VIS
      FROM DPA_ASS_RUOLO_STATI_DIAGRAMMA
      WHERE ID_DIAGRAMMA = @idDiagramma@
    </value>
  </query>
  <query>
    <name>S_ASS_RUOLO_DIAGRAMMA</name>
    <value>
      SELECT count(*)
      FROM DPA_ASS_RUOLO_STATI_DIAGRAMMA
      WHERE
      ID_DIAGRAMMA = @idDiagramma@ AND
      ID_GRUPPO = @idRuolo@ AND
      ID_STATO = 0
    </value>
  </query>
  <query>
    <name>S_ASS_RUOLO_STATO_DIAGRAMMA</name>
    <value>
      SELECT count(*)
      FROM DPA_ASS_RUOLO_STATI_DIAGRAMMA
      WHERE
      ID_DIAGRAMMA = @idDiagramma@ AND
      ID_GRUPPO = @idRuolo@ AND
      ID_STATO = @idStato@
    </value>
  </query>
  <query>
    <name>COUNT_DIAGRAMMI</name>
    <value>
      SELECT COUNT(*)
      FROM DPA_ASS_RUOLO_STATI_DIAGRAMMA
      WHERE id_diagramma = @idDiagramma@
      AND id_stato = @idStato@
      AND id_gruppo = @idGruppo@
    </value>
  </query>
  <query>
    <name>DELETE_DIAGRAMMI</name>
    <value>
      DELETE
      FROM DPA_ASS_RUOLO_STATI_DIAGRAMMA
      WHERE id_diagramma = @idDiagramma@
      AND id_stato = @idStato@
      AND id_gruppo = @idGruppo@
    </value>
  </query>
  <query>
    <name>UPDATE_DIAGRAMMI</name>
    <value>
      UPDATE DPA_ASS_RUOLO_STATI_DIAGRAMMA
      SET cha_not_vis = '1'
      WHERE id_diagramma = @idDiagramma@
      AND id_stato = @idStato@
      AND id_gruppo = @idGruppo@
    </value>
  </query>
  <query>
    <name>INSERT_DIAGRAMMI</name>
    <value>
      INSERT
      INTO DPA_ASS_RUOLO_STATI_DIAGRAMMA VALUES
      (
      @idGruppo@,
      @idDiagramma@,
      @idStato@,
      '1'
      )
    </value>
  </query>
  <query>
    <name>SELECT_VAR_CODICE_AMM_IPA</name>
    <value>
      SELECT var_codice_amm_ipa
      FROM  DPA_AMMINISTRA
      WHERE system_id=@param1@
    </value>
  </query>
  <query>
    <name>SELECT_VAR_CODICE_AOO_IPA</name>
    <value>
      SELECT var_codice_aoo_ipa
      FROM  DPA_EL_REGISTRI
      WHERE var_codice='@param1@'
      AND CHA_RF=0
    </value>
  </query>
  <query>
    <name>SELECT_SYSTEM_ID_DPA_TIPO_ATTO</name>
    <value>
      SELECT System_Id
      FROM  DPA_TIPO_ATTO
      WHERE ID_AMM=@param1@
      AND var_desc_atto = 'Fattura elettronica'
    </value>
  </query>
  <query>
    <name>SELECT_CODICE_UAC_DPA_EL_REGISTRI</name>
    <value>
      SELECT codice_uac
      FROM  DPA_EL_REGISTRI
      WHERE ID_AMM=@param1@
      AND var_codice = '@param2@'
    </value>
  </query>
  <query>
    <name>SELECT_CODICE_CLASSIFICAZIONE_DPA_EL_REGISTRI</name>
    <value>
      SELECT codice_classificazione
      FROM  DPA_EL_REGISTRI
      WHERE ID_AMM=@param1@
      AND var_codice = '@param2@'
    </value>
  </query>
  <query>
    <name>S_GET_IDTITOLARY_BY_CODEFASC_OR_DESCRIPTION</name>
    <value>
      SELECT id_titolario
      FROM  project
      WHERE cha_stato = 'A'
      AND ID_AMM=@idAmministrazione@
      AND ID_REGISTRO = @idRegistro@
      @condizioniWhere@
    </value>
  </query>
  <query>
    <name>S_PROJECT_DOCUMENTS_COUNT_VISIBLE_NOTVISIBLE</name>
    <value>
      Select (
      SELECT COUNT (a.system_id)
      FROM PROFILE a, project_components b, documenttypes d
      WHERE b.project_id = @id@
      AND B.LINK=A.SYSTEM_ID AND B.TYPE = 'D' AND A.DOCUMENTTYPE=D.SYSTEM_ID
      AND b.TYPE = 'D'
      AND a.documenttype = d.system_id
      AND a.dta_annulla IS NULL
      AND EXISTS (
      SELECT 'x'
      FROM security e
      WHERE a.system_id = e.thing
      AND e.personorgroup IN (@idgruppo@, @idpeople@)
      AND e.accessrights &gt; 0)
      AND isnull(cha_in_cestino, '0') = '0') as visible,
      (
      SELECT COUNT (a.system_id)
      FROM PROFILE a, project_components b, documenttypes d
      WHERE b.project_id = @id@
      AND B.LINK=A.SYSTEM_ID AND B.TYPE = 'D' AND A.DOCUMENTTYPE=D.SYSTEM_ID
      AND b.TYPE = 'D'
      AND a.documenttype = d.system_id
      AND isnull(cha_in_cestino, '0') = '0') as notvisible
    </value>
  </query>
  <query>
    <name>U_PROJECT_MOVE_FOLDER</name>
    <value>
      UPDATE PROJECT SET
      ID_PARENT=@id_parent@
      WHERE SYSTEM_ID=@system_id@
    </value>
  </query>
  <query>
    <name>I_DPA_CHECK_MAILBOX</name>
    <value>
      INSERT INTO DPA_CHECK_MAILBOX(idjob, iduser, idrole, idreg, mail)
      values(@idJob@, @idUser@, @idRole@, @idReg@, '@mail@')
    </value>
  </query>
  <query>
    <name>S_DPA_CHECK_MAILBOX</name>
    <value>
      SELECT r.var_codice as registerCode,
      m.mail,
      m.errormessage,
      m.mailserver,
      m.mailuserid,
      m.DTA_CONCLUDED
      FROM DPA_CHECK_MAILBOX m WITH(NOLOCK) JOIN DPA_EL_REGISTRI r WITH(NOLOCK) ON( m.id = @id@ and m.idreg = r.system_id)
    </value>
  </query>
  <query>
    <name>I_DPA_REPORT_MAILBOX_ERRATA!!!</name>
    <value>
      INSERT INTO DPA_REPORT_MAILBOX(
      ID,
      ID_CHECK_MAILBOX,
      MAILID,
      TYPE,
      RECEIPT,
      DATE_MAIL,
      FROM_MAIL,
      ERROR,
      COUNT_ATTACHMENTS,
      SUBJECT)
      values(@param1@)
    </value>
  </query>
  <query>
    <name>D_DPA_CHECK_MAILBOX</name>
    <value>
      DELETE FROM DPA_CHECK_MAILBOX
      WHERE ID = @idCheckMailbox@
    </value>
  </query>
  <query>
    <name>S_DPA_REPORT_MAILBOX</name>
    <value>
      SELECT MAILID, TYPE, RECEIPT, DATE_MAIL, FROM_MAIL, ERROR, COUNT_ATTACHMENTS, SUBJECT
      FROM DPA_REPORT_MAILBOX WITH(NOLOCK)
      WHERE ID_CHECK_MAILBOX = @id@
    </value>
  </query>
  <query>
    <name>S_VERIFICA_INTERVALLO_LOG_PROTOCOLLO_ERRATA!!!</name>
    <value>
      SELECT   userid_operatore, dta_azione, var_oggetto, var_desc_oggetto,
      var_desc_azione, cha_esito, id_people_operatore, id_gruppo_operatore,
      id_amm, id_oggetto, var_cod_azione
      FROM dpa_log
      WHERE id_amm = 361
      AND dta_azione &gt;= DATEADD(SECOND,-@intervallo@,GETDATE())
      AND var_oggetto = 'DOCUMENTO'
      AND (var_cod_azione = 'AGG_PROT' or var_cod_azione ='PUT_FILE')
      AND var_cod_azione NOT LIKE 'AMM_%'
      ORDER BY dta_azione DESC
    </value>
  </query>
  <query>
    <name>S_UO_SOTTOPOSTE</name>
    <value>
      with gerarchia as
      (
      select p.system_id--, 0 as level
      from DOCSADM.DPA_CORR_GLOBALI p
      where p.CHA_TIPO_URP = 'U'
      and p.system_id = @param2@
      and p.ID_AMM='@param1@'
      union all
      select pg.system_id--, level+1
      from DOCSADM.DPA_CORR_GLOBALI pg inner join gerarchia g on pg.ID_PARENT = g.SYSTEM_ID
      where pg.CHA_TIPO_URP = 'U'
      and pg.ID_AMM='@param1@'
      )
      select * from gerarchia
    </value>
  </query>

  <!-- FINE QUERY AGGIUNTE DA SABRINA 30/04/2013-->

  <!-- QUERY DEPOSITO -->


  <query>
    <name>S_J_PROJECT__SECURITY5_DEPOSITO</name>
    <value>
      SELECT DISTINCT A.*, @dbuser@.getAccessRightsProject(@param3@,@param2@,@idRuoloPubblico@,a.system_id) as accessrights
      FROM PROJECT A
      WHERE  A.ID_FASCICOLO=@param1@
      AND (@dbuser@.checkSecurity(A.SYSTEM_ID, @param2@, @param3@, @idRuoloPubblico@, 'F') > 0)

      ORDER BY DESCRIPTION ASC
    </value>
  </query>
  <query>
    <name>I_DPA_NOTIFY_HISTORY_TRASM_OTHER_PEOPLE_GROUP</name>
    <value>
      INSERT
      INTO DPA_NOTIFY_HISTORY
      (
      ID_NOTIFY,
      ID_EVENT,
      DESC_PRODUCER,
      ID_PEOPLE_RECEIVER,
      ID_GROUP_RECEIVER,
      TYPE_NOTIFY,
      DTA_NOTIFY,
      FIELD_1,
      FIELD_2,
      FIELD_3,
      FIELD_4,
      MULTIPLICITY,
      SPECIALIZED_FIELD,
      TYPE_EVENT,
      DOMAINOBJECT,
      ID_OBJECT,
      ID_SPECIALIZED_OBJECT,
      DTA_EVENT,
      READ_NOTIFICATION,
      NOTES
      )
      SELECT
      SYSTEM_ID,
      ID_EVENT,
      DESC_PRODUCER,
      ID_PEOPLE_RECEIVER,
      ID_GROUP_RECEIVER,
      TYPE_NOTIFY,
      DTA_NOTIFY,
      FIELD_1,
      FIELD_2,
      FIELD_3,
      FIELD_4,
      MULTIPLICITY,
      SPECIALIZED_FIELD,
      TYPE_EVENT,
      DOMAINOBJECT,
      ID_OBJECT,
      ID_SPECIALIZED_OBJECT,
      DTA_EVENT,
      READ_NOTIFICATION,
      NOTES
      FROM DPA_NOTIFY
      WHERE ID_SPECIALIZED_OBJECT =
      (SELECT A.SYSTEM_ID
      FROM DPA_TRASM_SINGOLA A,
      DPA_TRASM_UTENTE B
      WHERE A.SYSTEM_ID=B.ID_TRASM_SINGOLA
      AND B.SYSTEM_ID IN
      (SELECT TU.SYSTEM_ID
      FROM DPA_TRASM_UTENTE TU,
      DPA_TRASMISSIONE TX,
      DPA_TRASM_SINGOLA TS
      WHERE TU.ID_PEOPLE=@idPeople@
      AND TX.SYSTEM_ID  =TS.ID_TRASMISSIONE
      AND TX.SYSTEM_ID  =@idTrasm@
      AND TS.SYSTEM_ID  =TU.ID_TRASM_SINGOLA
      AND TS.SYSTEM_ID  =
      (SELECT ID_TRASM_SINGOLA FROM DPA_TRASM_UTENTE WHERE SYSTEM_ID =@idTrasmUser@
      )
      )
      )
      @condition@
    </value>
  </query>
  <query>
    <name>D_DPA_NOTIFY_OTHER_TRASM_GROUP</name>
    <value>
      DELETE
      FROM DPA_NOTIFY
      WHERE ID_SPECIALIZED_OBJECT =
      (SELECT A.SYSTEM_ID
      FROM DPA_TRASM_SINGOLA A,
      DPA_TRASM_UTENTE B
      WHERE A.SYSTEM_ID=B.ID_TRASM_SINGOLA
      AND B.SYSTEM_ID IN
      (SELECT TU.SYSTEM_ID
      FROM DPA_TRASM_UTENTE TU,
      DPA_TRASMISSIONE TX,
      DPA_TRASM_SINGOLA TS
      WHERE TU.ID_PEOPLE=@idPeople@
      AND TX.SYSTEM_ID  =TS.ID_TRASMISSIONE
      AND TX.SYSTEM_ID  =@idTrasm@
      AND TS.SYSTEM_ID  =TU.ID_TRASM_SINGOLA
      AND TS.SYSTEM_ID  =
      (SELECT ID_TRASM_SINGOLA FROM DPA_TRASM_UTENTE WHERE SYSTEM_ID =@idTrasmUser@
      )
      )
      )
      @condition@
    </value>
  </query>
  <query>
    <name>S_NODO_TITOLARIO_DEPOSITO</name>
    <value>
      SELECT DISTINCT
      a.system_id as IDRECORD,a.var_codice as CODICE,a.description as DESCRIZIONE,a.num_livello as LIVELLO,a.id_registro as REGISTRO,a.id_parent as IDPARENT,a.var_cod_liv1 as CODLIV, isnull(a.num_mesi_conservazione,0) as NUMMESICONSERVAZIONE,
      (SELECT count(b.system_id)
      FROM PROJECT b
      WHERE b.cha_tipo_proj = 'T'
      AND b.id_amm = @param1@
      AND b.id_parent = a.system_id
      ) as FIGLIO
      FROM PROJECT a
      WHERE a.cha_tipo_proj = 'T'
      AND a.id_amm = @param1@
      AND a.id_parent = @param2@
      AND (a.id_registro is null or a.id_registro = @param4@)
      ORDER BY a.var_cod_liv1
    </value>
  </query>
  <query>
    <name>S_FILTRO_RIC_TIT_DOCSPA_DEPOSITO</name>
    <value>
      SELECT
      DISTINCT A.system_id as ID, A.var_codice as CODICE, A.description as DESCRIZIONE, A.num_livello as LIVELLO, A.id_parent as IDPARENT
      FROM PROJECT A  @paramFrom@
      WHERE
      A.cha_tipo_proj = 'T'
      @param1@
      @param2@
      AND A.id_amm = @param3@
      AND (A.id_registro is null or A.id_registro = @param5@)
      AND ID_TITOLARIO = @param6@
      @paramNote@
      @paramIndice@
      ORDER BY num_livello
    </value>
  </query>

  <query>
    <name>S_RUOLO_ARCHIVISTA_DEPOSITO</name>
    <value>
      select system_id from dpa_tipo_f_ruolo where ID_RUOLO_IN_UO in
      (select SYSTEM_ID from DPA_CORR_GLOBALI where ID_GRUPPO = @param1@)
      and ID_TIPO_FUNZ in (select id_tipo_funz from dpa_funzioni where COD_FUNZIONE = 'ARCHIVIO_DEPOSITO')
    </value>
  </query>

  <!-- END QUERY DEPOSITO -->

  <query>
    <name>S_ANAGRAFICA_LOG</name>
    <value>
      SELECT VAR_CODICE as CODICE, VAR_DESCRIZIONE as DESCRIZIONE, VAR_OGGETTO as OGGETTO, VAR_METODO as METODO, 0 as ATTIVO,
      'NN' as NOTIFY, NOTIFICATION, CONFIGURABLE
      FROM DPA_ANAGRAFICA_LOG
      WHERE VAR_CODICE not like 'AMM_%'
      AND (ID_AMM = @param1@ OR ID_AMM IS NULL)
      ORDER BY VAR_OGGETTO
    </value>
  </query>

  <query>
    <name>S_ID_LOG</name>
    <value>
      SELECT SYSTEM_ID
      FROM DPA_ANAGRAFICA_LOG
      WHERE VAR_CODICE = '@param1@'
      AND (ID_AMM = @param2@ OR ID_AMM IS NULL)
    </value>
  </query>
  <query>
    <name>S_LOG_ATTIVI</name>
    <value>
      SELECT a.VAR_CODICE as CODICE, a.VAR_DESCRIZIONE as DESCRIZIONE, a.VAR_OGGETTO as OGGETTO,  a.VAR_METODO as METODO, 1 as ATTIVO,
      b.NOTIFY AS NOTIFY,
      case when a.NOTIFICATION is null then '0' else a.NOTIFICATION end as NOTIFICATION,
      case when a.CONFIGURABLE is null then '0' else a.CONFIGURABLE end as CONFIGURABLE
      FROM DPA_ANAGRAFICA_LOG a , DPA_LOG_ATTIVATI b
      WHERE a.system_id = b.system_id_anagrafica
      AND b.id_amm = @param1@
      AND (a.id_amm = @param1@ OR a.id_amm is null)
      AND a.VAR_CODICE not like 'AMM_%'
      ORDER BY a.VAR_OGGETTO
    </value>
  </query>
  <query>
    <name>I_LOG_ATTIVATI</name>
    <value>
      INSERT INTO DPA_LOG_ATTIVATI
      (system_id_anagrafica, id_amm, notify)
      VALUES
      (@param1@, @param2@,@param3@)
    </value>
  </query>

  <query>
    <name>S_DPA_NOTIFY</name>
    <value>
      SELECT system_id as ID_NOTIFY,
      id_event,
      desc_producer as PRODUCER,
      id_people_receiver as ID_PEOPLE,
      id_group_receiver as ID_GROUP,
      type_notify as TYPE_NOTIFICATION,
      dta_notify,
      field_1 as ITEM1,
      field_2 as ITEM2,
      field_3 as ITEM3,
      field_4 as ITEM4,
      multiplicity,
      specialized_field as ITEM_SPECIALIZED,
      type_event,
      domainobject,
      id_object,
      id_specialized_object,
      dta_event,
      read_notification,
      color,
      notes,
      @dbuser@.getchaimg(id_object) as EXTENSION,
      @dbuser@.getchafirmato(id_object) as SIGNED
      FROM DPA_NOTIFY
      WHERE ID_PEOPLE_RECEIVER = @idPeople@ AND (ID_GROUP_RECEIVER = @idGroup@ OR ID_GROUP_RECEIVER = 0)
      ORDER BY DTA_EVENT desc
    </value>
  </query>

  <query>
    <name>D_DPA_NOTIFY</name>
    <value>
      DELETE FROM DPA_NOTIFY
      WHERE SYSTEM_ID = @idNotification@
    </value>
  </query>

  <query>
    <name>D_DPA_NOTIFY_MULTIPLICITY_ONE</name>
    <value>
      DELETE FROM DPA_NOTIFY
      WHERE ID_EVENT = @idEvent@
    </value>
  </query>

  <query>
    <name>D_DPA_NOTIFY_MULTIPLICITY_ALL</name>
    <value>
      DELETE FROM DPA_NOTIFY
      WHERE ID_EVENT = @idEvent@ AND
      ID_PEOPLE_RECEIVER = @idPeople@ AND
      ID_GROUP_RECEIVER = @idGroup@
    </value>
  </query>

  <query>
    <name>U_DATE_REMOVE_FROM_NC</name>
    <value>
      UPDATE DPA_TRASM_UTENTE
      SET DTA_RIMOZIONE_TODOLIST = GETDATE()
      WHERE SYSTEM_ID =
      (SELECT SYSTEM_ID
      FROM DPA_TRASM_UTENTE
      WHERE ID_TRASM_SINGOLA = @idTrasmSing@
      AND ID_PEOPLE = @idPeople@
      )
    </value>
  </query>

  <query>
    <name>I_DPA_NOTIFY_HISTORY</name>
    <value>
      INSERT INTO DPA_NOTIFY_HISTORY
      VALUES(@values@)
    </value>
  </query>

  <query>
    <name>U_DPA_NOTIFY_READ_NOTIFICATION</name>
    <value>
      UPDATE DPA_NOTIFY
      SET READ_NOTIFICATION = 1
      WHERE SYSTEM_ID = @idNotify@
    </value>
  </query>

  <query>
    <name>S_DPA_NOTIFY_NUMBER_NOTIFY_OTHER_ROLES</name>
    <value>
      SELECT COUNT(*)
      FROM DPA_NOTIFY
      WHERE ID_PEOPLE_RECEIVER = @idPeople@  AND (NOT(ID_GROUP_RECEIVER = @idGroup@) OR ID_GROUP_RECEIVER = 0)
    </value>
  </query>
  <query>
    <name>ARCHIVE_S_DPATipoAtto</name>
    <value>
      SELECT DISTINCT(DPA_TIPO_ATTO.SYSTEM_ID), VAR_DESC_ATTO
      FROM DPA_TIPO_ATTO
      where ID_AMM=@param2@ --1
      OR ID_AMM IS NULL
      ORDER BY @param1@ --VAR_DESC_ATTO
    </value>
  </query>



  <!-- QUERY NUOVA_ADL -->
  <query>
    <name>S_DOC_IN_ADLROLE</name>
    <value>
      SELECT DISTINCT(SYSTEM_ID) FROM DPA_AREA_LAVORO
      WHERE ID_PROFILE = @idDoc@
      AND ID_RUOLO_IN_UO = @idRole@ and id_people = 0
    </value>
  </query>
  <query>
    <name>S_FASC_IN_ADLROLE</name>
    <value>
      SELECT DISTINCT(SYSTEM_ID) FROM DPA_AREA_LAVORO
      WHERE ID_PROJECT = @idFasc@
      AND ID_RUOLO_IN_UO = @idRole@ and id_people = 0
    </value>
  </query>

  <!-- END QUERY NUOVA_ADL  -->

  <query>
    <name>I_DPA_UA_INFO</name>
    <value>
      INSERT INTO DPA_UA_INFO
      (USER_ID,
      ID_PEOPLE,
      DTA_LOGIN,
      IP,
      BROWSER_TYPE,
      BROWSER_VERSION,
      ACTIVEX,
      JAVASCRIPT,
      JAVAAPPLET,
      USER_AGENT)
      VALUES
      ('@userId@',
      @idPeople@,
      getDate(),
      '@ip@',
      '@browserType@',
      '@browserVersion@',
      @activex@,
      @javascript@,
      @javaapplet@,
      '@userAgent@')
    </value>
  </query>
  <!-- QUERY PER STAMPE REGISTRO CONSERVAZIONE -->
  <query>
    <name>S_REG_CONS_GET_NUM_ENABLED</name>
    <value>
      SELECT COUNT(*) AS N_AMM
      FROM dpa_config_stampa_cons
      WHERE disabled=0
    </value>
  </query>
  <query>
    <name>S_REG_CONS_GET_LIST_ENABLED_AMM</name>
    <value>
      SELECT c.id_amm, c.print_freq, c.printer_user_id, c.printer_role_id,
      c.dta_last_print, c.dta_next_print, c.print_hour, c.id_last_printed_event, r.id_last_event_to_print
      FROM dpa_config_stampa_cons c
      INNER JOIN
      (SELECT id_amm, MAX(system_id) AS id_last_event_to_print FROM dpa_registro_conservazione GROUP BY id_amm) r
      ON c.id_amm=r.id_amm
      WHERE disabled=0
    </value>
  </query>
  <query>
    <name>S_REG_CONS_VERIFY_SYS_ID</name>
    <value>
      SELECT COUNT(system_id) AS totId
      FROM dpa_registro_conservazione
      WHERE id_amm = @id_amm@
      AND system_id &gt; @system_id@
      AND cha_printed = 0
    </value>
  </query>
  <query>
    <name>S_REG_CONS_GET_INFOUTENTE</name>
    <value>
      SELECT id_people, system_id
      FROM dpa_corr_globali
      WHERE var_codice = @user_id@
    </value>
  </query>
  <query>
    <name>S_REG_CONS_GET_LIST_ISTANZE</name>
    <value>
      SELECT DISTINCT id_istanza
      FROM dpa_registro_conservazione
      WHERE id_amm = @id_amm@ AND
      system_id &gt; @next_system_id@ AND
      system_id &lt;= @last_system_id@
    </value>
  </query>
  <query>
    <name>S_REG_CONS_GET_LIST_DOC_ISTANZE</name>
    <value>
      SELECT DISTINCT id_oggetto
      FROM dpa_registro_conservazione
      WHERE id_amm = @id_amm@ AND
      system_id &gt; @next_system_id@ AND
      system_id &lt;= @last_system_id@ AND
      cha_tipo_oggetto = 'D' AND
      id_istanza = @id_istanza@ AND
      id_oggetto IS NOT NULL
    </value>
  </query>
  <query>
    <name>S_REG_CONS_STAMPA_ISTANZA</name>
    <value>
      SELECT DISTINCT rc.system_id, rc.var_desc_azione, rc.userid_operatore,
      CONVERT(datetime, rc.dta_operazione, 103) AS dta_operazione,
      rc.cha_esito, rc.cha_tipo_oggetto
      FROM dpa_registro_conservazione rc
      WHERE rc.id_amm = @id_amm@
      AND rc.system_id &gt; @next_system_id@
      AND rc.system_id &lt;= @last_system_id@
      AND rc.id_istanza = @id_istanza@
      AND rc.cha_tipo_oggetto='I'
      ORDER BY rc.dta_operazione
    </value>
  </query>
  <query>
    <name>S_REG_CONS_STAMPA_DOCUMENTO</name>
    <value>
      SELECT DISTINCT rc.system_id, rc.var_desc_azione, rc.userid_operatore,
      CONVERT(datetime, rc.dta_operazione, 103) AS dta_operazione,
      rc.cha_esito, rc.cha_tipo_oggetto
      FROM dpa_registro_conservazione rc
      WHERE rc.id_amm = @id_amm@
      AND rc.system_id &gt; @next_system_id@
      AND rc.system_id &lt;= @last_system_id@
      AND rc.id_istanza = @id_istanza@
      AND rc.id_oggetto = @id_oggetto@
      AND rc.cha_tipo_oggetto='D'
      ORDER BY rc.dta_operazione
    </value>
  </query>
  <query>
    <name>U_REG_CONS_UPDATE_CONFIG</name>
    <value>
      UPDATE dpa_config_stampa_cons
      SET
      dta_last_print=CONVERT(DATETIME,'@lastPrintDate@', 105),
      dta_next_print=CONVERT(DATETIME,'@nextPrintDate@', 105),
      id_last_printed_event=@idLastPrintedEvent@
      WHERE id_amm=@idAmm@
    </value>
  </query>
  <query>
    <name>U_REG_CONS_MOD_NEXT_PRINT_DATE</name>
    <value>
      UPDATE dpa_config_stampa_cons
      SET
      dta_next_print=CONVERT(DATETIME,'@ndate@', 105)
      WHERE id_amm=@idAmm@
    </value>
  </query>
  <query>
    <name>I_REG_CONS_SAVE_PRINT</name>
    <value>
      INSERT INTO dpa_stampa_conservazione
      (
      id_amm,
      print_date,
      id_profile,
      id_last_printed_event,
      id_first_printed_event)
      VALUES
      (
      @id_amm@,
      GETDATE(),
      @id_profile@,
      @next_system_id@,
      @last_system_id@)
    </value>
  </query>
  <query>
    <name>U_REG_CONS_PRINTED_ITEMS</name>
    <value>
      UPDATE dpa_registro_conservazione
      SET cha_printed=1
      WHERE id_amm = @id_amm@
      AND system_id &gt;  @next_system_id@
      AND system_id &lt;= @last_system_id@
    </value>
  </query>
  <query>
    <name>S_REG_CONS_SUMMARY_DATA_IST</name>
    <value>
      SELECT i.var_descrizione, i.data_apertura, i.data_invio, d.n_doc, d.tot_size
      FROM dpa_area_conservazione i,
      (
      SELECT COUNT(*) AS n_doc, SUM(size_item) AS tot_size, id_conservazione
      FROM dpa_items_conservazione
      GROUP BY id_conservazione
      ) d
      WHERE i.system_id = d.id_conservazione
      AND i.system_id=@id_istanza@
    </value>
  </query>
  <query>
    <name>S_REG_CONS_SUMMARY_DATA_DOC</name>
    <value>
      SELECT data_ins, var_oggetto, cod_fasc, numero_allegati, var_tipo_file, size_item
      FROM dpa_items_conservazione
      WHERE id_profile=@id_doc@
    </value>
  </query>
  <query>
    <name>U_REG_CONS_TIPO_PROTO</name>
    <value>
      UPDATE profile
      SET cha_tipo_proto = '@tipo_proto@'
      WHERE system_id = @docnumber@
    </value>
  </query>
  <query>
    <name>S_SEGNATURA_ID_DOC</name>
    <value>
      select DOCSADM.vardescribe(@idDoc@,'SEGNATURA_DOCNUMBER') from profile where system_id = @idDoc@
    </value>
  </query>
  <query>
    <name>S_REG_CONS_RICERCA_STAMPE_CONS</name>
    <value>
      SELECT sc.system_id, sc.print_date, p.var_prof_oggetto, sc.id_profile, p.cha_firmato
      FROM dpa_stampa_conservazione sc, profile p
      WHERE id_amm = @id_amm@
      AND p.system_id = sc.id_profile
      @p_firma@
      @p_data@
      ORDER BY sc.print_date ASC
    </value>
  </query>
  <query>
    <name>I_DPA_CONFIG_STAMPA_CONS</name>
    <value>
      INSERT INTO DPA_CONFIG_STAMPA_CONS
      (
      -- Mod per sql
      @col_id@
      -- end mod sql
      -- SYSTEM_ID,
      ID_AMM,
      DISABLED,
      PRINT_FREQ,
      DTA_NEXT_PRINT,
      PRINT_HOUR
      )
      values
      (
      @seq@
      @id_amm@,
      @disabled@,
      @print_freq@,
      CONVERT(DATETIME,'@dta_next_print@', 105),
      @print_hour@
      )
    </value>
  </query>
  <query>
    <name>U_DPA_CONFIG_STAMPA_CONS</name>
    <value>
      UPDATE DPA_CONFIG_STAMPA_CONS
      SET DISABLED = @disbled@,
      PRINT_FREQ = @print_freq@,
      DTA_NEXT_PRINT = CONVERT(DATETIME,'@dta_next_print@', 105),
      PRINT_HOUR = @print_hour@
      WHERE ID_AMM = @idAmm@
    </value>
  </query>
  <query>
    <name>S_DPA_CONFIG_STAMPA_CONS_ORA_STAMPA</name>
    <value>
      SELECT CONVERT(DATETIME,'@dta_next_print@', 105)||'_'||s.print_hour as info_next_print
      FROM dpa_config_stampa_cons s
      WHERE ID_AMM = @idAmm@
    </value>
  </query>

  <!-- QUERY update mesi conservazione doc e fasc -->
  <query>
    <name>PD_UPDATE_MESICONS_DOC</name>
    <value>
      UPDATE DPA_TIPO_ATTO
      SET NUM_MESI_CONSERVAZIONE = @NUM_MESI_CONSERVAZIONE@
      WHERE
      SYSTEM_ID = @idTemplate@
    </value>
  </query>
  <query>
    <name>PD_UPDATE_MESICONS_FASC</name>
    <value>
      UPDATE DPA_TIPO_FASC
      SET NUM_MESI_CONSERVAZIONE = @NUM_MESI_CONSERVAZIONE@
      WHERE
      SYSTEM_ID = @idTemplate@
    </value>
  </query>
  <query>
    <name>PD_UPDATE_INVIOCONS_DOC</name>
    <value>
      UPDATE DPA_TIPO_ATTO
      SET CHA_INVIO_CONSERVAZIONE = @INVIO_CONSERVAZIONE@
      WHERE
      SYSTEM_ID = @idTemplate@
    </value>
  </query>
  <query>
    <name>PD_UPDATE_CONSOLIDA_CAMPO</name>
    <value>
      UPDATE DPA_OGGETTI_CUSTOM
      SET CHA_CONSOLIDAMENTO = @CHA_CONSOLIDAMENTO@
      @CONSERVAZIONE@
      WHERE
      SYSTEM_ID = @idOggCustom@
    </value>
  </query>
  <query>
    <name>PD_UPDATE_CONSERVA_CAMPO</name>
    <value>
      UPDATE DPA_OGGETTI_CUSTOM
      SET CHA_CONSERVAZIONE = @CHA_CONSERVAZIONE@
      @CONSOLIDAMENTO@
      WHERE
      SYSTEM_ID = @idOggCustom@
    </value>
  </query>
  <query>
    <name>PD_UPDATE_PROCEDIMENTALE_DOC</name>
    <value>
      UPDATE DPA_TIPO_ATTO
      SET CHA_PROCEDIMENTALE = '@PROCEDIMENTALE@'
      WHERE
      SYSTEM_ID = @idTemplate@
    </value>
  </query>
  <query>
    <name>S_DPA_TRASM_SING_CORR_GLOBALI</name>
    <value>
      SELECT c.VAR_DESC_CORR
      FROM DPA_TRASM_SINGOLA a, dpa_corr_globali c
      WHERE a.ID_CORR_GLOBALE = c.SYSTEM_ID
      and a.cha_tipo_dest = 'R'
      @param1@
    </value>
  </query>
  <query>
    <name>PD_UPDATE_PROCEDIMENTALE_FASC</name>
    <value>
      UPDATE DPA_TIPO_FASC
      SET CHA_PROCEDIMENTALE = '@PROCEDIMENTALE@'
      WHERE
      SYSTEM_ID = @idTemplate@
    </value>
  </query>
  <!-- END QUERY update mesi conservazione doc e fasc -->
  <query>
    <name>S_CODA_PROCESSO_FILEINFO</name>
    <value>
      SELECT TOP @rowCount@
      C.DOCNUMBER,
      C.VERSION_ID,
      C.PATH,
      C.CHA_FIRMATO,
      PE.ID_AMM,
      P.AUTHOR,
      P.ID_RUOLO_CREATORE,
      C.FILE_INFO
      FROM COMPONENTS C , PROFILE P, PEOPLE PE
      WHERE FILE_INFO LIKE '%8' and
      C.CHA_FIRMATO = '1' AND
      C.DOCNUMBER = P.DOCNUMBER
      AND  P.AUTHOR = PE.SYSTEM_ID
      ORDER BY C.DTA_FILE_ACQUIRED DESC
    </value>
  </query>
  <query>
    <name>S_CODA_PROCESSO_SIGN_TYPE</name>
    <value>
      SELECT TOP @rowCount@
      C.DOCNUMBER,
      C.VERSION_ID,
      C.PATH,
      C.CHA_FIRMATO,
      C.VAR_NOMEORIGINALE,
      PE.ID_AMM,
      P.AUTHOR,
      P.ID_RUOLO_CREATORE,
      C.CHA_TIPO_FIRMA
      FROM COMPONENTS C , PROFILE P, PEOPLE PE
      WHERE C.CHA_TIPO_FIRMA IS NULL and
      C.CHA_FIRMATO = '1' AND
      C.DOCNUMBER = P.DOCNUMBER
      AND  P.AUTHOR = PE.SYSTEM_ID
      AND C.VERSION_ID IN (
      SELECT MAX(VERSION_ID)
      FROM COMPONENTS
      WHERE DOCNUMBER =  C.DOCNUMBER )
      ORDER BY C.DTA_FILE_ACQUIRED DESC
    </value>
  </query>
  <query>
    <name>S_LOG_CONSERVAZIONE_AZIONE</name>
    <value>
      SELECT DISTINCT var_codice, var_descrizione
      FROM dpa_anagrafica_log
      WHERE var_oggetto='CONSERVAZIONE'
      AND var_codice NOT LIKE 'AMM_%'
      ORDER BY var_descrizione
    </value>
  </query>
  <!-- PEC 4 - requisito 5 - storico spedizioni -->
  <query>
    <name>I_DPA_SEND_STO</name>
    <value>
      INSERT INTO DPA_SEND_STO
      (ID_CORR_GLOBALE, ID_PROFILE, MAIL, DTA_SPEDIZIONE, ESITO, ID_DOCUMENTTYPE,ID_GROUP_SENDER,MAIL_MITTENTE,ID_REG_MAIL_MITTENTE)
      VALUES(
      @idCorrispondente@,
      @idProfile@,
      '@mail@',
      GETDATE(),
      @esito@,
      (SELECT ID_DOCUMENTTYPES FROM DPA_DOC_ARRIVO_PAR WHERE ID_MITT_DEST=@idCorrispondente@ AND ID_PROFILE=@idProfile@),
      @idGruppoMittente@,
      '@mail_mittente@',
      @id_reg_mail_mittente@)
    </value>
  </query>
  <query>
    <name>S_DPA_SEND_STO_BY_IDDOCUMENT</name>
    <value>
      SELECT B.DOCNUMBER AS ID_DOCUMENT,
      B.var_prof_oggetto AS OGGETTO_DOCUMENTO ,
      c.var_desc_corr AS CORRISPONDENTE,
      d.description AS MEZZO,
      A.mail AS MAIL,
      A.mail_mittente AS MAIL_MITTENTE,
      A.esito AS ESITO,
      a.dta_spedizione AS DTA_SPEDIZIONE,
      a.SYSTEM_ID AS ID,
      a.ID_GROUP_SENDER as ID_GROUP_SENDER
      FROM DPA_SEND_STO A, PROFILE B, DPA_CORR_GLOBALI C , DOCUMENTTYPES D
      WHERE a.id_profile = B.system_id
      AND a.id_corr_globale= c.system_id
      AND a.id_documenttype= d.system_id
      AND A.ID_PROFILE=@idDocument@
      ORDER BY CORRISPONDENTE, DTA_SPEDIZIONE DESC
    </value>
  </query>
  <query>
    <name>U_DPA_SEND_STO</name>
    <value>
      UPDATE DPA_SEND_STO
      SET ESITO=@esito@, DTA_SPEDIZIONE = GETDATE()
      WHERE ID_PROFILE = @idProfile@
      AND ID_CORR_GLOBALE = @idCorrispondente@
      AND ID_GROUP_SENDER = @idRuolo@
      AND ESITO = 'In fase di spedizione'
    </value>
  </query>
  <query>
    <name>U_DPA_SEND_STO_ERRORE</name>
    <value>
      UPDATE DPA_SEND_STO
      SET ESITO=@esito@, DTA_SPEDIZIONE = GETDATE()
      WHERE ID_PROFILE = @idProfile@
      AND ID_GROUP_SENDER = @idRuolo@
      AND ESITO = 'In fase di spedizione'
    </value>
  </query>
  <!-- PEC 4 maschera caratteri -->
  <query>
    <name>S_DPASI_STATUSMASK</name>
    <value>
      SELECT A.STATUS_C_MASK AS STATUSMASK, B.TYPE_ID AS TIPO
      FROM DPA_STATO_INVIO A, DOCUMENTTYPES B
      WHERE A.VAR_INDIRIZZO = '@address@'
      AND A.ID_PROFILE=@idprofile@
      AND A.ID_DOCUMENTTYPE=B.SYSTEM_ID
    </value>
  </query>
  <!-- PEC 4 Report spedizioni -->
  <query>
    <name>GET_REPORT_SPEDIZIONI_MASTER</name>
    <value>
      SELECT DISTINCT A.ID_PROFILE AS IDDOCUMENT, MAX(A.dta_spedizione) AS DTA_ULTIMA_SPED
      FROM DPA_STATO_INVIO A, PROFILE B, DOCUMENTTYPES C, DPA_CORR_GLOBALI D
      WHERE A.ID_PROFILE= B.SYSTEM_ID AND
      A.ID_DOCUMENTTYPE= C.SYSTEM_ID
      AND A.ID_CORR_GLOBALE = D.SYSTEM_ID
      AND EXISTS (select  'x' from security e where b.system_id=e.thing and e.PERSONORGROUP in (@idPeople@, @idGruppo@) and e.ACCESSRIGHTS>0)
      @filters@
      @filtersEsito@
      GROUP BY A.ID_PROFILE
      ORDER BY MAX(A.DTA_SPEDIZIONE) DESC
    </value>
  </query>
  <query>
    <name>GET_REPORT_SPEDIZIONI_DETAILS</name>
    <value>
      SELECT A.ID_PROFILE AS IDDOCUMENT,
      B.DOCNAME AS PROTOCOLLO,
      b.NUM_PROTO as NUM_PROTOCOLLO,
      B.VAR_PROF_OGGETTO AS OGGETTO,
      C.DESCRIPTION AS MEZZO,
      C.TYPE_ID AS TYPE_ID_MEZZO,
      D.VAR_DESC_CORR AS DESTINATARIO,
      A.VAR_INDIRIZZO AS MAIL,
      A.DTA_SPEDIZIONE AS DATASPEDIZIONE,
      A.STATUS_C_MASK AS MASK,
      E.CHA_TIPO_MITT_DEST AS TIPO_DEST,
      A.VAR_PROTO_DEST AS PROTO_DEST,
      A.DTA_PROTO_DEST AS DATA_PROTO_DEST,
      A.VAR_MOTIVO_ANNULLA AS MOTIVO_ANNULLA,
      (SELECT MAX(mail_mittente) FROM DPA_SEND_STO k WHERE k.esito='Spedito' and k.dta_spedizione>=a.dta_spedizione and k.id_profile=a.id_profile and k.id_corr_globale=a.id_corr_globale) AS MAIL_MITTENTE
      FROM DPA_STATO_INVIO A, PROFILE B, DOCUMENTTYPES C, DPA_CORR_GLOBALI D, DPA_DOC_ARRIVO_PAR E
      WHERE A.ID_PROFILE= B.SYSTEM_ID AND
      A.ID_DOCUMENTTYPE= C.SYSTEM_ID
      AND A.ID_CORR_GLOBALE = D.SYSTEM_ID AND
      E.ID_PROFILE= A.ID_PROFILE AND
      E.ID_MITT_DEST= A.ID_CORR_GLOBALE
      @filters@
      ORDER BY A.ID_DOC_ARRIVO_PAR
    </value>
  </query>
  <query>
    <name>GET_REPORT_SPEDIZIONI_BY_DOCUMENTO</name>
    <value>
      SELECT A.ID_PROFILE AS IDDOCUMENT,
      B.DOCNAME AS PROTOCOLLO,
      b.NUM_PROTO as NUM_PROTOCOLLO,
      B.VAR_PROF_OGGETTO AS OGGETTO,
      C.DESCRIPTION AS MEZZO,
      C.TYPE_ID AS TYPE_ID_MEZZO,
      D.VAR_DESC_CORR AS DESTINATARIO,
      A.VAR_INDIRIZZO AS MAIL,
      A.DTA_SPEDIZIONE AS DATASPEDIZIONE,
      A.STATUS_C_MASK AS MASK,
      E.CHA_TIPO_MITT_DEST AS TIPO_DEST,
      A.VAR_PROTO_DEST AS PROTO_DEST,
      A.DTA_PROTO_DEST AS DATA_PROTO_DEST,
      A.VAR_MOTIVO_ANNULLA AS MOTIVO_ANNULLA,
      (SELECT MAX(mail_mittente) FROM DPA_SEND_STO k WHERE k.esito='Spedito' and k.dta_spedizione>=a.dta_spedizione and k.id_profile=a.id_profile and k.id_corr_globale=a.id_corr_globale) AS MAIL_MITTENTE
      FROM DPA_STATO_INVIO A, PROFILE B, DOCUMENTTYPES C, DPA_CORR_GLOBALI D, DPA_DOC_ARRIVO_PAR E
      WHERE A.ID_PROFILE= B.SYSTEM_ID AND
      A.ID_DOCUMENTTYPE= C.SYSTEM_ID
      AND A.ID_CORR_GLOBALE = D.SYSTEM_ID AND
      E.ID_PROFILE= A.ID_PROFILE AND
      E.ID_MITT_DEST= A.ID_CORR_GLOBALE
      @filters@
      AND A.ID_PROFILE = @iddocumento@
      ORDER BY A.ID_DOC_ARRIVO_PAR
    </value>
  </query>

  <!-- Query report conservazione 1.3 -->
  <query>
    <name>S_REPORT_ISTANZE_CONSERVAZIONE</name>
    <value>
      SELECT AC.SYSTEM_ID as ID_ISTANZA,
      AC.VAR_DESCRIZIONE as DESCRIZIONE,
      DATA_INVIO,DATA_CONSERVAZIONE AS DATA_CHIUSURA,
      AC.DATA_RIFIUTO,
      (SELECT COUNT(IC.SYSTEM_ID) from DPA_ITEMS_CONSERVAZIONE IC where AC.SYSTEM_ID = IC.ID_CONSERVAZIONE) as NUMERO_DOCUMENTI,
      (SELECT CONVERT(DECIMAL(10,2),(SUM(IC.SIZE_ITEM)/1048576)) from DPA_ITEMS_CONSERVAZIONE IC where AC.SYSTEM_ID = IC.ID_CONSERVAZIONE) as DIMENSIONE,
      DATEDIFF(DAY,ac.DATA_INVIO,ac.DATA_CONSERVAZIONE) as GIORNI_LAVORAZIONE_C,
      DATEDIFF(DAY,ac.DATA_INVIO,ac.DATA_RIFIUTO) as GIORNI_LAVORAZIONE_R
      FROM DPA_AREA_CONSERVAZIONE AC , DPA_ITEMS_CONSERVAZIONE IC
      where AC.SYSTEM_ID = IC.ID_CONSERVAZIONE
      @filterParam@
      ORDER BY ID_ISTANZA
    </value>
  </query>
  <query>
    <name>S_REPORT_VER_PERIODICHE_ISTANZE_CONSERVAZIONE</name>
    <value>
      SELECT
      a.ID_ISTANZA, a.ID_SUPPORTO, d.VAR_DESCRIZIONE,
      CONVERT(VARCHAR(10),DATA_INVIO,103) AS DATA_INVIO,
      CONVERT(VARCHAR(10),DATA_PRODUZIONE,103) AS DATA_CREAZIONE_SUPP,
      CONVERT(VARCHAR(10),DATA_CONSERVAZIONE,103)AS DATA_CHIUSURA,
      CONVERT(VARCHAR(20),DATA_VER,113)AS DATA_VERIFICA,
      a.VAR_NOTE as DESC_VER,a.PERCENTUALE, a.ESITO
      from DPA_CONS_VERIFICA a,
      DPA_SUPPORTO b,
      DPA_AREA_CONSERVAZIONE c,
      DPA_TIPO_SUPPORTO d
      where a.ID_SUPPORTO = b.SYSTEM_ID
      and b.ID_CONSERVAZIONE = c.SYSTEM_ID
      and b.ID_TIPO_SUPPORTO = d.SYSTEM_ID
      and a.ID_ISTANZA = c.SYSTEM_ID
      @filterParam@
      ORDER BY ID_ISTANZA,DATA_VERIFICA
    </value>
  </query>
  <query>
    <name>S_REPORT_STORIA_ISTANZE_CONSERVAZIONE</name>
    <value>
      SELECT DISTINCT
      c.SYSTEM_ID as ID_ISTANZA,r.DTA_OPERAZIONE as DATA_OPERAZIONE,r.USERID_OPERATORE as OPERATORE,
      r.VAR_DESC_AZIONE as DETTAGLI,r.CHA_ESITO as ESITO
      FROM DPA_AREA_CONSERVAZIONE C,
      DPA_REGISTRO_CONSERVAZIONE R
      WHERE r.ID_ISTANZA = c.SYSTEM_ID
      AND r.CHA_TIPO_OGGETTO = 'I'
      @filterParam@
      ORDER BY ID_ISTANZA,DATA_OPERAZIONE
    </value>
  </query>
  <query>
    <name>S_REPORT_STORIA_DOCUMENTI_CONSERVAZIONE</name>
    <value>
      SELECT DISTINCT
      DOCSADM.Vardescribe(p.system_id, 'SEGNATURA_DOCNUMBER') as ID_DOCUMENTO,
      c.SYSTEM_ID as ID_ISTANZA,r.DTA_OPERAZIONE as DATA_OPERAZIONE,r.USERID_OPERATORE as OPERATORE,
      r.VAR_DESC_AZIONE as DETTAGLI,r.CHA_ESITO as ESITO
      FROM DPA_AREA_CONSERVAZIONE C,
      DPA_REGISTRO_CONSERVAZIONE R,
      PROFILE P
      WHERE r.ID_ISTANZA = c.SYSTEM_ID
      AND r.ID_OGGETTO = p.SYSTEM_ID
      AND r.CHA_TIPO_OGGETTO = 'D'
      @filterParam@ ORDER BY ID_DOCUMENTO,DATA_OPERAZIONE
    </value>
  </query>
  <query>
    <name>S_REPORT_VERIFICHE_IN_FASE</name>
    <value>
      select
      c.system_id as id_istanza,CONVERT(VARCHAR(20),c.DATA_INVIO,113) as data_invio,
      DOC_TOT.NUM_DOC as N_DOCUMENTI, DOC_VALIDI.NUM_DOCVALIDI as N_DOCUMENTI_VALIDI,
      DOC_FNONVALIDI.NUM_DOCFNONVALIDI as N_DOCUMENTI_FORM_NVALIDO,DOC_FIRMAINVALIDA.NUM_FIRMANONVALIDA as N_DOCUMENTI_FIRMA_NVALIDA,
      DOC_MARCANONVALIDA.NUM_MARCANONVALIDA as N_DOCUMENTI_MARCA_NVALIDA,DOC_PNONVALIDA.NUM_PNONVALIDA as N_DOCUMENTI_PNONCONFORME,
      VER.percentuale as VER_LEGG_DIM_CAMP,VER.esito as VER_LEGG_ESITO
      from dpa_area_conservazione c
      left outer join
      (
      select ID_CONSERVAZIONE, count(*) NUM_DOC
      from dpa_items_conservazione
      where not id_profile is null
      group by id_conservazione
      ) DOC_TOT on c.system_id = DOC_TOT.ID_CONSERVAZIONE
      left outer join
      (
      select ID_CONSERVAZIONE, count(*) NUM_DOCVALIDI
      from dpa_items_conservazione
      where validazione_formato= '1'
      AND (validazione_marca = '1' OR validazione_marca is null)
      AND (esito_firma = '1' OR esito_firma is null)
      AND
      ((validazione_firma!='4')
      AND (validazione_firma!='5')
      AND (validazione_firma!='6')
      AND (validazione_firma!='7')
      or (validazione_firma is null)
      )
      group by id_conservazione
      ) DOC_VALIDI on c.system_id = DOC_VALIDI.ID_CONSERVAZIONE
      left outer join
      (
      select ID_CONSERVAZIONE, count(*) NUM_DOCFNONVALIDI
      from dpa_items_conservazione
      where validazione_firma = '4'
      or validazione_firma = '5'
      or validazione_firma = '6'
      or validazione_firma = '7'
      group by id_conservazione
      ) DOC_FNONVALIDI on c.system_id = DOC_FNONVALIDI.ID_CONSERVAZIONE
      left outer join
      (
      select ID_CONSERVAZIONE, count(*) NUM_FIRMANONVALIDA
      from dpa_items_conservazione
      where validazione_firma = '2'
      or validazione_firma = '6'
      group by id_conservazione
      ) DOC_FIRMAINVALIDA on c.system_id = DOC_FIRMAINVALIDA.ID_CONSERVAZIONE
      left outer join
      (
      select ID_CONSERVAZIONE, count(*) NUM_MARCANONVALIDA
      from dpa_items_conservazione
      where validazione_firma = '3'
      or validazione_firma = '7'
      or validazione_marca = '0'
      group by id_conservazione
      ) DOC_MARCANONVALIDA on c.system_id = DOC_MARCANONVALIDA.ID_CONSERVAZIONE
      left outer join
      (
      select ID_CONSERVAZIONE, count(*) NUM_PNONVALIDA
      from dpa_items_conservazione
      where policy_valida = '1'
      group by id_conservazione
      ) DOC_PNONVALIDA on c.system_id = DOC_PNONVALIDA.ID_CONSERVAZIONE
      left outer join
      (
      select id_istanza, percentuale, esito
      from dpa_cons_verifica
      where var_note = 'Verifica Leggibilità per chiusura'
      ) VER on c.system_id = VER.id_istanza
      WHERE c.DATA_INVIO is not null
      @filterParam@
      order by c.system_id

    </value>
  </query>

  <!-- End query report conservazione 1.3 -->
  <!-- MEV CONS 1.3 - Query report notifica chiusura e rifiuto istanze -->
  <query>
    <name>S_NOTIFICHE_RIFIUTO_REPORT</name>
    <value>
      SELECT cha_tipo_doc AS TIPO_DOC, var_oggetto AS OGGETTO, cod_fasc,
      CONVERT(datetime, data_ins, 103) AS DATA_INS,
      DOCSADM.Vardescribe(dpa_items_conservazione.id_profile, 'SEGNATURA_DOCNUMBER') as SEGNATURA,
      DOCSADM.Vardescribe(dpa_items_conservazione.id_profile, 'DATADOC') as DATA_PROT_OR_CREA,
      size_item, validazione_firma, esito_firma, validazione_marca, validazione_formato
      FROM dpa_items_conservazione
      WHERE id_conservazione = @idIst@
      ORDER BY cod_fasc
    </value>
  </query>
  <query>
    <name>S_NOTIFICHE_RIFIUTO_REPORT_POLICY</name>
    <value>
      SELECT cha_tipo_doc AS TIPO_DOC, var_oggetto AS OGGETTO, cod_fasc,
      CONVERT(datetime, data_ins, 103) AS DATA_INS,
      DOCSADM.Vardescribe(dpa_items_conservazione.id_profile, 'SEGNATURA_DOCNUMBER') as SEGNATURA,
      DOCSADM.Vardescribe(dpa_items_conservazione.id_profile, 'DATADOC') as DATA_PROT_OR_CREA,
      mask_validazione_policy
      FROM dpa_items_conservazione
      WHERE id_conservazione = @idIst@
      ORDER BY cod_fasc
    </value>
  </query>
  <!-- MEV CONS 1.3 - Fine query report notifica chiusura e rifiuto istanze -->
  <query>
    <name>S_FIRSTDAY_YEAR</name>
    <value>
      select '01/01/' + CONVERT(VARCHAR(4), YEAR(GETDATE())) as DAY
    </value>
  </query>
  <!--Mev Cons 1.4 Esibizione-->
  <query>
    <name>S_GET_COUNT_ITEMS_ESIBIZIONE</name>
    <value>
      select ae.cha_stato as stato, ae.cha_certificazione as certificata,
      count(ae.system_id) as totale
      from dpa_area_esibizione ae
      inner join dpa_amministra a on ae.id_amm = a.system_id
      where a.var_codice_amm = '@codiceAmministrazione@'
      and ae.id_ruolo_in_uo = @idRuoloInUo@
      and ae.id_people = @idPeople@
      group by ae.cha_stato, ae.cha_certificazione
    </value>
  </query>
  <query>
    <name>U_SizeItemEsib</name>
    <value>
      UPDATE DPA_ITEMS_ESIBIZIONE
      SET SIZE_ITEM=@size@
      WHERE SYSTEM_ID=@sysId@
    </value>
  </query>
  <query>
    <name>U_DPA_ITEMS_ESIB</name>
    <value>
      UPDATE DPA_ITEMS_ESIBIZIONE
      SET
      @param1@
      WHERE
      @param2@
    </value>
  </query>
  <query>
    <name>S_getInEsibizione</name>
    <value>
      select @dbUser@.getInEsibizione(@idProfile@, @idProject@, '@typeId@', @idPeople@, @idGruppo@, @idIstanzaConservazione@) as inEsibizione
    </value>
  </query>
  <query>
    <name>S_ISTANZE_ESIBIZIONE</name>
    <value>
      SELECT e.system_id, e.id_amm, e.id_people, e.id_ruolo_in_uo,
      e.cha_stato, e.var_note, e.var_descrizione,
      CONVERT(datetime, e.data_creazione, 109) AS data_creazione,
      CONVERT(datetime, e.data_certificazione, 109) AS data_certificazione,
      CONVERT(datetime, e.data_chiusura, 109) AS data_chiusura,
      CONVERT(datetime, e.data_rifiuto, 109) AS data_rifiuto,
      e.cha_certificazione, e.id_profile_certificazione, e.var_note_rifiuto,
      DOCSADM.Vardescribe(e.ID_PEOPLE, 'PEOPLENAME') + '_' + DOCSADM.Vardescribe(e.id_ruolo_in_uo, 'GROUPNAME') AS RICHIEDENTE
      FROM dpa_area_esibizione e
      WHERE id_amm = @idAmm@
      @idIst@
      @certif@
      @ogg@
      @stato@
      @filtroDate@
      @visibilita@
      @order@
      --ORDER BY system_id
    </value>
  </query>
  <query>
    <name>S_ESIBIZIONE1</name>
    <value>
      SELECT
      @param1@
      DOCSADM.Vardescribe(DPA_ITEMS_ESIBIZIONE.ID_PROFILE, 'SEGNATURA_DOCNUMBER') AS SEGNATURA,
      DOCSADM.Vardescribe(DPA_ITEMS_ESIBIZIONE.ID_PROFILE, 'DATADOC') AS DATA_PROT_OR_CREA,
      DOCSADM.Vardescribe(DPA_ITEMS_ESIBIZIONE.ID_PROFILE, 'NUMPROTO') AS NUM_PROT,
      DOCSADM.getchaimg(DPA_ITEMS_ESIBIZIONE.DOCNUMBER) AS IMG_ACQUISITA
      @param2@
      @param3@
    </value>
  </query>
  <query>
    <name>D_ELIMINA_DOC_ESIBIZIONE</name>
    <value>
      DELETE FROM dpa_items_esibizione
      WHERE system_id IN (@idDoc@)
    </value>
  </query>
  <query>
    <name>U_ESIBIZIONE_FIELDS</name>
    <value>
      UPDATE dpa_area_esibizione
      SET
      @stato@
      @descrizione@
      @params@
      WHERE
      system_id=@idEs@
    </value>
  </query>
  <query>
    <name>U_ESIBIZIONE_RICHIEDI_CERTIF</name>
    <value>
      UPDATE dpa_area_esibizione
      SET
      cha_stato='I',
      cha_certificazione='1',
      id_profile_certificazione=@docNumber@
      WHERE
      system_id=@idEs@
    </value>
  </query>
  <query>
    <name>S_ESIBIZIONE_CERTIF</name>
    <value>
      SELECT
      DOCSADM.Vardescribe(DPA_ITEMS_ESIBIZIONE.ID_PROFILE, 'SEGNATURA_DOCNUMBER') AS SEGNATURA,
      DOCSADM.Vardescribe(DPA_ITEMS_ESIBIZIONE.ID_PROFILE, 'DATADOC') AS DATA_PROT_OR_CREA,
      DPA_ITEMS_ESIBIZIONE.var_oggetto, C.var_impronta
      FROM DPA_ITEMS_ESIBIZIONE, components C
      WHERE DPA_ITEMS_ESIBIZIONE.id_esibizione=@idEsib@
      AND DPA_ITEMS_ESIBIZIONE.id_profile = C.docnumber
    </value>
  </query>
  <query>
    <name>U_ESIBIZIONE_SALVA_CERT</name>
    <value>
      UPDATE dpa_area_esibizione
      SET
      cha_stato='@stato@',
      data_certificazione=@dataCert@,
      id_people_certificatore='@idPeopleCert@'
      WHERE
      system_id = @idEsib@
    </value>
  </query>
  <query>
    <name>U_ESIBIZIONE_RIFIUTA_CERT</name>
    <value>
      UPDATE dpa_area_esibizione
      SET
      cha_stato='R',
      data_rifiuto=@dataRif@,
      var_note_rifiuto='@noteRif@',
      id_people_certificatore='@idPeopleCert@'
      WHERE
      system_id=@idEsib@
    </value>
  </query>
  <query>
    <name>D_ESIBIZIONE_ELIMINA_ISTANZA</name>
    <value>
      DELETE FROM dpa_area_esibizione
      WHERE
      system_id = @idEsib@
    </value>
  </query>
  <query>
    <name>U_ESIBIZIONE_RIABILITA_ITEMS</name>
    <value>
      UPDATE dpa_items_esibizione
      SET
      id_esibizione = @newId@
      WHERE
      id_esibizione = @oldId@
    </value>
  </query>
  <query>
    <name>I_ISTANZE_ESIBIZIONE</name>
    <value>
      INSERT INTO dpa_area_esibizione
      (

      id_amm,
      id_people,
      id_ruolo_in_uo,
      cha_stato,
      var_note,
      var_descrizione,
      data_creazione,
      data_rifiuto
      )
      VALUES
      (

      @idAmm@,
      @idPeople@,
      @idRuolo@,
      'N',
      '@note@',
      '@descr@',
      @dataCreaz@,
      @dataRif@
      )
    </value>
  </query>
  <query>
    <name>U_ESIBIZIONE_STATO</name>
    <value>
      UPDATE
      dpa_area_conservazione
      SET
      cha_stato='@stato@'
      @params@
      WHERE
      system_id=@idEsib@
    </value>
  </query>
  <!--Mev Cons 1.4 Esibizione-->
  <!--MEW 1.5 inizio F02_01-->
  <query>
    <name>I_INSERT_VERIFICA_FORMATI_CONS</name>
    <value>
      INSERT INTO DPA_VERIFICA_FORMATI_CONS
      (

      ID_ISTANZA,
      ID_ITEM,
      DOCNUMBER,
      ID_PROJECT,
      ID_DOCPRINCIPALE,
      VERSION_ID,
      TIPO_FILE,
      ESTENSIONE,
      AMMESSO,
      VALIDO,
      CONSOLIDATO,
      ESITO,
      CONVERTIBILE,
      MODIFICA,
      UT_PROP,
      RUOLO_PROP,
      FIRMATA,
      MARCATA,
      DACONVERTIRE,
      CONVERTITO,
      ERRORE,
      TIPOERRORE
      )
      VALUES
      (

      @ID_ISTANZA@,
      @ID_ITEM@,
      @DOCNUMBER@ ,
      @ID_PROJECT@,
      @ID_DOCPRINCIPALE@,
      @VERSION_ID@,
      '@TIPO_FILE@',
      '@ESTENSIONE@',
      @AMMESSO@,
      @VALIDO@,
      @CONSOLIDATO@,
      '@ESITO@',
      @CONVERTIBILE@,
      @MODIFICA@,
      @UT_PROP@,
      @RUOLO_PROP@,
      @FIRMATA@,
      @MARCATA@,
      @DACONVERTIRE@,
      @CONVERTITO@,
      @ERRORE@,
      @TIPOERRORE@
      )
    </value>
  </query>
  <query>
    <name>U_UPDATE_VERIFICA_FORMATI_CONS</name>
    <value>
      UPDATE DPA_VERIFICA_FORMATI_CONS
      SET ID_ITEM = @ID_ITEM@,
      ID_PROJECT= @ID_PROJECT@,
      ID_DOCPRINCIPALE = @ID_DOCPRINCIPALE@,
      VERSION_ID = @VERSION_ID@,
      TIPO_FILE = '@TIPO_FILE@',
      ESTENSIONE = '@ESTENSIONE@',
      AMMESSO = @AMMESSO@,
      VALIDO = @VALIDO@,
      CONSOLIDATO = @CONSOLIDATO@,
      ESITO = '@ESITO@',
      CONVERTIBILE = @CONVERTIBILE@,
      MODIFICA = @MODIFICA@,
      UT_PROP = @UT_PROP@,
      RUOLO_PROP = @RUOLO_PROP@,
      FIRMATA = @FIRMATA@,
      MARCATA = @MARCATA@,
      DACONVERTIRE = @DACONVERTIRE@,
      CONVERTITO = @CONVERTITO@,
      ERRORE = @ERRORE@,
      TIPOERRORE= @TIPOERRORE@
      WHERE SYSTEM_ID = @SYSTEM_ID@
      AND ID_ISTANZA = @ID_ISTANZA@
      AND DOCNUMBER = @DOCNUMBER@
    </value>
  </query>
  <query>
    <name>S_SELECT_VERIFICA_FORMATI_CONS_BY_ID_ISTANZA</name>
    <value>
      SELECT *
      FROM DPA_VERIFICA_FORMATI_CONS
      WHERE ID_ISTANZA = @ID_ISTANZA@
    </value>
  </query>
  <query>
    <name>S_SELECT_VERIFICA_FORMATI_CONS_BY_DOCNUMBER</name>
    <value>
      SELECT *
      FROM DPA_VERIFICA_FORMATI_CONS
      WHERE DOCNUMBER = @DOCNUMBER@
      AND DACONVERTIRE = 1
      AND CONVERTITO = 0
    </value>
  </query>
  <query>
    <name>D_DELETE_VERIFICA_FORMATI_CONS_BY_ID_ISTANZA</name>
    <value>
      DELETE
      FROM DPA_VERIFICA_FORMATI_CONS
      WHERE ID_ISTANZA = @ID_ISTANZA@
    </value>
  </query>
  <query>
    <name>S_CHECK_ITEM_CONSOLIDATO</name>
    <value>
      SELECT *
      FROM PROFILE
      WHERE SYSTEM_ID = @DocNumber@
      AND CHA_CONSOLIDATO IS NOT NULL
    </value>
  </query>
  <query>
    <name>U_UPDATE_STATO_ISTANZA_CONSERVAZIONE_WITH_ESITO_VERIFICA</name>
    <value>
      UPDATE DPA_AREA_CONSERVAZIONE
      SET CHA_STATO = '@stato@',
      DATA_CONSERVAZIONE = @dataConservazione@,
      ESITO_VERIFICA = @esitoVerifica@
      @dataInvio@
      WHERE SYSTEM_ID = @systemId@
    </value>
  </query>
  <query>
    <name>U_UPDATE_STATO_ISTANZA_CONSERVAZIONE2</name>
    <value>
      UPDATE DPA_AREA_CONSERVAZIONE
      SET CHA_STATO='@stato@',
      VAR_TIPO_SUPPORTO = '@VAR_TIPO_SUPPORTO@',
      VAR_TIPO_CONS = '@VAR_TIPO_CONS@',
      VAR_NOTE = '@VAR_NOTE@',
      VAR_DESCRIZIONE = '@VAR_DESCRIZIONE@',
      CONSOLIDA = '@CONSOLIDA@'
      @dataInvio@
      WHERE SYSTEM_ID = @systemId@
    </value>
  </query>
  <query>
    <name>U_UPDATE_STATO_ISTANZA_CONSERVAZIONE_INVIO</name>
    <value>
      UPDATE DPA_AREA_CONSERVAZIONE
      SET CHA_STATO = '@stato@',
      DATA_CONSERVAZIONE = @dataConservazione@
      @dataInvio@
      WHERE SYSTEM_ID = @systemId@
    </value>
  </query>
  <query>
    <name>S_GET_NUM_VERSIONE_DOC</name>
    <value>
      SELECT VERSION_ID
      WHERE DOCNUMBER = @docNumber@
      ORDER BY VERSIONE DESC
    </value>
  </query>
  <query>
    <name>S_COUNT_DPA_TIMESTAMP_DOC</name>
    <value>
      SELECT
      COUNT(*) as NumTimestamp
      FROM DPA_TIMESTAMP_DOC
      WHERE
      VERSION_ID = @versionId@
      AND
      DOC_NUMBER = @docNumber@
    </value>
  </query>
  <query>
    <name>S_SELECT_DETTAGLIO_VERIFICA_FORMATI_CONS_BY_ID_ISTANZA</name>
    <value>
      SELECT vf.* ,
      p.var_segnatura,
      p.VAR_PROF_OGGETTO as OGGETTO,
      p.CREATION_DATE,
      p.DTA_PROTO,
      p.CHA_TIPO_PROTO,
      p2.full_name as DESCR_UT,
      g.group_name as DESCR_RUOLO
      FROM DPA_VERIFICA_FORMATI_CONS vf left outer join profile p on vf.DOCNUMBER = p.system_id
      left outer join people p2 on vf.UT_PROP = p2.system_id
      left outer join groups g on vf.ruolo_prop = g.system_id
      WHERE ID_ISTANZA = @ID_ISTANZA@
      ORDER BY vf.system_id DESC
    </value>
  </query>
  <query>
    <name>U_UPDATE_STATO_ITEMS_CONSERVAZIONE</name>
    <value>
      UPDATE DPA_ITEMS_CONSERVAZIONE
      SET CHA_STATO= '@stato@'
      WHERE ID_CONSERVAZIONE = @systemId@
    </value>
  </query>
  <!-- MEV 1.5 F02_01 fine-->
  <!-- MEV CS 1.5 - F03_01 -->
  <query>
    <name>S_SUM_SIZE_ITEMS_DPA_ITEMS_CONSERVAZIONE</name>
    <value>
      SELECT SUM(size_item)
      FROM dpa_items_conservazione
      WHERE id_conservazione = @idConservazione@
    </value>
  </query>
  <query>
    <name>S_COUNT_DPA_ITEMS_CONSERVAZIONE</name>
    <value>
      SELECT COUNT(system_id)
      FROM dpa_items_conservazione
      WHERE id_conservazione = @idConservazione@
    </value>
  </query>
  <!-- End MEV CS 1.5 - F03_01 -->

  <query>
    <name>U_UPDATE_ISTANZA_RIGENERATA</name>
    <value>
      UPDATE DPA_AREA_CONSERVAZIONE SET ID_ISTANZA_RIGENERATA = @id_istanza_vecchia@
      WHERE SYSTEM_ID = @system_id@
    </value>
  </query>
  <query>
    <name>S_SELECT_ISTANZA_RIGENERATA</name>
    <value>
      SELECT SYSTEM_ID FROM DPA_AREA_CONSERVAZIONE WHERE ID_ISTANZA_RIGENERATA = @id_istanza_vecchia@
    </value>
  </query>
  <!-- MEV CS 1.5 - Alert Conservazione -->
  <query>
    <name>S_CONS_ALERT_LOG_ATTIVO</name>
    <value>
      SELECT COUNT(*) FROM dpa_log_attivati
      WHERE id_amm=@idAmm@
      AND
      system_id_anagrafica IN
      ( SELECT system_id
      FROM dpa_anagrafica_log
      WHERE var_codice='@codice@'
      )
    </value>
  </query>
  <query>
    <name>S_CONS_ALERT_GET_CONF</name>
    <value>
      SELECT *
      FROM dpa_config_alert_cons
      WHERE id_amm=@idAmm@
    </value>
  </query>
  <query>
    <name>I_CONS_ALERT_SAVE_CONF</name>
    <value>
      INSERT INTO dpa_config_alert_cons
      (

      id_amm,
      var_server_smtp,
      num_porta_smtp,
      cha_smtp_ssl,
      var_user_mail,
      var_pwd_mail,
      var_mail_notifica,
      var_mail_destinatario,
      cha_alert_leggibilita_scadenza,
      cha_alert_leggibilita_max_doc,
      cha_alert_leggibilita_sing,
      cha_alert_download,
      cha_alert_sfoglia
      @param1@
      )
      VALUES
      (

      @idAmm@,
      '@serverSMTP@',
      @portaSMTP@,
      '@chaSSL@',
      '@userid@',
      '@pass@',
      '@mailFrom@',
      '@mailTo@',
      '@chaScadenza@',
      '@chaMaxDoc@',
      '@chaSingleDoc@',
      '@chaDownload@',
      '@chaSfoglia@'
      @param2@
      )
    </value>
  </query>
  <query>
    <name>U_CONS_ALERT_AGGIORNA_CONF</name>
    <value>
      UPDATE dpa_config_alert_cons
      SET
      var_server_smtp='@serverSMTP@',
      num_porta_smtp=@portaSMTP@,
      cha_smtp_ssl='@chaSSL@',
      var_user_mail='@userID@',
      var_pwd_mail='@pass@',
      var_mail_notifica='@mailFrom@',
      var_mail_destinatario='@mailTo@',
      cha_alert_leggibilita_scadenza='@chaScadenza@',
      cha_alert_leggibilita_max_doc='@chaMaxDoc@',
      cha_alert_leggibilita_sing='@chaSingleDoc@',
      cha_alert_download='@chaDownload@',
      cha_alert_sfoglia='@chaSfoglia@'
      @alert@
      WHERE
      id_amm=@idAmm@
    </value>
  </query>
  <query>
    <name>S_ALERT_CONS_IS_ATTIVO</name>
    <value>
      SELECT COUNT (*)
      FROM dpa_config_alert_cons
      WHERE
      id_amm=@idAmm@
      AND
      @codice@=1
    </value>
  </query>
  <query>
    <name>S_ALERT_CONS_GET_PARAMETRI</name>
    <value>
      SELECT
      @params@
      AS paramstring
      FROM
      dpa_config_alert_cons
      WHERE
      id_amm=@idAmm@
    </value>
  </query>
  <query>
    <name>S_ALERT_CONS_MAIL</name>
    <value>
      SELECT
      var_server_smtp, num_porta_smtp, cha_smtp_ssl, var_user_mail,
      var_pwd_mail, var_mail_notifica
      FROM dpa_config_alert_cons
      WHERE
      id_amm=@idAmm@
    </value>
  </query>
  <query>
    <name>U_REGISTRA_ESITO_VERIFICA_LEGG_SUPPORTO_RIMOVIBILE</name>
    <value>
      UPDATE DPA_SUPPORTO
      SET CHA_STATO = '@stato@',
      DATA_ULTIMA_VERIFICA_LEGG = @dataUltimaVerifica@,
      ESITO_ULTIMA_VERIFICA_LEGG = '@esitoUltimaVerifica@',
      PERC_VERIFICA_LEGG = '@percentualeVerifica@',
      DATA_PROX_VERIFICA_LEGG = @dataProssimaVerifica@,
      VERIFICHE_LEGG_EFFETTUATE = @verificheEffettuate@
      WHERE SYSTEM_ID = @systemId@
    </value>
  </query>
  <query>
    <name>S_CONSERVAZIONE_GET_COUNT_NOTIFICHE_VERIFICHE_LEGG_SUPPORTI</name>
    <value>
      select  count(*)
      from    dpa_supporto s
      inner join dpa_area_conservazione a on s.id_conservazione = a.system_id
      inner join dpa_tipo_supporto ts on s.id_tipo_supporto = ts.system_id
      inner join dpa_amministra amm on a.id_amm = amm.system_id
      where   s.cha_stato = 'V'
      and amm.var_codice_amm = '@codiceAmministrazione@'
      and s.data_prox_verifica_legg &lt;= @dataConfronto@
    </value>
  </query>
  <query>
    <name>S_CONSERVAZIONE_GET_COUNT_NOTIFICHE_VERIFICHE_LEGG_SUPPORTI_REMOTI</name>
    <value>
      select  count(*)
      from    dpa_supporto s
      inner join dpa_area_conservazione a on s.id_conservazione = a.system_id
      inner join dpa_tipo_supporto ts on s.id_tipo_supporto = ts.system_id
      inner join dpa_amministra amm on a.id_amm = amm.system_id
      where   ts.var_tipo = 'REMOTO'
      and s.cha_stato = 'V'
      and amm.var_codice_amm = '@codiceAmministrazione@'
      and s.data_prox_verifica_legg &lt;= @dataConfronto@
    </value>
  </query>
  <query>
    <name>S_CONSERVAZIONE_GET_NOTIFICHE_VERIFICHE_LEGG_SUPPORTI</name>
    <value>
      select  s.system_id as IdSupporto,
      s.id_conservazione as IdIstanza,
      s.data_prox_verifica_legg as DataVerificaSupporto,
      ts.var_tipo as TipoSupporto
      from    dpa_supporto s
      inner join dpa_area_conservazione a on s.id_conservazione = a.system_id
      inner join dpa_tipo_supporto ts on s.id_tipo_supporto = ts.system_id
      where   s.cha_stato = 'V'
      and a.ID_AMM = @idAmm@
      and s.data_prox_verifica_legg &lt;= @dataConfronto@
    </value>
  </query>
  <query>
    <name>S_CONSERVAZIONE_GET_NOTIFICHE_VERIFICHE_LEGG_SUPPORTI_REMOTI</name>
    <value>
      select  s.system_id as IdSupporto,
      s.id_conservazione as IdIstanza,
      s.data_prox_verifica_legg as DataVerificaSupporto,
      ts.var_tipo as TipoSupporto
      from    dpa_supporto s
      inner join dpa_area_conservazione a on s.id_conservazione = a.system_id
      inner join dpa_tipo_supporto ts on s.id_tipo_supporto = ts.system_id
      where   ts.var_tipo = 'REMOTO'
      and s.cha_stato = 'V'
      and a.ID_AMM = @idAmm@
      and s.data_prox_verifica_legg &lt;= @dataConfronto@
    </value>
  </query>
  <query>
    <name>S_CONSERVAZIONE_GET_DATA_PROX_VERIFICA_LEGG</name>
    <value>
      SELECT data_prox_verifica_legg
      FROM dpa_supporto
      WHERE
      id_conservazione=@idCons@ AND
      system_id=@idSupporto@
    </value>
  </query>
  <query>
    <name>S_CONSERVAZIONE_ALERT_GET_CONTATORI</name>
    <value>
      SELECT var_codice || '�' || num_operazioni || '�' ||
      CONVERT(DATETIME,dta_inizio_monitoraggio,103) AS paramscounter
      FROM dpa_alert_conservazione
      WHERE
      var_codice = '@codice@' AND
      id_amm = @idAmm@ AND
      id_people = @userId@
    </value>
  </query>

  <!-- End MEV CS 1.5 - Alert Conservazione-->
  <query>
    <name>U_UPDATE_STATO_ISTANZA_CONSERVAZIONE_INVIO</name>
    <value>
      UPDATE DPA_AREA_CONSERVAZIONE
      SET CHA_STATO = '@stato@',
      DATA_CONSERVAZIONE = @dataConservazione@
      @dataInvio@
      WHERE SYSTEM_ID = @systemId@
    </value>
  </query>
  <query>
    <name>S_NOTIFICHE_RIGENERAZIONE_REPORT</name>
    <value>
      SELECT cha_tipo_doc AS TIPO_DOC, var_oggetto AS OGGETTO, cod_fasc,
      CONVERT(VARCHAR,data_ins,103) AS DATA_INS
      @dbuser@.Vardescribe(dpa_items_conservazione.id_profile, 'SEGNATURA_DOCNUMBER') as SEGNATURA,
      @dbuser@.Vardescribe(dpa_items_conservazione.id_profile, 'DATADOC') as DATA_PROT_OR_CREA,
      size_item, validazione_firma
      FROM dpa_items_conservazione
      WHERE id_conservazione = @idIst@
      ORDER BY cod_fasc
    </value>
  </query>
  <query>
    <name>S_ALLEGATI_SUPER_SIMPLE</name>
    <value>
      SELECT SYSTEM_ID
      FROM PROFILE
      WHERE ID_DOCUMENTO_PRINCIPALE=@param1@
      AND CHA_IN_CESTINO IS NULL
    </value>
  </query>
  <query>
    <name>S_DOCUMENTALREADY_SENT_OPT</name>
    <value>
      SELECT SYSTEM_ID
      FROM DPA_STATO_INVIO
      WHERE ID_PROFILE=@param1@
      AND DTA_SPEDIZIONE IS NOT NULL
    </value>
  </query>
  <query>
    <name>S_DOCUMENTALREADY_TRASMITTED_OPT</name>
    <value>
      SELECT SYSTEM_ID
      FROM DPA_TRASMISSIONE
      WHERE ID_PROFILE=@param1@
      AND DTA_INVIO IS NOT NULL
    </value>
  </query>
  <query>
    <name>S_VALORE_CHIAVE</name>
    <value>
      SELECT	VAR_VALORE AS VALORE
      FROM		DPA_CHIAVI_CONFIGURAZIONE
      WHERE ID_AMM = @idAmm@
      AND VAR_CODICE = '@nome@'
    </value>
  </query>
  <query>
    <name>S_DPA_CHECK_MAILBOX_WHERE_CONDITION</name>
    <value>
      SELECT @fields@
      FROM DPA_CHECK_MAILBOX WITH(NOLOCK)
      WHERE @whereCondition@
    </value>
  </query>
  <query>
    <name>U_DPA_CHECK_MAILBOX</name>
    <value>
      UPDATE DPA_CHECK_MAILBOX
      SET @param1@
      WHERE id=@id@
    </value>
  </query>
  <query>
    <name>S_SMISTADOC_GET_LIST_DOCUMENTI_IN_NOTIFY</name>
    <value>
      SELECT a.system_id AS id_trasmissione, a.id_profile AS id_documento,
      rt.cha_tipo_ragione AS tipo_ragione,
      s.system_id AS id_trasmissione_singola,
      u.system_id AS id_trasmissione_utente,
      a.var_note_generali AS note_generali,
      s.VAR_NOTE_SING AS note_individuali,
      rt.var_desc_ragione AS ragione_trasm,
      @getDescCorr@ as role,
      @getPeopleName@ as people
      FROM dpa_trasmissione a,
      dpa_trasm_singola s,
      dpa_trasm_utente u,
      dpa_ragione_trasm rt
      where u.ID_TRASM_SINGOLA = s.SYSTEM_ID  @param2@
      and s.ID_TRASMISSIONE = a.SYSTEM_ID  and
      s.ID_RAGIONE = rt.SYSTEM_ID and u.ID_PEOPLE =  @param1@
      order by a.DTA_INVIO desc
    </value>
  </query>
  <query>
    <name>D_DPA_NOTIFY_BY_ID_PROFILE</name>
    <value>
      DELETE FROM DPA_NOTIFY
      WHERE ID_OBJECT = @idProfile@
    </value>
  </query>
  <query>
    <name>AMM_D_DELETE_VIS_MAIL_REGISTRI</name>
    <value>
      DELETE FROM DPA_VIS_MAIL_REGISTRI
      WHERE ID_REGISTRO = @idRegistro@
      AND VAR_EMAIL_REGISTRO = @emailRegistro@
    </value>
  </query>
  <query>
    <name>GET_EX_RUOLI</name>
    <value>
      select var_codice + ' - ' + var_desc_corr as res
      from dpa_corr_globali c, peoplegroups p
      where p.PEOPLE_SYSTEM_ID = @param1@
      and p.DTA_FINE is not null
      and c.ID_GRUPPO = p.GROUPS_SYSTEM_ID
    </value>
  </query>
  <query>
    <name>GET_CONTA_RUOLI</name>
    <value>
      SELECT COUNT(*) AS TOT
      FROM PEOPLEGROUPS
      WHERE PEOPLE_SYSTEM_ID = @param1@
      @param2@
    </value>
  </query>
  <query>
    <name>S_RICERCA_ALL_CORRISPONDENTI_BY_FILTER</name>
    <value>
      SELECT /*+index (a)*/ a.var_cod_rubrica, a.var_desc_corr,
      (case when a.CHA_TIPO_IE='I' then 1 else 0 end) AS interno,
      a.cha_tipo_urp, a.system_id, @dbuser@.getcodreg(a.ID_REGISTRO) var_codice, a.ID_REGISTRO, a.CHA_DISABLED_TRASM, a.DTA_FINE, a.VAR_NOME, a.VAR_COGNOME, dett.VAR_COD_FISC as VAR_COD_FISC, dett.VAR_COD_PI as VAR_COD_PI, a.ID_PEOPLE,
      a.var_codice_amm, a.var_codice_aoo, dett.var_indirizzo,  dett.var_cap, dett.var_citta, dett.var_provincia,dett.var_localita, dett.var_nazione, dett.var_telefono, dett.var_telefono2,
      dett.Var_Fax, Id_Old, docsadm.MAIL_E_NOTE_CORR_ESTERNI(a.system_id) as VAR_EMAIL, dett.Var_Note, DOCUMENTTYPES.DESCRIPTION
      FROM dpa_corr_globali a @param2@ LEFT JOIN DPA_DETT_GLOBALI DETT ON DETT.ID_CORR_GLOBALI=a.SYSTEM_ID
      LEFT JOIN DPA_T_CANALE_CORR ON a.system_id = DPA_T_CANALE_CORR.ID_CORR_GLOBALE
      LEFT JOIN DOCUMENTTYPES ON DPA_T_CANALE_CORR.ID_DOCUMENTTYPE = DOCUMENTTYPES.SYSTEM_ID
      WHERE @param1@
    </value>
  </query>
  <query>
    <name>S_FATTURAZIONE_GET_FATTURA</name>
    <value>
      SELECT DISTINCT
      [1.1.1.1] as TRASM_IDPAESE,
      SUBSTRING(('00000000000' + [1.1.1.2]),(LEN(('00000000000' + [1.1.1.2])) - 10),11) as TRASM_CODICE,
      REPLACE(LTRIM(RTRIM([1.1.5.1])),' ','') as TRASM_TELEFONO,
      [1.1.5.2] as TRASM_EMAIL,
      [1.2.1.1.1] as CEDENTE_IDPAESE,
      --SUBSTRING(('00000000000' + [1.2.1.1.2]),(LEN(('00000000000' + [1.2.1.1.2])) - 15),16) as CEDENTE_CODICE,
      --SUBSTRING(('00000000000' + [1.4.1.2]),(LEN(('00000000000' + [1.4.1.2])) - 10),11) as CEDENTE_CODICE,
      '07988320011' as CEDENTE_CODICE,
      [1.2.1.3.1] as CEDENTE_DESCR,
      [1.2.2.1] as CEDENTE_SEDE_INDIRIZZO,
      [1.2.2.2] as CEDENTE_SEDE_NUMCIVICO,
      [1.2.2.3] as CEDENTE_SEDE_CAP,
      [1.2.2.4] as CEDENTE_SEDE_COMUNE,
      [1.2.2.5] as CEDENTE_SEDE_PROVINCIA,
      [1.2.2.6] as CEDENTE_SEDE_NAZIONE,
      --[1.2.4.1] as CEDENTE_UFFICIO,
      [1.2.2.5] as CEDENTE_UFFICIO,
      [1.2.4.2] as CEDENTE_NUMEROREA,
      REPLACE(CAST(CAST(REPLACE([1.2.4.3],'.','') AS decimal (12,2)) as varchar),',','.') as CEDENTE_CAPITALESOC,
      [1.2.4.4] as CEDENTE_SOCIOUNICO,
      [1.2.4.5] as CEDENTE_STATOLIQUIDAZIONE,
      [1.4.1.1.1] as CESSIONARIO_IDPAESE,
      CASE
      WHEN [1.4.1.1.2] != '' THEN SUBSTRING(('00000000000' + [1.4.1.1.2]),(LEN(('00000000000' + [1.4.1.1.2])) - 10),11)
      ELSE null
      END as CESSIONARIO_IVA,
      CASE
      WHEN [1.4.1.2] != '' THEN SUBSTRING(('00000000000' + [1.4.1.2]),(LEN(('00000000000' + [1.4.1.2])) - 10),11)
      ELSE null
      END as CESSIONARIO_FISCALE,
      [1.4.1.3.1] as CESSIONARIO_DESCR,
      [1.4.2.1] as CESSIONARIO_SEDE_INDIRIZZO,
      [1.4.2.2] as CESSIONARIO_SEDE_NUMCIVICO,
      [1.4.2.3] as CESSIONARIO_SEDE_CAP,
      [1.4.2.4] as CESSIONARIO_SEDE_COMUNE,
      [1.4.2.5] as CESSIONARIO_SEDE_PROVINCIA,
      [1.4.2.6] as CESSIONARIO_SEDE_NAZIONE,
      [2.1.1.1] as TIPO_DOC,
      [2.1.1.2] as DIVISA,
      CONVERT(char, [2.1.1.3], 103) as DATA_DOC,
      [2.1.1.4] as NUMERO_FATTURA,
      REPLACE(CAST ([2.1.1.9] AS decimal (12,2)),',','.') as TOTALE_IMPORTO_DOC,
      [2.1.2.2] as ORDINE_ACQUISTO_IDDOC,
      [2.1.2.6] as ORDINE_ACQUISTO_CUP,
      [2.1.2.7] as ORDINE_ACQUISTO_CIG,
      [2.1.3.2] as CONTRATTO_IDDOC,
      [2.1.3.6] as CONTRATTO_CUP,
      [2.1.3.7] as CONTRATTO_CIG,
      [2.2.1.1] as NUMERO_LINEA,
      REPLACE([2.2.1.4],'—', '-') as DESCRIZIONE,
      REPLACE(CAST ([2.2.1.5] AS decimal (12,2)),',','.')  as QUANTITA,
      [2.2.1.6] as UNITA_MISURA,
      REPLACE(CAST ([2.2.1.9] AS decimal (12,2)),',','.') as PREZZO_UNITARIO,
      REPLACE(CAST ([2.2.1.11] AS decimal (12,2)),',','.') as PREZZO_TOTALE,
      LTRIM(RTRIM([2.2.1.12])) as ALIQUOTA_IVA,
      LTRIM(RTRIM([2.2.2.1])) as RIEPILOGO_ALIQUOTA_IVA,
      REPLACE(CAST ([2.2.2.5] AS decimal (12,2)),',','.') as RIEPILOGO_IMPONIBILE,
      REPLACE(CAST ([2.2.2.6] AS decimal (12,2)),',','.') as RIEPILOGO_IMPOSTA,
      [2.4.2.2] as MODALITA_PAGAMENTO,
      REPLACE(CAST ([2.4.2.6] AS decimal (12,2)),',','.') as IMPORTO_PAGAMENTO,
      CONVERT(char, [2.4.2.3], 103) as DATA_RIF_TERMINI_PAGAM,
      LTRIM(RTRIM([2.4.2.4])) as GIORNI_TERMINI_PAGAMENTO,
      [2.4.2.12] as ISTITUTO_FINANZIARIO,
      REPLACE(LTRIM(RTRIM([2.4.2.13])),' ','') as IBAN,
      [2.4.2.16] as BIC,
      ISNULL([2.2.2.7],'') as ESIGIBILITA,
      ISNULL(DPA_DETT_GLOBALI.VAR_COD_IPA,DPA_DETT_GLOBALI2.VAR_COD_IPA) as CODICE_DESTINATARIO
      --FROM DOCSADM.Invoice4VTDocs
      FROM DOCSADM.T_INVOICES
      LEFT JOIN DOCSADM.DPA_DETT_GLOBALI
      --ON Invoice4VTDocs.[1.4.1.2] = DPA_DETT_GLOBALI.VAR_COD_FISCALE COLLATE Latin1_General_BIN
      ON LTRIM(RTRIM(T_INVOICES.[1.4.1.2])) = DPA_DETT_GLOBALI.VAR_COD_FISCALE COLLATE Latin1_General_BIN
      AND DPA_DETT_GLOBALI.VAR_COD_FISCALE != ''
      LEFT JOIN DOCSADM.DPA_DETT_GLOBALI DPA_DETT_GLOBALI2
      --ON Invoice4VTDocs.[1.4.1.1.2] = DPA_DETT_GLOBALI2.VAR_COD_PI COLLATE Latin1_General_BIN
      ON LTRIM(RTRIM(T_INVOICES.[1.4.1.1.2])) = DPA_DETT_GLOBALI2.VAR_COD_PI COLLATE Latin1_General_BIN
      AND DPA_DETT_GLOBALI2.VAR_COD_PI != ''
      WHERE [2.1.1.4]='@codice@'
      --AND ELABORATO = 1
      AND ELABORATO is null

    </value>
  </query>
  <query>
    <name>S_FATTURAZIONE_GET_TEMPLATE</name>
    <value>
      SELECT templateXML FROM DPA_FATTURA
      WHERE idAmministrazione = @idAmm@
    </value>
  </query>
  <query>
    <name>S_FATTURAZIONE_GET_PARAM_AMM</name>
    <value>
      SELECT formato_trasmissione + '§' + esigibilita_iva + '§' + condizioni_pagamento AS result
      FROM dpa_fattura
      WHERE idAmministrazione=@idAmm@
    </value>
  </query>
  <query>
    <name>S_SERVIZI_ESTERNI</name>
    <value>
      SELECT DPA_SERVIZI_ESTERNI.SYSTEM_ID,
      DPA_SERVIZI_ESTERNI.DESCRIZIONE,
      DPA_SERVIZI_ESTERNI.SERVIZIO
      FROM  DPA_SERVIZI_ESTERNI
    </value>
  </query>
  <query>
    <name>S_SERVIZI_ESTERNI_STATO</name>
    <value>
      SELECT DPA_SERVIZI_ESTERNI.SYSTEM_ID, DPA_SERVIZI_ESTERNI.DESCRIZIONE, DPA_SERVIZI_ESTERNI.CODICE_ESECUTORE FROM  DPA_SERVIZI_ESTERNI INNER JOIN DPA_STATI_SERVIZI
      ON DPA_SERVIZI_ESTERNI.SYSTEM_ID = DPA_STATI_SERVIZI.ID_SERVIZIO INNER JOIN DPA_DIAGRAMMI
      ON DPA_STATI_SERVIZI.ID_STATO = DPA_DIAGRAMMI.Id_stato
      WHERE DPA_DIAGRAMMI.Doc_number = '@docNumber@'
    </value>
  </query>
  <query>
    <name>S_PARAMETRI_SERVIZIO_ESTERNO</name>
    <value>
      SELECT DPA_PARAMETRO_SERVIZI.DESCRIZIONE, DPA_PARAMETRO_SERVIZI.TIPO_VALORE
      FROM DPA_PARAMETRO_SERVIZI INNER JOIN DPA_PARAMETRI_SERVIZIO
      ON DPA_PARAMETRO_SERVIZI.SYSTEM_ID = DPA_PARAMETRI_SERVIZIO.ID_PARAMETRO
      WHERE DPA_PARAMETRI_SERVIZIO.ID_SERVIZIO = @idServizio@
      ORDER BY DPA_PARAMETRO_SERVIZI.POSIZIONE
    </value>
  </query>
  <query>
    <name>S_OWNER_FATTURA</name>
    <value>
      SELECT PROFILE.AUTHOR, PROFILE.ID_RUOLO_CREATORE, PROFILE.DOCNUMBER, DPA_PROFILE_FATTURA.DIAGRAMMA
      FROM DPA_PROFILE_FATTURA INNER JOIN PROFILE ON DPA_PROFILE_FATTURA.DOCNUMBER = PROFILE.DOCNUMBER
      WHERE DPA_PROFILE_FATTURA.IDSDI = @idsdi@
    </value>
  </query>
  <query>
    <name>I_PROFILE_FATTURA</name>
    <value>
      INSERT INTO DPA_PROFILE_FATTURA (DOCNUMBER, IDSDI, DIAGRAMMA)
      VALUES (@docnumber@, @idsdi@, @diagramid@)
    </value>
  </query>
  <query>
    <name>S_CHA_STATO_PROJECT</name>
    <value>
      SELECT CHA_STATO
      FROM PROJECT
      WHERE SYSTEM_ID = @idProject@
    </value>
  </query>
  <query>
    <name>S_FATTURA_TIPO_ATTO</name>
    <value>
      SELECT DPA_FATTURA.idTipoAtto FROM DPA_FATTURA INNER JOIN PROFILE
      ON DPA_FATTURA.idTipoAtto = PROFILE.ID_TIPO_ATTO
      where PROFILE.DOCNUMBER = @docnumber@
      AND idAmministrazione = @idamm@
    </value>
  </query>
  <query>
    <name>I_LOG_FATTURA</name>
    <value>
      INSERT INTO LOG_INVOICES
      (NUM_FATTURA, DATA_CREAZIONE_FATTURA, ID_FORNITORE, MSG_ERRORE, DATA_OPERAZIONE)
      VALUES
      ('@numero@', @dataFatt@, '@fornitore@', '@logMsg@', GETDATE())
    </value>
  </query>
  <query>
    <name>S_CHECK_NUM_FATTURA</name>
    <value>
      SELECT COUNT(DISTINCT A.SYSTEM_ID)
      FROM DPA_ASSOCIAZIONE_TEMPLATES A
      WHERE A.VALORE_OGGETTO_DB='@numero@'
      AND A.ID_TEMPLATE=(SELECT SYSTEM_ID FROM DPA_TIPO_ATTO WHERE ID_AMM=@idAmm@ AND VAR_DESC_ATTO = 'FATTURA ELETTRONICA')
    </value>
  </query>
  <query>
    <name>I_LOG_FATTURE_FIRMATE</name>
    <value>
      INSERT INTO TMP_LOG_FATTURE_FIRMATE
      (DOCNUMBER, NOME_FATT, ALLEGATO, DATA_OPERAZIONE, MSG_ERRORE)
      values
      ('@docnumber@', '@nome_fatt@', '@allegato@', @data_op@, '@msg_err@')
    </value>
  </query>
  <query>
    <name>S_GET_FATTURA_FROM_NOMEFILE</name>
    <value>
      SELECT DISTINCT IDOGGETTOASSOCIATO FROM DPA_NOTE WHERE TESTO='@fileName@'
    </value>
  </query>
  <query>
    <name>S_FATTURA_MAIL_ELABORATE</name>
    <value>
      SELECT SYSTEM_ID
      FROM DPA_FATT_MAIL_ELABORATE
      WHERE VAR_MESSAGE='@msgId@'
    </value>
  </query>
  <query>
    <name>I_FATTURA_MAIL_ELABORATE</name>
    <value>
      INSERT INTO DPA_FATT_MAIL_ELABORATE
      (VAR_MESSAGE, DTA_ELAB)
      VALUES
      ('@msgID@', @dtaElab@)
    </value>
  </query>
  <!-- Autenticazione Sistemi Esterni -->
  <query>
    <name>S_LISTA_SYS_EXT</name>
    <value>
      SELECT *
      FROM DPA_EXTERNAL_SYSTEMS
      WHERE ID_AMM = @idamm@
    </value>
  </query>
  <query>
    <name>S_PIS_METHODS</name>
    <value>
      SELECT *
      FROM DPA_PRODUCT_INTEGRATION_SVCS
      WHERE CHECKABLE ='1'
      ORDER BY FILE_SVC, METHOD_NAME
    </value>
  </query>
  <query>
    <name>U_PIS_IN_DPA_EXT_SYS</name>
    <value>
      UPDATE DPA_EXTERNAL_SYSTEMS
      SET VAR_PIS_METHODS_ALLOWED = '@param1@'
      WHERE SYSTEM_ID = @param2@
    </value>
  </query>
  <query>
    <name>U_DESC_TKN_DPA_EXT_SYS</name>
    <value>
      UPDATE DPA_EXTERNAL_SYSTEMS
      SET VAR_DESC_ESTESA='@param1@',
      VAR_TKN_TIME='@param2@'
      WHERE SYSTEM_ID=@param3@
    </value>
  </query>
  <query>
    <name>I_DPA_EXTERNAL_SYSTEMS</name>
    <value>
      INSERT INTO DPA_EXTERNAL_SYSTEMS
      VALUES(
      seq_DPA_EXTERNAL_SYSTEMS.nextval,
      @param1@
      )
    </value>
  </query>
  <query>
    <name>S_SYS_EXT_BY_IDAMM_CODEAPP</name>
    <value>
      SELECT *
      FROM DPA_EXTERNAL_SYSTEMS
      WHERE ID_AMM = @param1@
      AND VAR_CODE_APPLICATION = '@param2@'
    </value>
  </query>
  <query>
    <name>S_SYS_EXT_BY_IDAMM_USERID</name>
    <value>
      SELECT *
      FROM DPA_EXTERNAL_SYSTEMS
      WHERE ID_AMM = @param1@
      AND VAR_USER_ID = '@param2@'
    </value>
  </query>
  <query>
    <name>D_DPA_EXTERNAL_SYSTEMS</name>
    <value>
      DELETE FROM DPA_EXTERNAL_SYSTEMS
      WHERE SYSTEM_ID = @param1@
    </value>
  </query>
  <query>
    <name>D_CLEAN_RIGHTS_AFTER_CREATION_SYS_EXT</name>
    <value>
      DELETE FROM SECURITY
      WHERE THING = @param1@
      AND PERSONORGROUP NOT IN (@param2@)
    </value>
  </query>
  <!-- fine Autenticazione Sistemi Esterni -->
  <!-- MEV EXPORT FUNZIONI E MICROFUNZIONI DA AMMINISTRAZIONE-->
  <query>
    <name>S_AMM_EXPORT_MACRO_FUNZIONI</name>
    <value>
      SELECT t.var_cod_tipo, t.var_desc_tipo_fun, f.cod_funzione, af.var_desc_funzione
      FROM dpa_funzioni f, dpa_anagrafica_funzioni af, dpa_tipo_funzione t
      WHERE t.id_amm = @idAmm@
      AND t.var_cod_tipo = '@tipoFunz@'
      AND t.system_id=f.id_tipo_funzione
      AND f.cod_funzione=af.cod_funzione
      ORDER BY f.cod_funzione
    </value>
  </query>
  <query>
    <name>S_AMM_EXPORT_MACRO_RUOLI</name>
    <value>
      SELECT cg.var_cod_rubrica AS COD_RUOLO, cg.var_desc_corr AS desc_ruolo,
      cg.id_uo, cg_uo.var_cod_rubrica AS COD_UO, cg_uo.var_desc_corr AS desc_uo,
      @dbuser@.getcodregrfcorcat(cg.system_id) AS REG_RF,
      @dbuser@.getutenticorcat(cg.id_gruppo) AS utenti
      FROM dpa_tipo_funzione f, dpa_tipo_f_ruolo t, dpa_corr_globali cg, dpa_corr_globali cg_uo
      WHERE f.id_amm = @idAmm@
      AND f.var_cod_tipo = '@tipoFunz@'
      AND t.id_tipo_funz = f.system_id
      AND cg.system_id = t.id_ruolo_in_uo
      AND cg.id_uo = cg_uo.system_id
      ORDER BY cg.var_cod_rubrica
    </value>
  </query>
  <query>
    <name>S_AMM_EXPORT_MICRO_FUNZIONI</name>
    <value>
      SELECT DISTINCT cg.var_cod_rubrica AS cod_ruolo,
      cg.var_desc_corr AS desc_ruolo,
      t.var_cod_tipo AS cod_tipo_funz,
      t.var_desc_tipo_fun AS desc_tipo_funz,
      cg_uo.var_cod_rubrica AS cod_uo,
      cg_uo.var_desc_corr AS desc_uo,
      @dbuser@.getcodregrfcorcat(cg.system_id) AS REG_RF,
      @dbuser@.getutenticorcat(cg.id_gruppo) AS utenti
      FROM dpa_funzioni f, dpa_tipo_funzione t, dpa_tipo_f_ruolo tf, dpa_corr_globali cg, dpa_corr_globali cg_uo
      WHERE f.cod_funzione = '@codFunz@'
      AND f.id_amm = @idAmm@
      AND t.system_id=f.id_tipo_funzione
      AND tf.id_tipo_funz = t.system_id
      AND cg.system_id = tf.id_ruolo_in_uo
      AND cg.id_uo = cg_uo.system_id
      ORDER BY cg.var_cod_rubrica, t.var_cod_tipo
    </value>
  </query>
  <query>
    <name>AMM_S_GET_TIPO_FUNZIONE_BY_COD</name>
    <value>
      SELECT	TF.SYSTEM_ID AS ID,
      TF.VAR_COD_TIPO AS CODICE,
      TF.VAR_DESC_TIPO_FUN AS DESCRIZIONE,
      TF.CHA_VIS AS CHA_VIS
      FROM	DPA_TIPO_FUNZIONE TF
      WHERE	TF.VAR_COD_TIPO='@codFunzione@'
    </value>
  </query>
  <query>
    <name>AMM_S_GET_ANAGRAFICA_FUNZIONE_REPORT</name>
    <value>
      SELECT cod_funzione AS codice, var_desc_funzione AS descrizione, cha_tipo_funz AS tipo_funzione
      FROM dpa_anagrafica_funzioni
      WHERE cod_funzione = '@codice@'
    </value>
  </query>
  <!-- APSS - Delibere e Determine - Integrazione SOLR -->
  <query>
    <name>APSS_SOLR_GET_DEL_DET_DA_PUBBLICARE</name>
    <value>
      select a.doc_number as iddoc,
      a.valore_oggetto_db as data_pubb,
      a.id_template as id_tipo_atto,
      c.ext as estensione,
      c.var_nomeoriginale as nome_file
      from dpa_associazione_templates a, dpa_diagrammi b , components c
      where b.doc_number = a.doc_number
      @ogg_custom@
      @template@
      @stati@
      and to_date(a.valore_oggetto_db || ' 23:59:59','dd/mm/yyyy hh24:mi:ss')  >= to_date('@lastExec@','dd/mm/yyyy hh24:mi:ss')
      and to_date(a.valore_oggetto_db,'dd/mm/yyyy') &lt;= to_date('@currentDate@ 23:59:59', 'dd/mm/yyyy hh24:mi:ss')
      and b.doc_number = c.docnumber
      and c.version_id = (SELECT max(version_id) from components where docnumber= b.doc_number)
      and a.doc_number not in (select distinct(idProfile) from DPA_INTEGR_APSS_DEL_DET)
      order by a.doc_number
    </value>
  </query>
  <query>
    <name>APSS_SOLR_GET_DEL_DET_DA_RIPUBBLICARE</name>
    <value>
      select a.doc_number as iddoc,
      a.valore_oggetto_db as data_pubb,
      a.id_template as id_tipo_atto,
      c.ext as estensione,
      c.var_nomeoriginale as nome_file,
      d.id_specialized_object as idsingletrasm
      from dpa_associazione_templates a, dpa_diagrammi b , components c, dpa_notify d
      where b.doc_number = a.doc_number
      and b.doc_number = d.id_object
      @ogg_custom@
      @template@
      @stati@
      and d.dta_event &lt;= SYSDATE
      and d.dta_event >= to_date(a.valore_oggetto_db,'dd/mm/yyyy')
      and b.doc_number = c.docnumber
      and c.version_id = (SELECT max(version_id) from components where docnumber= b.doc_number)
      and d.type_event = '@tipo_evento@'
      and d.read_notification = '0'
      order by a.doc_number
    </value>
  </query>
  <query>
    <name>APSS_SOLR_GET_LASTEXECUTIONDATE</name>
    <value>
      select to_char(max(ExecutionDate),'dd/mm/yyyy hh24:mi:ss') as LASTEXECUTIONDATE
      from DPA_INTEGR_APSS_DEL_DET
      where idTipoAtto @TipoAtto@
    </value>
  </query>
  <query>
    <name>APSS_SOLR_S_DPA_INTEGR_APSS_BY_IDDOC</name>
    <value>
      SELECT *
      FROM DPA_INTEGR_APSS_DEL_DET
      WHERE IDPROFILE = @param1@
      ORDER BY SYSTEM_ID DESC
    </value>
  </query>
  <query>
    <name>APSS_SOLR_I_DPA_INTEGR_APSS_DEL_DET</name>
    <value>
      INSERT INTO DPA_INTEGR_APSS_DEL_DET
      VALUES(
      seq_DPA_INTEGR_APSS_DEL_DET.nextval,
      @param1@
      )
    </value>
  </query>
  <query>
    <name>APSS_SOLR_U_DPA_INTEGR_APSS_DEL_DET</name>
    <value>
      UPDATE DPA_INTEGR_APSS_DEL_DET
      SET @param1@
      WHERE @param2@
    </value>
  </query>
  <query>
    <name>APSS_SOLR_CTRL_ATTACH_EXT</name>
    <value>
      SELECT A.VAR_NOMEORIGINALE AS NOMEFILE
      FROM COMPONENTS A
      WHERE A.DOCNUMBER IN
      (SELECT SYSTEM_ID FROM PROFILE WHERE ID_DOCUMENTO_PRINCIPALE =@param1@)
      AND A.VERSION_ID= (SELECT MAX(VERSION_ID) FROM COMPONENTS WHERE DOCNUMBER = A.DOCNUMBER)
    </value>
  </query>
  <query>
    <name>APSS_SOLR_U_ESITO_PUBB</name>
    <value>
      UPDATE DPA_ASSOCIAZIONE_TEMPLATES
      SET VALORE_OGGETTO_DB = '@dataesito@'
      WHERE DOC_NUMBER= @idDoc@
      AND ID_OGGETTO IN (SELECT SYSTEM_ID FROM DPA_OGGETTI_CUSTOM WHERE DESCRIZIONE = 'ESITO PUBBLICAZIONE')
    </value>
  </query>

  <!-- FINE APSS - Delibere e Determine - Integrazione SOLR -->
  <query>
    <name>S_OPPORTUNITY</name>
    <value>
      SELECT ID_OPPORTUNITY
      FROM OPPORTUNITY INNER JOIN PEOPLE
      ON OPPORTUNITY.ID_People = PEOPLE.SYSTEM_ID
      @param1@
    </value>
  </query>
  <!-- INTEGRAZIONE PITRE-PARER -->
  <query>
    <name>S_GET_STATO_CONS</name>
    <value>
      SELECT @fields@
      FROM dpa_versamento
      WHERE id_profile=@idDoc@
    </value>
  </query>
  <query>
    <name>S_VERSAMENTO_GET_DOC_TO_SEND</name>
    <value>
      SELECT V.id_profile, V.id_people, V.id_ruolo, V.id_amm, P.cha_tipo_proto, V.num_tentativi_invio, V.cha_stato
      FROM dpa_versamento V, profile P
      WHERE V.id_profile=P.system_id
      AND  V.cha_stato IN ('V', 'E', 'T')
      @filtroStampe@
    </value>
  </query>
  <query>
    <name>I_INSERT_DOC_IN_QUEUE_CONS</name>
    <value>
      INSERT INTO dpa_versamento (

      id_profile,
      id_people,
      id_ruolo,
      id_amm,
      cha_stato,
      var_file_risposta,
      var_file_metadati
      )
      VALUES (

      @idDoc@,
      @idPeople@,
      @idRuolo@,
      @idAmm@,
      'V',
      '',
      ''
      )
    </value>
  </query>
  <query>
    <name>U_UPDATE_QUEUE_VERS</name>
    <value>
      UPDATE dpa_versamento
      SET
      cha_stato = '@stato@'
      @dataInvio@
      @idPeople@
      @idRuolo@
      @fileChiusura@
      @warning@
      @numTentativo@
      WHERE id_profile @idDoc@
    </value>
  </query>
  <query>
    <name>S_VERSAMENTO_GET_TEMPLATE</name>
    <value>
      SELECT var_template_xml
      FROM dpa_config_versamento
      WHERE id_amm = @idAmm@
      AND cha_tipo = '@tipo@'
    </value>
  </query>
  <query>
    <name>S_VERSAMENTO_GET_VERS_DATI_SPEC</name>
    <value>
      SELECT cha_vers_dati
      FROM dpa_config_versamento
      WHERE id_amm = @idAmm@
      AND cha_tipo = '@tipo@'
    </value>
  </query>
  <query>
    <name>S_VERSAMENTO_GET_XML</name>
    <value>
      SELECT @field@
      FROM dpa_versamento
      WHERE
      id_profile=@idProfile@
    </value>
  </query>
  <query>
    <name>S_GET_PARENT_FOLDER</name>
    <value>
      SELECT  P.SYSTEM_ID AS ID_FOLDER,
      P.ID_PARENT AS ID_PARENT_FOLDER,
      P.ID_FASCICOLO ID_FASCICOLO,
      P.DESCRIPTION FOLDER_DESCRIPTION,
      P.cha_tipo_fascicolo,
      P.dta_apertura APERTURA
      from project P
      where P.system_id=@idFolder@
    </value>
  </query>
  <query>
    <name>S_GET_INFO_STAMPA_REG</name>
    <value>
      SELECT id_registro, num_proto_start, num_proto_end, num_anno,
      convert(CHAR, dta_stampa, 103) as datastampa
      FROM dpa_stamparegistri
      WHERE docnumber=@idDoc@
    </value>
  </query>
  <query>
    <name>S_GET_INFO_STAMPA_REP</name>
    <value>
      SELECT id_repertorio, num_rep_start, num_rep_end, num_anno, registryid
      FROM dpa_stampa_repertori
      WHERE docnumber=@idDoc@
    </value>
  </query>
  <query>
    <name>S_GET_DATA_INSERIMENTO_REP</name>
    <value>
      SELECT
      CONVERT(char, dta_ins, 103) AS data_ins
      FROM dpa_associazione_templates
      WHERE anno=@anno@
      AND valore_oggetto_db='@cont@'
      AND id_oggetto=@idOgg@
    </value>
  </query>
  <query>
    <name>S_GET_NOME_TIPOLOGIA</name>
    <value>
      SELECT DISTINCT var_desc_atto FROM dpa_tipo_atto t, dpa_associazione_templates a
      WHERE t.system_id=a.id_template
      AND a.id_oggetto=@idCounter@
      AND a.doc_number IS NULL
    </value>
  </query>
  <query>
    <name>S_GET_NOME_TIPOLOGIA_DA_DOC</name>
    <value>
      SELECT DISTINCT var_desc_atto FROM dpa_tipo_atto t, dpa_associazione_templates a
      WHERE t.system_id=a.id_template
      AND a.doc_number=@idDoc@
    </value>
  </query>
  <query>
    <name>S_GET_NOME_TIPOLOGIA_DA_STAMPA</name>
    <value>
      SELECT DISTINCT t.var_desc_atto
      FROM dpa_tipo_atto t, dpa_registri_repertorio r, dpa_stampa_repertori s
      WHERE s.docnumber=@idDoc@
      AND s.id_repertorio=r.counterid
      AND t.system_id=r.tipologyid
    </value>
  </query>
  <query>
    <name>S_GET_DATA_ORA_PROTOCOLLAZIONE</name>
    <value>
      SELECT CONVERT(charm dta_proto, 103) AS data_proto
      FROM profile
      WHERE system_id=@idDoc@
    </value>
  </query>
  <query>
    <name>U_ERROR_VERSAMENTO</name>
    <value>
      UPDATE DPA_VERSAMENTO
      SET var_messaggio_errore='@str@'
      WHERE id_profile='@idPr@'
    </value>
  </query>
  <query>
    <name>S_CONS_GET_COD_AOO</name>
    <value>
      SELECT a.var_codice_aoo
      FROM dpa_corr_globali a, profile b
      WHERE b.id_uo_creatore=a.system_id
      AND b.system_id=@idProfile@
    </value>
  </query>
  <!-- MEV Policy e responsabile conservazione -->
  <query>
    <name>S_GET_ID_ROLE_RESP_CONS</name>
    <value>
      SELECT ID_RUOLO_RESP_CONS
      FROM DPA_AMMINISTRA
      WHERE SYSTEM_ID=@idAmm@
    </value>
  </query>
  <query>
    <name>S_GET_ID_USER_RESP_CONS</name>
    <value>
      SELECT ID_UTENTE_RESP_CONS
      FROM DPA_AMMINISTRA
      WHERE SYSTEM_ID=@idAmm@
    </value>
  </query>
  <query>
    <name>U_SET_ROLE_RESP_CONS</name>
    <value>
      UPDATE DPA_AMMINISTRA
      SET ID_RUOLO_RESP_CONS=@idGr@, ID_UTENTE_RESP_CONS=@idUt@
      WHERE SYSTEM_ID=@idAmm@
    </value>
  </query>
  <query>
    <name>S_ATTIVAZIONE_CONSERVAZIONE</name>
    <value>
      SELECT CHA_ENABLE_CONS
      FROM DPA_AMMINISTRA
      WHERE SYSTEM_ID=@id_amm@
    </value>
  </query>
  <query>
    <name>U_ATTIVAZIONE_CONSERVAZIONE</name>
    <value>
      UPDATE DPA_AMMINISTRA
      SET CHA_ENABLE_CONS='@val@'
      WHERE SYSTEM_ID=@id_amm@
    </value>
  </query>
  <query>
    <name>S_CONS_PRIMA_FASC</name>
    <value>
      SELECT a.id_fascicolo
      FROM project a, project_components b
      WHERE a.system_id=b.project_id
      AND b.link=@idDoc@
      AND a.id_fascicolo in (SELECT system_id FROM project WHERE cha_tipo_fascicolo='P')
      ORDER BY b.dta_class ASC
    </value>
  </query>
  <query>
    <name>I_SECURITY_CONSERVAZIONE</name>
    <value>
      INSERT INTO SECURITY
      (THING,PERSONORGROUP,ACCESSRIGHTS,ID_GRUPPO_TRASM,CHA_TIPO_DIRITTO)
      VALUES
      ( @param1@,@param2@,'63','@param3@','C')
    </value>
  </query>
  <query>
    <name>U_SECURITY_CONSERVAZIONE</name>
    <value>
      UPDATE SECURITY
      SET
      ACCESSRIGHTS=63
      WHERE THING=@param1@
      AND PERSONORGROUP=@param2@
    </value>
  </query>
  <query>
    <name>S_VERIFICA_DIRITTI_SEC_CONS</name>
    <value>
      SELECT MAX(ACCESSRIGHTS)
      FROM SECURITY
      WHERE THING=@param1@ AND PERSONORGROUP=@param2@
    </value>
  </query>
  <query>
    <name>S_GET_LISTA_POLICY_PARER</name>
    <value>
      SELECT *
      FROM DPA_POLICY_PARER
      WHERE ID_AMM=@idAmm@
      AND CHA_TIPO_POLICY='@tipo@'
      ORDER BY VAR_CODICE
    </value>
  </query>
  <query>
    <name>S_GET_POLICY_PARER_BY_ID</name>
    <value>
      SELECT
      system_id, var_codice, var_descrizione, id_group_ruolo_resp, cha_tipo_policy, id_amm, cha_attiva,
      cha_periodicita, cha_esecuzione_giorno, cha_esecuzione_mese, dta_esecuzione_policy, cha_stato_versamento,
      cha_tipo_proto_a, cha_tipo_proto_p, cha_tipo_proto_i, cha_tipo_proto_g, id_template,id_stato,cha_stato,
      id_registro,id_rf,id_uo_creatrice,cha_uo_sottoposte,id_titolario,cha_tipo_class,id_fascicolo,
      cha_doc_digitali,cha_firmato,cha_marcato,cha_scadenza_timestamp,
      cha_data_creazione_tipo,CONVERT(char, data_creazione_from, 103) AS DATA_CREAZ_FROM,CONVERT(char, data_creazione_to, 103) AS DATA_CREAZ_TO,
      cha_data_proto_tipo,CONVERT(char, data_proto_from, 103) AS DATA_PROT_FROM,CONVERT(char, data_proto_to, 103) AS DATA_PROT_TO,
      cha_tipo_registro_stampa,id_repertorio_stampa,num_anno_stampa,
      cha_data_stampa_tipo,CONVERT(char, data_stampa_from, 103) AS DATA_ST_FROM, CONVERT(char, data_stampa_to, 103) AS DATA_ST_TO,
      num_giorni_data_creazione,num_giorni_data_proto,num_giorni_data_stampa, cha_escludi_fatture, num_giorni_firma
      FROM DPA_POLICY_PARER
      WHERE SYSTEM_ID=@idPolicy@
    </value>
  </query>
  <query>
    <name>I_DPA_POLICY_PARER</name>
    <value>
      INSERT INTO DPA_POLICY_PARER
      (
      var_codice,var_descrizione,cha_tipo_policy,id_amm,id_group_ruolo_resp,cha_attiva,cha_periodicita,cha_esecuzione_giorno,cha_esecuzione_mese, dta_esecuzione_policy,
      cha_tipo_proto_a,cha_tipo_proto_p,cha_tipo_proto_i,cha_tipo_proto_g,id_template,id_registro,id_rf,id_uo_creatrice,
      id_titolario,id_fascicolo,cha_tipo_class,cha_uo_sottoposte,cha_firmato,cha_marcato,cha_scadenza_timestamp,
      cha_data_creazione_tipo,data_creazione_from,data_creazione_to,cha_data_proto_tipo,data_proto_from,data_proto_to,
      cha_tipo_registro_stampa,id_repertorio_stampa,num_anno_stampa,cha_data_stampa_tipo,data_stampa_from,data_stampa_to,
      num_giorni_data_creazione, num_giorni_data_proto, num_giorni_data_stampa,cha_stato_versamento,cha_doc_digitali,cha_escludi_fatture,num_giorni_firma
      )
      VALUES
      (
      '@codPolicy@', '@descrPolicy@','@tipoPolicy@',@idAmm@,'@ruoloResp@','0','@period@','@giornoExec@','@meseExec@',@dataExec@,
      '@arrivo@','@partenza@','@interno@','@grigio@','@idTemplate@','@idReg@','@idRf@','@idUo@',
      '@idTit@','@idFasc@','@tipoClass@','@uosp@','@isfirmato@','@ismarcato@','@scadMarca@','@dataCr@',@dataCrDa@,@dataCrA@,'@dataProto@',@dataProtoDa@,@dataProtoA@,
      '@tipoReg@','@idRep@','@annoStampa@','@dataStampa@',@dataStampaDa@,@dataStampaA@,'@numGiorniDataCreazione@','@numGiorniDataProto@','@numGiorniDataStampa@','@statoVersamento@','@docDigitali@','@escludiFatture@','@numGiorniFirma@'
      )
    </value>
  </query>
  <query>
    <name>U_POLICY_PARER</name>
    <value>
      UPDATE DPA_POLICY_PARER
      SET
      VAR_DESCRIZIONE='@descr@',
      ID_GROUP_RUOLO_RESP='@idGroupRuoloResp@',
      CHA_PERIODICITA='@period@',
      CHA_ESECUZIONE_GIORNO='@execDay@',
      CHA_ESECUZIONE_MESE='@execMonth@',
      DTA_ESECUZIONE_POLICY=@execDate@,
      CHA_TIPO_PROTO_A='@tipoProtoA@',
      CHA_TIPO_PROTO_P='@tipoProtoP@',
      CHA_TIPO_PROTO_I='@tipoProtoI@',
      CHA_TIPO_PROTO_G='@tipoProtoG@',
      ID_TEMPLATE='@idTemplate@',
      ID_STATO='@stato@',
      CHA_STATO='@opStato@',
      ID_REGISTRO='@idReg@',
      ID_RF='@idRF@',
      ID_UO_CREATRICE='@idUO@',
      ID_TITOLARIO='@idTit@',
      ID_FASCICOLO='@idFasc@',
      CHA_TIPO_CLASS='@tipoClass@',
      CHA_UO_SOTTOPOSTE='@UOsp@',
      CHA_DOC_DIGITALI='@docDigitali@',
      CHA_FIRMATO='@isFirmato@',
      CHA_MARCATO='@isMarcato@',
      CHA_SCADENZA_TIMESTAMP='@scadMarca@',
      CHA_DATA_CREAZIONE_TIPO='@dataCr@',
      @dataCreazioneFrom@
      @dataCreazioneTo@
      CHA_DATA_PROTO_TIPO='@dataProto@',
      @dataProtoFrom@
      @dataProtoTo@
      CHA_TIPO_REGISTRO_STAMPA='@tipoRegStampa@',
      ID_REPERTORIO_STAMPA='@idRep@',
      NUM_ANNO_STAMPA='@annoStampa@',
      CHA_DATA_STAMPA_TIPO='@dataStampa@',
      @dataStampaFrom@
      @dataStampaTo@
      NUM_GIORNI_DATA_CREAZIONE='@numGiorniDataCreazione@',
      NUM_GIORNI_DATA_PROTO='@numGiorniDataProto@',
      NUM_GIORNI_DATA_STAMPA='@numGiorniDataStampa@',
      CHA_STATO_VERSAMENTO='@statoVersamento@',
      CHA_ESCLUDI_FATTURE='@escludiFatture@',
      NUM_GIORNI_FIRMA='@numGiorniFirma@',
      ID_AMM=@idAmm@
      WHERE SYSTEM_ID=@idPolicy@
    </value>
  </query>
  <query>
    <name>D_POLICY_PARER</name>
    <value>
      DELETE FROM DPA_POLICY_PARER
      WHERE SYSTEM_ID=@id@
    </value>
  </query>
  <query>
    <name>S_GET_FORMATI_POLICY_PARER</name>
    <value>
      SELECT p.system_id as id_policy,t.ID_TYPE, d.FILE_EXTENSION
      FROM dpa_policy_parer p, dpa_ass_policy_type t, DPA_FORMATI_DOCUMENTO d
      WHERE p.system_id = t.ID_POLICY
      AND t.ID_TYPE=d.SYSTEM_ID and p.system_id=@policyId@
    </value>
  </query>
  <query>
    <name>U_STATO_POLICY_PARER</name>
    <value>
      UPDATE DPA_POLICY_PARER
      SET
      CHA_ATTIVA='@attiva@'
      WHERE SYSTEM_ID=@id@
    </value>
  </query>
  <query>
    <name>S_GET_COUNT_DOC_FROM_POLICY</name>
    <value>
      SELECT COUNT(A.SYSTEM_ID) FROM PROFILE A
      @queryFrom@
      WHERE @dbuser@.getchaimg(A.DOCNUMBER) != '0'
      AND nvl(A.CHA_IN_CESTINO,'0')='0'
      AND NOT EXISTS(SELECT 'x' FROM DPA_CHECKIN_CHECKOUT WHERE ID_DOCUMENT=A.SYSTEM_ID)
      @filtri@
    </value>
  </query>
  <query>
    <name>S_GET_DOC_FROM_POLICY_PARER</name>
    <value>
      SELECT A.SYSTEM_ID, A.DOCNUMBER, A.NUM_PROTO, A.NUM_ANNO_PROTO,
      A.VAR_PROF_OGGETTO, A.CHA_TIPO_PROTO,
      CONVERT(CHAR, A.CREATION_TIME, 103) AS DATA_CREAZIONE,
      CONVERT(CHAR, A.DTA_PROTO, 103) AS DATA_PROTO
      FROM PROFILE A
      @queryFrom@
      WHERE @dbuser@.getchaimg(A.DOCNUMBER) != '0'
      AND nvl(A.CHA_IN_CESTINO,'0')='0'
      AND NOT EXISTS(SELECT 'x' FROM DPA_CHECKIN_CHECKOUT WHERE ID_DOCUMENT=A.SYSTEM_ID)
      @filtri@
    </value>
  </query>
  <query>
    <name>I_DPA_EXEC_POLICY_PARER</name>
    <value>
      INSERT INTO DPA_ESECUZIONE_POLICY_PARER
      (ID_POLICY, NUM_ESECUZIONI, DATA_PROSSIMA_ESECUZIONE)
      VALUES
      (@id@, '0', @execDate@)
    </value>
  </query>
  <query>
    <name>U_DPA_EXEC_POLICY_PARER</name>
    <value>
      UPDATE DPA_ESECUZIONE_POLICY_PARER
      SET
      @par@
      WHERE ID_POLICY=@id@
    </value>
  </query>
  <query>
    <name>S_DPA_EXEC_POLICY_PARER</name>
    <value>
      SELECT
      CONVERT(char, data_ultima_esecuzione, 103) AS ULTIMA_ESECUZIONE,
      CONVERT(char, data_prossima_esecuzione, 103) AS PROSSIMA_ESECUZIONE,
      num_esecuzioni
      FROM DPA_ESECUZIONE_POLICY_PARER
      WHERE ID_POLICY=@id@
    </value>
  </query>
  <query>
    <name>I_DPA_VERSAMENTO_POLICY_PARER</name>
    <value>
      INSERT INTO DPA_VERSAMENTI_POLICY
      (ID_POLICY, ID_PROFILE, NUM_ESECUZIONE_POLICY, DATA_ESECUZIONE_POLICY)
      VALUES
      (@idPolicy@, @idDoc@, @numExec@, GETDATE())
    </value>
  </query>
  <query>
    <name>S_GET_POLICY_TO_EXECUTE</name>
    <value>
      SELECT P.SYSTEM_ID AS ID_POLICY, E.NUM_ESECUZIONI,
      CONVERT(CHAR, E.data_ultima_esecuzione, 103) AS ULTIMA_ESECUZIONE,
      CONVERT(CHAR, E.data_prossima_esecuzione, 103) AS PROSSIMA_ESECUZIONE
      FROM DPA_POLICY_PARER P, DPA_ESECUZIONE_POLICY_PARER E
      WHERE P.ID_AMM=@idAmm@
      AND P.CHA_ATTIVA='1'
      AND P.SYSTEM_ID=E.ID_POLICY
      AND CAST(CONVERT(CHAR, E.data_prossima_esecuzione, 103) AS DATETIME) &lt;= CAST(CONVERT(CHAR, GETDATE(), 103), AS DATETIME)
    </value>
  </query>
  <query>
    <name>S_USER_GET_LIST_RESP_PRINT_REP</name>
    <value>
      SELECT DISTINCT o.descrizione
      FROM dpa_registri_repertorio r, dpa_oggetti_custom o
      WHERE r.printerrolerespid=@idGroup@
      AND r.printeruserrespid=@idPeople@
      AND r.counterid=o.system_id
      ORDER BY o.descrizione
    </value>
  </query>
  <query>
    <name>S_GET_POLICY_FOR_EXPORT</name>
    <value>
      SELECT system_id, var_codice, var_descrizione,
      (SELECT GROUP_NAME FROM GROUPS WHERE SYSTEM_ID=P.ID_GROUP_RUOLO_RESP) AS ruolo_resp,
      cha_attiva, cha_periodicita,cha_esecuzione_giorno,cha_esecuzione_mese, CONVERT(CHAR, dta_esecuzione_policy, 103) AS data_exec_policy,cha_stato_versamento,
      cha_tipo_proto_a,cha_tipo_proto_p,cha_tipo_proto_i,cha_tipo_proto_g,
      (SELECT VAR_DESC_ATTO FROM DPA_TIPO_ATTO WHERE SYSTEM_ID=ID_TEMPLATE) AS tipologia, id_template,
      (SELECT VAR_DESCRIZIONE FROM DPA_STATI WHERE SYSTEM_ID=ID_STATO) AS stato_diagramma, cha_stato,
      (SELECT '[' || VAR_CODICE || '] - ' || VAR_DESC_REGISTRO FROM DPA_EL_REGISTRI WHERE SYSTEM_ID=ID_REGISTRO AND CHA_RF=0) AS registro,
      (SELECT '[' || VAR_CODICE || '] - ' || VAR_DESC_REGISTRO FROM DPA_EL_REGISTRI WHERE SYSTEM_ID=ID_RF AND CHA_RF=1) AS rf,
      (SELECT VAR_DESC_CORR FROM DPA_CORR_GLOBALI WHERE SYSTEM_ID=ID_UO_CREATRICE) AS uo_creatrice, cha_uo_sottoposte,
      id_titolario, cha_tipo_class,
      (SELECT VAR_CODICE || ' - ' || DESCRIPTION FROM PROJECT WHERE SYSTEM_ID=P.ID_FASCICOLO) AS classifica,
      cha_doc_digitali, cha_firmato, cha_marcato, cha_scadenza_timestamp, cha_escludi_fatture,
      CONVERT(CHAR, data_creazione_from, 103) AS data_creaz_from, CONVERT(CHAR, data_creazione_to, 103) AS data_creaz_to, cha_data_creazione_tipo, num_giorni_data_creazione,
      CONVERT(CHAR, data_proto_from, 103) AS data_prot_from, CONVERT(CHAR, data_proto_to, 103) AS data_prot_to, cha_data_proto_tipo, num_giorni_data_proto,
      cha_tipo_registro_stampa,
      (SELECT DISTINCT VAR_DESC_ATTO FROM DPA_TIPO_ATTO T, DPA_REGISTRI_REPERTORIO R WHERE T.SYSTEM_ID=R.TIPOLOGYID AND R.COUNTERID=P.ID_REPERTORIO_STAMPA) AS repertorio,
      num_anno_stampa, cha_data_stampa_tipo,
      CONVERT(CHAR, data_stampa_from, 103) AS data_st_from, CONVERT(CHAR, data_stampa_to, 103) AS data_st_to, num_giorni_data_stampa, cha_escludi_fatture, num_giorni_firma
      FROM DPA_POLICY_PARER P
      WHERE P.SYSTEM_ID IN (@idPolicy@)
      ORDER BY P.VAR_CODICE
    </value>
  </query>
  <query>
    <name>S_COUNT_VERSAMENTI_REPORT</name>
    <value>
      SELECT COUNT(system_id)
      FROM dpa_versamento
      WHERE cha_stato='@stato@'
      AND id_amm='@idAmm@'
      AND DATEDIFF(DD, v.dta_invio-1, GETDATE()) = 0
    </value>
  </query>
  <query>
    <name>S_REPORT_REGISTRO_ACCESSI</name>
    <value>
      A.SYSTEM_ID AS ID_PROJECT,
      A.VAR_CODICE AS CODICE,
      A.DESCRIPTION AS DESCRIZIONE,
      C.VAR_CODICE || ' - ' || C.VAR_DESC_CORR AS STRUTTURA,
      TO_CHAR(A.DTA_CREAZIONE, 'DD/MM/YYYY') AS DATA_CREAZIONE,
      B.VAR_DESC_FASC AS TIPOLOGIA,
      E.DESCRIZIONE AS NOME_CAMPO,
      GETVALPROFOBJPRJ(A.SYSTEM_ID,D.ID_OGGETTO) AS VALORE_CAMPO
      FROM PROJECT A, DPA_TIPO_FASC B, DPA_CORR_GLOBALI C, DPA_ASS_TEMPLATES_FASC D, DPA_OGGETTI_CUSTOM_FASC E
      WHERE A.ID_TIPO_FASC=B.SYSTEM_ID
      AND A.ID_UO_CREATORE=C.SYSTEM_ID
      AND A.ID_TIPO_FASC=D.ID_TEMPLATE
      AND D.ID_PROJECT=A.SYSTEM_ID
      AND D.ID_OGGETTO=E.SYSTEM_ID
      AND E.ID_TIPO_OGGETTO != (SELECT T.SYSTEM_ID FROM DPA_TIPO_OGGETTO_FASC T WHERE T.TIPO = 'SEPARATORE')
      AND
      (
      B.VAR_DESC_FASC ='ACCESSO DOCUMENTALE' OR
      B.VAR_DESC_FASC ='ACCESSO GENERALIZZATO E CIVICO' OR
      B.VAR_DESC_FASC ='ACCESSO DEI CONSIGLIERI PRONVINCIALI'
      )
      @filtro_data@
      @filtro_stato@
      ORDER BY A.SYSTEM_ID, D.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>S_GET_REPORT_POLICY_PARER</name>
    <value>
      SELECT v.id_profile, p.num_proto, p.cha_tipo_proto,
      CONVERT(CHAR, p.creation_time, 103) AS data_creazione,
      CONVERT(CHAR, p.dta_proto, 103) AS data_proto,
      p.var_prof_oggetto,
      CONVERT(CHAR, v.dta_invio, 103) as data_versamento,
      @dbuser@.getPolicyVersamentoCod(v.id_profile) as var_codice,
      @dbuser@.getPolicyVersamentoCounter(v.id_profile) as num_esecuzione_policy,
      v.var_file_risposta
      FROM dpa_versamento v, profile p
      WHERE v.cha_stato='@stato@'
      AND v.id_amm='@idAmm@'
      AND v.id_profile=p.system_id
      AND DATEDIFF(DAY, dateadd(day, -1, v.dta_invio), GETDATE()) = 0
      ORDER BY v.id_profile
    </value>
  </query>
  <!-- fine INTEGRAZIONE PITRE-PARER -->

  <!--  LIBRO FIRMA -->

  <query>
    <name>S_DPA_ANAGRAFICA_EVENTI</name>
    <value>
      SELECT GRUPPO, DESCRIZIONE
      FROM DPA_ANAGRAFICA_EVENTI
      WHERE CHA_TIPO_EVENTO = '@tipoEvento@'
      GROUP BY GRUPPO, DESCRIZIONE
    </value>
  </query>
  <query>
    <name>S_DPA_ANAGRAFICA_EVENTI_TIPO_PASSO</name>
    <value>
      SELECT GRUPPO, DESCRIZIONE, VAR_COD_AZIONE, ID_EVENTO, CHA_TIPO_EVENTO
      FROM DPA_ANAGRAFICA_EVENTI
      WHERE CHA_TIPO_EVENTO = '@tipoEvento@'
    </value>
  </query>
  <query>
    <name>S_DPA_SCHEMA_PROCESSO_FIRMA_VISIBLE_ROLE</name>
    <value>
      SELECT P.ID_PROCESSO, P.NOME, P.RUOLO_AUTORE, P.UTENTE_AUTORE, P.TICK, P.CHA_MODELLO
      FROM DPA_SCHEMA_PROCESSO_FIRMA P
      JOIN DPA_PROCESSO_FIRMA_VISIBILITA V
      ON P.ID_PROCESSO  = V.ID_PROCESSO
      WHERE V.ID_GROUPS = @idGroup@ AND P.ELIMINATO IS NULL
      ORDER BY ID_PROCESSO DESC
    </value>
  </query>
  <query>
    <name>S_DPA_SCHEMA_PROCESSO_FIRMA_BY_ID_PROCESSO</name>
    <value>
      SELECT *
      FROM DPA_SCHEMA_PROCESSO_FIRMA
      WHERE ID_PROCESSO=@idProcesso@
    </value>
  </query>
  <query>
    <name>S_DPA_SCHEMA_PROCESSO_FIRMA</name>
    <value>
      SELECT *
      FROM DPA_SCHEMA_PROCESSO_FIRMA f, PEOPLE p, GROUPS g
      WHERE RUOLO_AUTORE = @ruoloAutore@ AND UTENTE_AUTORE = @utenteAutore@ <!-- AND ELIMINATO = '0'-->
      AND p.SYSTEM_ID = f.UTENTE_AUTORE AND g.SYSTEM_ID = RUOLO_AUTORE
      ORDER BY ID_PROCESSO DESC
    </value>
  </query>
  <query>
    <name>S_DPA_SCHEMA_PROCESSO_FIRMA_BY_FILTER</name>
    <value>
      SELECT *
      FROM DPA_SCHEMA_PROCESSO_FIRMA S
      WHERE RUOLO_AUTORE = @ruoloAutore@
      @condition@
      @order@
    </value>
  </query>
  <query>
    <name>S_DPA_PASSO_DI_FIRMA_OLD</name>
    <value>
      SELECT
      pf.ID_PASSO, pf.ID_PROCESSO, pf.NUMERO_SEQUENZA, pf.TIPO_FIRMA, pf.TIPO_EVENTO, pf.NOTE, pf.ID_UTENTE_COINVOLTO AS ID_UTENTE, pf.SCADENZA, pf.ELIMINATO,
      g.ID_GRUPPO AS ID_GRUPPO, g.VAR_COD_RUBRICA AS GROUP_ID, g.VAR_DESC_CORR AS GROUP_NAME, G.SYSTEM_ID AS ID_CORR,
      e.ID_EVENTO, e.VAR_COD_AZIONE, e.CHA_TIPO_EVENTO, e.descrizione, e.gruppo
      FROM DPA_PASSO_DI_FIRMA pf
      Inner Join Dpa_Anagrafica_Eventi E On pf.Tipo_Evento = e.Id_Evento
      left Join DPA_CORR_GLOBALI g on pf.ID_RUOLO_COINVOLTO = g.ID_GRUPPO
      WHERE ID_PROCESSO = @idProcessoFirma@
      ORDER BY NUMERO_SEQUENZA ASC
    </value>
  </query>
  <query>
    <name>S_DPA_PASSO_DI_FIRMA</name>
    <value>
      SELECT
      pf.ID_PASSO, pf.ID_PROCESSO, pf.NUMERO_SEQUENZA, pf.TIPO_FIRMA, pf.TIPO_EVENTO, pf.NOTE,  pf.SCADENZA, pf.ELIMINATO, pf.TICK, pf.ID_TIPO_RUOLO_COINVOLTO,
      e.ID_EVENTO, e.VAR_COD_AZIONE, e.CHA_TIPO_EVENTO, e.descrizione, e.gruppo,
      pf.ID_RUOLO_COINVOLTO AS ID_GRUPPO,
      docsadm.GETROLETYPEDESCRIPTION(pf.ID_TIPO_RUOLO_COINVOLTO) AS TIPO_RUOLO_DESCRIZIONE,
      docsadm.GETDESCRUOLO(pf.ID_RUOLO_COINVOLTO) AS Group_Name,
      docsadm.getcodRuolo(pf.ID_RUOLO_COINVOLTO) as Group_Id,
      docsadm.getRuoloSystemIdCorr(pf.ID_RUOLO_COINVOLTO) as Id_Corr,
      pf.ID_UTENTE_COINVOLTO AS ID_UTENTE,
      docsadm.getpeopleuserid(pf.ID_UTENTE_COINVOLTO) AS USER_CODE,
      docsadm.getpeoplename(pf.ID_UTENTE_COINVOLTO) AS USER_DESCRIPTION,
      docsadm.getCorrSystemId(pf.ID_UTENTE_COINVOLTO) AS USER_SYSTEM_ID
      FROM DPA_PASSO_DI_FIRMA pf
      Inner Join Dpa_Anagrafica_Eventi E On pf.Tipo_Evento = e.Id_Evento
      WHERE ID_PROCESSO = @idProcessoFirma@
      ORDER BY NUMERO_SEQUENZA ASC
    </value>
  </query>
  <query>
    <name>S_DPA_PASSO_DPA_EVENTO</name>
    <value>
      SELECT DISTINCT(e.GRUPPO)
      FROM DPA_PASSO_DPA_EVENTO p
      JOIN DPA_ANAGRAFICA_EVENTI e ON p.id_evento = e.ID_EVENTO
      WHERE ID_PASSO = @idPasso@
    </value>
  </query>
  <query>
    <name>S_DPA_PROCESSO_FIRMA_VISIBILITA</name>
    <value>
      SELECT G.SYSTEM_ID AS ID_CORR, G.VAR_DESC_CORR AS DESCRIZIONE, G.VAR_COD_RUBRICA
      FROM DPA_PROCESSO_FIRMA_VISIBILITA V JOIN DPA_CORR_GLOBALI G ON G.ID_PEOPLE = V.ID_GROUPS OR G.ID_GRUPPO = V.ID_GROUPS
      WHERE V.ID_PROCESSO = @idProcesso@ AND G.DTA_FINE IS NULL
      ORDER BY G.VAR_DESC_CORR ASC
    </value>
  </query>
  <query>
    <name>I_DPA_SCHEMA_PROCESSO_FIRMA</name>
    <value>
      INSERT INTO DPA_SCHEMA_PROCESSO_FIRMA
      (
      NOME,
      RUOLO_AUTORE,
      UTENTE_AUTORE,
      CHA_MODELLO
      )
      VALUES
      (
      '@nome@',
      @ruolo@,
      @utente@,
      '@modello@'
      )
    </value>
  </query>
  <query>
    <name>I_DPA_PASSO_DI_FIRMA</name>
    <value>
      INSERT INTO DPA_PASSO_DI_FIRMA
      (
      ID_PROCESSO,
      NUMERO_SEQUENZA,
      TIPO_FIRMA,
      TIPO_EVENTO,
      NOTE,
      ID_RUOLO_COINVOLTO,
      ID_UTENTE_COINVOLTO,
      ID_TIPO_RUOLO_COINVOLTO
      )
      SELECT
      @idProcesso@,
      @numeroSequenza@,
      '@tipoFirma@',
      e.ID_EVENTO,
      '@note@',
      @ruolo@,
      @utente@,
      @idTipoRuolo@
      FROM DPA_ANAGRAFICA_EVENTI e
      WHERE e.VAR_COD_AZIONE = '@tipoEvento@'
    </value>
  </query>
  <query>
    <name>S_DPA_SCHEMA_PROCESSO_FIRMA_BY_NAME</name>
    <value>
      SELECT ID_PROCESSO
      FROM DPA_SCHEMA_PROCESSO_FIRMA
      WHERE NOME = '@nomeProcesso@' and ID_AMM = @idAmm@
    </value>
  </query>
  <query>
    <name>S_DPA_ELEMENTO_IN_LIBRO_FIRMA_ID_TRASM_SINGOLA</name>
    <value>
      SELECT ID_TRASM_SINGOLA , DTA_ACCETTAZIONE
      FROM DPA_ELEMENTO_IN_LIBRO_FIRMA E
      WHERE E.ID_DOC_PRINCIPALE = @docnumber@ AND E.ID_RUOLO_TITOLARE = @idRuoloTitolare@ AND @conditionIdUtenteTitolare@ @idElemento@
    </value>
  </query>
  <query>
    <name>S_DPA_ELEMENTI_LIBRO_FIRMA_BY_ID_TRASM_SINGOLA</name>
    <value>
      SELECT E.*
      FROM DPA_ELEMENTO_IN_LIBRO_FIRMA E
      WHERE E.ID_TRASM_SINGOLA = @idTrasmSingola@
    </value>
  </query>
  <query>
    <name>I_DPA_PASSO_DPA_EVENTO</name>
    <value>
      INSERT INTO DPA_PASSO_DPA_EVENTO
      (
      ID_PASSO,
      ID_EVENTO
      )
      SELECT @idPasso@, ID_EVENTO
      FROM DPA_ANAGRAFICA_EVENTI
      WHERE GRUPPO IN (@gruppo@)
    </value>
  </query>
  <query>
    <name>I_DPA_PROCESSO_FIRMA_VISIBILITA</name>
    <value>
      INSERT INTO DPA_PROCESSO_FIRMA_VISIBILITA
      (
      ID_PROCESSO,
      ID_GROUPS
      )
      SELECT
      @idProcesso@,
      (CASE
      WHEN g.CHA_TIPO_URP = 'R' THEN G.ID_GRUPPO
      ELSE G.ID_PEOPLE
      END)
      FROM DPA_CORR_GLOBALI g
      WHERE g.SYSTEM_ID = @idCorr@
    </value>
  </query>
  <query>
    <name>D_DPA_PROCESSO_FIRMA_VISIBILITA</name>
    <value>
      DELETE
      FROM DPA_PROCESSO_FIRMA_VISIBILITA
      WHERE id_processo=@idProcesso@
      AND ID_GROUPS    =
      (SELECT
      CASE
      WHEN CHA_TIPO_URP= 'R'
      THEN g.ID_GRUPPO
      ELSE G.ID_PEOPLE
      END
      FROM DPA_CORR_GLOBALI G
      WHERE G.SYSTEM_ID =@idCorr@
      )
    </value>
  </query>
  <query>
    <name>S_GET_USERS_IN_ROLE_BY_IDGRUPPO</name>
    <value>
      select b.id_people,b.VAR_DESC_CORR from dpa_corr_globali b, peoplegroups g where g.GROUPS_SYSTEM_ID = @idGruppo@ and g.PEOPLE_SYSTEM_ID = b.ID_PEOPLE and g.dta_fine is null order by var_desc_corr
    </value>
  </query>
  <query>
    <name>U_DPA_ISTANZA_PASSO_FIRMA_MOTIVO_RESPINGIMENTO</name>
    <value>
      UPDATE DPA_ISTANZA_PASSO_FIRMA
      SET MOTIVO_RESPINGIMENTO = '@motivoRespingimento@'
      WHERE ID_ISTANZA_PASSO = @idIstanzaPasso@
    </value>
  </query>
  <query>
    <name>U_DPA_PASSO_DI_FIRMA</name>
    <value>
      UPDATE DPA_PASSO_DI_FIRMA
      SET NUMERO_SEQUENZA= @numeroSequenza@,
      TIPO_FIRMA = '@tipoFirma@',
      TIPO_EVENTO = (SELECT ID_EVENTO FROM DPA_ANAGRAFICA_EVENTI WHERE VAR_COD_AZIONE = '@tipoEvento@'),
      NOTE = '@note@',
      ID_TIPO_RUOLO_COINVOLTO = @idTipoRuolo@,
      ID_RUOLO_COINVOLTO = @ruolo@,
      ID_UTENTE_COINVOLTO = @utente@,
      TICK =  '@tick@'
      WHERE ID_PASSO = @idPasso@
    </value>
  </query>
  <query>
    <name>S_DPA_PASSO_DI_FIRMA_TICK</name>
    <value>
      SELECT ID_PASSO
      FROM DPA_PASSO_DI_FIRMA
      WHERE ID_PROCESSO = @idProcesso@ AND NOT TICK = '0'
    </value>
  </query>
  <query>
    <name>U_DPA_SCHEMA_PROCESSO_FIRMA_TICK</name>
    <value>
      UPDATE DPA_SCHEMA_PROCESSO_FIRMA
      SET TICK = '@tick@'
      WHERE ID_PROCESSO = @idProcesso@
    </value>
  </query>
  <query>
    <name>U_DPA_SCHEMA_PROCESSO_FIRMA_CHA_MODELLO</name>
    <value>
      UPDATE DPA_SCHEMA_PROCESSO_FIRMA
      SET CHA_MODELLO =
      CASE WHEN EXISTS (SELECT 'X' FROM DPA_PASSO_DI_FIRMA P, DPA_ANAGRAFICA_EVENTI E
      WHERE ID_PROCESSO = @idProcesso@ AND ID_RUOLO_COINVOLTO IS NULL AND ID_TIPO_RUOLO_COINVOLTO IS NULL AND P.TIPO_FIRMA = E.VAR_COD_AZIONE AND E.CHA_TIPO_EVENTO &lt; &gt; 'W') THEN '1'
      ELSE '0'
      END
      WHERE ID_PROCESSO = @idProcesso@
    </value>
  </query>
  <query>
    <name>D_DPA_PASSO_DPA_EVENTO</name>
    <value>
      DELETE FROM DPA_PASSO_DPA_EVENTO
      WHERE ID_PASSO = @idPasso@
    </value>
  </query>
  <query>
    <name>D_DPA_SCHEMA_PROCESSO_FIRMA</name>
    <value>
      DELETE FROM DPA_SCHEMA_PROCESSO_FIRMA
      WHERE ID_PROCESSO = @idProcesso@
    </value>
  </query>
  <query>
    <name>D_DPA_PROCESSO_FIRMA_VISIBILITA_BY_ID_PROCESSO</name>
    <value>
      DELETE FROM DPA_PROCESSO_FIRMA_VISIBILITA
      WHERE ID_PROCESSO = @idProcesso@
    </value>
  </query>
  <query>
    <name>D_DPA_PASSO_DI_FIRMA</name>
    <value>
      DELETE FROM DPA_PASSO_DI_FIRMA
      WHERE ID_PASSO = @idPasso@
    </value>
  </query>
  <query>
    <name>U_DPA_SCHEMA_PROCESSO_FIRMA</name>
    <value>
      UPDATE DPA_SCHEMA_PROCESSO_FIRMA
      SET NOME = '@nome@'
      WHERE ID_PROCESSO = @idProcesso@
    </value>
  </query>
  <query>
    <name>U_DECREMENTA_SEQUENZA_DPA_PASSO</name>
    <value>
      UPDATE DPA_PASSO_DI_FIRMA
      SET NUMERO_SEQUENZA = NUMERO_SEQUENZA - 1
      WHERE ID_PROCESSO = @idProcesso@ AND NUMERO_SEQUENZA > @numeroSequenza@
    </value>
  </query>
  <query>
    <name>U_INCREMENTA_SEQUENZA_DPA_PASSO</name>
    <value>
      UPDATE DPA_PASSO_DI_FIRMA
      SET NUMERO_SEQUENZA = NUMERO_SEQUENZA + 1
      WHERE ID_PROCESSO = @idProcesso@ AND NUMERO_SEQUENZA >= @numeroSequenza@ AND NOT ID_PASSO = @idPasso@
    </value>
  </query>
  <query>
    <name>U_NR_DPA_PASSO_DI_FIRMA</name>
    <value>
      UPDATE DPA_PASSO_DI_FIRMA
      SET NUMERO_SEQUENZA = @numeroSequenza@
      WHERE ID_PROCESSO = @idProcesso@ AND NOT ID_PASSO = @idPasso@ AND @condition@
    </value>
  </query>
  <query>
    <name>S_DPA_ELEMENTI_LIBRO_FIRMA_BY_RECEIVER</name>
    <value>
      SELECT E.ID_ELEMENTO
      FROM DPA_ELEMENTO_IN_LIBRO_FIRMA E
      JOIN DPA_DOC_ARRIVO_PAR D ON D.ID_PROFILE = E.DOC_NUMBER
      @fromDpaCorrGlobali@
      WHERE E.ID_RUOLO_TITOLARE = @idRuoloTitolare@
      AND (ID_UTENTE_TITOLARE  IS NULL
      OR ID_UTENTE_TITOLARE     = @idUtenteTitolare@)
      AND (ID_UTENTE_LOCKER IS NULL OR ID_UTENTE_LOCKER = @idUtenteTitolare@)
      AND @conditionCorr@ AND (D.CHA_TIPO_MITT_DEST = 'D' OR D.CHA_TIPO_MITT_DEST = 'C')
    </value>
  </query>
  <query>
    <name>S_DPA_ELEMENTI_LIBRO_FIRMA</name>
    <value>
      SELECT E.ID_ELEMENTO,
      E.ID_RUOLO_TITOLARE,
      E.TIPO_FIRMA,
      E.STATO_FIRMA,
      E.SCADENZA,
      E.UTENTE_PROPONENTE AS ID_UTENTE,
      E.MODALITA,
      E.DATA_INSERIMENTO,
      E.DTA_ACCETTAZIONE,
      E.DOC_NUMBER,
      E.VERSION_ID,
      E.NUM_ALL,
      E.NUM_VERSIONE,
      E.ID_UTENTE_TITOLARE,
      E.ID_UTENTE_LOCKER,
      E.ID_TRASM_SINGOLA,
      E.ISTANZA_PROCESSO,
      E.ID_ISTANZA_PASSO,
      E.ERRORE_FIRMA,
      E.ID_PEOPLE_PROPONENTE_DELEGATO,
      P.SYSTEM_ID,
      P.VAR_PROF_OGGETTO,
      P.NUM_PROTO,
      P.CHA_TIPO_PROTO,
      P.ID_DOCUMENTO_PRINCIPALE,
      docsadm.getObjectMainDoc(p.id_documento_principale) as OBJECT_MAIN_DOCUMENT,
      P.CREATION_TIME,
      P.DTA_PROTO,
      p.CHA_FIRMATO,
      T.VAR_DESC_ATTO,
      docsadm.corrcatbytipo(e.doc_number, P.CHA_TIPO_PROTO, 'D') AS DESC_RECIPIENT,
      e.ruolo_proponente As Id_Gruppo,
      docsadm.GETDESCRUOLO(RUOLO_PROPONENTE) AS Group_Name,
      docsadm.getcodRuolo(RUOLO_PROPONENTE) as Group_Id,
      docsadm.getRuoloSystemIdCorr(RUOLO_PROPONENTE) as Id_Corr,
      docsadm.getpeopleuserid(UTENTE_PROPONENTE) AS USER_CODE,
      docsadm.getpeoplename(UTENTE_PROPONENTE) AS USER_DESCRIPTION,
      docsadm.getCorrSystemId(UTENTE_PROPONENTE) AS USER_SYSTEM_ID,
      e.note as NOTE,
      IP.MOTIVO_RESPINGIMENTO,
      Components.File_Size,
      Components.CHA_TIPO_FIRMA
      FROM DPA_ELEMENTO_IN_LIBRO_FIRMA E
      JOIN PROFILE P
      ON E.DOC_NUMBER = P.SYSTEM_ID
      left Join Components
      On E.Version_Id = Components.Version_Id
      LEFT JOIN DPA_TIPO_ATTO t
      ON P.ID_TIPO_ATTO         = T.SYSTEM_ID
      LEFT JOIN DPA_ISTANZA_PROCESSO_FIRMA IP ON E.ISTANZA_PROCESSO = IP.ID_ISTANZA
      WHERE E.ID_RUOLO_TITOLARE = @idRuoloTitolare@
      AND (ID_UTENTE_TITOLARE  IS NULL
      OR ID_UTENTE_TITOLARE     = @idUtenteTitolare@)
      AND (ID_UTENTE_LOCKER IS NULL OR ID_UTENTE_LOCKER = @idUtenteTitolare@) AND DTA_ESECUZIONE IS NULL AND E.ID_TRASM_SINGOLA IS NOT NULL
      ORDER BY E.DATA_INSERIMENTO DESC
    </value>
  </query>
  <query>
    <name>S_DPA_ELEMENTI_LIBRO_FIRMA_BY_ID</name>
    <value>
      SELECT E.ID_ELEMENTO,
      E.ID_RUOLO_TITOLARE,
      E.TIPO_FIRMA,
      E.STATO_FIRMA,
      E.SCADENZA,
      E.UTENTE_PROPONENTE AS ID_UTENTE,
      E.MODALITA,
      E.DATA_INSERIMENTO,
      E.DOC_NUMBER,
      E.VERSION_ID,
      E.NUM_ALL,
      E.NUM_VERSIONE,
      E.ID_UTENTE_TITOLARE,
      E.ID_UTENTE_LOCKER,
      E.ISTANZA_PROCESSO,
      P.SYSTEM_ID,
      P.VAR_PROF_OGGETTO,
      P.NUM_PROTO,
      P.CHA_TIPO_PROTO,
      P.ID_DOCUMENTO_PRINCIPALE,
      docsadm.getObjectMainDoc(p.id_documento_principale) as OBJECT_MAIN_DOCUMENT,
      P.CREATION_TIME,
      P.DTA_PROTO,
      T.VAR_DESC_ATTO,
      docsadm.corrcatbytipo(e.doc_number, P.CHA_TIPO_PROTO, 'D') AS DESC_RECIPIENT,
      g.Id_Gruppo As Id_Gruppo,
      g.Var_Cod_Rubrica As Group_Id,
      g.Var_Desc_Corr As Group_Name,
      g.System_Id As Id_Corr,
      i.note as NOTE
      FROM DPA_ELEMENTO_IN_LIBRO_FIRMA E
      JOIN PROFILE P
      ON E.DOC_NUMBER = P.SYSTEM_ID
      LEFT JOIN DPA_TIPO_ATTO t
      ON P.ID_TIPO_ATTO         = T.SYSTEM_ID
      Inner Join Dpa_Corr_Globali g On e.ruolo_proponente = g.Id_Gruppo
      LEFT JOIN DPA_ISTANZA_PROCESSO_FIRMA i on e.istanza_processo = i.id_istanza
      WHERE ID_ELEMENTO = @idElemento@
    </value>
  </query>
  <query>
    <name>S_DPA_ELEMENTI_LIBRO_FIRMA_BY_ID_ISTANZA_PASSO</name>
    <value>
      SELECT E.ID_ELEMENTO,
      E.ID_RUOLO_TITOLARE,
      E.TIPO_FIRMA,
      E.STATO_FIRMA,
      E.SCADENZA,
      E.UTENTE_PROPONENTE AS ID_UTENTE,
      E.MODALITA,
      E.DATA_INSERIMENTO,
      E.DOC_NUMBER,
      E.VERSION_ID,
      E.NUM_ALL,
      E.NUM_VERSIONE,
      E.ID_UTENTE_TITOLARE,
      E.ID_UTENTE_LOCKER,
      E.ISTANZA_PROCESSO,
      P.SYSTEM_ID,
      P.VAR_PROF_OGGETTO,
      P.NUM_PROTO,
      P.CHA_TIPO_PROTO,
      P.ID_DOCUMENTO_PRINCIPALE,
      docsadm.getObjectMainDoc(p.id_documento_principale) as OBJECT_MAIN_DOCUMENT,
      P.CREATION_TIME,
      P.DTA_PROTO,
      T.VAR_DESC_ATTO,
      docsadm.corrcatbytipo(e.doc_number, P.CHA_TIPO_PROTO, 'D') AS DESC_RECIPIENT,
      g.Id_Gruppo As Id_Gruppo,
      g.Var_Cod_Rubrica As Group_Id,
      g.Var_Desc_Corr As Group_Name,
      g.System_Id As Id_Corr,
      i.note as NOTE
      FROM DPA_ELEMENTO_IN_LIBRO_FIRMA E
      JOIN PROFILE P
      ON E.DOC_NUMBER = P.SYSTEM_ID
      LEFT JOIN DPA_TIPO_ATTO t
      ON P.ID_TIPO_ATTO         = T.SYSTEM_ID
      Inner Join Dpa_Corr_Globali g On e.ruolo_proponente = g.Id_Gruppo
      LEFT JOIN DPA_ISTANZA_PROCESSO_FIRMA i on e.istanza_processo = i.id_istanza
      WHERE ID_ISTANZA_PASSO = @idIstanzaPasso@
    </value>
  </query>
  <query>
    <name>U_DPA_ELEMENTI_IN_LIBRO_FIRMA_STATO</name>
    <value>
      UPDATE DPA_ELEMENTO_IN_LIBRO_FIRMA
      SET STATO_FIRMA = '@stato@',
      ID_UTENTE_LOCKER = @idUtenteLocker@
      WHERE @idElements@ AND (ID_UTENTE_LOCKER IS NULL OR ID_UTENTE_LOCKER = @idPeople@)
    </value>
  </query>
  <query>
    <name>U_DPA_ELEMENTO_IN_LIBRO_FIRMA_STATO</name>
    <value>
      UPDATE DPA_ELEMENTO_IN_LIBRO_FIRMA
      SET STATO_FIRMA = '@stato@',
      ID_UTENTE_LOCKER = @idUtenteLocker@
      WHERE ID_ELEMENTO = @idElemento@ AND (ID_UTENTE_LOCKER IS NULL OR ID_UTENTE_LOCKER = @idPeople@)
    </value>
  </query>
  <query>
    <name>U_DPA_ISTANZA_PROCESSO_FIRMA_MOTIVO_RESPINGIMENTO</name>
    <value>
      UPDATE DPA_ISTANZA_PROCESSO_FIRMA
      SET MOTIVO_RESPINGIMENTO='@motivoRespingimento@'
      WHERE ID_ISTANZA = @idIstanza@
    </value>
  </query>
  <query>
    <name>S_DPA_ELEMENTO_IN_LIBRO_FIRMA_LOCKER</name>
    <value>
      SELECT ID_ELEMENTO, ID_UTENTE_LOCKER, P.VAR_PROF_OGGETTO AS OGGETTO, g.var_desc_corr AS DESCRIZIONE_UTENTE
      FROM DPA_ELEMENTO_IN_LIBRO_FIRMA
      JOIN PROFILE P
      ON DOC_NUMBER = P.SYSTEM_ID
      Inner Join Dpa_Corr_Globali g On id_utente_locker= g.id_People
      WHERE @idElements@ AND ID_UTENTE_LOCKER IS NOT NULL AND NOT(ID_UTENTE_LOCKER = @idPeople@)
    </value>
  </query>
  <query>
    <name>I_DPA_ELEMENTO_IN_LIBRO_FIRMA</name>
    <value>
      INSERT
      INTO DPA_ELEMENTO_IN_LIBRO_FIRMA
      (
      ID_RUOLO_TITOLARE,
      TIPO_FIRMA,
      STATO_FIRMA,
      NOTE,
      RUOLO_PROPONENTE,
      UTENTE_PROPONENTE,
      MODALITA,
      DATA_INSERIMENTO,
      DOC_NUMBER,
      VERSION_ID,
      NUM_ALL,
      NUM_VERSIONE,
      ID_UTENTE_TITOLARE,
      ID_UTENTE_LOCKER,
      ISTANZA_PROCESSO,
      ID_ISTANZA_PASSO,
      ID_DOC_PRINCIPALE
      )
      SELECT @idRuoloTitolare@,
      '@tipoFitma@',
      '@statoFirma@',
      '@note@',
      @idRuoloProponente@,
      @idUtenteProponente@,
      '@modalita@',
      @dataInserimento@,
      @docNumber@,
      @versionId@,
      @numAll@,
      @numVersion@,
      @idUtenteTitolare@,
      @IdUtenteLocker@,
      @idIstanzaProcesso@,
      @idIstanzaPasso@,
      CASE
      WHEN P.ID_DOCUMENTO_PRINCIPALE IS NULL
      THEN P.SYSTEM_ID
      ELSE P.ID_DOCUMENTO_PRINCIPALE
      END
      FROM PROFILE P WHERE p.system_id = @docNumber@
    </value>
  </query>
  <query>
    <name>I_DPA_ELEMENTO_IN_LIBRO_FIRMA_MANUALE</name>
    <value>
      INSERT
      INTO DPA_ELEMENTO_IN_LIBRO_FIRMA
      (
      ID_RUOLO_TITOLARE,
      TIPO_FIRMA,
      STATO_FIRMA,
      NOTE,
      RUOLO_PROPONENTE,
      UTENTE_PROPONENTE,
      MODALITA,
      DATA_INSERIMENTO,
      DOC_NUMBER,
      VERSION_ID,
      NUM_VERSIONE,
      ID_UTENTE_TITOLARE,
      ID_UTENTE_LOCKER,
      ID_DOC_PRINCIPALE,
      ID_TRASM_SINGOLA,
      DTA_ACCETTAZIONE
      )
      values (
      @idRuoloTitolare@,
      '@tipoFirma@',
      '@statoFirma@',
      '@note@',
      @idRuoloProponente@,
      @idUtenteProponente@,
      '@modalita@',
      @dataInserimento@,
      @docNumber@,
      @versionId@,
      @numVersion@,
      @idUtenteTitolare@,
      @IdUtenteLocker@,
      @idDocumentoPrincipale@,
      @idTrasmSingola@,
      CONVERT(datetime,'@dtaAccettazione@',103)
      )
    </value>
  </query>
  <query>
    <name>S_DPA_ISTANZA_PROCESSO_DA_PASSO</name>
    <value>
      Select Dpa_Istanza_Processo_Firma.Id_Ruolo_Proponente,
      Dpa_Istanza_Processo_Firma.Id_Utente_Proponente,
      Dpa_Istanza_Processo_Firma.Doc_All,
      Dpa_Istanza_Processo_Firma.Num_All,
      Dpa_Istanza_Processo_Firma.Num_Versione,
      Dpa_Istanza_Processo_Firma.Version_Id,
      Dpa_Istanza_Processo_Firma.Id_Documento,
      Dpa_Istanza_Processo_Firma.Id_Istanza,
      Dpa_Istanza_Processo_Firma.Note
      From Dpa_Istanza_Processo_Firma Inner Join Dpa_Istanza_Passo_Firma
      On Dpa_Istanza_Processo_Firma.Id_Istanza = Dpa_Istanza_Passo_Firma.Id_Istanza_Processo
      WHERE Dpa_Istanza_Passo_Firma.Id_Istanza_Passo = @idIstanzaPasso@
    </value>
  </query>
  <query>
    <name>S_DPA_ISTANZA_PASSO_DI_FIRMA</name>
    <value>
      SELECT Dpa_Istanza_Passo_Firma.Id_Istanza_Passo,
      Dpa_Istanza_Passo_Firma.Id_Istanza_Processo,
      Dpa_Istanza_Passo_Firma.Id_Passo,
      Dpa_Istanza_Passo_Firma.Stato_Passo,
      Dpa_Istanza_Passo_Firma.Eseguito_Il,
      Dpa_Istanza_Passo_Firma.Motivo_Respingimento,
      Dpa_Istanza_Passo_Firma.Id_Utente_Coinvolto As Id_Utente,
      Dpa_Istanza_Passo_Firma.Tipo_Firma,
      Dpa_Istanza_Passo_Firma.Scadenza,
      Dpa_Istanza_Passo_Firma.Numero_Sequenza,
      Dpa_Istanza_Passo_Firma.Note,
      Dpa_Istanza_Passo_Firma.Id_Notifica_Effettuata,
      Dpa_Corr_Globali.Id_Gruppo As Id_Gruppo,
      Dpa_Corr_Globali.Var_Cod_Rubrica As Group_Id,
      Dpa_Corr_Globali.Var_Desc_Corr As Group_Name,
      Dpa_Corr_Globali.System_Id As Id_Corr,
      Dpa_Anagrafica_Eventi.Id_Evento As Id_Tipo_Evento,
      Dpa_Anagrafica_Eventi.Var_Cod_Azione As Tipo_Evento,
      Dpa_Anagrafica_Eventi.Descrizione,
      Dpa_Anagrafica_Eventi.Cha_tipo_evento,
      Dpa_Anagrafica_Eventi.gruppo,
      Dpa_Istanza_Processo_Firma.Notifica_Interrotto,
      Dpa_Istanza_Processo_Firma.Notifica_Concluso
      From Dpa_Istanza_Passo_Firma Inner Join Dpa_Anagrafica_Eventi
      On Dpa_Istanza_Passo_Firma.Tipo_Evento = Dpa_Anagrafica_Eventi.Id_Evento
      Left Join Dpa_Corr_Globali On Dpa_Istanza_Passo_Firma.Id_Ruolo_Coinvolto = Dpa_Corr_Globali.Id_Gruppo
      Inner Join Dpa_Istanza_Processo_Firma On Dpa_Istanza_Passo_Firma.Id_Istanza_Processo = Dpa_Istanza_Processo_Firma.Id_Istanza
      WHERE id_istanza_Passo =  @idIstanzaPassoFirma@
    </value>
  </query>
  <query>
    <name>S_DPA_ISTANZA_PASSO_DI_FIRMA_IN_ATTESA_BY_PROCESSO</name>
    <value>
      SELECT ID_ISTANZA_PASSO,
      ID_ISTANZA_PROCESSO,
      Id_Passo,
      Stato_Passo,
      ESEGUITO_IL,
      Motivo_Respingimento,
      TIPO_FIRMA,
      Scadenza,
      Dpa_Anagrafica_Eventi.Id_Evento,
      Dpa_Anagrafica_Eventi.Var_Cod_Azione,
      Dpa_Anagrafica_Eventi.Descrizione,
      Dpa_Anagrafica_Eventi.Cha_tipo_evento,
      Dpa_Anagrafica_Eventi.gruppo,
      Numero_Sequenza,
      ID_NOTIFICA_EFFETTUATA,
      NOTE,
      ID_UTENTE_COINVOLTO,
      ID_RUOLO_COINVOLTO
      From Dpa_Istanza_Passo_Firma Inner Join Dpa_Anagrafica_Eventi
      On Dpa_Istanza_Passo_Firma.Tipo_Evento = Dpa_Anagrafica_Eventi.Id_Evento
      WHERE id_istanza_Processo=  @idIstanzaProcesso@ AND stato_passo = '@statoPasso@'
    </value>
  </query>
  <query>
    <name>U_ISTANZA_PASSO_SET_STATE</name>
    <value>
      UPDATE Dpa_Istanza_Passo_Firma SET STATO_PASSO = '@stato@'
      @dataEvento@
      Where Dpa_Istanza_Passo_Firma.ID_ISTANZA_PASSO = @Id_Passo@
    </value>
  </query>
  <query>
    <name>S_NEXT_PASSO</name>
    <value>
      Select Dpa_Istanza_Passo_Firma.*, Dpa_Anagrafica_Eventi.Var_Cod_Azione, Dpa_Anagrafica_Eventi.Descrizione, Dpa_Anagrafica_Eventi.Gruppo,
      Dpa_Istanza_Processo_Firma.Id_Ruolo_Proponente, Dpa_Istanza_Processo_Firma.Id_Utente_Proponente
      From Dpa_Istanza_Passo_Firma Inner Join Dpa_Istanza_Processo_Firma
      ON Dpa_Istanza_Passo_Firma.Id_Istanza_Processo = Dpa_Istanza_Processo_Firma.Id_Istanza
      Inner join Dpa_Anagrafica_Eventi on Dpa_Istanza_Passo_Firma.Tipo_Evento = Dpa_Anagrafica_Eventi.Id_Evento
      Where Dpa_Istanza_Processo_Firma.Id_Istanza = @idIstanzaProcesso@
      And Dpa_Istanza_Passo_Firma.numero_sequenza = @numeroSequenza@
      And Dpa_Istanza_Processo_Firma.VERSION_ID = @versionId@
    </value>
  </query>
  <query>
    <name>S_TITOLARE_PASSO</name>
    <value>
      SELECT ID_UTENTE_LOCKER, ID_RUOLO_COINVOLTO
      FROM DPA_ISTANZA_PASSO_FIRMA
      WHERE NUMERO_SEQUENZA = @numeroSequenza@ AND ID_ISTANZA_PROCESSO = @idIstanzaProcesso@
    </value>
  </query>
  <query>
    <name>S_DPA_ISTANZA_PROCESSO_FIRMA_BY_DOCNUMBER</name>
    <value>
      SELECT ID_ISTANZA, ID_PROCESSO, DESCRIZIONE, ATTIVATO_IL, CONCLUSO_IL, NOTIFICA_CONCLUSO, NOTIFICA_INTERROTTO, NOTE, STATO,
      MOTIVO_RESPINGIMENTO, DOC_ALL, ID_DOCUMENTO,
      P.ID_RUOLO_PROPONENTE AS ID_GRUPPO,
      P.CHA_INTERROTTO_DA,
      P.ID_PEOPLE_DELEGATO,
      docsadm.GETDESCRUOLO(P.ID_RUOLO_PROPONENTE) AS Group_Name,
      docsadm.getcodRuolo(P.ID_RUOLO_PROPONENTE) as Group_Id,
      docsadm.getRuoloSystemIdCorr(P.ID_RUOLO_PROPONENTE) as Id_Corr,
      P.ID_UTENTE_PROPONENTE AS ID_UTENTE,
      docsadm.getpeopleuserid(P.ID_UTENTE_PROPONENTE) AS USER_CODE,
      docsadm.getpeoplename(P.ID_UTENTE_PROPONENTE) AS USER_DESCRIPTION,
      docsadm.getCorrSystemId(P.ID_UTENTE_PROPONENTE) AS USER_SYSTEM_ID
      FROM DPA_ISTANZA_PROCESSO_FIRMA P
      WHERE ID_DOCUMENTO = @docnumber@
      ORDER BY ATTIVATO_IL DESC
    </value>
  </query>
  <query>
    <name>S_DPA_ISTANZA_PROCESSO_FIRMA_BY_ID_PROCESSO</name>
    <value>
      SELECT ID_ISTANZA, ID_PROCESSO, DESCRIZIONE, ATTIVATO_IL, CONCLUSO_IL, NOTE,  MOTIVO_RESPINGIMENTO, STATO,ID_UTENTE_PROPONENTE AS ID_UTENTE, ID_RUOLO_PROPONENTE,
      ID_RUOLO_PROPONENTE AS ID_GRUPPO,
      docsadm.GETDESCRUOLO(P.ID_RUOLO_PROPONENTE) AS Group_Name,
      docsadm.getcodRuolo(P.ID_RUOLO_PROPONENTE) as Group_Id,
      docsadm.GETDESCRUOLO(ID_RUOLO_PROPONENTE) AS GROUP_DESCRIPTION,
      docsadm.getRuoloSystemIdCorr(ID_RUOLO_PROPONENTE) as Id_Corr,
      docsadm.getpeopleuserid(ID_UTENTE_PROPONENTE) AS USER_CODE,
      docsadm.getpeoplename(ID_UTENTE_PROPONENTE) AS USER_DESCRIPTION,
      docsadm.getCorrSystemId(ID_UTENTE_PROPONENTE) AS USER_SYSTEM_ID
      FROM DPA_ISTANZA_PROCESSO_FIRMA P
      WHERE ID_PROCESSO = @idProcesso@
      order by  ATTIVATO_IL desc
    </value>
  </query>
  <query>
    <name>S_DPA_ISTANZA_PROCESSO_FIRMA_BY_ID_ISTANZA_PROCESSO</name>
    <value>
      SELECT ID_ISTANZA, ID_PROCESSO, DESCRIZIONE, ATTIVATO_IL, CONCLUSO_IL, NOTE,  MOTIVO_RESPINGIMENTO, STATO,ID_UTENTE_PROPONENTE AS ID_UTENTE, ID_RUOLO_PROPONENTE,
      docsadm.GETDESCRUOLO(ID_RUOLO_PROPONENTE) AS GROUP_DESCRIPTION,
      docsadm.getRuoloSystemIdCorr(ID_RUOLO_PROPONENTE) as Id_Corr,
      docsadm.getpeopleuserid(ID_UTENTE_PROPONENTE) AS USER_CODE,
      docsadm.getpeoplename(ID_UTENTE_PROPONENTE) AS USER_DESCRIPTION,
      docsadm.getCorrSystemId(ID_UTENTE_PROPONENTE) AS USER_SYSTEM_ID, Id_Documento
      FROM DPA_ISTANZA_PROCESSO_FIRMA
      WHERE ID_ISTANZA = @idIstanzaProcesso@
    </value>
  </query>
  <query>
    <name>S_DPA_ISTANZA_PROCESSO_FIRMA_FILTER</name>
    <value>
      SELECT Row, A.*
      FROM
      (SELECT ROW_NUMBER() OVER (ORDER BY I.ATTIVATO_IL DESC)
      AS Row,
      I.ID_ISTANZA,
      I.ID_PROCESSO,
      I.DESCRIZIONE,
      I.ATTIVATO_IL,
      I.CONCLUSO_IL, I.NOTE,
      I.MOTIVO_RESPINGIMENTO,
      I.STATO,
      I.ID_UTENTE_PROPONENTE AS ID_UTENTE,
      I.ID_RUOLO_PROPONENTE,
      I.ID_DOCUMENTO,
      I.DOC_ALL,
      @dbuser@.GETOBJECTMAINDOCCHECKSECURITY(I.ID_DOCUMENTO, @peopleId@, @groupId@, @idRuoloPubblico@) AS VAR_PROF_OGGETTO,
      @dbuser@.GETSEGNATURAREPERTORIO_NEW(I.ID_DOCUMENTO, @idAmm@) as SEGNATURA_REPERTORIO,
      P.NUM_PROTO,
      convert(nvarchar (10), P.DTA_PROTO, 103) AS DTA_PROTO,
      convert(nvarchar (10), P.CREATION_DATE, 103)  as CREATION_DATE
      FROM DPA_ISTANZA_PROCESSO_FIRMA I JOIN  PROFILE P ON I.ID_DOCUMENTO = P.SYSTEM_ID
      @condition@
      ) AS A
      @paging@
    </value>
  </query>
  <query>
    <name>S_DPA_ISTANZA_PROCESSO_FIRMA_FILTER_COUNT</name>
    <value>
      SELECT
      COUNT(I.ID_ISTANZA)
      FROM DPA_ISTANZA_PROCESSO_FIRMA I JOIN  PROFILE P ON I.ID_DOCUMENTO = P.SYSTEM_ID
      @condition@
    </value>
  </query>
  <query>
    <name>U_ISTANZA_PROCESSO_FIRMA</name>
    <value>
      UPDATE DPA_ISTANZA_PROCESSO_FIRMA SET NOTIFICA_INTERROTTO = '@notificaInterrotto@', NOTIFICA_CONCLUSO = '@notificaConcluso@'
      Where ID_ISTANZA = @idIstanzaProcesso@
    </value>
  </query>
  <query>
    <name>S_DPA_ISTANZA_PASSO_DI_FIRMA_BY_ISTANZA_PROCESSO</name>
    <value>
      SELECT ID_ISTANZA_PASSO,
      ID_ISTANZA_PROCESSO,
      Id_Passo,
      Stato_Passo,
      ESEGUITO_IL,
      Motivo_Respingimento,
      NOTE,
      DESC_UTENTE_LOCKER,
      Dpa_Corr_Globali.Id_Gruppo As Id_Gruppo,
      Dpa_Corr_Globali.Var_Cod_Rubrica As Group_Id,
      Dpa_Corr_Globali.Var_Desc_Corr As Group_Name,
      Dpa_Corr_Globali.System_Id As Id_Corr,
      ID_UTENTE_COINVOLTO AS ID_UTENTE,
      TIPO_FIRMA,
      Scadenza,
      Dpa_Anagrafica_Eventi.Id_Evento,
      Dpa_Anagrafica_Eventi.Var_Cod_Azione,
      Dpa_Anagrafica_Eventi.Descrizione,
      Dpa_Anagrafica_Eventi.Cha_tipo_evento,
      Dpa_Anagrafica_Eventi.gruppo,
      Numero_Sequenza,
      ID_NOTIFICA_EFFETTUATA
      From Dpa_Istanza_Passo_Firma Inner Join Dpa_Anagrafica_Eventi
      On Dpa_Istanza_Passo_Firma.Tipo_Evento = Dpa_Anagrafica_Eventi.Id_Evento
      left Join Dpa_Corr_Globali On Dpa_Istanza_Passo_Firma.Id_Ruolo_Coinvolto = Dpa_Corr_Globali.Id_Gruppo
      WHERE id_istanza_Processo =  @idIstanzaProcesso@
      order by numero_sequenza
    </value>
  </query>
  <query>
    <name>I_DPA_ISTANZA_PROCESSO_FIRMA</name>
    <value>
      INSERT
      INTO DPA_ISTANZA_PROCESSO_FIRMA
      (
      ID_PROCESSO,
      STATO,
      ATTIVATO_IL,
      CONCLUSO_IL,
      ID_RUOLO_PROPONENTE,
      ID_UTENTE_PROPONENTE,
      ID_DOCUMENTO,
      VERSION_ID,
      DOC_ALL,
      NUM_ALL,
      NUM_VERSIONE,
      DESCRIZIONE,
      NOTIFICA_INTERROTTO,
      NOTIFICA_CONCLUSO,
      NOTE,
      ID_PEOPLE_DELEGATO
      )
      VALUES
      (
      @idProcesso@,
      '@stato@',
      @dataAttivazione@,
      @dataConclusione@,
      @idRuolo@,
      @idUtente@,
      @docNumber@,
      @versionId@,
      '@docAll@',
      @numAll@,
      @numVersion@,
      '@descrizione@',
      '@noticaInterruzione@',
      '@noticaConclusione@',
      '@note@',
      @idUtenteDelegato@
      )
    </value>
  </query>

  <query>
    <name>I_DPA_ISTANZA_PASSI_PROCESSO</name>
    <value>
      INSERT INTO DPA_ISTANZA_PASSO_FIRMA
      (
      ID_ISTANZA_PROCESSO,
      ID_PASSO,
      STATO_PASSO,
      ESEGUITO_IL,
      MOTIVO_RESPINGIMENTO,
      ID_RUOLO_COINVOLTO,
      ID_UTENTE_COINVOLTO,
      TIPO_FIRMA,
      SCADENZA,
      TIPO_EVENTO,
      NUMERO_SEQUENZA,
      ID_NOTIFICA_EFFETTUATA,
      NOTE
      )
      Select @idIstanza@, Id_Passo, '@statoPasso@',
      Null, Null,
      case
      when id_tipo_ruolo_coinvolto is null  then Id_Ruolo_Coinvolto
      else docsadm.GETROLESUPBYIDROLEANDTYPEROLE(@idGruppo@, id_tipo_ruolo_coinvolto)
      END,
      Id_Utente_Coinvolto, Tipo_Firma, Scadenza,
      Tipo_Evento, Numero_Sequenza, Null, NOTE
      FROM Dpa_Passo_Di_Firma Inner Join Dpa_Anagrafica_Eventi
      On Dpa_Passo_Di_Firma.Tipo_Evento = Dpa_Anagrafica_Eventi.Id_Evento
      WHERE Dpa_Passo_Di_Firma.Id_Processo = @idProcesso@
      @allegato@
    </value>
  </query>
  <query>
    <name>S_DPA_CORR_GLOBALI_ROLE_SUP_BY_ID_TIPO_RUOLO</name>
    <value>
      SELECT SYSTEM_ID, VAR_CODICE, VAR_DESC_RUOLO
      FROM DPA_TIPO_RUOLO
      WHERE @idTypeRole@
      AND docsadm.GETROLESUPBYIDROLEANDTYPEROLE(@idGruppo@, SYSTEM_ID) IS NULL
    </value>
  </query>
  <query>
    <name>U_STATE_ISTANZA_PASSO_NUM</name>
    <value>
      UPDATE Dpa_Istanza_Passo_Firma SET stato_passo = '@stato@'
      Where Dpa_Istanza_Passo_Firma.id_istanza_Processo = @IdProcesso@
      AND NUMERO_SEQUENZA = @numPasso@
    </value>
  </query>
  <query>
    <name>I_DPA_PASSI_DPA_EVENTO_ISTANZA_PASSO</name>
    <value>
      INSERT INTO DPA_PASSO_DPA_EVENTO
      (ID_EVENTO, ID_ISTANZA_PASSO
      )
      SELECT P.ID_EVENTO,
      I.ID_ISTANZA_PASSO
      FROM DPA_ISTANZA_PASSO_FIRMA I
      JOIN DPA_PASSO_DPA_EVENTO P
      ON P.ID_PASSO = I.ID_PASSO
      WHERE I.ID_ISTANZA_PROCESSO = @idIstanza@
    </value>
  </query>
  <query>
    <name>S_DPA_PASSI_DPA_EVENTO_BY_ISTANZA_PASSO</name>
    <value>
      SELECT *
      FROM DPA_PASSO_DPA_EVENTO P
      INNER JOIN DPA_ANAGRAFICA_EVENTI E
      ON P.ID_EVENTO         = E.ID_EVENTO
      WHERE ID_ISTANZA_PASSO = @idIstanzaPasso@
      AND E.VAR_COD_AZIONE   = '@codiceEvento@'
    </value>
  </query>
  <query>
    <name>U_LOCK_DOC_LF</name>
    <value>
      UPDATE PROFILE SET In_Librofirma = @stato@
      WHERE PROFILE.DOCNUMBER = @docnumber@ AND NOT(isNull(IN_LIBROFIRMA,'0')='@stato@')
    </value>
  </query>

  <query>
    <name>E_ISTANZA_PASSI_DEL_PROCESSO</name>
    <value>
      DELETE FROM Dpa_Istanza_Passo_Firma
      WHERE Id_Istanza_Processo = @IdProcesso@
    </value>
  </query>

  <query>
    <name>E_ISTANZA_PROCESSO</name>
    <value>
      DELETE FROM Dpa_Istanza_Processo_Firma
      WHERE Id_Istanza = @IdProcesso@
    </value>
  </query>
  <query>
    <name>S_TITOLARE_LIBRO_FIRMA</name>
    <value>
      SELECT Id_Ruolo_Titolare, Id_Utente_Titolare, Id_Utente_Locker
      FROM Dpa_Elemento_In_Libro_Firma
      WHERE Doc_Number = @docnumber@ AND DTA_ESECUZIONE IS NULL
    </value>
  </query>

  <query>
    <name>S_FIRMA_ELETTRONICA</name>
    <value>
      SELECT * FROM DPA_FIRMA_ELETTRONICA
      WHERE ID_FIRMA = @idfirma@
    </value>
  </query>

  <query>
    <name>I_FIRMA_ELETTRONICA_NEW</name>
    <value>
      INSERT INTO DPA_FIRMA_ELETTRONICA
      (ID_DOCUMENTO,
      VERSION_ID, DOC_ALL,
      NUM_ALL, NUMERO_VERSIONE,
      DATA_APPOSIZIONE)
      VALUES
      (@docnumber@, @versionid@,
      '@docall@', '@numall@',
      '@numavers@', @data@)
    </value>
  </query>

  <query>
    <name>I_FIRMA_ELETTRONICA</name>
    <value>
      INSERT INTO DPA_FIRMA_ELETTRONICA
      (ID_DOCUMENTO,
      VERSION_ID, DOC_ALL,
      NUM_ALL, NUMERO_VERSIONE,
      DATA_APPOSIZIONE, XML)
      VALUES
      (
      @docnumber@, @versionid@,
      '@docall@', '@numall@',
      '@numavers@', @data@, '@xml@')
    </value>
  </query>

  <query>
    <name>U_FIRMA_ELETTRONICA</name>
    <value>
      UPDATE DPA_FIRMA_ELETTRONICA SET XML = '@xml@'
      WHERE ID_FIRMA = @idfirma@
    </value>
  </query>
  <query>
    <name>U_DPA_ELEMENTO_IN_LIBRO_FIRMA_ID_TRASM</name>
    <value>
      UPDATE DPA_ELEMENTO_IN_LIBRO_FIRMA
      SET ID_TRASM_SINGOLA = @idTrasmSingola@, DTA_ACCETTAZIONE = @dtaAccettazione@
      WHERE ID_ELEMENTO = @idElemento@
    </value>
  </query>
  <query>
    <name>U_DPA_ELEMENTO_IN_LIBRO_FIRMA_DTA_ACCETTATA</name>
    <value>
      UPDATE DPA_ELEMENTO_IN_LIBRO_FIRMA
      SET DTA_ACCETTAZIONE = @dtaAccettazione@, STATO_FIRMA='@stato@', ID_UTENTE_LOCKER=@idUtenteLocker@
      WHERE ID_TRASM_SINGOLA = @idTrasmSingola@ AND DTA_ACCETTAZIONE IS NULL
    </value>
  </query>
  <query>
    <name>U_DPA_ELEMENTO_IN_LIBRO_FIRMA_SET_ULOCKER</name>
    <value>
      UPDATE DPA_ELEMENTO_IN_LIBRO_FIRMA
      SET DTA_ESECUZIONE = @dtaAzione@, ID_UTENTE_LOCKER = @idUtenteLocker@
      WHERE ID_ISTANZA_PASSO = @idIstanzaPasso@ AND ID_UTENTE_LOCKER is null
    </value>
  </query>
  <query>
    <name>U_DPA_ELEMENTO_IN_LIBRO_FIRMA_DTA_ESECUZIONE</name>
    <value>
      UPDATE DPA_ELEMENTO_IN_LIBRO_FIRMA
      SET DTA_ESECUZIONE = @dtaEsecuzione@, STATO_FIRMA='@stato@'
      WHERE DOC_NUMBER = @docnumber@ AND DTA_ESECUZIONE IS NULL
    </value>
  </query>
  <query>
    <name>U_DPA_ELEMENTO_IN_LIBRO_ERRORE_FIRMA</name>
    <value>
      UPDATE DPA_ELEMENTO_IN_LIBRO_FIRMA
      SET ERRORE_FIRMA = '@msgError@'
      WHERE DOC_NUMBER = @docnumber@ AND DTA_ESECUZIONE IS NULL
    </value>
  </query>
  <query>
    <name>S_DPA_TRASM_SINGOLA_ID_TRASMISSIONE</name>
    <value>
      SELECT ID_TRASMISSIONE
      FROM DPA_TRASM_SINGOLA
      WHERE SYSTEM_ID = @idTrasmissioneSingola@
    </value>
  </query>
  <query>
    <name>S_DPA_RAGIONE_TRASM_BY_PROC_RES</name>
    <value>
      SELECT
      a.SYSTEM_ID,
      a.VAR_DESC_RAGIONE,
      a.CHA_TIPO_RAGIONE,
      a.CHA_TIPO_DIRITTI,
      a.CHA_RISPOSTA,
      a.CHA_TIPO_DEST,
      a.VAR_NOTE,
      a.CHA_EREDITA,
      a.CHA_TIPO_RISPOSTA,
      a.VAR_NOTIFICA_TRASM,
      a.VAR_TESTO_MSG_NOTIFICA_DOC,
      a.VAR_TESTO_MSG_NOTIFICA_FASC,
      a.CHA_CEDE_DIRITTI,
      a.CHA_MANTIENI_LETT
      FROM DPA_RAGIONE_TRASM a, DPA_AMMINISTRA b
      WHERE a.ID_AMM = @idAmm@
      AND a.ID_AMM = b.SYSTEM_ID
      AND a.CHA_PROC_RES = '@tipoOperazione@'
    </value>
  </query>

  <query>
    <name>S_DPA_FIRMA_ELETTRONICA_BY_VERSION</name>
    <value>
      SELECT Id_Firma, Id_Documento, Version_Id, Doc_All, Num_All, Numero_Versione, Xml, Data_Apposizione
      FROM Dpa_Firma_Elettronica WHERE Version_Id = @versionid@
      AND Xml is not null
      order by id_firma
    </value>
  </query>

  <query>
    <name>I_DPA_ELEMENTO_IN_LF_STOR</name>
    <value>
      INSERT INTO DPA_ELEMENTO_IN_LF_STOR
      (ID_ELEMENTO,ID_RUOLO_TITOLARE,
      TIPO_FIRMA,STATO_FIRMA,NOTE,SCADENZA,
      RUOLO_PROPONENTE,UTENTE_PROPONENTE,MODALITA,
      DATA_INSERIMENTO,DOC_NUMBER,
      Version_Id,Num_All,
      NUM_VERSIONE,ID_UTENTE_TITOLARE,
      ID_UTENTE_LOCKER,ISTANZA_PROCESSO,
      ID_TRASM_SINGOLA,ID_DOC_PRINCIPALE,
      ID_ISTANZA_PASSO,DTA_ACCETTAZIONE)
      SELECT
      ID_ELEMENTO,ID_RUOLO_TITOLARE,
      TIPO_FIRMA,STATO_FIRMA,
      NOTE,SCADENZA,
      RUOLO_PROPONENTE,UTENTE_PROPONENTE,
      MODALITA,DATA_INSERIMENTO,
      Doc_Number,VERSION_ID,
      NUM_ALL,NUM_VERSIONE,
      ID_UTENTE_TITOLARE,ID_UTENTE_LOCKER,
      ISTANZA_PROCESSO,ID_TRASM_SINGOLA,
      ID_DOC_PRINCIPALE,ID_ISTANZA_PASSO,
      Dta_Accettazione
      FROM Dpa_Elemento_In_Libro_Firma WHERE ID_ISTANZA_PASSO = @idpasso@
    </value>
  </query>

  <query>
    <name>I_DPA_ELEMENTO_IN_LF_STOR_BY_ID_ELEMENTO</name>
    <value>
      INSERT INTO DPA_ELEMENTO_IN_LF_STOR
      (ID_ELEMENTO,ID_RUOLO_TITOLARE,
      TIPO_FIRMA,STATO_FIRMA,NOTE,SCADENZA,
      RUOLO_PROPONENTE,UTENTE_PROPONENTE,MODALITA,
      DATA_INSERIMENTO,DOC_NUMBER,
      Version_Id,Num_All,
      NUM_VERSIONE,ID_UTENTE_TITOLARE,
      ID_UTENTE_LOCKER,ISTANZA_PROCESSO,
      ID_TRASM_SINGOLA,ID_DOC_PRINCIPALE,
      ID_ISTANZA_PASSO,DTA_ACCETTAZIONE)
      SELECT
      ID_ELEMENTO,ID_RUOLO_TITOLARE,
      TIPO_FIRMA,STATO_FIRMA,
      NOTE,SCADENZA,
      RUOLO_PROPONENTE,UTENTE_PROPONENTE,
      MODALITA,DATA_INSERIMENTO,
      Doc_Number,VERSION_ID,
      NUM_ALL,NUM_VERSIONE,
      ID_UTENTE_TITOLARE,ID_UTENTE_LOCKER,
      ISTANZA_PROCESSO,ID_TRASM_SINGOLA,
      ID_DOC_PRINCIPALE,ID_ISTANZA_PASSO,
      Dta_Accettazione
      FROM Dpa_Elemento_In_Libro_Firma WHERE ID_ELEMENTO = @idElemento@
    </value>
  </query>

  <query>
    <name>E_DPA_ELEMENTO_IN_LF</name>
    <value>
      DELETE Dpa_Elemento_In_Libro_Firma WHERE ID_ISTANZA_PASSO = @idpasso@
    </value>
  </query>

  <query>
    <name>E_DPA_ELEMENTO_IN_LF_BY_ID_ELEMENTO</name>
    <value>
      DELETE Dpa_Elemento_In_Libro_Firma WHERE ID_ELEMENTO = @idElemento@
    </value>
  </query>

  <query>
    <name>U_DPA_ISTANZA_PROCESSO_FIRMA</name>
    <value>
      Update Dpa_Istanza_Processo_Firma Set Concluso_Il = @dataConclusione@, stato='@stato@'
      where Id_Istanza = @idIstanza@
    </value>
  </query>
  <query>
    <name>U_DPA_ISTANZA_PROCESSO_FIRMA_INTERRUPTNIO</name>
    <value>
      Update Dpa_Istanza_Processo_Firma Set Concluso_Il = @dataConclusione@, stato='@stato@',CHA_INTERROTTO_DA='@interrottoDa@', MOTIVO_RESPINGIMENTO='@noteInterruption@'
      where Id_Istanza = @idIstanza@
    </value>
  </query>

  <query>
    <name>U_DPA_ISTANZA_PASSI_FIRMA_STOP</name>
    <value>
      Update Dpa_Istanza_Passo_Firma SET stato_passo = '@stato@'
      Where Dpa_Istanza_Passo_Firma.id_istanza_Processo = @idIstanza@
      AND NUMERO_SEQUENZA >= @numPasso@
    </value>
  </query>

  <query>
    <name>S_DOC_IN_LIBRO_FIRMA</name>
    <value>
      SELECT IN_LIBROFIRMA FROM PROFILE
      WHERE Docnumber = '@docnumber@'
      AND In_Librofirma = '1'
    </value>
  </query>
  <query>
    <name>S_DOC_ALL_IN_LIBRO_FIRMA</name>
    <value>
      SELECT IN_LIBROFIRMA FROM PROFILE
      WHERE (Docnumber = @docnumber@ OR ID_DOCUMENTO_PRINCIPALE = @docnumber@)
      AND In_Librofirma = '1'
    </value>
  </query>
  <query>
    <name>S_DPA_ELEMENTO_LIBRO_FIRMA_TYPE_SIGNATURE</name>
    <value>
      SELECT TIPO_FIRMA
      FROM DPA_ELEMENTO_IN_LIBRO_FIRMA
      WHERE DOC_NUMBER =  @docnumber@ AND VERSION_ID = @versionId@
    </value>
  </query>

  <query>
    <name>S_GET_INFO_DOCUMENTO_LITE</name>
    <value>
      SELECT 	A.SYSTEM_ID,
      A.DOCNUMBER,
      A.VAR_PROF_OGGETTO AS VAR_DESC_OGGETTO,
      A.CHA_TIPO_PROTO,
      A.NUM_PROTO,
      A.VAR_SEGNATURA,
      A.ID_DOCUMENTO_PRINCIPALE
      FROM 	  PROFILE A WITH(NOLOCK)
      WHERE (A.SYSTEM_ID = @docnumber@ AND A.ID_DOCUMENTO_PRINCIPALE IS NULL) OR (A.SYSTEM_ID = (SELECT ID_DOCUMENTO_PRINCIPALE FROM PROFILE WHERE SYSTEM_ID=@docnumber@))
    </value>
  </query>
  <query>
    <name>S_DPA_ISTANZA_PROCESSO_FIRMA_DOC_ATTACH</name>
    <value>
      SELECT I.ID_ISTANZA, I.ID_DOCUMENTO, I.DOC_ALL, I.NUM_ALL, I.DESCRIZIONE, P.VAR_PROF_OGGETTO
      FROM DPA_ISTANZA_PROCESSO_FIRMA I
      INNER JOIN PROFILE P
      ON I.ID_DOCUMENTO = P.DOCNUMBER
      WHERE I.CONCLUSO_IL IS NULL
      AND (P.ID_DOCUMENTO_PRINCIPALE = @docnumber@
      OR P.DOCNUMBER = @docnumber@)
    </value>
  </query>

  <query>
    <name>S_ISTANZA_WAIT</name>
    <value>
      Select Dpa_Istanza_Passo_Firma.Id_Istanza_Passo, Dpa_Istanza_Processo_Firma.Version_Id, Dpa_Istanza_Processo_Firma.Id_Istanza,
      Dpa_Istanza_Passo_Firma.Numero_Sequenza, Dpa_Elemento_In_Libro_Firma.Id_Doc_Principale, Dpa_Istanza_Processo_Firma.note,
      Dpa_Istanza_Processo_Firma.Id_Ruolo_Proponente, Dpa_Istanza_Processo_Firma.Id_Utente_Proponente
      From Dpa_Istanza_Passo_Firma Inner Join Dpa_Istanza_Processo_Firma
      On Dpa_Istanza_Passo_Firma.Id_Istanza_Processo = Dpa_Istanza_Processo_Firma.Id_Istanza
      Inner Join Dpa_Elemento_In_Libro_Firma
      On Dpa_Istanza_Processo_Firma.Id_Documento = Dpa_Elemento_In_Libro_Firma.Id_Doc_Principale
      Where Dpa_Elemento_In_Libro_Firma.Id_Istanza_Passo = @idIstanzaPasso@
      And Dpa_Istanza_Processo_Firma.Concluso_Il Is Null
      And Dpa_Istanza_Passo_Firma.Tipo_Firma = 'WAITING' And Dpa_Istanza_Passo_Firma.Stato_Passo = 'LOOK'
    </value>
  </query>
  <query>
    <name>S_DPA_ISTANZA_PASSO_FIRMA_CUT</name>
    <value>
      SELECT TOP 1 ID_ISTANZA_PASSO
      FROM DPA_ISTANZA_PASSO_FIRMA
      WHERE ID_ISTANZA_PROCESSO = @idIstanzaProcesso@ AND STATO_PASSO='CUT'
    </value>
  </query>
  <query>
    <name>S_DPA_SCHEMA_PROCESSO_FIRMA_BY_RUOLO_TITOLARE</name>
    <value>
      SELECT DISTINCT P.ID_PROCESSO, P.NOME, docsadm.getcodRuolo(P.RUOLO_AUTORE) AS RUOLO_AUTORE
      FROM DPA_SCHEMA_PROCESSO_FIRMA P INNER JOIN DPA_PASSO_DI_FIRMA PF ON P.ID_PROCESSO = PF.ID_PROCESSO
      WHERE PF.ID_RUOLO_COINVOLTO = @idRuoloTitolare@
      ORDER BY P.ID_PROCESSO DESC
    </value>
  </query>
  <query>
    <name>S_DPA_TIPO_RUOLO_BY_ID_AMM</name>
    <value>
      SELECT SYSTEM_ID, VAR_CODICE, VAR_DESC_RUOLO
      FROM DPA_TIPO_RUOLO
      WHERE ID_AMM = @idAmm@
      order by var_desc_ruolo asc
    </value>
  </query>
  <!-- FINE LIBRO FIRMA -->

  <!--  FIRMA ELETTRONICA -->

  <query>
    <name>S_DPA_FIRMA_ELETTRONICA</name>
    <value>
      SELECT *
      FROM DPA_FIRMA_ELETTRONICA
      WHERE ID_DOCUMENTO=@docnumber@ AND VERSION_ID=@versionId@ AND XML IS NOT NULL
      ORDER BY DATA_APPOSIZIONE
    </value>
  </query>
  <query>
    <name>U_COMPONENTS_CHA_FIRMATO</name>
    <value>
      UPDATE COMPONENTS
      SET CHA_FIRMATO= '1'
      WHERE DOCNUMBER=@docnumber@ AND VERSION_ID=@versionId@
    </value>
  </query>
  <query>
    <name>U_COMPONENTS_CHA_TIPO_FIRMA</name>
    <value>
      UPDATE COMPONENTS
      SET CHA_TIPO_FIRMA= '@tipoFirma@'
      WHERE DOCNUMBER=@docnumber@ AND VERSION_ID=@versionId@
    </value>
  </query>
  <query>
    <name>S_DPA_FIRMA_ELETTRONICA_IS_SIGNED</name>
    <value>
      SELECT TOP 1 ID_FIRMA
      FROM DPA_FIRMA_ELETTRONICA
      WHERE ID_DOCUMENTO = @docnumber@ AND VERSION_ID = @versionId@
    </value>
  </query>
  <!--  FINE FIRMA ELETTRONICA -->
  <query>
    <name>S_DPA_ULTIMI_DOC_VISUALIZZATI</name>
    <value>
      SELECT D.SYSTEM_ID, D.ID_PEOPLE, D.ID_GRUPPO, D.ID_AMM, D.ID_PROFILE,
      P.VAR_PROF_OGGETTO AS OGGETTO, P.VAR_SEGNATURA AS SEGNATURA
      FROM DPA_ULTIMI_DOC_VISUALIZZATI D JOIN PROFILE P ON D.ID_PROFILE = P.SYSTEM_ID
      WHERE ID_PEOPLE = @idPeople@ AND ID_GRUPPO = @idGruppo@ AND ID_AMM = @idAmm@
      ORDER BY DTA_VISUALIZZAZIONE DESC
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__PEOPLEGROUPS__TIPO_RUOLO_COD_FUNC</name>
    <value>
      SELECT
      A.PEOPLE_SYSTEM_ID,
      B.SYSTEM_ID,
      B.ID_GRUPPO,
      C.NUM_LIVELLO,
      C.VAR_CODICE,
      C.VAR_DESC_RUOLO,
      B.NUM_LIVELLO,
      B.ID_UO,
      B.VAR_COD_RUBRICA,
      B.ID_REGISTRO,
      B.ID_AMM ,
      B.VAR_DESC_CORR,
      A.CHA_PREFERITO,
      b.CHA_RIFERIMENTO,
      b.CHA_RESPONSABILE,
      b.CHA_SEGRETARIO
      from    peoplegroups as a INNER JOIN
      dpa_corr_globali as b
      on a.GROUPS_SYSTEM_ID = b.ID_GRUPPO INNER JOIN
      DPA_TIPO_RUOLO as c
      on B.ID_TIPO_RUOLO = C.SYSTEM_ID,
      dpa_tipo_f_ruolo as fr INNER JOIN
      dpa_tipo_funzione as d
      on fr.ID_TIPO_FUNZ = d.system_id,
      people as e
      where  b.cha_tipo_ie = 'I'
      and  b.cha_tipo_urp = 'R'
      and b.system_id = fr.id_ruolo_in_uo
      and a.people_system_id = e.system_id
      AND @param1@
      AND @param2@
      ORDER BY @param3@
    </value>
  </query>
  <query>
    <name>S_J_DPA_CORR_GLOBALI__PEOPLEGROUPS__TIPO_RUOLO_COD_MICROFUNC</name>
    <value>
      SELECT
      A.PEOPLE_SYSTEM_ID,
      B.SYSTEM_ID,
      B.ID_GRUPPO,
      C.NUM_LIVELLO,
      C.VAR_CODICE,
      C.VAR_DESC_RUOLO,
      B.NUM_LIVELLO,
      B.ID_UO,
      B.VAR_COD_RUBRICA,
      B.ID_REGISTRO,
      B.ID_AMM ,
      B.VAR_DESC_CORR,
      A.CHA_PREFERITO,
      b.CHA_RIFERIMENTO,
      b.CHA_RESPONSABILE,
      b.CHA_SEGRETARIO
      from    peoplegroups as a INNER JOIN
      dpa_corr_globali as b  on a.GROUPS_SYSTEM_ID = b.ID_GRUPPO INNER JOIN
      DPA_TIPO_RUOLO as c on B.ID_TIPO_RUOLO = C.SYSTEM_ID,
      dpa_tipo_f_ruolo as fr INNER JOIN
      dpa_tipo_funzione as d on fr.ID_TIPO_FUNZ = d.system_id,
      dpa_funzioni as f,
      people as e
      where b.cha_tipo_ie = 'I'
      and b.cha_tipo_urp = 'R'
      AND f.COD_FUNZIONE = '@codMicrofunzione@'
      AND A.PEOPLE_SYSTEM_ID=@idPeople@
      AND b.system_id = fr.id_ruolo_in_uo
      AND d.system_id = f.id_tipo_funzione
      AND a.people_system_id = e.system_id
      AND d.ID_AMM = @idAmministrazione@
      ORDER BY @param3@
    </value>
  </query>
  <query>
    <name>S_J_GETIMPRONTA_W_ALL</name>
    <value>
      SELECT @dbuser@.getimprontawithallegati(P.DOCNUMBER) AS VAR_IMPRONTA
      FROM PROFILE as P
      WHERE P.DOCNUMBER=@param1@
    </value>
  </query>
  <query>
    <name>S_LOG_ATTIVI_BY_OGGETTO</name>
    <value>
      SELECT a.VAR_CODICE as CODICE, a.VAR_DESCRIZIONE as DESCRIZIONE, a.VAR_OGGETTO as OGGETTO, VAR_METODO as METODO, 1 as ATTIVO,
      b.NOTIFY AS NOTIFY,
      case when a.NOTIFICATION is null then '0' else a.NOTIFICATION end as NOTIFICATION,
      case when a.CONFIGURABLE is null then '0' else a.CONFIGURABLE end as CONFIGURABLE
      FROM DPA_ANAGRAFICA_LOG as a INNER JOIN DPA_LOG_ATTIVATI as b
      on a.system_id = b.system_id_anagrafica
      WHERE b.id_amm = @param1@
      AND (a.id_amm = @param1@ OR a.id_amm is null)
      AND a.VAR_CODICE not like 'AMM_%'
      AND VAR_OGGETTO = '@oggetto@'
      order by a.var_descrizione
    </value>
  </query>
  <query>
    <name>S_PROJECT_ID_FASCICOLO</name>
    SELECT ID_FASCICOLO
    FROM PROJECT
    WHERE SYSTEM_ID = @param1@
  </query>
  <query>
    <name>U_DPACorrGlobDescCorrAndCod</name>
    <value>
      UPDATE DPA_CORR_GLOBALI
      SET VAR_COD_RUBRICA = '@param1@',
      VAR_DESC_CORR = '@param1@'
      WHERE SYSTEM_ID = @param2@
    </value>
  </query>
  <query>
    <name>I_DELETED_SECURITY_2</name>
    <value>
      INSERT INTO DELETED_SECURITY
      (
      THING,
      PERSONORGROUP,
      ACCESSRIGHTS,
      ID_GRUPPO_TRASM,
      CHA_TIPO_DIRITTO,
      NOTE,
      DTA_REVOCA,
      ID_UTENTE_REV,
      ID_RUOLO_REV,
      HIDE_DOC_VERSIONS,
      CHA_COPIA_VISIBILITA
      ) VALUES (
      @param1@
      )
    </value>
  </query>
  <query>
    <name>I_Security_2</name>
    <value>
      INSERT INTO SECURITY
      (
      THING,
      PERSONORGROUP,
      ACCESSRIGHTS,
      ID_GRUPPO_TRASM,
      CHA_TIPO_DIRITTO,
      HIDE_DOC_VERSIONS,
      CHA_COPIA_VISIBILITA
      ) VALUES (
      @param1@
      )
    </value>
  </query>
  <query>
    <name>S_AMM_GET_UTENTE_BY_ID_PEOPLE</name>
    <value>
      SELECT
      a.system_id AS IDCORRGLOBALE,
      c.system_id AS IDPEOPLE,
      c.user_id AS USERID,
      a.var_nome AS NOME,
      a.var_cognome AS COGNOME,
      a.var_codice AS CODICE,
      a.var_cod_rubrica AS CODICERUBRICA,
      c.cha_amministratore AS AMMINISTRATORE,
      a.var_email AS EMAIL,
      c.from_email_address AS FROM_EMAIL,
      c.disabled AS ABILITATO,
      (SELECT b.network_id FROM NETWORK_ALIASES b WHERE b.personorgroup = c.system_id) AS DOMINIO,
      c.var_sede AS SEDE,
      c.cha_notifica AS NOTIFICA,
      c.cha_notifica_con_allegato AS ALLEGATO_NOTIFICA,
      a.id_amm AS IDAMMINISTRAZIONE,
      c.password_never_expire as NESSUNA_SCADENZA_PASSWORD,
      c.ldap_never_sync,
      c.ldap_id_sync,
      c.ldap_authenticated,
      c.ID_CLIENT_MODEL_PROCESSOR,
      c.IS_ENABLED_SMART_CLIENT,
      c.CHA_TIPO_COMPONENTI,
      c.smart_client_pdf_conv_on_scan,
      c.ID_DISPOSITIVO_STAMPA,
      c.ABILITATO_CENTRO_SERVIZI,
      c.matricola,
      c.ABILITATO_CHIAVI_CONFIG,
      c.ABILITATO_ESIBIZIONE
      FROM
      DPA_CORR_GLOBALI as a INNER JOIN PEOPLE as c
      on a.id_people = c.system_id and a.id_amm = c.id_amm
      WHERE a.cha_tipo_urp = 'P'
      AND a.cha_tipo_ie = 'I'
      AND c.system_id = @param1@
      AND c.cha_system_user != '1'
      order by a.var_cognome asc, a.var_nome asc
    </value>
  </query>
  <query>
    <name>U_DOC_ARRIVO_MITTENTE_OCCASIONALE_INTEROP</name>
    update
    dpa_doc_arrivo_par
    set id_mitt_dest=@param1@
    WHERE id_profile =@param2@
  </query>
  <query>
    <name>S_RICERCA_RUBRICA_MOBILE_ADD_UTENTE</name>
    <value>
      --arrivato qui
      SELECT distinct
      cg_utenti.var_desc_corr AS VAR_DESC_CORR,
      cg_uo.system_id AS ID_UO,
      cg_ruoli.SYSTEM_ID AS ID_RUOLO,
      cg_utenti.CHA_TIPO_URP,
      cg_utenti.ID_PEOPLE
      FROM dpa_corr_globali as cg_utenti INNER JOIN
      people as p on cg_utenti.id_people = p.system_id INNER JOIN
      peoplegroups as pg on p.system_id = pg.people_system_id INNER JOIN
      GROUPS as g on g.system_id = pg.groups_system_id INNER JOIN
      dpa_corr_globali as cg_ruoli on cg_ruoli.id_gruppo = g.system_id INNER JOIN
      dpa_corr_globali as cg_uo on cg_uo.system_id = cg_ruoli.id_uo
      WHERE  cg_utenti.var_desc_corr LIKE '%@param2@%'
      and cg_ruoli.DTA_FINE is null
      AND cg_utenti.cha_tipo_urp = 'P'
      AND cg_utenti.DTA_FINE is null
      and cg_uo.DTA_FINE is null
      AND cg_utenti.ID_AMM =  @param1@
      AND cg_utenti.CHA_TIPO_IE ='I'
      AND cg_utenti.VAR_COD_RUBRICA !=  '@param5@'
      and docsadm.iscorrispondenteinterno(cg_utenti.system_id, @param3@) &gt; 0
    </value>
  </query>
  <query>
    <name>S_RICERCA_RUBRICA_MOBILE_ADD_RUOLO</name>
    <value>
      SELECT
      cg_ruoli.VAR_DESC_CORR AS VAR_DESC_CORR,
      cg_uo.system_id AS ID_UO,
      cg_ruoli.SYSTEM_ID as ID_RUOLO,
      cg_ruoli.CHA_TIPO_URP,0
      FROM GROUPS as g INNER JOIN
      dpa_corr_globali as cg_ruoli on cg_ruoli.id_gruppo = g.system_id INNER JOIN
      dpa_corr_globali as cg_uo on cg_uo.system_id = cg_ruoli.id_uo
      WHERE cg_ruoli.var_desc_corr LIKE '%@param2@%'
      AND cg_ruoli.cha_tipo_urp = 'R'
      and cg_ruoli.DTA_FINE is null
      and cg_uo.DTA_FINE is null
      AND cg_ruoli.ID_AMM =  @param1@
      AND cg_ruoli.CHA_TIPO_IE ='I'
      and docsadm.iscorrispondenteinterno(cg_ruoli.SYSTEM_ID, @param3@) &gt; 0
    </value>
  </query>
  <query>
    <name>S_RICERCA_RUBRICA_MOBILE_UTENTI_RUOLO</name>
    <value>
      SELECT distinct
      cg_utenti.var_desc_corr AS VAR_DESC_CORR,
      cg_uo.system_id AS ID_UO,
      cg_ruoli.SYSTEM_ID AS ID_RUOLO,
      'R' AS CHA_TIPO_URP,
      cg_utenti.ID_PEOPLE
      FROM dpa_corr_globali as cg_utenti INNER JOIN
      people as p on cg_utenti.id_people = p.system_id INNER JOIN
      peoplegroups as pg on p.system_id = pg.people_system_id INNER JOIN
      GROUPS as g on g.system_id = pg.groups_system_id INNER JOIN
      dpa_corr_globali as cg_ruoli on cg_ruoli.id_gruppo = g.system_id INNER JOIN
      dpa_corr_globali as cg_uo on cg_uo.system_id = cg_ruoli.id_uo
      WHERE  cg_ruoli.system_id = @param2@
      and cg_ruoli.DTA_FINE is null
      AND cg_utenti.cha_tipo_urp = 'P'
      AND cg_utenti.DTA_FINE is null
      and cg_uo.DTA_FINE is null
      AND cg_utenti.ID_AMM =  @param1@
      AND cg_utenti.CHA_TIPO_IE ='I'
      AND cg_utenti.VAR_COD_RUBRICA !=  '@param5@'
      and docsadm.iscorrispondenteinterno(cg_utenti.system_id, @param3@) &gt; 0
    </value>
  </query>
  <query>
    <name>S_GET_UO_IN_AOO_2</name>
    <value>
      select dpa_corr_globali.var_cod_rubrica as CODICE,
      dpa_corr_globali.system_id as IDCORRGLOBALE,
      dpa_corr_globali.var_desc_corr as DESCRIZIONE
      from dpa_corr_globali INNER JOIN
      dpa_uo_reg on dpa_uo_reg.id_uo = dpa_corr_globali.system_id
      where  dpa_uo_reg.id_registro IN (@id_reg@)
      order by var_cod_rubrica, var_desc_corr asc
    </value>
  </query>
  <query>
    <name>UPDATE_MODELLI_TRASMISSIONE_BY_RAGIONE</name>
    <value>
      UPDATE DPA_MODELLI_TRASM
      SET
      CHA_MANTIENI_LETTURA = @paramMantieniLettura@,
      CHA_MANTIENI_SCRITTURA = @paramMantieniScrittura@
      WHERE SYSTEM_ID IN (SELECT mmd.ID_MODELLO FROM DPA_MODELLI_MITT_DEST mmd WHERE mmd.ID_RAGIONE = @paramIdRagione@)
      AND ID_AMM=@paramIdAmm@
    </value>
  </query>
  <query>
    <name>S_AMM_LOGIN_PGU</name>
    <value>
      SELECT  p.system_id AS ID,
      p.cha_amministratore AS TIPO,
      p.var_nome AS NOME,
      p.var_cognome AS COGNOME,
      p.id_amm AS IDAMM,
      cg.system_id AS ID_CORR_GLOBALI
      FROM    PEOPLE as p LEFT OUTER JOIN
      DPA_CORR_GLOBALI cg on p.system_id = cg.id_people
      WHERE   p.user_id = '@userId@'
      and p.id_amm = @paramIdAmm@
      AND cha_amministratore in ('0','1','2','3')
    </value>
  </query>
  <query>
    <name>S_PIANI_RIENTRO_ISTRUTTORIA</name>
    <value>
      select o.project_id, o.system_id, o.oggetto, o.num_proto,
      o.dta_proto, o.dta_annulla, o.aut_annulla, o.description, o.dta_scadenza, o.atto, o.segn, o.tipo_proto,  o.parent
      from (
      select pf.project_id as project_id, d.system_id as system_id, d.var_prof_oggetto as oggetto, d.num_proto as num_proto,
      d.dta_proto as dta_proto, d.dta_annulla as dta_annulla, d.var_aut_annulla as aut_annulla, f.description as description, f.dta_uo_lf as dta_scadenza, a.var_desc_atto as atto, d.var_segnatura as segn, d.cha_tipo_proto as tipo_proto, d.id_parent as parent
      from project as c INNER JOIN
      project_components as pf on c.system_id = pf.project_id INNER JOIN
      project as f on f.system_id = c.id_parent,
      profile as d INNER JOIN
      dpa_tipo_atto as a on d.id_tipo_atto = a.system_id
      where d.id_registro = @param1@
      and d.cha_tipo_proto = 'A'
      and dta_annulla is null
      and f.cha_tipo_proj = 'F'
      and f.cha_tipo_fascicolo = 'P'
      and c.cha_tipo_proj = 'C'
      and pf.project_id not in (select system_id from project where var_codice = 'PFP' and id_registro =@param1@)
      and f.dta_uo_lf between cast('@param2@' AS DATETIME) and cast('@param3@' AS DATETIME)
      and dta_proto between cast('@param2@' AS DATETIME) and cast('@param3@' AS DATETIME)
      and f.system_id not in
      (
      select t.id_project
      from dpa_trasmissione as t INNER JOIN
      dpa_trasm_singola as b on t.system_id = b.id_trasmissione INNER JOIN
      dpa_ragione_trasm as c on b.id_ragione = c.system_id
      where t.cha_tipo_oggetto = 'F'
      and  c.var_Desc_ragione in ('CONCERTO_TECNICO','COMPETENZA_TECNICA')
      )
      union
      select pf.project_id as project_id, d.system_id as system_id, d.var_prof_oggetto as oggetto, d.num_proto as num_proto,
      d.dta_proto as dta_proto, d.dta_annulla as dta_annulla, d.var_aut_annulla as aut_annulla, f.description as description, f.dta_uo_lf as dta_scadenza, a.var_desc_atto as atto, d.var_segnatura as segn, d.cha_tipo_proto as tipo_proto, d.id_parent as parent
      from profile as d INNER JOIN
      project_components as pf on d.system_id = pf.link INNER JOIN
      project as c on c.system_id = pf.project_id INNER JOIN
      project as f on f.system_id = c.id_parent INNER JOIN
      dpa_tipo_atto as a on d.id_tipo_atto = a.system_id
      where d.id_registro = @param1@
      and d.cha_tipo_proto = 'A'
      and dta_annulla is null
      and f.cha_tipo_proj = 'F'
      and f.cha_tipo_fascicolo = 'P'
      and c.cha_tipo_proj = 'C'
      and pf.project_id not in (select system_id from project where var_codice = 'PFP' and id_registro =@param1@)
      and f.dta_uo_lf between cast('@param2@' AS DATETIME) and cast('@param3@' AS DATETIME)
      and d.dta_proto between cast('@param2@' AS DATETIME) and cast('@param3@' AS DATETIME)
      and d.dta_proto &gt;
      (
      select distinct tf.dta_invio from dpa_v_txfasc tf
      where
      tf.dta_invio between cast('@param2@' AS DATETIME) and cast('@param3@' AS DATETIME) --coincide con il periodo del report
      and  tf.ragione in ('CONCERTO_TECNICO','COMPETENZA_TECNICA') and f.system_id=tf.id_fasc
      )
      ) as o
      order by o.project_id asc
    </value>
  </query>
  <query>
    <name>S_PIANI_RIENTRO_TRASMESSI_MEF</name>
    <value>
      WITH GERARCHIA_UO AS
      (
      SELECT CG.SYSTEM_ID, CG.ID_PARENT, CG.VAR_CODICE
      FROM DPA_CORR_GLOBALI CG
      WHERE CG.CHA_TIPO_URP = 'R'
      AND CG.cha_tipo_ie = 'I'
      AND var_cod_rubrica = 'IGSS'
      UNION ALL
      SELECT CG.SYSTEM_ID, CG.ID_PARENT, CG.VAR_CODICE
      FROM DPA_CORR_GLOBALI CG INNER JOIN GERARCHIA_UO G ON G.SYSTEM_ID = CG.ID_PARENT
      AND CG.CHA_TIPO_URP = 'R' AND CG.cha_tipo_ie = 'I' AND var_cod_rubrica = 'IGSS'
      )
      SELECT pf.project_id AS project_id, d.system_id AS system_id,
      d.var_prof_oggetto AS oggetto, d.num_proto AS num_proto,
      d.dta_proto AS dta_proto, d.dta_annulla AS dta_annulla,
      d.var_aut_annulla AS aut_annulla, f.description AS description,
      f.dta_uo_lf AS dta_scadenza, a.var_desc_atto AS atto,
      d.var_segnatura AS segn, d.cha_tipo_proto AS tipo_proto,
      d.id_parent AS PARENT
      FROM PROFILE as d INNER JOIN
      project_components as pf on d.system_id = pf.LINK INNER JOIN
      project as c on c.system_id = pf.project_id INNER JOIN
      project as f on f.system_id = c.id_parent,
      dpa_tipo_atto a
      WHERE d.id_registro = @param1@
      AND d.id_tipo_atto = a.system_id
      AND d.cha_tipo_proto = 'A'
      AND dta_annulla IS NULL
      AND f.cha_tipo_proj = 'F'
      AND f.cha_tipo_fascicolo = 'P'
      AND c.cha_tipo_proj = 'C'
      AND pf.project_id NOT IN (
      SELECT system_id
      FROM project
      WHERE var_codice = 'PFP'
      AND id_registro = @param1@)
      AND f.dta_uo_lf BETWEEN cast ('@param2@' AS DATETIME) AND cast ('@param3@' AS DATETIME)
      AND dta_proto BETWEEN cast ('@param2@' AS DATETIME) AND cast ('@param3@' AS DATETIME)
      AND f.system_id IN (select u.system_id
      from GERARCHIA_UO u)
      AND dta_proto @param4@
      (SELECT MAX (dta_invio)
      FROM dpa_v_txfasc tf
      WHERE dta_invio BETWEEN cast ('@param2@' AS DATETIME) AND cast ('@param3@' AS DATETIME)
      and ragione in ('CONCERTO_TECNICO','COMPETENZA_TECNICA')
      AND tf.id_corr_glob IN (select u.system_id
      from GERARCHIA_UO u))
    </value>
  </query>
  <query>
    <name>S_PIANI_RIENTRO_RICEVUTI_MEF</name>
    <value>
      WITH GERARCHIA_UO AS
      (
      SELECT CG.SYSTEM_ID, CG.ID_PARENT, CG.VAR_CODICE
      FROM DPA_CORR_GLOBALI CG
      WHERE CG.CHA_TIPO_URP = 'R'
      AND CG.cha_tipo_ie = 'I'
      AND var_cod_rubrica = 'DGPROG'
      UNION ALL
      SELECT CG.SYSTEM_ID, CG.ID_PARENT, CG.VAR_CODICE
      FROM DPA_CORR_GLOBALI CG INNER JOIN GERARCHIA_UO G ON G.SYSTEM_ID = CG.ID_PARENT
      AND CG.CHA_TIPO_URP = 'R' AND CG.cha_tipo_ie = 'I' AND var_cod_rubrica = 'DGPROG'
      )
      SELECT pf.project_id AS project_id, d.system_id AS system_id,
      d.var_prof_oggetto AS oggetto, d.num_proto AS num_proto,
      d.dta_proto AS dta_proto, d.dta_annulla AS dta_annulla,
      d.var_aut_annulla AS aut_annulla, f.description AS description,
      f.dta_uo_lf AS dta_scadenza, a.var_desc_atto AS atto,
      d.var_segnatura AS segn, d.cha_tipo_proto AS tipo_proto,
      d.id_parent AS PARENT
      FROM PROFILE as d INNER JOIN
      project_components as pf on d.system_id = pf.LINK INNER JOIN
      project as c on c.system_id = pf.project_id INNER JOIN
      project as f on f.system_id = c.id_parent,
      dpa_tipo_atto a
      WHERE d.id_registro = @param1@
      AND d.id_tipo_atto = a.system_id
      AND d.cha_tipo_proto = 'A'
      AND dta_annulla IS NULL
      AND f.cha_tipo_proj = 'F'
      AND f.cha_tipo_fascicolo = 'P'
      AND c.cha_tipo_proj = 'C'
      AND pf.project_id NOT IN (
      SELECT system_id
      FROM project
      WHERE var_codice = 'PFP'
      AND id_registro = @param1@)
      AND f.dta_uo_lf BETWEEN cast ('@param2@' as datetime) AND cast ('@param3@' as datetime)
      AND dta_proto BETWEEN cast ('@param2@' as datetime) AND cast ('@param3@' as datetime)
      AND f.system_id IN (
      SELECT t.id_project
      FROM dpa_trasmissione as t INNER JOIN
      dpa_trasm_singola as b on t.system_id = b.id_trasmissione INNER JOIN
      dpa_ragione_trasm c on b.id_ragione = c.system_id
      WHERE b.cha_tipo_dest = 'R'
      AND b.id_corr_globale IN (select u.system_id
      from GERARCHIA_UO u)
      AND t.id_project IS NOT NULL
      AND c.var_desc_ragione IN ('CONCERTO_TECNICO', 'COMPETENZA_TECNICA'))
      AND d.dta_proto @param4@
      (SELECT MAX (t.dta_invio)
      FROM dpa_trasmissione as t INNER JOIN
      dpa_trasm_singola as b on t.system_id = b.id_trasmissione INNER JOIN
      dpa_ragione_trasm as c on b.id_ragione = c.system_id
      WHERE t.dta_invio BETWEEN cast ('@param2@' as datetime) AND cast ('@param3@' as datetime)
      AND b.cha_tipo_dest = 'R'
      AND b.id_corr_globale IN (select u.system_id
      from GERARCHIA_UO u)
      AND c.var_desc_ragione IN
      ('CONCERTO_TECNICO', 'COMPETENZA_TECNICA')
      AND t.id_project = f.system_id)
    </value>
  </query>
  <query>
    <name>S_PIANI_RIENTRO_TRASMESSI_REGIONE</name>
    <value>
      SELECT   pf.project_id AS project_id, d.system_id AS system_id,
      d.var_prof_oggetto AS oggetto, d.num_proto AS num_proto,
      d.dta_proto AS dta_proto, d.dta_annulla AS dta_annulla,
      d.var_aut_annulla AS aut_annulla, f.description AS description,
      f.dta_uo_lf AS dta_scadenza, a.var_desc_atto AS atto,
      d.var_segnatura AS segn, d.cha_tipo_proto AS tipo_proto,
      doc.num_proto AS PARENT, doc.dta_proto AS parent_dta_proto,
      dpa_valore_oggetto_tipo_atto (d.id_tipo_atto, d.docnumber) AS stato
      FROM PROFILE as d INNER JOIN
      project_components as pf on d.system_id = pf.LINK INNER JOIN
      project as c on c.system_id = pf.project_id INNER JOIN
      project as f on f.system_id = c.id_parent,
      dpa_tipo_atto as a,
      PROFILE as doc
      WHERE d.id_registro = @param1@
      AND d.id_parent = doc.system_id
      AND d.id_tipo_atto = a.system_id
      AND d.cha_tipo_proto = 'P'
      AND d.dta_annulla IS NULL
      AND f.cha_tipo_proj = 'F'
      AND f.cha_tipo_fascicolo = 'P'
      AND c.cha_tipo_proj = 'C'
      AND pf.project_id NOT IN (
      SELECT system_id
      FROM project
      WHERE var_codice = 'PFP'
      AND id_registro = @param1@)
      AND ISNULL(d.id_parent, 0) &gt; 0
      AND f.dta_uo_lf BETWEEN cast ('@param2@' as datetime) AND cast ('@param3@' as datetime)
      AND d.dta_proto BETWEEN cast ('@param2@' as datetime) AND cast ('@param3@' as datetime)
      ORDER BY d.num_proto ASC
    </value>
  </query>
  <query>
    <name>S_PIANI_RIENTRO_ISTRUTTORIA_SC</name>
    <value>
      select x.project_id, x.system_id, x.oggetto, x.num_proto,
      x.dta_proto, x.dta_annulla, x.aut_annulla, x.description, x.dta_scadenza,
      x.atto, x.segn, x.tipo_proto,  x.parent
      from (
      select pf.project_id as project_id, d.system_id as system_id, d.var_prof_oggetto as oggetto, d.num_proto as num_proto,
      d.dta_proto as dta_proto, d.dta_annulla as dta_annulla, d.var_aut_annulla as aut_annulla, f.description as description, f.dta_uo_lf as dta_scadenza, a.var_desc_atto as atto, d.var_segnatura as segn, d.cha_tipo_proto as tipo_proto, d.id_parent as parent
      from profile as d INNER JOIN
      project_components as pf on d.system_id = pf.link INNER JOIN
      project as c on c.system_id = pf.project_id INNER JOIN
      project as f on f.system_id = c.id_parent,
      dpa_tipo_atto as a
      where d.id_registro = @param1@
      and d.id_tipo_atto = a.system_id
      and d.cha_tipo_proto = 'A'
      and dta_annulla is null
      and f.cha_tipo_proj = 'F'
      and f.cha_tipo_fascicolo = 'P'
      and c.cha_tipo_proj = 'C'
      and pf.project_id not in (select system_id from project where var_codice = 'PFP' and id_registro =@param1@)
      and f.dta_uo_lf is null
      and dta_proto between cast('@param2@' as datetime) and cast('@param3@' as datetime)
      and f.system_id not in
      (
      select t.id_project
      from dpa_trasmissione as t INNER JOIN
      dpa_trasm_singola as b on t.system_id = b.id_trasmissione INNER JOIN
      dpa_ragione_trasm as c on b.id_ragione=c.system_id
      where t.cha_tipo_oggetto = 'F'
      and  c.var_Desc_ragione in ('CONCERTO_TECNICO','COMPETENZA_TECNICA')
      )
      union
      select pf.project_id as project_id, d.system_id as system_id, d.var_prof_oggetto as oggetto, d.num_proto as num_proto,
      d.dta_proto as dta_proto, d.dta_annulla as dta_annulla, d.var_aut_annulla as aut_annulla, f.description as description, f.dta_uo_lf as dta_scadenza, a.var_desc_atto as atto, d.var_segnatura as segn, d.cha_tipo_proto as tipo_proto, d.id_parent as parent
      from 	profile as d INNER JOIN
      project_components as pf on d.system_id = pf.link INNER JOIN
      project as c on c.system_id = pf.project_id INNER JOIN
      project as f on f.system_id = c.id_parent ,
      dpa_tipo_atto as a
      where d.id_registro = @param1@
      and d.id_tipo_atto = a.system_id
      and d.cha_tipo_proto = 'A'
      and dta_annulla is null
      and f.cha_tipo_proj = 'F'
      and f.cha_tipo_fascicolo = 'P'
      and c.cha_tipo_proj = 'C'
      and pf.project_id not in (select system_id from project where var_codice = 'PFP' and id_registro =@param1@)
      and f.dta_uo_lf is null
      and d.dta_proto between cast('@param2@' as datetime) and cast('@param3@' as datetime)
      and d.dta_proto &gt;
      (
      select distinct tf.dta_invio
      from dpa_v_txfasc tf
      where  tf.dta_invio between cast('@param2@' as datetime) and cast('@param3@' as datetime) --coincide con il periodo del report
      and  tf.ragione in ('CONCERTO_TECNICO','COMPETENZA_TECNICA')
      and f.system_id = tf.id_fasc
      )
      ) as x
      order by x.project_id asc
    </value>
  </query>
  <query>
    <name>S_PIANI_RIENTRO_TRASMESSI_MEF_SC</name>
    <value>
      WITH GERARCHIA_UO AS
      (
      SELECT CG.SYSTEM_ID, CG.ID_PARENT, CG.VAR_CODICE
      FROM DPA_CORR_GLOBALI CG
      WHERE CG.CHA_TIPO_URP = 'R'
      AND CG.cha_tipo_ie = 'I'
      AND var_cod_rubrica = 'IGSS'
      UNION ALL
      SELECT CG.SYSTEM_ID, CG.ID_PARENT, CG.VAR_CODICE
      FROM DPA_CORR_GLOBALI CG INNER JOIN GERARCHIA_UO G ON G.SYSTEM_ID = CG.ID_PARENT
      AND CG.CHA_TIPO_URP = 'R' AND CG.cha_tipo_ie = 'I' AND var_cod_rubrica = 'IGSS'
      )
      SELECT pf.project_id AS project_id, d.system_id AS system_id,
      d.var_prof_oggetto AS oggetto, d.num_proto AS num_proto,
      d.dta_proto AS dta_proto, d.dta_annulla AS dta_annulla,
      d.var_aut_annulla AS aut_annulla, f.description AS description,
      f.dta_uo_lf AS dta_scadenza, a.var_desc_atto AS atto,
      d.var_segnatura AS segn, d.cha_tipo_proto AS tipo_proto,
      d.id_parent AS PARENT
      FROM 	PROFILE as d INNER JOIN
      project_components as pf on d.system_id = pf.LINK INNER JOIN
      project as c on c.system_id = pf.project_id INNER JOIN
      project as f on f.system_id = c.id_parent,
      dpa_tipo_atto as a
      WHERE d.id_registro = @param1@
      AND d.id_tipo_atto = a.system_id
      AND d.cha_tipo_proto = 'A'
      AND dta_annulla IS NULL
      AND f.cha_tipo_proj = 'F'
      AND f.cha_tipo_fascicolo = 'P'
      AND c.cha_tipo_proj = 'C'
      AND pf.project_id NOT IN (
      SELECT system_id
      FROM project
      WHERE var_codice = 'PFP'
      AND id_registro = @param1@)
      AND f.dta_uo_lf is null
      AND dta_proto BETWEEN cast ('@param2@' as datetime) AND cast ('@param3@' as datetime)
      AND f.system_id IN (
      SELECT id_fasc
      FROM dpa_v_txfasc tf
      WHERE dta_invio BETWEEN cast ('@param2@' as datetime) AND cast ('@param3@' as datetime)
      and ragione in ('CONCERTO_TECNICO','COMPETENZA_TECNICA')
      AND tf.id_corr_glob IN (select u.system_id
      from GERARCHIA_UO u))
      AND dta_proto @param4@
      (SELECT MAX (dta_invio)
      FROM dpa_v_txfasc tf
      WHERE dta_invio BETWEEN cast ('@param2@' as datetime) AND cast ('@param3@' as datetime)
      and ragione in ('CONCERTO_TECNICO','COMPETENZA_TECNICA')
      AND tf.id_corr_glob IN (select u.system_id
      from GERARCHIA_UO u))
    </value>
  </query>
  <query>
    <name>S_PIANI_RIENTRO_RICEVUTI_MEF_SC</name>
    <value>
      WITH GERARCHIA_UO AS
      (
      SELECT CG.SYSTEM_ID, CG.ID_PARENT, CG.VAR_CODICE
      FROM DPA_CORR_GLOBALI CG
      WHERE CG.CHA_TIPO_URP = 'R'
      AND CG.cha_tipo_ie = 'I'
      AND var_cod_rubrica = 'DGPROG'
      UNION ALL
      SELECT CG.SYSTEM_ID, CG.ID_PARENT, CG.VAR_CODICE
      FROM DPA_CORR_GLOBALI CG INNER JOIN GERARCHIA_UO G ON G.SYSTEM_ID = CG.ID_PARENT
      AND CG.CHA_TIPO_URP = 'R' AND CG.cha_tipo_ie = 'I' AND var_cod_rubrica = 'DGPROG'
      )
      SELECT pf.project_id AS project_id, d.system_id AS system_id,
      d.var_prof_oggetto AS oggetto, d.num_proto AS num_proto,
      d.dta_proto AS dta_proto, d.dta_annulla AS dta_annulla,
      d.var_aut_annulla AS aut_annulla, f.description AS description,
      f.dta_uo_lf AS dta_scadenza, a.var_desc_atto AS atto,
      d.var_segnatura AS segn, d.cha_tipo_proto AS tipo_proto,
      d.id_parent AS PARENT
      FROM 	PROFILE as d INNER JOIN
      project_components as pf on d.system_id = pf.LINK INNER JOIN
      project as c on c.system_id = pf.project_id INNER JOIN
      project as f on f.system_id = c.id_parent,
      dpa_tipo_atto as a
      WHERE d.id_registro = @param1@
      AND d.id_tipo_atto = a.system_id
      AND d.cha_tipo_proto = 'A'
      AND dta_annulla IS NULL
      AND f.cha_tipo_proj = 'F'
      AND f.cha_tipo_fascicolo = 'P'
      AND c.cha_tipo_proj = 'C'
      AND pf.project_id NOT IN (
      SELECT system_id
      FROM project
      WHERE var_codice = 'PFP'
      AND id_registro = @param1@)
      AND f.dta_uo_lf is null
      AND dta_proto BETWEEN cast ('@param2@' as datetime) AND cast ('@param3@' as datetime)
      AND f.system_id IN (
      SELECT t.id_project
      FROM dpa_trasmissione as t INNER JOIN
      dpa_trasm_singola as b on t.system_id = b.id_trasmissione INNER JOIN
      dpa_ragione_trasm c on b.id_ragione = c.system_id
      WHERE b.cha_tipo_dest = 'R'
      --and t.dta_invio between to_date('@param2@','dd/mm/yyyy') and to_date('@param3@','dd/mm/yyyy') --coincide con il periodo del report
      AND b.id_corr_globale IN (select u.system_id
      from GERARCHIA_UO u)
      AND t.id_project IS NOT NULL
      AND c.var_desc_ragione IN
      ('CONCERTO_TECNICO', 'COMPETENZA_TECNICA'))
      AND d.dta_proto @param4@
      (SELECT MAX (t.dta_invio)
      FROM 	dpa_trasmissione as t INNER JOIN
      dpa_trasm_singola as b on t.system_id = b.id_trasmissione INNER JOIN
      dpa_ragione_trasm as c on b.id_ragione = c.system_id
      WHERE t.dta_invio BETWEEN cast ('@param2@' as datetime)
      AND cast ('@param3@' as datetime)
      AND b.cha_tipo_dest = 'R'
      AND b.id_corr_globale IN (select u.system_id
      from GERARCHIA_UO u)
      AND c.var_desc_ragione IN
      ('CONCERTO_TECNICO', 'COMPETENZA_TECNICA')
      AND t.id_project = f.system_id)
    </value>
  </query>
  <query>
    <name>S_PIANI_RIENTRO_TRASMESSI_REGIONE_SC</name>
    <value>
      -- tutti i documenti trasmessi alla regione
      SELECT   pf.project_id AS project_id, d.system_id AS system_id,
      d.var_prof_oggetto AS oggetto, d.num_proto AS num_proto,
      d.dta_proto AS dta_proto, d.dta_annulla AS dta_annulla,
      d.var_aut_annulla AS aut_annulla, f.description AS description,
      f.dta_uo_lf AS dta_scadenza, a.var_desc_atto AS atto,
      d.var_segnatura AS segn, d.cha_tipo_proto AS tipo_proto,
      doc.num_proto AS PARENT, doc.dta_proto AS parent_dta_proto,
      dpa_valore_oggetto_tipo_atto (d.id_tipo_atto, d.docnumber) AS stato
      FROM 	PROFILE as d INNER JOIN
      project_components as pf on d.system_id = pf.LINK INNER JOIN
      project as c on c.system_id = pf.project_id INNER JOIN
      project as f on f.system_id = c.id_parent,
      PROFILE as doc,
      dpa_tipo_atto a
      WHERE d.id_registro = @param1@
      AND d.id_tipo_atto = a.system_id
      AND d.id_parent = doc.system_id
      AND d.cha_tipo_proto = 'P'
      AND d.dta_annulla IS NULL
      AND f.cha_tipo_proj = 'F'
      AND f.cha_tipo_fascicolo = 'P'
      AND c.cha_tipo_proj = 'C'
      AND pf.project_id NOT IN (
      SELECT system_id
      FROM project
      WHERE var_codice = 'PFP'
      AND id_registro = @param1@)
      AND ISNULL (d.id_parent, 0) &gt; 0
      AND f.dta_uo_lf is null
      AND d.dta_proto BETWEEN cast ('@param2@' as datetime)
      AND cast ('@param3@' as datetime)
      ORDER BY d.num_proto ASC
    </value>
  </query>
  <query>
    <name>S_PIANI_RIENTRO_ISTRUTTORIA_FP</name>
    <value>
      select x.project_id, x.system_id, x.oggetto, x.num_proto,
      x.dta_proto, x.dta_annulla, x.aut_annulla, x.description,
      x.dta_scadenza, x.atto, x.segn, x.tipo_proto,  x.parent
      from (
      select pf.project_id as project_id, d.system_id as system_id, d.var_prof_oggetto as oggetto, d.num_proto as num_proto,
      d.dta_proto as dta_proto, d.dta_annulla as dta_annulla, d.var_aut_annulla as aut_annulla, f.description as description, f.dta_uo_lf as dta_scadenza, a.var_desc_atto as atto, d.var_segnatura as segn, d.cha_tipo_proto as tipo_proto, d.id_parent as parent
      from 	profile as d INNER JOIN
      project_components as pf on d.system_id = pf.link INNER JOIN
      project as c on c.system_id = pf.project_id INNER JOIN
      project as f on f.system_id = c.id_parent,
      dpa_tipo_atto a
      where d.id_registro = @param1@
      and d.id_tipo_atto = a.system_id
      and d.cha_tipo_proto = 'A'
      and dta_annulla is null
      and f.cha_tipo_proj = 'F'
      and f.cha_tipo_fascicolo = 'P'
      and c.cha_tipo_proj = 'C'
      and pf.project_id in (select system_id from project where var_codice = 'PFP' and id_registro =@param1@)
      and dta_proto between cast('@param2@' as datetime) and cast('@param3@' as datetime)
      and f.system_id not in
      (
      select t.id_project
      from 	dpa_trasmissione as t INNER JOIN
      dpa_trasm_singola as b on t.system_id = b.id_trasmissione INNER JOIN
      dpa_ragione_trasm as c on b.id_ragione = c.system_id
      where t.cha_tipo_oggetto = 'F'
      and  c.var_Desc_ragione in ('CONCERTO_TECNICO','COMPETENZA_TECNICA')
      )
      union
      select pf.project_id as project_id, d.system_id as system_id, d.var_prof_oggetto as oggetto, d.num_proto as num_proto,
      d.dta_proto as dta_proto, d.dta_annulla as dta_annulla, d.var_aut_annulla as aut_annulla, f.description as description, f.dta_uo_lf as dta_scadenza, a.var_desc_atto as atto, d.var_segnatura as segn, d.cha_tipo_proto as tipo_proto, d.id_parent as parent
      from 	profile as d INNER JOIN
      project_components as pf on d.system_id = pf.link INNER JOIN
      project as c on c.system_id = pf.project_id INNER JOIN
      project as f on f.system_id = c.id_parent,
      dpa_tipo_atto a
      where d.id_registro = @param1@
      and d.id_tipo_atto = a.system_id
      and d.cha_tipo_proto = 'A'
      and dta_annulla is null
      and f.cha_tipo_proj = 'F'
      and f.cha_tipo_fascicolo = 'P'
      and c.cha_tipo_proj = 'C'
      and pf.project_id in (select system_id from project where var_codice = 'PFP' and id_registro =@param1@)
      and d.dta_proto between cast('@param2@' as datetime) and cast('@param3@' as datetime)
      and d.dta_proto &gt;
      (
      select distinct tf.dta_invio from dpa_v_txfasc tf
      where
      tf.dta_invio between cast('@param2@' as datetime) and cast('@param3@' as datetime) --coincide con il periodo del report
      and  tf.ragione in ('CONCERTO_TECNICO','COMPETENZA_TECNICA')
      and f.system_id = tf.id_fasc
      )
      ) as x
      order by x.project_id asc
    </value>
  </query>
  <query>
    <name>S_PIANI_RIENTRO_TRASMESSI_MEF_FP</name>
    <value>
      WITH GERARCHIA_UO AS
      (
      SELECT CG.SYSTEM_ID, CG.ID_PARENT, CG.VAR_CODICE
      FROM DPA_CORR_GLOBALI CG
      WHERE CG.CHA_TIPO_URP = 'R'
      AND CG.cha_tipo_ie = 'I'
      AND var_cod_rubrica = 'IGSS'
      UNION ALL
      SELECT CG.SYSTEM_ID, CG.ID_PARENT, CG.VAR_CODICE
      FROM DPA_CORR_GLOBALI CG INNER JOIN GERARCHIA_UO G ON G.SYSTEM_ID = CG.ID_PARENT
      AND CG.CHA_TIPO_URP = 'R' AND CG.cha_tipo_ie = 'I' AND var_cod_rubrica = 'IGSS'
      )
      SELECT pf.project_id AS project_id, d.system_id AS system_id,
      d.var_prof_oggetto AS oggetto, d.num_proto AS num_proto,
      d.dta_proto AS dta_proto, d.dta_annulla AS dta_annulla,
      d.var_aut_annulla AS aut_annulla, f.description AS description,
      f.dta_uo_lf AS dta_scadenza, a.var_desc_atto AS atto,
      d.var_segnatura AS segn, d.cha_tipo_proto AS tipo_proto,
      d.id_parent AS PARENT
      FROM 	PROFILE as d INNER JOIN
      project_components as pf on d.system_id = pf.LINK INNER JOIN
      project as c on c.system_id = pf.project_id INNER JOIN
      project as f on f.system_id = c.id_parent,
      dpa_tipo_atto a
      WHERE d.id_registro = @param1@
      AND d.id_tipo_atto = a.system_id
      AND d.cha_tipo_proto = 'A'
      AND dta_annulla IS NULL
      AND f.cha_tipo_proj = 'F'
      AND f.cha_tipo_fascicolo = 'P'
      AND c.cha_tipo_proj = 'C'
      AND pf.project_id IN (
      SELECT system_id
      FROM project
      WHERE var_codice = 'PFP'
      AND id_registro = @param1@)
      AND dta_proto BETWEEN cast ('@param2@' as datetime)
      AND cast ('@param3@' as datetime)
      AND f.system_id IN (
      SELECT id_fasc
      FROM dpa_v_txfasc tf
      WHERE dta_invio BETWEEN cast ('@param2@' as datetime)
      AND cast ('@param3@' as datetime)
      and ragione in ('CONCERTO_TECNICO','COMPETENZA_TECNICA')
      AND tf.id_corr_glob IN (select u.system_id
      from GERARCHIA_UO u))
      AND dta_proto @param4@
      (SELECT MAX (dta_invio)
      FROM dpa_v_txfasc tf
      WHERE dta_invio BETWEEN cast ('@param2@' as datetime)
      AND cast ('@param3@' as datetime)
      and ragione in ('CONCERTO_TECNICO','COMPETENZA_TECNICA')
      AND tf.id_corr_glob IN (select u.system_id
      from GERARCHIA_UO u))
    </value>
  </query>
  <query>
    <name>S_PIANI_RIENTRO_RICEVUTI_MEF_FP</name>
    <value>
      WITH GERARCHIA_UO AS
      (
      SELECT CG.SYSTEM_ID, CG.ID_PARENT, CG.VAR_CODICE
      FROM DPA_CORR_GLOBALI CG
      WHERE CG.CHA_TIPO_URP = 'R'
      AND CG.cha_tipo_ie = 'I'
      AND var_cod_rubrica = 'DGPROG'
      UNION ALL
      SELECT CG.SYSTEM_ID, CG.ID_PARENT, CG.VAR_CODICE
      FROM DPA_CORR_GLOBALI CG INNER JOIN GERARCHIA_UO G ON G.SYSTEM_ID = CG.ID_PARENT
      AND CG.CHA_TIPO_URP = 'R' AND CG.cha_tipo_ie = 'I' AND var_cod_rubrica = 'DGPROG'
      )
      SELECT pf.project_id AS project_id, d.system_id AS system_id,
      d.var_prof_oggetto AS oggetto, d.num_proto AS num_proto,
      d.dta_proto AS dta_proto, d.dta_annulla AS dta_annulla,
      d.var_aut_annulla AS aut_annulla, f.description AS description,
      f.dta_uo_lf AS dta_scadenza, a.var_desc_atto AS atto,
      d.var_segnatura AS segn, d.cha_tipo_proto AS tipo_proto,
      d.id_parent AS PARENT
      FROM 	PROFILE as d INNER JOIN
      project_components as pf on d.system_id = pf.LINK INNER JOIN
      project as c on c.system_id = pf.project_id INNER JOIN
      project as f on f.system_id = c.id_parent ,
      dpa_tipo_atto as a
      WHERE d.id_registro = @param1@
      AND d.id_tipo_atto = a.system_id
      AND d.cha_tipo_proto = 'A'
      AND dta_annulla IS NULL
      AND f.cha_tipo_proj = 'F'
      AND f.cha_tipo_fascicolo = 'P'
      AND c.cha_tipo_proj = 'C'
      AND pf.project_id IN (
      SELECT system_id
      FROM project
      WHERE var_codice = 'PFP'
      AND id_registro = @param1@)
      --coincide con il periodo del report
      AND dta_proto BETWEEN cast ('@param2@' as datetime)
      AND cast ('@param3@' as datetime)
      --coincide con il periodo del report
      AND f.system_id IN (
      SELECT t.id_project
      FROM 	dpa_trasmissione as t INNER JOIN
      dpa_trasm_singola as b on t.system_id = b.id_trasmissione INNER JOIN
      dpa_ragione_trasm as c on b.id_ragione = c.system_id
      WHERE b.cha_tipo_dest = 'R'
      --and t.dta_invio between to_date('@param2@','dd/mm/yyyy') and to_date('@param3@','dd/mm/yyyy') --coincide con il periodo del report
      AND b.id_corr_globale IN (select u.system_id
      from GERARCHIA_UO u)
      AND t.id_project IS NOT NULL
      AND c.var_desc_ragione IN
      ('CONCERTO_TECNICO', 'COMPETENZA_TECNICA'))
      AND d.dta_proto @param4@
      (SELECT MAX (t.dta_invio)
      FROM 	dpa_trasmissione as t INNER JOIN
      dpa_trasm_singola as b on t.system_id = b.id_trasmissione INNER JOIN
      dpa_ragione_trasm as c on b.id_ragione = c.system_id
      WHERE t.dta_invio BETWEEN cast ('@param2@' as datetime)
      AND cast ('@param3@' as datetime)
      AND b.cha_tipo_dest = 'R'
      AND b.id_corr_globale IN (select u.system_id
      from GERARCHIA_UO u)
      AND c.var_desc_ragione IN
      ('CONCERTO_TECNICO', 'COMPETENZA_TECNICA')
      AND t.id_project = f.system_id)
    </value>
  </query>
  <query>
    <name>S_PIANI_RIENTRO_TRASMESSI_REGIONE_FP</name>
    <value>
      SELECT   pf.project_id AS project_id, d.system_id AS system_id,
      d.var_prof_oggetto AS oggetto, d.num_proto AS num_proto,
      d.dta_proto AS dta_proto, d.dta_annulla AS dta_annulla,
      d.var_aut_annulla AS aut_annulla, f.description AS description,
      f.dta_uo_lf AS dta_scadenza, a.var_desc_atto AS atto,
      d.var_segnatura AS segn, d.cha_tipo_proto AS tipo_proto,
      doc.num_proto AS PARENT, doc.dta_proto AS parent_dta_proto,
      docsadm.dpa_valore_oggetto_tipo_atto(d.id_tipo_atto, d.docnumber) AS stato
      FROM 	PROFILE as d INNER JOIN
      project_components as pf on d.system_id = pf.LINK INNER JOIN
      project as c on c.system_id = pf.project_id INNER JOIN
      project as f on f.system_id = c.id_parent,
      PROFILE as doc,
      dpa_tipo_atto as a
      WHERE d.id_registro = @param1@
      and d.id_tipo_atto = a.system_id
      AND d.id_parent = doc.system_id
      AND d.cha_tipo_proto = 'P'
      and d.dta_annulla is null
      AND f.cha_tipo_proj = 'F'
      AND f.cha_tipo_fascicolo = 'P'
      AND c.cha_tipo_proj = 'C'
      and pf.project_id in (select system_id from project where var_codice = 'PFP' and id_registro = @param1@)
      and ISNULL(d.id_parent,0) &gt; 0
      and doc.dta_proto between cast('@param2@' as datetime) and cast('@param3@' as datetime)
      ORDER BY pf.project_id ASC
    </value>
  </query>
  <query>
    <name>S_REPORT_AV_1</name>
    <value>
      SELECT
      getcodreg (pr.id_registro)) AS REGISTRO,
      upper(getdesccorr (tx.id_ruolo_in_uo)) AS RUOLO,
      upper(getpeoplename (tx.id_people)) AS UTENTE,
      upper(vardescribe (ts.id_ragione, 'RAGIONETRASM')) AS RAGIONE,
      count(*) AS TOT
      FROM  dpa_trasm_singola ts INNER JOIN
      dpa_trasmissione tx on tx.system_id = ts.id_trasmissione INNER JOIN
      profile pr on tx.id_profile = pr.system_id ,
      dpa_ragione_trasm rt
      WHERE ts.id_ragione = rt.system_id
      @condWhere@
      GROUP BY
      docsadm.getcodreg (pr.id_registro),
      docsadm.getdesccorr (tx.id_ruolo_in_uo),
      docsadm.getpeoplename (tx.id_people),
      docsadm.vardescribe (ts.id_ragione, 'RAGIONETRASM')
    </value>
  </query>
  <query>
    <name>S_REPORT_AV_2</name>
    <value>
      SELECT
      upper(docsadm.getcodreg (id_registro)) AS REGISTRO,
      upper(docsadm.vardescribe (id_ruolo_dest, 'DESC_RUOLO')) AS RUOLO,
      upper(docsadm.vardescribe (id_ragione_trasm, 'RAGIONETRASM')) AS RAGIONE,
      count(*) AS TOT
      FROM  dpa_todolist
      WHERE
      id_ruolo_dest not in (0)
      @condWhere@
      GROUP BY
      docsadm.getcodreg (id_registro),
      docsadm.vardescribe (id_ruolo_dest,'DESC_RUOLO'),
      docsadm.vardescribe (id_ragione_trasm, 'RAGIONETRASM')
    </value>
  </query>
  <query>
    <name>S_REPORT_AV_3</name>
    <value>
      SELECT upper(docsadm.getcodreg (id_registro)) AS REGISTRO ,
      sum(docsadm.getprotocollato(system_id,'T','@abilProtInt@')) AS PROTOCOLLATI,
      sum(docsadm.getprotocollato(system_id,'A','@abilProtInt@')) AS ARRIVO,
      sum(docsadm.getprotocollato(system_id,'P','@abilProtInt@')) AS PARTENZA,
      @protInterni@
      sum(docsadm.GetDocFascicolato(SYSTEM_ID)) AS FASCICOLATI,
      sum(CASE dta_annulla when null then 0 else 1 end) AS ANNULLATI,
      sum(cast(docsadm.getimg(docnumber) as int)) AS IMMAGINE
      FROM   profile
      WHERE  cha_tipo_proto not in ('R','G')
      AND ISNULL(CHA_IN_CESTINO,'0') = '0'
      and cha_in_archivio &lt;&gt; '1'
      @condWhere@
      GROUP BY
      id_registro
      ORDER BY
      docsadm.getcodreg (id_registro)
    </value>
  </query>
  <query>
    <name>S_REPORT_AV_4</name>
    <value>
      SELECT upper(docsadm.getcodreg (id_registro)) AS REGISTRO,
      upper(docsadm.GETDESCCORR(id_ruolo_prot)) AS RUOLO,
      sum(docsadm.getprotocollato(system_id,'T','@abilProtInt@')) AS PROTOCOLLATI,
      sum(docsadm.getprotocollato(system_id,'A','@abilProtInt@')) AS ARRIVO,
      sum(docsadm.getprotocollato(system_id,'P','@abilProtInt@')) AS PARTENZA,
      @protInterni@
      sum(docsadm.GetDocFascicolato(SYSTEM_ID)) AS FASCICOLATI,
      sum(CASE dta_annulla when null then 0 else 1 end) AS ANNULLATI,
      sum(cast(docsadm.getimg(docnumber) as int)) AS IMMAGINE
      FROM   profile
      WHERE  cha_tipo_proto not in ('R','G')
      AND ISNULL(CHA_IN_CESTINO,'0') = '0'
      and cha_in_archivio &lt;&gt; '1'
      @condWhere@
      GROUP BY  id_registro, docsadm.GETDESCCORR(id_ruolo_prot)
      ORDER BY docsadm.getcodreg (id_registro)
    </value>
  </query>
  <query>
    <name>S_REPORT_AV_5_MAIN</name>
    <value>
      SELECT
      upper(docsadm.getcodreg (id_registro)) AS REGISTRO,
      sum(docsadm.getprotocollato(system_id,'A','0')) AS "PROTOCOLLATI IN ARRIVO",
      0 as "FASCICOLATI IN ARRIVO" ,
      0 as "CLASSIFICATI IN ARRIVO" ,
      sum(docsadm.getprotocollato(system_id,'P','0')) AS "PROTOCOLLATI IN PARTENZA",
      0 as "FASCICOLATI IN PARTENZA" ,
      0 as "CLASSIFICATI IN PARTENZA"
      from profile a
      where  ISNULL(CHA_IN_CESTINO,'0') = '0'
      @condWhere@
      GROUP BY  id_registro
      ORDER BY docsadm.getcodreg (id_registro)
    </value>
  </query>
  <query>
    <name>S_REPORT_AV_5_FASCICOLATI</name>
    <value>
      select  upper(docsadm.getcodreg (id_registro)) AS REGISTRO ,
      count(*) AS FASCICOLATI
      from 	profile a INNER JOIN
      project_components b on a.system_id = b.link
      where  a.cha_tipo_proto = '@destinazione@'
      and   b.project_id in
      (Select system_id
      from project where cha_tipo_proj='C'
      and  id_fascicolo in (select system_id
      from project
      where cha_tipo_fascicolo = 'P'
      and cha_tipo_proj = 'F'))
      @condWhere@
      GROUP BY  id_registro
      ORDER BY docsadm.getcodreg (id_registro)
    </value>
  </query>
  <query>
    <name>S_REPORT_AV_5_CLASSIFICATI</name>
    <value>
      select  upper(docsadm.getcodreg (id_registro)) AS REGISTRO ,
      count(*)  AS CLASSIFICATO
      from 	profile as a INNER JOIN
      project_components b on a.system_id = b.link
      where  a.cha_tipo_proto = '@destinazione@'
      and  b.project_id in
      (Select system_id
      from project where cha_tipo_proj = 'C'
      and id_fascicolo in (select system_id
      from project
      where cha_tipo_fascicolo = 'G'
      and cha_tipo_proj='F'))
      @condWhere@
      GROUP BY  id_registro
      ORDER BY docsadm.getcodreg (id_registro)
    </value>
  </query>
  <query>
    <name>S_REPORT_AV_6_MAIN</name>
    <value>
      select  r.var_CODICE REGISTRO,
      sum(docsadm.getprotocollato(p.system_id,'A','0')) AS "PROTOCOLLI IN INGRESSO",
      sum(docsadm.getprotocollato(p.system_id,'P','0')) AS "PROTOCOLLI IN USCITA",
      0 as "SPEDITI INT. ESTERNA",
      0 as "SPEDITI INT. INTERNA",
      0 as "RICEVUTI INT. INTERNA",
      0 as "RICEVUTI INT. ESTERNA"
      from 	profile as p INNER JOIN
      dpa_el_registri as r on p.id_registro=r.system_id
      where
      p.id_registro=r.system_id
      @condWhere@
      group by r.var_CODICE
      order by r.var_CODICE
    </value>
  </query>
  <query>
    <name>S_REPORT_AV_6_SPEDITI</name>
    <value>
      select r.var_CODICE REGISTRO,
      count(r.var_desc_registro ) as "SPEDITI"
      from 	dpa_stato_invio as m INNER JOIN
      profile as p on m.id_profile=p.system_id INNER JOIN
      dpa_el_registri as r on p.id_registro=r.system_id
      where m.id_corr_globale in (select system_id from dpa_corr_globali where cha_tipo_ie = '@destinazione@')
      @condWhere@
      group by r.var_CODICE
      order by r.var_CODICE
    </value>
  </query>
  <query>
    <name>S_REPORT_AV_6_RICEVUTI</name>
    <value>
      select  r.var_CODICE REGISTRO,
      count(r.var_desc_registro ) as "RICEVUTI"
      from 	profile as p INNER JOIN
      dpa_el_registri as r on p.id_registro=r.system_id
      where cha_interop in ('@destinazione@')
      @condWhere@
      group by r.var_CODICE
      order by r.var_CODICE
    </value>
  </query>
  <query>
    <name>S_REPORT_AV_7_MAIN</name>
    <value>
      select r.var_CODICE REGISTRO,
      count(r.var_desc_registro ) as "RICEVUTI MAIL ESTERNA",
      0 as "PROTO MAIL ESTERNA",
      0 as "PROTO ENTRO X GIORNI"
      from 	profile as p INNER JOIN
      dpa_el_registri as r on p.id_registro=r.system_id
      where cha_interop in ('@destinazione@')
      @condWhere@
      group by r.var_CODICE
      order by r.var_CODICE
    </value>
  </query>
  <query>
    <name>S_REPORT_AV_7_PROTO_ESTERNI</name>
    <value>
      select  r.var_CODICE REGISTRO,
      count(r.var_desc_registro ) as "PROTO MAIL ESTERNA"
      from 	profile as p INNER JOIN
      dpa_el_registri r on p.id_registro=r.system_id
      where cha_da_proto = 0
      and cha_interop in ('@destinazione@')
      @condWhere@
      group by r.var_CODICE
      order by r.var_CODICE
    </value>
  </query>
  <query>
    <name>S_REPORT_AV_7_PROTO_ENTRO_X_GG</name>
    <value>
      select  r.var_CODICE REGISTRO,
      count(r.var_desc_registro ) as "PROTO ENTRO X GIORNI",
      convert(VARCHAR(19), creation_date,103) as "DATA CREAZIONE",
      convert(VARCHAR(19), dta_proto ,103) as "DATA PROTOCOLLAZIONE"
      from 	profile as p INNER JOIN
      dpa_el_registri as r on p.id_registro = r.system_id
      where cha_da_proto = 0
      and cha_interop in ('@destinazione@')
      @condWhere@
      group by r.var_CODICE,creation_date,dta_proto
      order by r.var_CODICE
    </value>
  </query>
  <query>
    <name>S_REPORT_AV_8</name>
    <value>
      SELECT  upper(docsadm.getcodreg (pr.id_registro)) AS REGISTRO,
      upper(docsadm.getpeoplename (A.ID_PEOPLE)) AS UTENTE,
      upper(docsadm.getdesccorr (A.id_ruolo_in_uo)) AS RUOLO,
      count(B.ID_TRASMISSIONE) AS "NUMERO TRASM",
      C.cha_rifiutata as "ESITO TRASMISSIONE"
      FROM  DPA_TRASMISSIONE as A INNER JOIN
      DPA_TRASM_SINGOLA as B on A.SYSTEM_ID = B.ID_TRASMISSIONE INNER JOIN
      DPA_TRASM_UTENTE as C on B.SYSTEM_ID=C.ID_TRASM_SINGOLA,
      DPA_RAGIONE_TRASM as D,
      profile as PR
      WHERE A.id_profile = pr.system_id
      AND B.ID_RAGIONE = D.SYSTEM_ID
      AND A.CHA_TIPO_OGGETTO = 'D'
      @condWhere@
      group by
      upper(docsadm.getpeoplename (A.ID_PEOPLE)) ,
      C.cha_rifiutata,
      upper(docsadm.getcodreg (pr.id_registro)),
      upper(docsadm.getdesccorr (A.id_ruolo_in_uo))
      ORDER BY
      upper(docsadm.getpeoplename (A.ID_PEOPLE)),
      C.cha_rifiutata ,
      upper(docsadm.getcodreg (pr.id_registro)) desc
    </value>
  </query>
  <query>
    <name>S_REPORT_AV_9</name>
    <value>
      SELECT
      upper(docsadm.getcodreg (pr.id_registro)) AS REGISTRO,
      upper(docsadm.getpeoplename (C.ID_PEOPLE)) AS UTENTE,
      upper(docsadm.getdesccorr (B.ID_CORR_GLOBALE)) AS RUOLO,
      count(B.ID_TRASMISSIONE) AS "NUMERO TRASM",
      C.cha_accettata as "ESITO TRASMISSIONE"
      FROM  DPA_TRASMISSIONE as A INNER JOIN
      DPA_TRASM_SINGOLA as B on A.SYSTEM_ID=B.ID_TRASMISSIONE INNER JOIN
      DPA_TRASM_UTENTE as C on B.SYSTEM_ID=C.ID_TRASM_SINGOLA,
      dpa_corr_globali as dcg,
      profile as PR
      WHERE  A.id_profile = pr.system_id
      and dcg.system_id = b.id_corr_globale
      and dcg.cha_tipo_urp = 'R'
      and dcg.cha_tipo_ie = 'I'
      AND A.DTA_INVIO IS NOT NULL
      @condWhere@
      group by
      upper(docsadm.getcodreg (pr.id_registro)) ,
      upper(docsadm.getpeoplename (C.ID_PEOPLE)),
      upper(docsadm.getdesccorr (B.ID_CORR_GLOBALE)),
      C.cha_accettata
      ORDER BY
      upper(docsadm.getpeoplename (C.ID_PEOPLE)),
      C.cha_accettata ,
      upper(docsadm.getcodreg (pr.id_registro)) desc
    </value>
  </query>
  <query>
    <name>S_ESTRAZIONE_LOG</name>
    <value>
      SELECT x.intervallo, COUNT(*)
      FROM (SELECT a.DTA_AZIONE  AS intervallo
      FROM dpa_log a
      where
      @iop@
      @periodo_iap@
      @ampiezza_iap@
      AND a.ID_AMM = @idAmm@
      @altro@
      ) as x
      GROUP BY x.intervallo
      ORDER BY x.intervallo
    </value>
  </query>
  <query>
    <name>S_J_DPA_TRASMISSIONE__TRASM_SINGOLA__TRASM_UTENTE5</name>
    <value>
      SELECT @param1@,
      ISNULL(@dbuser@.vardescribe(a.id_profile,'SEGNATURA_CODFASC'),@dbuser@.vardescribe(id_project,'CODFASC')) ID_SEGN_CODFASC,
      ISNULL(@dbuser@.vardescribe(a.id_profile,'DATADOC'),@dbuser@.vardescribe(id_project,'DATA_CREAZ')) DATA_DOC_FASC,
      @dbuser@.getdesccorr(id_corr_globale) as var_desc_corr, @dbuser@.getpeoplename(a.id_people) as full_name, @dbuser@.getdesccorr(a.id_ruolo_in_uo) AS desc_ruolo_mitt,
      g.cha_tipo_ragione, g.var_desc_ragione,
      @dbuser@.getpeoplename(c.id_people) as desc_destinatario, @dbuser@.getcodruolobyidcorr(a.id_ruolo_in_uo) as cod_ruolo_mitt,
      @dbuser@.GETPEOPLEUSERID(a.id_people) as USER_ID @otherField@
      FROM 	DPA_TRASM_UTENTE as C,
      DPA_TRASM_SINGOLA as B,
      DPA_TRASMISSIONE as A,
      dpa_ragione_trasm as g @otherTable@
      @param2@
      WHERE @param3@
      AND g.system_id = b.id_ragione
      @otherFilter@
      ORDER BY @orderCondition@
    </value>
  </query>
  <query>
    <name>S_DPA_TRASMISSIONE_EXPORT2</name>
    <value>
      SELECT A.ID_RUOLO_IN_UO, A.ID_PEOPLE, A.CHA_TIPO_OGGETTO,
      A.ID_PROFILE, A.ID_PROJECT,@param1@ AS DTA_INVIO_F,
      B.ID_RAGIONE, B.ID_TRASMISSIONE, B.CHA_TIPO_DEST,B.ID_CORR_GLOBALE, B.SYSTEM_ID AS ID_TRASM_SINGOLA,
      @param2@ AS DTA_SCADENZA,
      A.ID_PEOPLE_DELEGATO AS ID_PEOPLE_DELEGATO,
      ISNULL(@dbuser@.vardescribe(a.id_profile,'SEGNATURA_CODFASC'),@dbuser@.vardescribe(id_project,'CODFASC')) ID_SEGN_CODFASC,
      ISNULL(@dbuser@.vardescribe(a.id_profile,'DATADOC'),@dbuser@.vardescribe(id_project,'DATA_CREAZ')) DATA_DOC_FASC,
      @dbuser@.getdesccorr(id_corr_globale) as var_desc_corr, @dbuser@.getpeoplename(a.id_people) as full_name, @dbuser@.getdesccorr(a.id_ruolo_in_uo) AS desc_ruolo_mitt,
      g.cha_tipo_ragione, g.var_desc_ragione, @dbuser@.getcodruolobyidcorr(a.id_ruolo_in_uo) as cod_ruolo_mitt,
      @dbuser@.GETPEOPLEUSERID(a.id_people) as USER_ID
      @otherField@
      FROM 	DPA_TRASMISSIONE as A INNER JOIN
      DPA_TRASM_SINGOLA as B on A.SYSTEM_ID=B.ID_TRASMISSIONE,
      dpa_ragione_trasm g
      @otherTable@
      @param7@
      WHERE g.system_id = b.id_ragione
      @param6@
      @otherFilter@
      ORDER BY @orderCondition@, B.ID_TRASMISSIONE DESC
    </value>
  </query>
  <query>
    <name>S_REGISTERS_REPAIR_PRINT</name>
    <value>
      Select
      CounterId,
      (Select descrizione From dpa_oggetti_custom Where system_id = CounterId) as CounterDescription,
      (Select var_desc_atto from dpa_tipo_atto Where system_id = TipologyId) As TipologyDescription,
      RegistryId,
      RFId,
      (Select system_id From dpa_corr_globali Where id_gruppo = PrinterRoleRespId And dta_fine Is Null) As PrinterRoleCorrGlob,
      PrinterUserRespId,
      DtaNextAutomaticPrint,
      CounterState,
      PrintFreq As PrintFrequency
      From dpa_registri_repertorio
      Where REGISTRYID IN (SELECT DPA_STAMPA_REPERTORI.REGISTRYID FROM DPA_STAMPA_REPERTORI , COMPONENTS WHERE DPA_STAMPA_REPERTORI.DOCNUMBER = COMPONENTS.DOCNUMBER
      AND COMPONENTS.PATH IS NULL) OR
      COUNTERID IN (SELECT DPA_STAMPA_REPERTORI.ID_REPERTORIO  FROM DPA_STAMPA_REPERTORI , COMPONENTS WHERE DPA_STAMPA_REPERTORI.DOCNUMBER = COMPONENTS.DOCNUMBER
      AND COMPONENTS.PATH IS NULL) OR
      RFID IN (SELECT DPA_STAMPA_REPERTORI.REGISTRYID FROM DPA_STAMPA_REPERTORI , COMPONENTS WHERE DPA_STAMPA_REPERTORI.DOCNUMBER = COMPONENTS.DOCNUMBER
      AND COMPONENTS.PATH IS NULL)
    </value>
  </query>
  <query>
    <name>S_REP_TO_PRINT_BY_COUNTER</name>
    <value>
      Select
      CounterId,
      (Select descrizione From dpa_oggetti_custom Where system_id = CounterId) as CounterDescription,
      (Select var_desc_atto from dpa_tipo_atto Where system_id = TipologyId) As TipologyDescription,
      RegistryId,
      RFId,
      (Select system_id From dpa_corr_globali Where id_gruppo = PrinterRoleRespId And dta_fine Is Null) As PrinterRoleCorrGlob,
      PrinterUserRespId,
      DtaNextAutomaticPrint,
      CounterState,
      PrintFreq As PrintFrequency
      From dpa_registri_repertorio
      Where tipologykind = 'D'
      And printerrolerespid Is Not Null
      And printeruserrespid Is Not Null
      and counterid=@counterid@
    </value>
  </query>
  <query>
    <name>S_REP_TO_PRINT_BY_YEAR_SPECIFIC</name>
    <value>
      select a.id_oggetto, a.anno, a.id_aoo_rf, min(cast(a.valore_oggetto_db as int)) as minimo , max(cast(a.valore_oggetto_db as int)) as massimo
      from dpa_associazione_Templates as a
      where a.id_oggetto=@counterid@
      and anno=@year@
      and id_aoo_rf=@idaoorf@
      group by a.id_oggetto, a.anno, a.id_aoo_rf
    </value>
  </query>
  <query>
    <name>CDC_REPORT_ELENCO_DECRETI_SCCLA_2</name>
    <value>
      SELECT p.num_proto as Protocollo, convert(varchar(10),dta_proto,103) as Data_proto, p.var_prof_oggetto as oggetto,
      (docsadm.corrcat(p.docnumber,p.CHA_TIPO_PROTO)) as corr
      FROM 	PROFILE as p INNER JOIN
      security s on s.thing=p.system_id INNER JOIN
      dpa_tipo_atto on p.id_tipo_atto = dpa_tipo_atto.system_id,
      dpa_associazione_templates,
      dpa_oggetti_custom
      WHERE  dpa_tipo_atto.var_desc_atto = 'CONTROLLO PREVENTIVO SCCLA' and s.personorgroup IN (@ufficio@)
      and s.ACCESSRIGHTS = '255' and s.CHA_TIPO_DIRITTO='P'
      @filterCond@
    </value>
  </query>
  <query>
    <name>CDC_REPORT_ELENCO_DECRETI_RESTITUITI_SCCLA</name>
    <value>
      SELECT p.num_proto as Protocollo, convert(varchar(10),dta_proto,103) as Data_proto, p.var_prof_oggetto as oggetto,
      docsadm.getvaloreoggettodb (dpa_tipo_atto.id_amm,
      p.docnumber,
      dpa_tipo_atto.var_desc_atto,
      'Numero UCB/Prot. Amm.'
      ) AS "Numero UCB"
      FROM	security as s INNER JOIN
      PROFILE as p on s.thing=p.system_id INNER JOIN
      dpa_tipo_atto on p.id_tipo_atto = dpa_tipo_atto.system_id,
      dpa_associazione_templates,
      dpa_oggetti_custom
      WHERE  dpa_tipo_atto.var_desc_atto = 'CONTROLLO PREVENTIVO SCCLA' and s.personorgroup IN (@ufficio@)
      and s.ACCESSRIGHTS = '255' and s.CHA_TIPO_DIRITTO='P'
      @filterCond@
    </value>
  </query>
  <query>
    <name>CDC_REPORT_ELENCO_DECRETI_RESTITUITI_SCCLA_SUCC</name>
    <value>
      SELECT p.num_proto as Protocollo, convert(varchar(10),dta_proto,103) as Data_proto, p.var_prof_oggetto as oggetto,
      docsadm.getvaloreoggettodb (dpa_tipo_atto.id_amm,
      p.docnumber,
      dpa_tipo_atto.var_desc_atto,
      'Numero UCB/Prot. Amm.'
      ) AS "Numero UCB"
      FROM 	security as s INNER JOIN
      PROFILE as p on s.thing=p.system_id INNER JOIN
      dpa_tipo_atto on p.id_tipo_atto = dpa_tipo_atto.system_id,
      dpa_associazione_templates,
      dpa_oggetti_custom
      WHERE dpa_tipo_atto.var_desc_atto = 'CONTROLLO SUCCESSIVO SCCLA' and s.personorgroup IN (@ufficio@)
      and s.ACCESSRIGHTS = '255' and s.CHA_TIPO_DIRITTO='P'
      @filterCond@
    </value>
  </query>
  <query>
    <name>CDC_REPORT_ELENCO_DECRETI_RESTITUITI_SCCLA_2</name>
    <value>
      SELECT (docsadm.corrcat(p.docnumber,p.CHA_TIPO_PROTO)) as corr
      FROM 	security as s INNER JOIN
      PROFILE as p on s.thing=p.system_id INNER JOIN
      dpa_tipo_atto on p.id_tipo_atto = dpa_tipo_atto.system_id,
      dpa_associazione_templates,
      dpa_oggetti_custom
      WHERE  dpa_tipo_atto.var_desc_atto = 'CONTROLLO PREVENTIVO SCCLA' and s.personorgroup IN (@ufficio@)
      and s.ACCESSRIGHTS = '255' and s.CHA_TIPO_DIRITTO='P'
      @filterCond@
    </value>
  </query>
  <query>
    <name>CDC_REPORT_ELENCO_DECRETI_RESTITUITI_SCCLA_2_SUCC</name>
    <value>
      SELECT (docsadm.corrcat(p.docnumber,p.CHA_TIPO_PROTO)) as corr
      FROM 	security as s INNER JOIN
      PROFILE as p on s.thing=p.system_id INNER JOIN
      dpa_tipo_atto on p.id_tipo_atto = dpa_tipo_atto.system_id,
      dpa_associazione_templates,
      dpa_oggetti_custom
      WHERE dpa_tipo_atto.var_desc_atto = 'CONTROLLO SUCCESSIVO SCCLA' and s.personorgroup IN (@ufficio@)
      and s.ACCESSRIGHTS = '255' and s.CHA_TIPO_DIRITTO='P'
      @filterCond@
    </value>
  </query>
  <query>
    <name>CDC_REPORT_ELENCO_DECRETI_RESTITUITI_CON_RILIEVO_SCCLA</name>
    <value>
      SELECT p.num_proto as Protocollo, convert(varchar(10),dta_proto,103) as Data_proto, p.var_prof_oggetto as oggetto,
      docsadm.getvaloreoggettodb (dpa_tipo_atto.id_amm,
      p.docnumber,
      dpa_tipo_atto.var_desc_atto,
      'num rilievo'
      ) AS "n. rilievo",
      convert(varchar(10),docsadm.getvaloreoggettodb_tipodata
      (dpa_tipo_atto.id_amm,
      p.docnumber,
      dpa_tipo_atto.var_desc_atto,
      'data rilievo'
      ),103) AS "data rilievo",
      docsadm.getvaloreoggettodb (dpa_tipo_atto.id_amm,
      p.docnumber,
      dpa_tipo_atto.var_desc_atto,
      'Numero UCB/Prot. Amm.'
      ) AS "Numero UCB"
      FROM 	security as s INNER JOIN
      PROFILE as p on s.thing=p.system_id INNER JOIN
      dpa_tipo_atto on p.id_tipo_atto = dpa_tipo_atto.system_id,
      dpa_associazione_templates,
      dpa_oggetti_custom
      WHERE dpa_tipo_atto.var_desc_atto = 'CONTROLLO PREVENTIVO SCCLA' and s.personorgroup IN (@ufficio@)
      and s.ACCESSRIGHTS = '255' and s.CHA_TIPO_DIRITTO='P'
      @filterCond@
    </value>
  </query>
  <query>
    <name>CDC_REPORT_ELENCO_DECRETI_RESTITUITI_CON_RILIEVO_SCCLA_SUCC</name>
    <value>
      SELECT p.num_proto as Protocollo, convert(varchar(10),dta_proto,103) as Data_proto, p.var_prof_oggetto as oggetto,
      docsadm.getvaloreoggettodb (dpa_tipo_atto.id_amm,
      p.docnumber,
      dpa_tipo_atto.var_desc_atto,
      'num rilievo'
      ) AS "n. rilievo",
      convert(varchar(10),docsadm.getvaloreoggettodb_tipodata
      (dpa_tipo_atto.id_amm,
      p.docnumber,
      dpa_tipo_atto.var_desc_atto,
      'data rilievo'
      ),103) AS "data rilievo",
      docsadm.getvaloreoggettodb (dpa_tipo_atto.id_amm,
      p.docnumber,
      dpa_tipo_atto.var_desc_atto,
      'Numero UCB/Prot. Amm.'
      ) AS "Numero UCB"
      FROM 	security as s INNER JOIN
      PROFILE as p on s.thing=p.system_id INNER JOIN
      dpa_tipo_atto on p.id_tipo_atto = dpa_tipo_atto.system_id,
      dpa_associazione_templates,
      dpa_oggetti_custom
      WHERE dpa_tipo_atto.var_desc_atto = 'CONTROLLO SUCCESSIVO SCCLA' and s.personorgroup IN (@ufficio@)
      and s.ACCESSRIGHTS = '255' and s.CHA_TIPO_DIRITTO='P'
      @filterCond@
    </value>
  </query>
  <query>
    <name>CDC_REPORT_ELENCO_DECRETI_RESTITUITI_CON_RILIEVO_SCCLA_2</name>
    <value>
      SELECT (docsadm.corrcat(p.docnumber,p.CHA_TIPO_PROTO)) as corr
      FROM 	security as s INNER JOIN
      PROFILE as p on s.thing=p.system_id INNER JOIN
      dpa_tipo_atto on p.id_tipo_atto = dpa_tipo_atto.system_id,
      dpa_associazione_templates,
      dpa_oggetti_custom
      WHERE dpa_tipo_atto.var_desc_atto = 'CONTROLLO PREVENTIVO SCCLA' and s.personorgroup IN (@ufficio@)
      and s.ACCESSRIGHTS = '255' and s.CHA_TIPO_DIRITTO='P'
      @filterCond@
    </value>
  </query>
  <query>
    <name>CDC_COUNT_TOTALI_DEFERIMENTI_OLD</name>
    <VALUE>
      SELECT count(*) FROM
      PROFILE a
      WHERE  EXISTS
      (
      Select  'x'
      from security e
      where a.system_id=e.thing @filterUfficio@ and e.ACCESSRIGHTS=255 and e.CHA_TIPO_DIRITTO='P'
      )
      AND
      (
      (ID_DOCUMENTO_PRINCIPALE IS NULL )
      AND A.CREATION_TIME BETWEEN cast('@dataFrom@' as datetime) AND cast('@dataTo@' as datetime)
      AND  ISNULL(A.CHA_IN_CESTINO,'0')='0'
      AND A.ID_TIPO_ATTO=@idTipoAtto@
      )
    </VALUE>
  </query>
  <query>
    <name>CDC_COUNT_TOTALI_DEFERIMENTI</name>
    <VALUE>
      SELECT count(*) FROM
      PROFILE a
      WHERE  EXISTS
      (
      Select  'x'
      from security e
      where a.system_id=e.thing @filterUfficio@ and e.ACCESSRIGHTS=255 and e.CHA_TIPO_DIRITTO='P'
      )
      AND
      (
      (ID_DOCUMENTO_PRINCIPALE IS NULL )
      AND A.CREATION_TIME BETWEEN cast('@dataFrom@' as datetime) AND cast('@dataTo@' as datetime)
      AND  ISNULL(A.CHA_IN_CESTINO,'0')='0'
      AND A.ID_TIPO_ATTO=(select system_id from dpa_tipo_atto where var_desc_atto = 'DEFERIMENTI SCCLA')
      )
    </VALUE>
  </query>
  <query>
    <name>CDC_COUNT_TOTALI_DECRETI_ESAMINATI</name>
    <VALUE>
      Select SUM(cast(docsadm.getvaloreoggettodb (dpa_tipo_atto.id_amm,
      a.docnumber,
      dpa_tipo_atto.var_desc_atto,
      'Decreti Esaminati'
      )as int)) as "Decreti_Esaminati"
      from PROFILE a, dpa_tipo_atto
      WHERE  EXISTS
      (
      Select 'x'
      from security e
      where a.system_id=e.thing @filterUfficio@ and e.ACCESSRIGHTS=255 and e.CHA_TIPO_DIRITTO='P'
      )
      AND
      (
      (ID_DOCUMENTO_PRINCIPALE IS NULL )
      AND A.CREATION_TIME BETWEEN cast('@dataFrom@' as datetime) AND cast('@dataTo@' as datetime)
      AND  ISNULL(A.CHA_IN_CESTINO,'0')='0'
      AND dpa_tipo_atto.var_desc_atto = 'Pareri SCCLA'
      )
      AND a.id_tipo_atto = dpa_tipo_atto.system_id
    </VALUE>
  </query>
  <query>
    <name>CDC_GET_REGISTRI_BY_TIPOLOGIA</name>
    <value>
      select dpa_el_registri.SYSTEM_ID, dpa_el_registri.var_codice, dpa_el_registri.var_desc_registro
      from 	dpa_contatori_doc INNER JOIN
      dpa_el_registri on dpa_contatori_doc.id_aoo = dpa_el_registri.system_id
      where  dpa_contatori_doc.id_tipologia = (select SYSTEM_ID from dpa_tipo_atto where var_desc_atto = '@DESC_TIPOLOGIA@')
      and dpa_contatori_doc.id_aoo != 0
      and  dpa_contatori_doc.id_aoo is not null
    </value>
  </query>
  <query>
    <name>CDC_GET_RUOLI_BY_REGISTRO</name>
    <value>
      SELECT *
      FROM 	DPA_L_RUOLO_REG INNER JOIN
      dpa_corr_globali on DPA_L_RUOLO_REG.id_ruolo_in_uo = dpa_corr_globali.system_id
      WHERE DPA_L_RUOLO_REG.ID_REGISTRO = @idRegistro@
    </value>
  </query>
  <query>
    <name>CDC_REPORT_ELENCO_DECRETI_SRC_2</name>
    <value>
      SELECT (docsadm.corrcat(p.docnumber,p.CHA_TIPO_PROTO)) as corr
      FROM 	security as s INNER JOIN
      PROFILE as p on s.thing=p.system_id INNER JOIN
      dpa_tipo_atto on p.id_tipo_atto = dpa_tipo_atto.system_id,
      dpa_associazione_templates,
      dpa_oggetti_custom
      WHERE dpa_tipo_atto.var_desc_atto = 'CONTROLLO PREVENTIVO SRC'
      and s.personorgroup IN (@ufficio@) and s.ACCESSRIGHTS = '255' and s.CHA_TIPO_DIRITTO='P'
      @filterCond@
    </value>
  </query>
  <query>
    <name>CDC_REPORT_ELENCO_DECRETI_RESTITUITI_SRC</name>
    <value>
      SELECT p.num_proto as Protocollo, convert(varchar(10),dta_proto,103) as Data_proto, p.var_prof_oggetto as oggetto,
      convert(varchar(10),docsadm.getvaloreoggettodb_tipodata
      (dpa_tipo_atto.id_amm,
      p.docnumber,
      dpa_tipo_atto.var_desc_atto,
      'Data decreto'
      ),103) AS "Data decreto"
      FROM 	security as s INNER JOIN
      PROFILE as p on s.thing=p.system_id INNER JOIN
      dpa_tipo_atto on p.id_tipo_atto = dpa_tipo_atto.system_id,
      dpa_associazione_templates,
      dpa_oggetti_custom
      WHERE dpa_tipo_atto.var_desc_atto = 'CONTROLLO PREVENTIVO SRC'
      and s.personorgroup IN (@ufficio@) and s.ACCESSRIGHTS = '255' and s.CHA_TIPO_DIRITTO='P'
      @filterCond@
    </value>
  </query>
  <query>
    <name>CDC_REPORT_ELENCO_DECRETI_RESTITUITI_SRC_2</name>
    <value>
      SELECT (docsadm.corrcat(p.docnumber,p.CHA_TIPO_PROTO)) as corr
      FROM 	security as s INNER JOIN
      PROFILE as p on s.thing=p.system_id INNER JOIN
      dpa_tipo_atto on p.id_tipo_atto = dpa_tipo_atto.system_id,
      dpa_associazione_templates,
      dpa_oggetti_custom
      WHERE dpa_tipo_atto.var_desc_atto = 'CONTROLLO PREVENTIVO SRC'
      and s.personorgroup IN (@ufficio@) and s.ACCESSRIGHTS = '255' and s.CHA_TIPO_DIRITTO='P'
      @filterCond@
    </value>
  </query>
  <query>
    <name>CDC_REPORT_ELENCO_DECRETI_RESTITUITI_CON_RILIEVO_SRC</name>
    <value>
      SELECT p.num_proto as Protocollo, convert(varchar(10),dta_proto,103) as Data_proto, p.var_prof_oggetto as oggetto,
      docsadm.getvaloreoggettodb (dpa_tipo_atto.id_amm,
      p.docnumber,
      dpa_tipo_atto.var_desc_atto,
      'num rilievo'
      ) AS "n. rilievo",
      convert(varchar(10),docsadm.getvaloreoggettodb_tipodata
      (dpa_tipo_atto.id_amm,
      p.docnumber,
      dpa_tipo_atto.var_desc_atto,
      'data rilievo'
      ),103) AS "data rilievo"
      FROM 	security as s INNER JOIN
      PROFILE as p on s.thing=p.system_id INNER JOIN
      dpa_tipo_atto on p.id_tipo_atto = dpa_tipo_atto.system_id,
      dpa_associazione_templates,
      dpa_oggetti_custom
      WHERE dpa_tipo_atto.var_desc_atto = 'CONTROLLO PREVENTIVO SRC'
      and s.personorgroup IN (@ufficio@) and s.ACCESSRIGHTS = '255' and s.CHA_TIPO_DIRITTO='P'
      @filterCond@
    </value>
  </query>
  <query>
    <name>CDC_REPORT_ELENCO_DECRETI_RESTITUITI_CON_RILIEVO_SRC_2</name>
    <value>
      SELECT (docsadm.corrcat(p.docnumber,p.CHA_TIPO_PROTO)) as corr
      FROM 	security as s INNER JOIN
      PROFILE as p on s.thing=p.system_id INNER JOIN
      dpa_tipo_atto on p.id_tipo_atto = dpa_tipo_atto.system_id,
      dpa_associazione_templates,
      dpa_oggetti_custom
      WHERE dpa_tipo_atto.var_desc_atto = 'CONTROLLO PREVENTIVO SRC'
      and s.personorgroup IN (@ufficio@) and s.ACCESSRIGHTS = '255' and s.CHA_TIPO_DIRITTO='P'
      @filterCond@
    </value>
  </query>
  <query>
    <name>CDC_PAROLE_CHIAVE</name>
    <value>
      SELECT *
      FROM DPA_PAROLE
      WHERE VAR_DESC_PAROLA LIKE '%@WORD@%'
      AND (ID_REGISTRO IS NULL OR ID_REGISTRO = '@ID_REG@')
    </value>
  </query>
  <query>
    <name>R_COPIA_VISIBILITA</name>
    <value>
      SELECT ts_copy dta_azione,
      docsadm.Getdocnameorcodfasc(thing)  id_segn_codice,
      docsadm.getcodruolo (id_ruolo_orig) codice_orig,
      docsadm.getdescruolo (id_ruolo_orig) descrizione_orig,
      docsadm.getcodruolo (id_ruolo_dest) codice_dest,
      docsadm.getdescruolo (id_ruolo_dest) descrizione_dest,
      (CASE accessrights
      WHEN 63 then 'Scrittura'
      WHEN 45 then 'Lettura'
      WHEN 255 THEN 'Proprietà'
      WHEN 0 THEN 'Proprietà'
      WHEN 20 then 'In attesa di accettazione'
      END ) diritto,
      var_note_sec motivo
      FROM DPA_COPY_LOG
    </value>
  </query>
  <query>
    <name>S_GET_INFO_DOCUMENT</name>
    <value>
      select a.NUM_PROTO, convert (varchar(10),a.dta_proto, 103) AS DTA_PROTO, convert (varchar(10),a.CREATION_DATE, 103) AS CREATION_DATE
      from profile a
      where a.system_id=@system_id@
    </value>
  </query>
  <query>
    <name>D_DELETE_PROFILE_FROM_PROJECT_COMPONENTS</name>
    <value>
      delete from project_components where link = @iDdoc@
    </value>
  </query>
  <query>
    <name>S_VERIFICA_INTERVALLO_LOG_PROTOCOLLO</name>
    <value>
      SELECT   userid_operatore, dta_azione, var_oggetto, var_desc_oggetto,
      var_desc_azione, cha_esito, id_people_operatore, id_gruppo_operatore,
      id_amm, id_oggetto, var_cod_azione
      FROM dpa_log, DUAL
      WHERE id_amm = 361
      AND dta_azione &gt;= GETDATE() - (select datename(dayofyear,DATE)-1 from
      (
      select DATEADD(second,1500,0) as date
      ) t)
      AND var_oggetto = 'DOCUMENTO'
      AND (var_cod_azione = 'AGG_PROT' or var_cod_azione ='PUT_FILE')
      AND var_cod_azione NOT LIKE 'AMM_%'
      ORDER BY dta_azione DESC
    </value>
  </query>
  <query>
    <name>S_GET_DOCUMENT_TRASM_TO_CC</name>
    <value>
      SELECT COUNT (a.id_profile) as Trasm
      FROM 	dpa_trasmissione as a INNER JOIN
      dpa_doc_arrivo_par as b on B.id_profile = A.ID_Profile INNER JOIN
      dpa_trasm_singola as c on C.ID_CORR_GLOBALE = b.id_mitt_Dest
      WHERE     a.id_profile = @idProfile@
      AND C.ID_TRASMISSIONE = A.system_id
      AND B.CHA_TIPO_MITT_DEST IN ('D', 'C')
    </value>
  </query>
  <query>
    <name>S_DPA_NOTIFY_BY_ID_OBJECT</name>
    <value>
      SELECT system_id as ID_NOTIFY,
      id_event,
      desc_producer as PRODUCER,
      id_people_receiver as ID_PEOPLE,
      id_group_receiver as ID_GROUP,
      type_notify as TYPE_NOTIFICATION,
      dta_notify,
      field_1 as ITEM1,
      field_2 as ITEM2,
      field_3 as ITEM3,
      field_4 as ITEM4,
      multiplicity,
      specialized_field as ITEM_SPECIALIZED,
      type_event,
      domainobject,
      id_object,
      id_specialized_object,
      dta_event,
      read_notification,
      color,
      notes,
      docsadm.getchaimg(id_object) as EXTENSION
      FROM DPA_NOTIFY
      WHERE ID_OBJECT = @idObject@ AND DOMAINOBJECT = '@domainObject@'
      ORDER BY DTA_EVENT desc
    </value>
  </query>
  <query>
    <name>S_DPA_NOTIFY_NO_WF</name>
    <value>
      SELECT n.system_id, n.id_specialized_object
      from DPA_NOTIFY n
      WHERE n.ID_PEOPLE_RECEIVER = @param1@
      AND (n.ID_GROUP_RECEIVER = @param2@ OR ID_GROUP_RECEIVER = 0)
      AND n.DTA_NOTIFY &lt; @param3@
      AND ((n.TYPE_EVENT not like 'TRASM_DOC_%' AND n.TYPE_EVENT not like 'TRASM_FOLDER_%') OR
      (( select rt.cha_tipo_ragione
      from DPA_TRASM_SINGOLA ts join DPA_RAGIONE_TRASM rt on ts.id_ragione = rt.system_id
      where ts.system_id = n.id_specialized_object
      ) NOT IN ('W')
      )
      )
    </value>
  </query>
  <query>
    <name>U_DPA_NOTIFY</name>
    <value>
      UPDATE DPA_NOTIFY
      SET FIELD_1 = '@field_1@',
      FIELD_2 = '@field_2@',
      FIELD_3 = '@field_3@',
      FIELD_4 = '@field_4@',
      SPECIALIZED_FIELD = '@specializeItem@'
      WHERE SYSTEM_ID = @idNotification@
    </value>
  </query>
  <query>
    <name>S_DPA_RAGIONE_TRASM_BY_ID_NOTIFY</name>
    <value>
      SELECT r.CHA_TIPO_RAGIONE
      FROM DPA_RAGIONE_TRASM r
      JOIN DPA_TRASM_SINGOLA s ON s.ID_RAGIONE=r.SYSTEM_ID
      JOIN DPA_NOTIFY n ON n.ID_SPECIALIZED_OBJECT = s.SYSTEM_ID
      WHERE n.SYSTEM_ID=@idNotify@ AND NOT(r.CHA_TIPO_RAGIONE='W') AND NOT(r.CHA_TIPO_RAGIONE='S')
    </value>
  </query>
  <query>
    <name>I_DPA_NOTIFY_HISTORY_MULTIPLE</name>
    <value>
      INSERT
      INTO DPA_NOTIFY_HISTORY
      (
      ID_NOTIFY,
      ID_EVENT,
      DESC_PRODUCER,
      ID_PEOPLE_RECEIVER,
      ID_GROUP_RECEIVER,
      TYPE_NOTIFY,
      DTA_NOTIFY,
      FIELD_1,
      FIELD_2,
      FIELD_3,
      FIELD_4,
      MULTIPLICITY,
      SPECIALIZED_FIELD,
      TYPE_EVENT,
      DOMAINOBJECT,
      ID_OBJECT,
      ID_SPECIALIZED_OBJECT,
      DTA_EVENT,
      READ_NOTIFICATION,
      NOTES
      )
      SELECT
      SYSTEM_ID,
      ID_EVENT,
      DESC_PRODUCER,
      ID_PEOPLE_RECEIVER,
      ID_GROUP_RECEIVER,
      TYPE_NOTIFY,
      DTA_NOTIFY,
      FIELD_1,
      FIELD_2,
      FIELD_3,
      FIELD_4,
      MULTIPLICITY,
      SPECIALIZED_FIELD,
      TYPE_EVENT,
      DOMAINOBJECT,
      ID_OBJECT,
      ID_SPECIALIZED_OBJECT,
      DTA_EVENT,
      READ_NOTIFICATION,
      NOTES
      FROM DPA_NOTIFY
      WHERE @condition@
    </value>
  </query>
  <query>
    <name>U_DPA_NOTIFY_NOTES</name>
    <value>
      UPDATE DPA_NOTIFY
      SET NOTES='@notes@'
      WHERE SYSTEM_ID = @idNotification@
    </value>
  </query>
  <query>
    <name>I_INSERT_REGISTRO_CONSERVAZIONE</name>
    <value>
      INSERT INTO DPA_REGISTRO_CONSERVAZIONE
      (
      @colSystemId@
      VAR_COD_AZIONE  ,
      VAR_DESC_AZIONE  ,
      ID_ISTANZA    ,
      ID_OGGETTO   ,
      CHA_TIPO_OGGETTO  ,
      USERID_OPERATORE  ,
      CHA_ESITO         ,
      ID_AMM            ,
      DTA_OPERAZIONE    ,
      CHA_TIPO_AZIONE   ,
      CHA_PRINTED
      )
      VALUES
      (
      @systemId@
      '@codAzione@',
      '@descAzione@',
      @idIstanza@,
      @idOggetto@,
      '@tipoOggetto@',
      '@userId@',
      '@esito@',
      @idAmministrazione@,
      SYSDATE,
      '@tipoAzione@',
      '0'
      )
    </value>
  </query>
  <query>
    <name>U_VALIDAZIONE_ITEMS_CONSERVAZIONE</name>
    <value>
      Update DPA_ITEMS_CONSERVAZIONE @parametro@
      where system_id = @sysId@
    </value>
  </query>
  <query>
    <name>S_PROFILE_SYSTEM_ID_BY_FILTER_NOTIFICATION</name>
    <value>
      SELECT SYSTEM_ID
      FROM PROFILE p, COMPONENTS c
      WHERE @condition@
    </value>
  </query>
  <query>
    <name>S_DPA_TRASM_UTENTE_ID_TRASM_SINGOLA_BY_FILTER_NOTIFICATION</name>
    <value>
      SELECT ID_TRASM_SINGOLA
      FROM DPA_TRASM_UTENTE tu
      JOIN DPA_TRASM_SINGOLA ts
      ON tu.id_trasm_singola   = ts.system_id
      AND tu.ID_TRASM_SINGOLA IN (@listIdTransUser@)
      JOIN DPA_RAGIONE_TRASM rt
      ON ts.id_ragione        = rt.system_id
      AND rt.cha_tipo_ragione = 'W'
      WHERE tu.ID_PEOPLE      =@idPeople@
      AND tu.DTA_ACCETTATA   IS NULL
      AND tu.DTA_RIFIUTATA   IS NULL
    </value>
  </query>
  <query>
    <name>S_DPA_EVENT_TYPE_ASSERTIONS</name>
    <value>
      SELECT TA.SYSTEM_ID,
      TA.ID_TYPE_EVENT,
      TA.DESC_TYPE_EVENT,
      TA.ID_AUR,
      TA.DESC_AUR,
      TA.TYPE_AUR,
      TA.TYPE_NOTIFY,
      TA.IS_EXERCISE,
      TA.ID_AMM,
      A.NOTIFY
      FROM DPA_EVENT_TYPE_ASSERTIONS TA INNER JOIN DPA_LOG_ATTIVATI A
      ON TA.ID_TYPE_EVENT = A.SYSTEM_ID_ANAGRAFICA AND
      TA.ID_AMM = A.ID_AMM AND
      TA.ID_AMM = @idAmm@
      ORDER BY TA.SYSTEM_ID DESC
    </value>
  </query>
  <query>
    <name>S_TYPE_EVENT_CONFIGURABLE</name>
    <value>
      SELECT al.system_id,
      al.var_descrizione as desc_type_event
      FROM DPA_ANAGRAFICA_LOG al INNER JOIN DPA_LOG_ATTIVATI la on
      AL.SYSTEM_ID = LA.SYSTEM_ID_ANAGRAFICA AND
      la.ID_AMM = @idAmm@ AND
      la.NOTIFY = 'CON'
    </value>
  </query>
  <query>
    <name>I_DPA_EVENT_TYPE_ASSERTIONS</name>
    <value>
      INSERT INTO DPA_EVENT_TYPE_ASSERTIONS
      VALUES(@value@)
    </value>
  </query>
  <query>
    <name>D_DPA_EVENT_TYPE_ASSERTIONS</name>
    <value>
      DELETE FROM DPA_EVENT_TYPE_ASSERTIONS
      WHERE SYSTEM_ID IN (@listSystemIdAssertion@)
    </value>
  </query>
  <query>
    <name>S_ASSERTIONS_COUNT_DUPLICATE</name>
    <value>
      SELECT count(*)
      FROM DPA_EVENT_TYPE_ASSERTIONS
      WHERE ID_TYPE_EVENT = @idTypeEvent@ AND
      ID_AUR = @idAur@ AND
      TYPE_AUR = @typeAur@ AND
      ID_AMM = @idAmm@
    </value>
  </query>
  <query>
    <name>S_SEARCH_AUR_TR</name>
    <value>
      SELECT system_id, var_codice as code, var_desc_ruolo as descr
      FROM DPA_TIPO_RUOLO
      WHERE var_codice like '%@code@%' AND
      var_desc_ruolo like '%@description@%' AND
      ID_AMM = @idAmm@
    </value>
  </query>
  <query>
    <name>S_SEARCH_AUR_RF</name>
    <value>
      SELECT system_id, var_codice as code, var_desc_registro as descr
      FROM DPA_EL_REGISTRI
      WHERE var_codice like '%@code@%' AND
      var_desc_registro like '%@description@%' AND
      ID_AMM = @idAmm@
    </value>
  </query>
  <query>
    <name>S_SEARCH_AUR_ROLE</name>
    <value>
      SELECT g.system_id, c.var_cod_rubrica as code, c.var_desc_corr as descr
      FROM 	DPA_CORR_GLOBALI as c INNER JOIN
      GROUPS as g on C.ID_GRUPPO = g.system_id
      WHERE	 c.var_cod_rubrica like '%@code@%'
      AND	 c.var_desc_corr like '%@description@%'
      AND    c.ID_AMM = @idAmm@
      AND    c.CHA_TIPO_URP = 'R'
    </value>
  </query>
  <query>
    <name>S_SEARCH_AUR_UO</name>
    <value>
      SELECT system_id, var_cod_rubrica as code, var_desc_corr as descr
      FROM DPA_CORR_GLOBALI
      WHERE var_cod_rubrica like '%@code@%'
      AND   var_desc_corr like '%@description@%'
      AND  CHA_TIPO_URP = 'U'
      AND  ID_AMM = @idAmm@
    </value>
  </query>
  <query>
    <name>U_DPA_EVENT_TYPE_ASSERTIONS</name>
    <value>
      UPDATE DPA_EVENT_TYPE_ASSERTIONS
      SET ID_TYPE_EVENT = @idTypeEvent@,
      DESC_TYPE_EVENT = '@descTypeEvent@',
      ID_AUR = @idAur@,
      DESC_AUR = '@descAur@',
      TYPE_AUR = '@typeAur@',
      TYPE_NOTIFY = '@typeNotify@',
      IS_EXERCISE = '@isExercise@',
      ID_AMM = @idAmm@
      WHERE SYSTEM_ID = @systemId@
    </value>
  </query>
  <query>
    <name>S_DPA_CONFIG_STAMPA_CONS</name>
    <value>
      SELECT cast(S.PRINT_FREQ as varchar) + '_' + cast(s.DISABLED as varchar) AS FREQUENZA_DISABLED
      FROM DPA_CONFIG_STAMPA_CONS S
      WHERE ID_AMM = @idAmm@
    </value>
  </query>
  <query>
    <name>S_DTA_LAST_PRINT_FROM_DPA_CONFIG_STAMPA_CONS</name>
    <value>
      SELECT S.DTA_LAST_PRINT AS FREQUENZA_DISABLED
      FROM DPA_CONFIG_STAMPA_CONS S
      WHERE ID_AMM = @idAmm@
    </value>
  </query>
  <query>
    <name>U_UPDATE_SUPPORTED_FILE_TYPES_FROM_PGU</name>
    <value>
      UPDATE 	DPA_FORMATI_DOCUMENTO
      SET
      FILE_TYPE_PRESERVATION = @fileTypePreservation@,
      FILE_TYPE_VALIDATION = @fileTypeValidation@
      WHERE 	SYSTEM_ID = @systemId@
    </value>
  </query>
  <query>
    <name>S_SIMPLE_SEARCH_GET_COUNT_DOC</name>
    <value>
      SELECT tab.SYSTEM_ID, tab.CODICE
      FROM (
      SELECT
      A.SYSTEM_ID,
      (CASE
      WHEN a.num_proto IS NOT NULL THEN a.num_proto
      WHEN a.num_proto IS NULL THEN a.docnumber
      END)
      AS codice
      FROM PROFILE a
      WHERE     EXISTS
      (SELECT 'x' FROM security e WHERE     a.system_id = e.thing AND e.PERSONORGROUP IN (@idPeople@, @idGruppo@) AND e.ACCESSRIGHTS &gt; 0)
      AND (    (   @tipiDoc@)
      AND ISNULL (A.CHA_IN_CESTINO, '0') = '0'
      @dataFrom@
      @dataTo@
      AND (   @simplesearchoggetto@ ))
      union
      (SELECT A.SYSTEM_ID, (CASE
      WHEN a.num_proto IS NOT NULL THEN a.num_proto
      WHEN a.num_proto IS NULL THEN a.docnumber
      END)
      AS codice FROM PROFILE a
      WHERE     EXISTS (SELECT 'x' FROM security e WHERE     a.system_id = e.thing AND e.PERSONORGROUP IN (@idPeople@, @idGruppo@) AND e.ACCESSRIGHTS &gt; 0)
      AND (    (   @tipiDoc@)
      AND ISNULL (A.CHA_IN_CESTINO, '0') = '0'
      @dataFrom@
      @dataTo@
      and a.num_proto = @simplesearchnumber@)
      union
      ( SELECT A.SYSTEM_ID,(CASE
      WHEN a.num_proto IS NOT NULL THEN a.num_proto
      WHEN a.num_proto IS NULL THEN a.docnumber
      END)
      AS codice FROM PROFILE a
      WHERE     EXISTS (SELECT 'x' FROM security e WHERE     a.system_id = e.thing AND e.PERSONORGROUP IN (@idPeople@, @idGruppo@) AND e.ACCESSRIGHTS &gt; 0)
      AND (    (   @tipiDoc@)
      AND ISNULL (A.CHA_IN_CESTINO, '0') = '0'
      @dataFrom@
      @dataTo@
      and (EXISTS(SELECT 'x' FROM dpa_doc_arrivo_par  as dp INNER JOIN
      dpa_corr_globali as sim on sim.system_id = dp.id_mitt_dest
      WHERE     a.system_id = dp.id_profile
      AND a.SYSTEM_ID = dp.ID_PROFILE
      AND @simplesearchmittdest@))))
      @fulltext@
      )) as tab
    </value>
  </query>
  <query>
    <name>S_RIC_DOC_SIMPLE_SEARCH</name>
    <value>
      SELECT a.*,
      docsadm.getpeopleuserid (a.author) AS code_author,
      a.ext AS cha_img,
      docsadm.getinadl (a.system_id, 'D', @idGruppo@,  @idPeople@) AS in_adl,
      docsadm.getinadl (a.system_id, 'D', @idGruppo@,  0) AS in_adlrole,
      docsadm.getinconservazione (a.system_id,NULL,'D',@idPeople@,@idGruppo@) AS in_conservazione,
      docsadm.getchafirmato (a.docnumber) AS cha_firmato,
      docsadm.getchatipofirma(a.docnumber) as CHA_TIPO_FIRMA,
      docsadm.corrcat (a.system_id, a.cha_tipo_proto) AS mitt_dest,
      docsadm.gettestoultimanota ('D',a.system_id,@idGruppo@,@idPeople@,@idGruppo@) AS ultima_nota,
      docsadm.getpeoplename (a.author) AS desc_autore,
      docsadm.getdesccorr (a.id_ruolo_creatore) AS desc_ruolo_autore,
      docsadm.getcodruolobyidcorr (a.id_ruolo_creatore) AS cod_ruolo_autore,
      docsadm.getcodreg (a.id_registro) AS cod_registro,
      docsadm.classcat(a.system_id) as COD_FASCICOLI,
      docsadm.getdataarrivodoc (a.docnumber) AS data_arrivo,
      docsadm.getdiagrammistato (a.docnumber, 'D') AS stato,
      docsadm.corrcatbytipo(a.docnumber, a.cha_tipo_proto, 'M') as mittenti,
      docsadm.corrcatbytipo(a.docnumber, a.cha_tipo_proto, 'D') as destinatari,
      docsadm.getEsitoPubblicazione(a.system_id) as pubblicazione,
      docsadm.esisteNotaVisibile('D',a.system_id,@idGruppo@,@idPeople@,@idGruppo@) AS esiste_nota,
      a.cha_cod_t_a,
      docsadm.getImpronta(a.docnumber) as impronta,
      docsadm.getNomeOriginale(a.docnumber) as nome_Originale,
      convert(varchar(10),docsadm.GetDateInADL (a.system_id, 'D', @idGruppo@, @idPeople@),103) AS dta_ins_adl,
      docsadm.getEsitoSpedizione(a.system_id) AS esito_spedizione,
      docsadm.getCountRicevuteInterop(a.system_id, '') AS count_ric_interop
      @contatore@
      @valoriCustom@
      @conservazione@
      @stato_cons@
      FROM (SELECT @index@
      interna.*, ROW_NUMBER() OVER (ORDER BY ISNULL (CONVERT(DATETIME, interna.dta_proto, 103), CONVERT(DATETIME, interna.creation_date,103)) Desc) as ROW
      FROM (SELECT interna2.* FROM (SELECT
      a.system_id, a.docnumber, a.dta_annulla,
      a.var_prof_oggetto AS var_desc_oggetto, a.id_registro,
      a.cha_tipo_proto, a.cha_evidenza, a.num_anno_proto,
      convert (varchar(10), ISNULL (a.dta_proto, a.creation_time), 103) AS DATA,
      convert (varchar(10),a.creation_time, 103) AS creation_date,
      a.num_proto, a.var_segnatura,
      convert (varchar(10),a.dta_proto, 103) AS dta_proto,
      a.cha_privato, a.cha_personale, a.id_documento_principale,
      a.cha_in_archivio, a.id_tipo_atto AS id_tipo_atto,
      ta.var_desc_atto AS desc_tipo_atto,
      a.prot_tit AS prot_tit,
      a.archive_date as dta_archiviazione, a.ID_RUOLO_CREATORE, a.author, a.cha_cod_t_a, a.COD_EXT_APP, a.ext
      FROM PROFILE a WITH(NOLOCK)
      LEFT OUTER JOIN dpa_tipo_atto ta on a.id_tipo_atto = ta.system_id
      WHERE  EXISTS (select  'x' from security e WITH(NOLOCK) where a.system_id=e.thing and e.PERSONORGROUP in (@idPeople@, @idGruppo@) and e.ACCESSRIGHTS&gt;0)
      AND (( @tipiDoc@ )
      AND  ISNULL(A.CHA_IN_CESTINO,'0')='0'
      @dataFrom@
      @dataTo@
      AND (@simplesearchoggetto@))
      union (SELECT
      a.system_id, a.docnumber, a.dta_annulla,
      a.var_prof_oggetto AS var_desc_oggetto, a.id_registro,
      a.cha_tipo_proto, a.cha_evidenza, a.num_anno_proto,
      convert ( varchar(10),ISNULL (a.dta_proto, a.creation_time), 103) AS DATA,
      convert (varchar(10),a.creation_time, 103) AS creation_date,
      a.num_proto, a.var_segnatura,
      convert (varchar(10),a.dta_proto, 103) AS dta_proto,
      a.cha_privato, a.cha_personale, a.id_documento_principale,
      a.cha_in_archivio, a.id_tipo_atto AS id_tipo_atto,
      ta.var_desc_atto AS desc_tipo_atto,
      a.prot_tit AS prot_tit,
      a.archive_date as dta_archiviazione, a.ID_RUOLO_CREATORE, a.author, a.cha_cod_t_a, a.COD_EXT_APP, a.ext
      FROM PROFILE a WITH(NOLOCK)
      LEFT OUTER JOIN dpa_tipo_atto ta on a.id_tipo_atto = ta.system_id
      WHERE  EXISTS (select  'x' from security e WITH(NOLOCK) where a.system_id=e.thing and e.PERSONORGROUP in (@idPeople@, @idGruppo@) and e.ACCESSRIGHTS&gt;0)
      AND (( @tipiDoc@ )
      AND  ISNULL(A.CHA_IN_CESTINO,'0')='0'
      @dataFrom@
      @dataTo@
      AND (a.num_proto=@simplesearchnumber@ ) ) )

      union (SELECT
      a.system_id, a.docnumber, a.dta_annulla,
      a.var_prof_oggetto AS var_desc_oggetto, a.id_registro,
      a.cha_tipo_proto, a.cha_evidenza, a.num_anno_proto,
      convert (varchar(10), ISNULL (a.dta_proto, a.creation_time), 103) AS DATA,
      convert (varchar(10),a.creation_time, 103) AS creation_date,
      a.num_proto, a.var_segnatura,
      convert (varchar(10),a.dta_proto, 103) AS dta_proto,
      a.cha_privato, a.cha_personale, a.id_documento_principale,
      a.cha_in_archivio, a.id_tipo_atto AS id_tipo_atto,
      ta.var_desc_atto AS desc_tipo_atto,
      a.prot_tit AS prot_tit,
      a.archive_date as dta_archiviazione, a.ID_RUOLO_CREATORE, a.author, a.cha_cod_t_a, a.COD_EXT_APP, a.ext
      FROM PROFILE a WITH(NOLOCK)
      LEFT OUTER JOIN dpa_tipo_atto ta on a.id_tipo_atto = ta.system_id
      WHERE  EXISTS (select  'x' from security e WITH(NOLOCK) where a.system_id=e.thing and e.PERSONORGROUP in (@idPeople@, @idGruppo@) and e.ACCESSRIGHTS&gt;0)
      AND (( @tipiDoc@ )
      AND  ISNULL(A.CHA_IN_CESTINO,'0')='0'
      @dataFrom@
      @dataTo@
      AND (  EXISTS (SELECT 'x' FROM dpa_doc_arrivo_par dp, dpa_corr_globali sim
      WHERE a.system_id = dp.id_profile AND sim.system_id = dp.id_mitt_dest
      and a.SYSTEM_ID = dp.ID_PROFILE AND @simplesearchmittdest@)) )
      )
      @fulltext@

      )as interna2  ) as interna ) AS A
      @paging@
    </value>
  </query>
  <query>
    <name>S_GET_COUNT_ITEMS_ESIBIZIONE_CONSERVAZIONE</name>
    <value>
      select ae.cha_stato as stato, ae.cha_certificazione as certificata,
      count(ae.system_id) as totale
      from dpa_area_esibizione ae
      inner join dpa_amministra a on ae.id_amm = a.system_id
      where a.var_codice_amm = '@codiceAmministrazione@'
      --and ae.id_ruolo_in_uo = @idRuoloInUo@
      --and ae.id_people = @idPeople@
      group by ae.cha_stato, ae.cha_certificazione
    </value>
  </query>
  <query>
    <name>D_ELIMINA_ISTANZA_ESIBIZIONE</name>
    <value>
      DELETE FROM dpa_area_esibizione
      WHERE system_id IN (@idEsib@)
    </value>
  </query>
  <query>
    <name>D_ELIMINA_DOC_ISTANZA_ESIBIZIONE</name>
    <value>
      DELETE FROM dpa_items_esibizione
      WHERE id_esibizione IN (@idEsib@)
    </value>
  </query>
  <query>
    <name>S_ESIBIZIONE_GET_ID_CORR_GLOBALI</name>
    <value>
      SELECT system_id
      FROM dpa_corr_globali
      WHERE id_gruppo = @idgruppo@
    </value>
  </query>
  <query>
    <name>I_INST_ACC</name>
    <value>
      INSERT INTO INST_ACC
      VALUES(@value@)
    </value>
  </query>
  <query>
    <name>I_INST_ACC_DOC</name>
    <value>
      INSERT INTO INST_ACC_DOC
      VALUES(@value@)
    </value>
  </query>
  <query>
    <name>I_INST_ACC_ATT</name>
    <value>
      INSERT INTO INST_ACC_ATT
      VALUES(@value@)
    </value>
  </query>
  <query>
    <name>S_INST_ACC_STATE_DOWNLOAD</name>
    <value>
      SELECT cha_stato_download_inoltro AS STATE_DOWNLOAD_FORWARD
      FROM INST_ACC
      WHERE SYSTEM_ID=@idInstanceAccess@
    </value>
  </query>
  <query>
    <name>S_INST_ACC_ID_PROFILE_DOWNLOAD</name>
    <value>
      SELECT id_profile_download AS ID_PROFILE_DOWNLOAD
      FROM INST_ACC
      WHERE SYSTEM_ID=@idInstanceAccess@
    </value>
  </query>
  <query>
    <name>S_INST_ACC</name>
    <value>
      SELECT a.system_id as ID_INSTANCE_ACCESS,
      a.description,
      a.dta_creazione as CREATION_DATE,
      a.dta_chiusura as CLOSE_DATE,
      a.id_people_proprietario as ID_PEOPLE_OWNER,
      a.id_gruppo_proprietario as ID_GROUPS_OWNER,
      a.id_richiedente as ID_RICHIEDENTE,
      a.dta_richiesta as REQUEST_DATE,
      a.id_documento_richiesto as ID_DOCUMENT_REQUEST,
      a.note,
      a.cha_stato_download_inoltro as STATE_DOWNLOAD_FORWARD,
      docsadm.getDescCorr(a.id_richiedente) as DESCRIPTION_RICHIEDENTE,
      c.VAR_COD_RUBRICA as CODICE_RUBRICA
      FROM 	INST_ACC a LEFT OUTER JOIN
      DPA_CORR_GLOBALI c ON c.SYSTEM_ID = a.id_richiedente
      WHERE @condition@
      ORDER BY a.dta_creazione desc
    </value>
  </query>
  <query>
    <name>S_INST_ACC_DOC</name>
    <value>
      SELECT d.system_id as ID_INSTANCE_ACCESS_DOCUMENT,
      d.id_inst_acc as ID_INSTANCE_ACCESS,
      d.docnumber as DOCNUMBER,
      d.id_project as ID_PROJECT,
      d.tipo_richiesta as TYPE_REQUEST,
      p.VAR_PROF_OGGETTO as OBJECT,
      docsadm.getImpronta(d.docnumber) as HASH,
      docsadm.getNomeOriginale(d.docnumber) as FILE_NAME,
      p.cha_tipo_proto as TYPE_PROTO,
      p.num_proto as NUMBER_PROTO,
      docsadm.corrCat(d.docnumber, p.cha_tipo_proto) as MITT_DEST,
      docsadm.Getregdescr(p.id_registro) as REGISTER,
      docsadm.getdesctipodoc(P.id_tipo_atto) as DESCRIPTION_TIPOLOGIA_ATTO,
      docsadm.GETSEGNATURAREPERTORIO(d.docnumber, @idAmm@) as COUNTER_REPERTORY,
      docsadm.getchaimg(d.docnumber) as EXTENSION,
      docsadm.getchafirmato (d.docnumber) AS SIGNED,
      p.id_documento_principale AS ID_DOCUMENTO_PRINCIPALE,
      ISNULL(p.DTA_PROTO,p.CREATION_TIME) AS DATA,
      pr.description as DESCRIPTION_PROJECT,
      pr.ID_FASCICOLO as ID_FASCICOLO,
      pr.ID_PARENT as ID_PARENT,
      docsadm.getCodeProject(pr.system_id) as CODE_PROJECT,
      docsadm.getCodTit2(pr.ID_PARENT) as CODE_CLASSIFICATION,
      d.enable
      FROM 	INST_ACC_DOC d INNER JOIN
      PROFILE p ON p.DOCNUMBER = d.docnumber LEFT OUTER JOIN
      project pr on pr.SYSTEM_ID = d.id_project
      WHERE d.id_inst_acc = @idInstanceAccess@
      ORDER BY d.docnumber desc
    </value>
  </query>
  <query>
    <name>S_INST_ACC_ATT</name>
    <value>
      SELECT a.id_inst_acc_doc as ID_INSTANCE_ACCESS_DOCUMENT,
      a.system_id as SYSTEM_ID,
      a.id_attach as ID_ATTACH,
      docsadm.getNomeOriginale(a.id_attach) as FILE_NAME,
      docsadm.getchaimg(a.id_attach) as EXTENSION,
      a.enable
      FROM INST_ACC_ATT a
      WHERE a.id_inst_acc_doc=@idInstanceAccessDocument@
    </value>
  </query>
  <query>
    <name>S_TEMPLATE_INSTANCE</name>
    <value>
      SELECT *
      FROM DPA_TIPO_ATTO
      WHERE IS_TYPE_INSTANCE='1' AND ID_AMM=@idAmm@
    </value>
  </query>
  <query>
    <name>U_INST_ACC</name>
    <value>
      UPDATE INST_ACC
      SET DESCRIPTION='@description@',
      ID_RICHIEDENTE=@idPeopleRichiedente@,
      DTA_RICHIESTA=@requestDate@,
      ID_DOCUMENTO_RICHIESTO=@idDocumentRequest@,
      NOTE='@note@',
      CHA_STATO_DOWNLOAD_INOLTRO='@stateDownloadForward@'
      WHERE SYSTEM_ID=@idInstanceAccess@
    </value>
  </query>
  <query>
    <name>U_INST_ACC_DOC_ENABLE</name>
    <value>
      UPDATE INST_ACC_DOC
      SET ENABLE='@enable@'
      WHERE SYSTEM_ID=@idInstanceAccessDocument@
    </value>
  </query>
  <query>
    <name>U_INST_ACC_ATT_ENABLE</name>
    <value>
      UPDATE INST_ACC_ATT
      SET ENABLE='@enable@'
      WHERE SYSTEM_ID=@idInstanceAccessAttachments@
    </value>
  </query>
  <query>
    <name>U_INST_ACC_DOC</name>
    <value>
      UPDATE INST_ACC_DOC
      SET TIPO_RICHIESTA='@typeRequest@'
      WHERE SYSTEM_ID=@idInstanceAccessDocument@
    </value>
  </query>
  <query>
    <name>U_INST_ACC_REQUEST_DATE</name>
    <value>
      UPDATE INST_ACC
      SET DTA_CHIUSURA=@closetDate@
      WHERE SYSTEM_ID=@idInstanceAccess@
    </value>
  </query>
  <query>
    <name>D_INST_ACC_DOC</name>
    <value>
      DELETE FROM INST_ACC_DOC
      WHERE SYSTEM_ID = @idInstanceAccessDocument@
    </value>
  </query>
  <query>
    <name>D_INST_ACC_ATT_BY_ID_INST_ACC_DOC</name>
    <value>
      DELETE FROM INST_ACC_ATT
      WHERE ID_INST_ACC_DOC = @idInstanceAccessDocument@
    </value>
  </query>
  <query>
    <name>D_INST_ACC_ATT</name>
    <value>
      DELETE FROM INST_ACC_ATT
      WHERE ID_INST_ACC_DOC = @idInstanceAccessDocument@ AND
      ID_ATTACH = @idAttach@
    </value>
  </query>
  <query>
    <name>S_VERSION_ID_ATTACH</name>
    <value>
      select c.VERSION_ID
      FROM VERSIONS c
      WHERE c.docnumber = @docnumber@
      and c.VERSION IN
      (
      SELECT MAX(VERSION)
      FROM VERSIONS
      WHERE DOCNUMBER = c.docnumber
      )
    </value>
  </query>
  <query>
    <name>U_INST_ACC_DOWNLOAD</name>
    <value>
      UPDATE INST_ACC
      SET CHA_STATO_DOWNLOAD_INOLTRO='@downloadState@'
      WHERE SYSTEM_ID=@idInstanceAccess@
    </value>
  </query>
  <query>
    <name>U_INST_ACC_ID_PROFILE_DOWNLOAD</name>
    <value>
      UPDATE INST_ACC
      SET ID_PROFILE_DOWNLOAD='@idProfileDownload@'
      WHERE SYSTEM_ID=@idInstanceAccess@
    </value>
  </query>
  <query>
    <name>U_DPA_TIPO_ATTO_TYPE_INSTANCE</name>
    <value>
      UPDATE DPA_TIPO_ATTO
      SET IS_TYPE_INSTANCE='@paramIsTypeInstance@'
      WHERE SYSTEM_ID=@idTemplate@ AND ID_AMM=@idAmm@
    </value>
  </query>
  <query>
    <name>U_DPA_TIPO_ATTO_NO_TYPE_INSTANCE</name>
    <value>
      UPDATE DPA_TIPO_ATTO
      SET IS_TYPE_INSTANCE='0'
      WHERE ID_AMM=@idAmm@ AND NOT(SYSTEM_ID=@idTemplate@)
    </value>
  </query>
  <query>
    <name>FIX_PEC4_SPED_IS_AVV_CONSEGNA</name>
    <value>
      UPDATE dpa_stato_invio
      SET status_c_mask = 'ANVAAAN'
      where id_documenttype=(select b.system_id from documenttypes b where b.type_id='SIMPLIFIEDINTEROPERABILITY')
      AND var_proto_dest IS NULL
      AND cha_annullato IS NULL
      AND id_profile = @idDoc@
      AND status_c_mask = 'ANAAAAN'
      AND EXISTS(SELECT * FROM 	dpa_corr_globali E INNER JOIN
      DPA_NOTIFICA C on UPPER(e.var_cod_rubrica) = UPPER(c.var_destinatario) INNER JOIN
      DPA_TIPO_NOTIFICA D on C.id_tipo_notifica = D.system_id
      WHERE dpa_stato_invio.id_profile= c.docnumber
      AND dpa_stato_invio.id_corr_globale = e.system_id
      AND d.var_codice_notifica='avvenuta-consegna')
    </value>
  </query>
  <query>
    <name>FIX_PEC4_SPED_IS_MANCATA_CONSEGNA</name>
    <value>
      UPDATE dpa_stato_invio
      SET status_c_mask='XNXNNNV', CHA_ANNULLATO = 'E', VAR_MOTIVO_ANNULLA='Errore di consegna IS'
      where id_documenttype=(select b.system_id from documenttypes b where b.type_id='SIMPLIFIEDINTEROPERABILITY')
      AND var_proto_dest IS NULL
      AND id_profile = @idDoc@
      AND status_c_mask = 'ANAAAAN'
      AND EXISTS(SELECT * FROM 	dpa_corr_globali E INNER JOIN
      DPA_NOTIFICA C on upper(e.var_cod_rubrica) = upper(c.var_destinatario) INNER JOIN
      DPA_TIPO_NOTIFICA D on C.id_tipo_notifica = D.system_id
      WHERE dpa_stato_invio.id_profile= c.docnumber
      AND dpa_stato_invio.id_corr_globale = e.system_id
      AND d.var_codice_notifica in ('DSN','errore','errore-consegna'))
    </value>
  </query>
  <query>
    <name>U_PROFILE_EXT</name>
    <value>
      UPDATE PROFILE
      SET EXT = @ext@
      WHERE SYSTEM_ID = @docnumber@
    </value>
  </query>
  <query>
    <name>FATT_EL_U_ESITO_NOT</name>
    <value>
      UPDATE DPA_ASSOCIAZIONE_TEMPLATES
      SET VALORE_OGGETTO_DB = '@esito@'
      WHERE DOC_NUMBER= @idDoc@
      AND ID_OGGETTO IN (SELECT SYSTEM_ID FROM DPA_OGGETTI_CUSTOM WHERE DESCRIZIONE ='ESITO NOTIFICA')
    </value>
  </query>
  <query>
    <name>S_DPA_PASSO_DI_FIRMA_SOGGETTO_TITOLARE</name>
    <value>
      SELECT
      pf.ID_PASSO, pf.ID_PROCESSO, pf.NUMERO_SEQUENZA, pf.TIPO_FIRMA, pf.TIPO_EVENTO, pf.NOTE,  pf.SCADENZA, pf.ELIMINATO, pf.TICK,, pf.ID_TIPO_RUOLO_COINVOLTO,
      e.ID_EVENTO, e.VAR_COD_AZIONE, e.CHA_TIPO_EVENTO, e.descrizione, e.gruppo,
      pf.ID_RUOLO_COINVOLTO AS ID_GRUPPO,
      docsadm.GETDESCRUOLO(pf.ID_RUOLO_COINVOLTO) AS Group_Name,
      docsadm.getcodRuolo(pf.ID_RUOLO_COINVOLTO) as Group_Id,
      docsadm.getRuoloSystemIdCorr(pf.ID_RUOLO_COINVOLTO) as Id_Corr,
      pf.ID_UTENTE_COINVOLTO AS ID_UTENTE,
      docsadm.getpeopleuserid(pf.ID_UTENTE_COINVOLTO) AS USER_CODE,
      docsadm.getpeoplename(pf.ID_UTENTE_COINVOLTO) AS USER_DESCRIPTION,
      docsadm.getCorrSystemId(pf.ID_UTENTE_COINVOLTO) AS USER_SYSTEM_ID
      FROM 	DPA_PASSO_DI_FIRMA pf Inner Join
      Dpa_Anagrafica_Eventi E On pf.Tipo_Evento = e.Id_Evento
      WHERE ID_PROCESSO = @idProcessoFirma@
      AND @soggettoTitolare@
      ORDER BY NUMERO_SEQUENZA ASC
    </value>
  </query>
  <query>
    <name>S_DPA_ELEMENTI_LIBRO_FIRMA_COUNT</name>
    <value>
      SELECT COUNT(E.ID_ELEMENTO)
      FROM 	DPA_ELEMENTO_IN_LIBRO_FIRMA E INNER JOIN
      PROFILE P  ON E.DOC_NUMBER = P.SYSTEM_ID
      WHERE E.ID_RUOLO_TITOLARE = @idRuoloTitolare@
      AND (E.ID_UTENTE_TITOLARE  IS NULL
      OR E.ID_UTENTE_TITOLARE     = @idUtenteTitolare@)
      AND (ID_UTENTE_LOCKER IS NULL OR ID_UTENTE_LOCKER = @idUtenteTitolare@) AND DTA_ESECUZIONE IS NULL AND ID_TRASM_SINGOLA IS NOT NULL
      @filtroRicerca@
    </value>
  </query>
  <query>
    <name>S_DPA_ELEMENTI_LIBRO_FIRMA_TO_STATE</name>
    <value>
      SELECT E.ID_ELEMENTO,
      E.ID_RUOLO_TITOLARE,
      E.TIPO_FIRMA,
      E.STATO_FIRMA,
      E.SCADENZA,
      E.UTENTE_PROPONENTE AS ID_UTENTE,
      E.MODALITA,
      E.DATA_INSERIMENTO,
      E.DTA_ACCETTAZIONE,
      E.DOC_NUMBER,
      E.VERSION_ID,
      E.NUM_ALL,
      E.NUM_VERSIONE,
      E.ID_UTENTE_TITOLARE,
      E.ID_UTENTE_LOCKER,
      E.ID_TRASM_SINGOLA,
      E.ISTANZA_PROCESSO,
      E.ID_ISTANZA_PASSO,
      E.ERRORE_FIRMA,
      P.SYSTEM_ID,
      P.VAR_PROF_OGGETTO,
      P.ID_DOCUMENTO_PRINCIPALE,
      e.ruolo_proponente As Id_Gruppo,
      e.note as NOTE,
      IP.MOTIVO_RESPINGIMENTO,
      Components.File_Size
      FROM DPA_ELEMENTO_IN_LIBRO_FIRMA E
      JOIN PROFILE P
      ON E.DOC_NUMBER = P.SYSTEM_ID
      left Join Components
      On E.Version_Id = Components.Version_Id
      LEFT JOIN DPA_ISTANZA_PROCESSO_FIRMA IP ON E.ISTANZA_PROCESSO = IP.ID_ISTANZA
      WHERE E.ID_RUOLO_TITOLARE = @idRuoloTitolare@
      AND (ID_UTENTE_TITOLARE  IS NULL
      OR ID_UTENTE_TITOLARE     = @idUtenteTitolare@)
      AND ID_UTENTE_LOCKER = @idUtenteTitolare@
      AND E.STATO_FIRMA = '@state@'
      ORDER BY E.DATA_INSERIMENTO DESC
    </value>
  </query>
  <query>
    <name>S_DPA_ELEMENTI_LIBRO_FIRMA_BY_TIPE_SIGN</name>
    <value>
      SELECT E.ID_ELEMENTO
      FROM DPA_ELEMENTO_IN_LIBRO_FIRMA E
      WHERE E.ID_RUOLO_TITOLARE = @idRuoloTitolare@
      AND (ID_UTENTE_TITOLARE  IS NULL
      OR ID_UTENTE_TITOLARE     = @idUtenteTitolare@)
      AND ID_UTENTE_LOCKER = @idUtenteTitolare@
      AND E.STATO_FIRMA = '@state@' AND TIPO_FIRMA = '@tipoFirma@'
    </value>
  </query>
  <query>
    <name>S_DPA_ELEMENTI_LIBRO_FIRMA_ID_DOC_BY_SIGN</name>
    <value>
      SELECT E.DOC_NUMBER
      FROM DPA_ELEMENTO_IN_LIBRO_FIRMA E
      WHERE E.ID_RUOLO_TITOLARE = @idRuoloTitolare@
      AND (ID_UTENTE_TITOLARE  IS NULL
      OR ID_UTENTE_TITOLARE     = @idUtenteTitolare@)
      AND ID_UTENTE_LOCKER = @idUtenteTitolare@
      AND E.STATO_FIRMA = '@state@' AND TIPO_FIRMA = '@tipoFirma@'
    </value>
  </query>
  <query>
    <name>S_DPA_ELEMENTI_LIBRO_FIRMA_INTO_PAGE</name>
    <value>
      SELECT x.*
      FROM
      (
      SELECT ROW_NUMBER() OVER(ORDER BY  E.DATA_INSERIMENTO DESC) AS RN,
      E.ID_ELEMENTO,
      E.ID_RUOLO_TITOLARE,
      E.TIPO_FIRMA,
      E.STATO_FIRMA,
      E.SCADENZA,
      E.UTENTE_PROPONENTE AS ID_UTENTE,
      E.MODALITA,
      E.DATA_INSERIMENTO,
      E.DTA_ACCETTAZIONE,
      E.DOC_NUMBER,
      E.VERSION_ID,
      E.NUM_ALL,
      E.NUM_VERSIONE,
      E.ID_UTENTE_TITOLARE,
      E.ID_UTENTE_LOCKER,
      E.ID_TRASM_SINGOLA,
      E.ISTANZA_PROCESSO,
      E.ID_ISTANZA_PASSO,
      E.ERRORE_FIRMA,
      P.SYSTEM_ID,
      P.VAR_PROF_OGGETTO,
      P.NUM_PROTO,
      P.CHA_TIPO_PROTO,
      P.ID_DOCUMENTO_PRINCIPALE,
      docsadm.getObjectMainDoc(p.id_documento_principale) as OBJECT_MAIN_DOCUMENT,
      P.CREATION_TIME,
      P.DTA_PROTO,
      T.VAR_DESC_ATTO,
      docsadm.corrcatbytipo(e.doc_number, P.CHA_TIPO_PROTO, 'D') AS DESC_RECIPIENT,
      e.ruolo_proponente As Id_Gruppo,
      docsadm.GETDESCRUOLO(RUOLO_PROPONENTE) AS Group_Name,
      docsadm.getcodRuolo(RUOLO_PROPONENTE) as Group_Id,
      docsadm.getRuoloSystemIdCorr(RUOLO_PROPONENTE) as Id_Corr,
      docsadm.getpeopleuserid(UTENTE_PROPONENTE) AS USER_CODE,
      docsadm.getpeoplename(UTENTE_PROPONENTE) AS USER_DESCRIPTION,
      docsadm.getCorrSystemId(UTENTE_PROPONENTE) AS USER_SYSTEM_ID,
      e.note as NOTE,
      IP.MOTIVO_RESPINGIMENTO,
      Components.File_Size
      FROM DPA_ELEMENTO_IN_LIBRO_FIRMA E
      JOIN PROFILE P
      ON E.DOC_NUMBER = P.SYSTEM_ID
      left Join Components
      On E.Version_Id = Components.Version_Id
      LEFT JOIN DPA_TIPO_ATTO t
      ON P.ID_TIPO_ATTO         = T.SYSTEM_ID
      LEFT JOIN DPA_ISTANZA_PROCESSO_FIRMA IP ON E.ISTANZA_PROCESSO = IP.ID_ISTANZA
      WHERE E.ID_RUOLO_TITOLARE = @idRuoloTitolare@
      AND (ID_UTENTE_TITOLARE  IS NULL
      OR ID_UTENTE_TITOLARE     = @idUtenteTitolare@)
      AND (ID_UTENTE_LOCKER IS NULL OR ID_UTENTE_LOCKER = @idUtenteTitolare@) AND DTA_ESECUZIONE IS NULL AND E.ID_TRASM_SINGOLA IS NOT NULL
      @filtroRicerca@
      ORDER BY E.DATA_INSERIMENTO DESC
      ) as x
      WHERE x.RN BETWEEN @startRow@ AND @endRow@
    </value>
  </query>
  <query>
    <name>E_ELEMENTO_IN_LF</name>
    <value>
      DELETE FROM DPA_ELEMENTO_IN_LIBRO_FIRMA
      WHERE ISTANZA_PROCESSO = @IdProcesso@
    </value>
  </query>
  <query>
    <name>S_DPA_ISTANZA_PASSO_EXECUTE_OPERATION</name>
    <value>
      SELECT ID_ELEMENTO
      FROM DPA_ELEMENTO_IN_LIBRO_FIRMA E
      WHERE E.DOC_NUMBER      = @docnumber@
      AND E.TIPO_FIRMA         ='@tipoOperazione@'
      AND DTA_ESECUZIONE IS NULL
      AND ID_RUOLO_TITOLARE    = @idRuolo@
      AND (ID_UTENTE_TITOLARE IS NULL
      OR ID_UTENTE_TITOLARE    = @idPeople@)
      AND (ID_UTENTE_LOCKER IS NULL OR ID_UTENTE_LOCKER = @idPeople@)
    </value>
  </query>
  <query>
    <name>S_COUNT_DPA_SCHEMA_PROCESSO_FIRMA_BY_RUOLO_TITOLARE</name>
    <value>
      SELECT COUNT(DISTINCT P.ID_PROCESSO)
      FROM DPA_SCHEMA_PROCESSO_FIRMA P INNER JOIN DPA_PASSO_DI_FIRMA PF ON P.ID_PROCESSO = PF.ID_PROCESSO
      WHERE PF.ID_RUOLO_COINVOLTO = @idRuoloTitolare@
      AND (P.TICK is null Or P.Tick = 0)
    </value>
  </query>
  <query>
    <name>S_DPA_SCHEMA_PROCESSO_FIRMA_BY_UTENTE_TITOLARE</name>
    <value>
      SELECT DISTINCT P.ID_PROCESSO, P.NOME, docsadm.getcodRuolo(P.RUOLO_AUTORE) AS RUOLO_AUTORE
      FROM DPA_SCHEMA_PROCESSO_FIRMA P INNER JOIN DPA_PASSO_DI_FIRMA PF ON P.ID_PROCESSO = PF.ID_PROCESSO
      WHERE PF.Id_Utente_Coinvolto = @idUtenteTitolare@
      @idRuoloCoinvolto@
      ORDER BY P.ID_PROCESSO DESC
    </value>
  </query>
  <query>
    <name>S_COUNT_DPA_SCHEMA_PROCESSO_FIRMA_BY_UTENTE_TITOLARE</name>
    <value>
      SELECT COUNT(DISTINCT P.ID_PROCESSO)
      FROM DPA_SCHEMA_PROCESSO_FIRMA P INNER JOIN DPA_PASSO_DI_FIRMA PF ON P.ID_PROCESSO = PF.ID_PROCESSO
      WHERE PF.Id_Utente_Coinvolto = @idUtenteTitolare@
      @idRuoloCoinvolto@
    </value>
  </query>
  <query>
    <name>S_DPA_ISTANZA_PROCESSO_FIRMA_BY_RUOLO_TITOLARE</name>
    <value>
      Select Distinct P.Id_Istanza, P.Id_Processo, P.Descrizione, P.Attivato_Il,
      P.Concluso_Il, P.Notifica_Concluso, P.Notifica_Interrotto, P.Note, P.Stato,
      P.MOTIVO_RESPINGIMENTO, P.DOC_ALL, P.ID_DOCUMENTO,
      P.ID_RUOLO_PROPONENTE AS ID_GRUPPO,
      --GETDESCRUOLO(P.ID_RUOLO_PROPONENTE) AS Group_Name,
      --getcodRuolo(P.ID_RUOLO_PROPONENTE) as Group_Id,
      --getRuoloSystemIdCorr(P.ID_RUOLO_PROPONENTE) as Id_Corr,
      P.ID_UTENTE_PROPONENTE AS ID_UTENTE
      --getpeopleuserid(P.ID_UTENTE_PROPONENTE) AS USER_CODE,
      --getpeoplename(P.ID_UTENTE_PROPONENTE) AS USER_DESCRIPTION,
      --getCorrSystemId(P.ID_UTENTE_PROPONENTE) AS USER_SYSTEM_ID
      From Dpa_Istanza_Processo_Firma P
      Inner Join Dpa_Istanza_Passo_Firma Pf
      On P.Id_Istanza = Pf.Id_Istanza_Processo
      Where Pf.Id_Ruolo_Coinvolto = @idRuoloTitolare@
      And P.Concluso_Il Is Null And P.Stato = 'IN_EXEC'
    </value>
  </query>
  <query>
    <name>S_COUNT_DPA_ISTANZA_PROCESSO_FIRMA_BY_RUOLO_TITOLARE</name>
    <value>
      Select count(Distinct P.Id_Istanza)
      From Dpa_Istanza_Processo_Firma P
      Inner Join Dpa_Istanza_Passo_Firma Pf
      On P.Id_Istanza = Pf.Id_Istanza_Processo
      Where Pf.Id_Ruolo_Coinvolto = @idRuoloTitolare@
      And P.Concluso_Il Is Null And P.Stato = 'IN_EXEC'
    </value>
  </query>
  <query>
    <name>S_DPA_ISTANZA_PROCESSO_FIRMA_BY_UTENTE_TITOLARE</name>
    <value>
      Select Distinct P.Id_Istanza, P.Id_Processo, P.Descrizione, P.Attivato_Il,
      P.Concluso_Il, P.Notifica_Concluso, P.Notifica_Interrotto, P.Note, P.Stato,
      P.MOTIVO_RESPINGIMENTO, P.DOC_ALL, P.ID_DOCUMENTO,
      P.ID_RUOLO_PROPONENTE AS ID_GRUPPO,
      --GETDESCRUOLO(P.ID_RUOLO_PROPONENTE) AS Group_Name,
      --getcodRuolo(P.ID_RUOLO_PROPONENTE) as Group_Id,
      --getRuoloSystemIdCorr(P.ID_RUOLO_PROPONENTE) as Id_Corr,
      P.ID_UTENTE_PROPONENTE AS ID_UTENTE
      --getpeopleuserid(P.ID_UTENTE_PROPONENTE) AS USER_CODE,
      --getpeoplename(P.ID_UTENTE_PROPONENTE) AS USER_DESCRIPTION,
      --getCorrSystemId(P.ID_UTENTE_PROPONENTE) AS USER_SYSTEM_ID
      From Dpa_Istanza_Processo_Firma P
      Inner Join Dpa_Istanza_Passo_Firma Pf
      On P.Id_Istanza = Pf.Id_Istanza_Processo
      Where Pf.Id_Utente_Coinvolto = @idUtenteTitolare@
      @idRuoloCoinvolto@
      And P.Concluso_Il Is Null And P.Stato = 'IN_EXEC'
    </value>
  </query>
  <query>
    <name>S_COUNT_DPA_ISTANZA_PROCESSO_FIRMA_BY_UTENTE_TITOLARE</name>
    <value>
      Select COUNT(Distinct P.Id_Istanza)
      From Dpa_Istanza_Processo_Firma P
      Inner Join Dpa_Istanza_Passo_Firma Pf
      On P.Id_Istanza = Pf.Id_Istanza_Processo
      Where Pf.Id_Utente_Coinvolto = @idUtenteTitolare@
      And P.Concluso_Il Is Null And P.Stato = 'IN_EXEC'
      @idRuoloCoinvolto@
    </value>
  </query>
  <query>
    <name>U_DPA_PASSO_TICK</name>
    <value>
      Update DPA_PASSO_DI_FIRMA Set TICK = '@tipoTick@'
      WHERE ID_PASSO IN (@idPassi@)
    </value>
  </query>
  <query>
    <name>U_DPA_PROCESSO_TICK</name>
    <value>
      Update DPA_SCHEMA_PROCESSO_FIRMA Set TICK = 1
      WHERE ID_PROCESSO IN (Select Id_Processo from Dpa_Passo_Di_Firma Where Id_Passo in (@idPassi@))
    </value>
  </query>
  <query>
    <name>S_INTEROP_ENABLED_SAVE_MAIL</name>
    <value>
      SELECT cha_salva_mail_loc
      FROM dpa_mail_registri
      WHERE id_registro=@idReg@
    </value>
  </query>
  <query>
    <name>U_EXT_PROFILE</name>
    <value>
      UPDATE PROFILE
      SET EXT = docsadm.GETCHAIMG(@docnumber@)
      WHERE DOCNUMBER = @docnumber@
    </value>
  </query>
  <!-- BIG FILE-->
  <!-- UPLOAD FILE-->
  <query>
    <name>S_DPA_UPLOAD_FILE</name>
    <value>
      Select Id_People, Id_Ruolo
      ,File_Hash
      ,Sender_Name
      ,Sender_Path
      ,File_Name
      ,File_Description
      ,File_Size
      ,File_Part
      ,Total_Part
      ,File_Path
      ,Start_Date
      ,Num_Order
      ,End_Date
      ,UnicStr
      From Dpa_Upload_File
      Where Id_People = @IdUtente@ AND UnicStr = '@identity@'
      --File_Name = '@fileName@' AND File_Description = '@fileDescription@'
      --AND File_Hash = '@fileHash@'
    </value>
  </query>
  <query>
    <name>S_DPA_UPLOAD_FILE_LIST</name>
    <value>
      Select Id_People, Id_Ruolo
      ,File_Hash,Sender_Name,Sender_Path,File_Name,File_Description
      ,File_Size,File_Part,Total_Part,File_Path
      ,Start_Date,Num_Order,End_Date, UnicStr
      From Dpa_Upload_File
      Where Id_People = @IdUtente@
      AND Sender_Name = '@MachineName@'
      And End_Date Is Null
      ORDER BY Num_Order
    </value>
  </query>
  <query>
    <name>I_DPA_UPLOAD_FILE</name>
    <value>
      INSERT INTO Dpa_Upload_File (Id_People, Id_Ruolo
      ,File_Hash
      ,Sender_Name
      ,Sender_Path
      ,File_Name
      ,File_Description
      ,File_Size
      ,File_Part
      ,Total_Part
      ,File_Path
      ,Num_Order
      ,Start_Date
      ,UnicStr)
      Values (@Id_People@
      ,@Id_Ruolo@
      ,'@File_Hash@'
      ,'@Sender_Name@'
      ,'@Sender_Path@'
      ,'@File_Name@'
      ,'@File_Description@'
      ,@File_Size@
      ,@File_Part@
      ,@Total_Part@
      ,'@File_Path@'
      ,@Ordine@
      ,GetDate()
      ,'@identity@')
    </value>
  </query>
  <query>
    <name>U_DPA_UPLOAD_FILE</name>
    <value>
      Update Dpa_Upload_File
      Set ID_RUOLO=@IdRuolo@, File_Name = '@File_Name@', File_Part = @File_Part@, NUM_ORDER=@Ordine@,
      Total_Part=@TotalChunk@, File_Path='@File_Path@', End_Date = @End_Date@, File_Description = '@File_Description@'
      Where Id_People = @IdUtente@ AND UnicStr = '@identity@'
      --AND File_Hash = '@fileHash@'
    </value>
  </query>
  <query>
    <name>D_DPA_UPLOAD_FILE</name>
    <value>
      DELETE Dpa_Upload_File
      Where Id_People = @IdUtente@ AND File_Name = '@fileName@' AND File_Description = '@fileDescription@'
      --AND File_Hash = '@fileHash@'
    </value>
  </query>
  <query>
    <name>S_DPA_BIGFILE_LIST</name>
    <value>
      Select Id_People ,Id_Ruolo ,File_Hash ,Sender_Name
      ,Sender_Path ,File_Name , File_Description, File_Size ,File_Part
      ,Total_Part ,File_Path ,Start_Date ,Num_Order ,End_Date, UnicStr
      From Dpa_Upload_File
      Where Id_People = @IdUtente@
      OR Id_Ruolo = @IdRuolo@
      ORDER BY Start_Date desc
    </value>
  </query>
  <!-- FINE GESTIONE FILE WA-->
  <!-- FINE BIG FILE-->
  <query>
    <name>S_DPA_LOG_BY_ID_OGGETTO_COD_AZIONE</name>
    <value>
      SELECT TOP 1 SYSTEM_ID
      FROM
      (SELECT SYSTEM_ID FROM DPA_LOG WHERE ID_OGGETTO = @param1@ AND VAR_COD_AZIONE = '@param2@'
      UNION
      SELECT SYSTEM_ID FROM DPA_LOG_STORICO WHERE ID_OGGETTO = @param1@ AND VAR_COD_AZIONE = '@param2@'
      ) AS TEMP
    </value>
  </query>
  <query>
    <name>U_PROFILE_CHA_IN_CESTINO_DOC</name>
    <value>
      UPDATE PROFILE
      SET CHA_IN_CESTINO = '1'
      WHERE @docnumber@
    </value>
  </query>
  <query>
    <name>S_PROFILE_ATTACHMENTS</name>
    <value>
      select docnumber
      from profile
      where id_documento_principale = @docnumber@
    </value>
  </query>
  <query>
    <name>U_PROFILE_LAST_EDIT_DATE</name>
    <value>
      UPDATE PROFILE
      SET LAST_EDIT_DATE= GETDATE()
      WHERE SYSTEM_ID = @docnumber@
      OR SYSTEM_ID = (SELECT ID_DOCUMENTO_PRINCIPALE FROM PROFILE WITH(NOLOCK) WHERE SYSTEM_ID = @docnumber@)
    </value>
  </query>
  <!--  TASK -->
  <query>
    <name>I_DPA_TASK</name>
    <value>
      INSERT INTO DPA_TASK
      (
      ID_RUOLO_MITT,
      ID_PEOPLE_MITT,
      ID_RUOLO_RECEIVER,
      ID_PEOPLE_RECEIVER,
      ID_PROFILE,
      ID_PROJECT,
      ID_TRASMISSIONE,
      ID_TRASM_SINGOLA,
      ID_RAGIONE_TRASM,
      ID_TIPO_ATTO,
      CHA_CONTRIBUTO
      )
      SELECT
      @idRuoloMtt@,
      @idUtenteMitt@,
      @idRuoloDest@,
      @idUtenteDest@,
      @idProfile@,
      @idProject@,
      @idTrasmissione@,
      @idTrasmSingola@,
      @idRagioneTrasm@,
      R.ID_TIPO_ATTO,
      R.CHA_CONTRIBUTO_OBBLIGATORIO
      FROM DPA_TIPO_RAGIONE R
      WHERE R.ID_RAGIONE_TRASM = @idRagioneTrasm@
    </value>
  </query>
  <query>
    <name>I_DPA_STATO_TASK</name>
    <value>
      INSERT INTO DPA_STATO_TASK
      (
      ID_TASK,
      DTA_APERTURA,
      DTA_SCADENZA,
      CHA_STATO,
      NOTE_RIAPERTURA
      )
      VALUES
      (
      @idTask@,
      @dataApertura@,
      @dataScadenza@,
      '@stato@',
      '@noteRiapertura@'
      )
    </value>
  </query>
  <query>
    <name>S_DPA_TASK_BY_ID_TRASM_SINGOLA</name>
    <value>
      SELECT
      T.SYSTEM_ID AS ID_TASK, T.ID_PROFILE, T.ID_PROJECT, T.ID_TRASMISSIONE,
      T.ID_TRASM_SINGOLA, T.ID_RAGIONE_TRASM, T.ID_PROFILE_REVIEW, T.ID_TIPO_ATTO, T.CHA_CONTRIBUTO,
      T.ID_RUOLO_MITT AS ID_GRUPPO,
      S.SYSTEM_ID AS ID_STATO_TASK, S.DTA_SCADENZA, S.DTA_APERTURA, S.DTA_ANNULLAMENTO, S.DTA_LAVORAZIONE, S.DTA_CHIUSURA, S.NOTE_LAVORAZIONE, S.NOTE_RIAPERTURA, S.CHA_STATO,
      docsadm.GETDESCRUOLO(T.ID_RUOLO_MITT) AS GROUP_NAME,
      docsadm.getcodRuolo(T.ID_RUOLO_MITT) as GROUP_ID,
      T.ID_PEOPLE_MITT AS ID_UTENTE,
      docsadm.getpeopleuserid(T.ID_PEOPLE_MITT) AS USER_CODE,
      docsadm.getpeoplename(T.ID_PEOPLE_MITT) AS USER_DESCRIPTION,
      docsadm.getCorrSystemId(T.ID_PEOPLE_MITT) AS USER_SYSTEM_ID,
      CASE WHEN T.ID_PROJECT IS NULL THEN docsadm.getObjectMainDoc(T.ID_PROFILE) ELSE (SELECT DESCRIPTION FROM PROJECT P WHERE P.SYSTEM_ID = T.ID_PROJECT) END AS DESCRIPTION_OBJECT,
      CASE WHEN T.ID_PROFILE IS NULL THEN docsadm.GETCODFASC(T.ID_PROJECT) END AS COD_PROJECT
      FROM DPA_TASK T, DPA_STATO_TASK S
      WHERE T.ID_TRASM_SINGOLA = @idTrasmSingola@
      AND S.SYSTEM_ID = (SELECT MAX(SYSTEM_ID) FROM DPA_STATO_TASK WHERE ID_TASK = T.SYSTEM_ID)
      AND CHA_STATO IN ('A', 'L', 'R')
    </value>
  </query>
  <query>
    <name>S_DPA_TASK_RICEVUTI</name>
    <value>
      SELECT
      T.SYSTEM_ID AS ID_TASK, T.ID_PROFILE, T.ID_PROJECT, T.ID_TRASMISSIONE,
      T.ID_TRASM_SINGOLA, T.ID_RAGIONE_TRASM, T.ID_PROFILE_REVIEW, T.ID_TIPO_ATTO, T.CHA_CONTRIBUTO,
      T.ID_RUOLO_MITT AS ID_GRUPPO, R.VAR_DESC_RAGIONE,
      S.SYSTEM_ID AS ID_STATO_TASK, S.DTA_SCADENZA, S.DTA_APERTURA, S.DTA_ANNULLAMENTO, S.DTA_LAVORAZIONE, S.DTA_CHIUSURA, S.NOTE_LAVORAZIONE, S.NOTE_RIAPERTURA, S.CHA_STATO,
      @dbuser@.GETDESCRUOLO(T.ID_RUOLO_MITT) AS GROUP_NAME,
      @dbuser@.getcodRuolo(T.ID_RUOLO_MITT) as GROUP_ID,
      T.ID_PEOPLE_MITT AS ID_UTENTE,
      @dbuser@.getpeopleuserid(T.ID_PEOPLE_MITT) AS USER_CODE,
      @dbuser@.getpeoplename(T.ID_PEOPLE_MITT) AS USER_DESCRIPTION,
      @dbuser@.getCorrSystemId(T.ID_PEOPLE_MITT) AS USER_SYSTEM_ID,
      CASE WHEN T.ID_PROJECT IS NULL THEN @dbuser@.getObjectMainDoc(T.ID_PROFILE) ELSE (SELECT DESCRIPTION FROM PROJECT P WHERE P.SYSTEM_ID = T.ID_PROJECT) END AS DESCRIPTION_OBJECT,
      CASE WHEN T.ID_PROFILE IS NULL THEN @dbuser@.GETCODEPROJECT(T.ID_PROJECT) END AS COD_PROJECT
      FROM DPA_TASK T, DPA_RAGIONE_TRASM R, DPA_STATO_TASK S
      WHERE ID_RUOLO_RECEIVER = @idRuolo@ AND ID_PEOPLE_RECEIVER = @idUtente@ AND R.SYSTEM_ID = T.ID_RAGIONE_TRASM
      AND S.SYSTEM_ID = (SELECT MAX(SYSTEM_ID) FROM DPA_STATO_TASK WHERE ID_TASK = T.SYSTEM_ID)
      @filterLavorazione@
      order by S.DTA_APERTURA desc
    </value>
  </query>
  <query>
    <name>S_DPA_TASK_ASSEGNATI</name>
    <value>
      SELECT
      T.SYSTEM_ID AS ID_TASK, T.ID_PROFILE, T.ID_PROJECT, T.ID_TRASMISSIONE,
      T.ID_TRASM_SINGOLA, T.ID_RAGIONE_TRASM, T.ID_PROFILE_REVIEW, T.ID_TIPO_ATTO, T.CHA_CONTRIBUTO,
      T.ID_RUOLO_RECEIVER As ID_GRUPPO,R.VAR_DESC_RAGIONE,
      S.SYSTEM_ID AS ID_STATO_TASK, S.DTA_SCADENZA, S.DTA_APERTURA, S.DTA_ANNULLAMENTO, S.DTA_LAVORAZIONE, S.DTA_CHIUSURA, S.NOTE_LAVORAZIONE, S.NOTE_RIAPERTURA, S.CHA_STATO,
      @dbuser@.GETDESCRUOLO(T.ID_RUOLO_RECEIVER) AS GROUP_NAME,
      @dbuser@.getcodRuolo(T.ID_RUOLO_RECEIVER) as GROUP_ID,
      T.ID_PEOPLE_RECEIVER AS ID_UTENTE,
      @dbuser@.getpeopleuserid(T.ID_PEOPLE_RECEIVER) AS USER_CODE,
      @dbuser@.getpeoplename(T.ID_PEOPLE_RECEIVER) AS USER_DESCRIPTION,
      CASE WHEN T.ID_PROJECT IS NULL THEN @dbuser@.getObjectMainDoc(T.ID_PROFILE) ELSE (SELECT DESCRIPTION FROM PROJECT P WHERE P.SYSTEM_ID = T.ID_PROJECT) END AS DESCRIPTION_OBJECT,
      CASE WHEN T.ID_PROFILE IS NULL THEN @dbuser@.GETCODEPROJECT(T.ID_PROJECT) END AS COD_PROJECT
      FROM DPA_TASK T, DPA_RAGIONE_TRASM R, DPA_STATO_TASK S
      WHERE ID_RUOLO_MITT = @idRuolo@ AND ID_PEOPLE_MITT = @idUtente@ and R.SYSTEM_ID=T.ID_RAGIONE_TRASM
      AND S.SYSTEM_ID = (SELECT MAX(SYSTEM_ID) FROM DPA_STATO_TASK WHERE ID_TASK = T.SYSTEM_ID)
      AND CHA_STATO IN ('A', 'L', 'R')
      order by S.DTA_APERTURA desc
    </value>
  </query>
  <query>
    <name>D_DPA_TASK</name>
    <value>
      DELETE FROM DPA_TASK
      WHERE SYSTEM_ID = @idTask@
    </value>
  </query>
  <query>
    <name>U_DPA_STATO_TASK_CHIUDI_LAVORAZIONE</name>
    <value>
      UPDATE DPA_STATO_TASK
      SET DTA_LAVORAZIONE = @dataLavorazione@, CHA_STATO = 'L', NOTE_LAVORAZIONE= '@noteLavorazione@'
      WHERE SYSTEM_ID = @idStatoTask@
    </value>
  </query>
  <query>
    <name>U_DPA_STATO_TASK_DTA_CHIUSURA</name>
    <value>
      UPDATE DPA_STATO_TASK
      SET DTA_CHIUSURA = @dataChiusura@, CHA_STATO = 'C'
      WHERE SYSTEM_ID = @idStatoTask@
    </value>
  </query>
  <query>
    <name>U_DPA_STATO_TASK_DTA_ANNULLAMENTO</name>
    <value>
      UPDATE DPA_STATO_TASK
      SET DTA_ANNULLAMENTO = @dataAnnullamento@, CHA_STATO = 'C'
      WHERE SYSTEM_ID = @idStatoTask@
    </value>
  </query>
  <query>
    <name>U_DPA_TASK_ID_PROFILE_REVIEW</name>
    <value>
      UPDATE DPA_TASK
      SET ID_PROFILE_REVIEW = @docnumber@
      WHERE SYSTEM_ID = @idTask@
    </value>
  </query>
  <query>
    <name>U_DPA_TASK_ID_ID_PROFILE_REVIEW</name>
    <value>
      UPDATE DPA_TASK
      SET ID_PROFILE_REVIEW = null
      WHERE SYSTEM_ID = @idTask@
    </value>
  </query>
  <query>
    <name>U_PROFILE_TASK_STATUS</name>
    <value>
      UPDATE PROFILE
      SET CHA_TASK_STATUS='@status@'
      WHERE SYSTEM_ID=@idProfile@
    </value>
  </query>
  <query>
    <name>U_DPA_TRASM_UTENTE_NOTE</name>
    <value>
      UPDATE DPA_TRASM_UTENTE
      SET VAR_NOTE_ACC = '@note@' + VAR_NOTE_ACC
      WHERE ID_TRASM_SINGOLA = @idTrasmSingola@ AND ID_PEOPLE = @idPeople@
    </value>
  </query>
  <query>
    <name>S_DPA_TIPO_RAGIONE</name>
    <value>
      SELECT CHA_TIPO_TASK
      FROM DPA_TIPO_RAGIONE
      WHERE ID_RAGIONE_TRASM= @idRagione@
    </value>
  </query>
  <query>
    <name>S_DPA_RAGIONE_TRASM_BY_SYSTEM_ID</name>
    <value>
      SELECT *
      FROM DPA_RAGIONE_TRASM
      WHERE SYSTEM_ID = @idRagione@ and ID_AMM = @idAmm@
    </value>
  </query>
  <query>
    <name>AMM_I_INSERT_DPA_TIPO_RAGIONE</name>
    <value>
      INSERT INTO DPA_TIPO_RAGIONE
      (
      ID_RAGIONE_TRASM,
      CHA_TIPO_TASK,
      ID_TIPO_ATTO,
      CHA_CONTRIBUTO_OBBLIGATORIO
      )
      SELECT
      R.SYSTEM_ID,
      '@chaTipoTask@',
      @idTipoAtto@,
      '@chaContributoObbligatorio@'
      FROM DPA_RAGIONE_TRASM R
      WHERE VAR_DESC_RAGIONE='@codice@' and ID_AMM=@idAmm@
    </value>
  </query>
  <query>
    <name>AMM_U_DPA_TIPO_RAGIONE</name>
    <value>
      UPDATE DPA_TIPO_RAGIONE
      SET CHA_TIPO_TASK = '@chaTipoTask@', ID_TIPO_ATTO = @idTipoAtto@, CHA_CONTRIBUTO_OBBLIGATORIO = '@chaContributoObbligatorio@'
      WHERE ID_RAGIONE_TRASM = @idRagione@
    </value>
  </query>
  <!--  FINE TASK -->
  <query>
    <name>S_DPA_NOTIFY_PAGE</name>
    <value>
      SELECT *
      FROM
      (
      SELECT ROW_NUMBER() OVER(ORDER BY DTA_EVENT DESC) AS RN, system_id as ID_NOTIFY,
      id_event,
      desc_producer as PRODUCER,
      id_people_receiver as ID_PEOPLE,
      id_group_receiver as ID_GROUP,
      type_notify as TYPE_NOTIFICATION,
      dta_notify,
      field_1 as ITEM1,
      field_2 as ITEM2,
      field_3 as ITEM3,
      field_4 as ITEM4,
      multiplicity,
      specialized_field as ITEM_SPECIALIZED,
      type_event,
      domainobject,
      id_object,
      id_specialized_object,
      dta_event,
      read_notification,
      color,
      notes,
      docsadm.getchaimg(id_object) as EXTENSION,
      docsadm.getchafirmato(id_object) as SIGNED
      FROM DPA_NOTIFY
      WHERE ID_PEOPLE_RECEIVER = @idPeople@ AND (ID_GROUP_RECEIVER = @idGruppo@ OR ID_GROUP_RECEIVER = 0)
      ORDER BY DTA_EVENT desc
      )
      WHERE RN BETWEEN @startRow@ AND @endRow@
    </value>
  </query>
  <query>
    <name>S_DPA_NOTIFY_COUNT</name>
    <value>
      SELECT COUNT(SYSTEM_ID)
      FROM DPA_NOTIFY
      WHERE ID_PEOPLE_RECEIVER = @idPeople@ AND (ID_GROUP_RECEIVER = @idGruppo@ OR ID_GROUP_RECEIVER = 0)
    </value>
  </query>
  <query>
    <name>S_SIMPINTEROPRECEIVEDMESSAGE_BY_ID_PROFILE</name>
    <value>
      Select
      SenderAdministrationCode AS SENDER_ADMINISTRATION_CODE,
      AOOCode AS SENDER_AOO_CODE,
      RecordNumber AS SENDER_RECORD_NUMBER,
      RecordDate AS SENDER_RECORD_DATE,
      SenderUrl AS SENDER_URL,
      ReceiverCode AS RECEIVER_CODE
      From SimpInteropReceivedMessage
      Where ProfileId = @idProfile@
    </value>
  </query>
  <query>
    <name>S_PROFILE_RECEIVER_INFO</name>
    <value>
      SELECT (SELECT VAR_CODICE FROM DPA_EL_REGISTRI WHERE SYSTEM_ID = ID_REGISTRO) AS RECEIVER_AOO_CODE,
      NUM_PROTO AS RECEIVER_RECORD_NUMBER,
      DTA_PROTO AS RECEIVER_RECORD_DATE,
      (SELECT VAR_CODICE_AMM FROM DPA_AMMINISTRA WHERE SYSTEM_ID = (SELECT ID_AMM FROM DPA_CORR_GLOBALI WHERE SYSTEM_ID = ID_UO_PROT)) as RECEIVER_ADMINISTRATOR_CODE
      FROM PROFILE
      Where System_id = @idProfile@
    </value>
  </query>
  <!--  INIZIO DESKTOPAPPS -->
  <query>
    <name>S_DPA_DESKTOP_APPS</name>
    <value>
      SELECT NOME ,VERSIONE, PATH, DESCRIZIONE
      FROM DPA_DESKTOP_APPS
    </value>
  </query>
  <query>
    <name>I_DPA_DESKTOP_APPS</name>
    <value>
      INSERT INTO DPA_DESKTOP_APPS
      (NOME,VERSIONE,PATH,DESCRIZIONE)
      VALUES
      ('@nome@','@versione@','@path@','@descrizione@')
    </value>
  </query>
  <query>
    <name>U_DPA_DESKTOP_APP</name>
    <value>
      UPDATE DPA_DESKTOP_APPS @parametri@
      WHERE NOME = '@nome@'
    </value>
  </query>
  <query>
    <name>D_DPA_DESKTOP_APP</name>
    <value>
      DELETE FROM DPA_DESKTOP_APPS
      WHERE NAME = '@nome@'
    </value>
  </query>
  <!--  FINE DESKTOPAPPS -->
  <query>
    <name>S_SELECT_ISTANZA_STATO_DA_STATO</name>
    <value>
      SELECT * FROM DPA_AREA_CONSERVAZIONE WHERE CHA_STATO = '@cha_stato@'
    </value>
  </query>
  <query>
    <name>S_DPA_HSMPIN</name>
    <value>
      SELECT PIN, ALIAS
      FROM DPA_HSMPIN
      WHERE PEOPLE_SYSTEM_ID = @idPeople@
      AND ID_AMM = @idAmministrazione@
    </value>
  </query>
  <query>
    <name>I_DPA_HSMPIN</name>
    <value>
      INSERT INTO DPA_HSMPIN (PEOPLE_SYSTEM_ID, ID_AMM, PIN, ALIAS)
      VALUES (@idPeople@, @idAmministrazione@, '@pin@', '@alias@')
    </value>
  </query>
  <query>
    <name>U_DPA_HSMPIN</name>
    <value>
      UPDATE DPA_HSMPIN SET PIN = '@pin@', ALIAS = '@alias@'
      WHERE PEOPLE_SYSTEM_ID = @idPeople@ AND ID_AMM = @idAmministrazione@
    </value>
  </query>
  <query>
    <name>D_DPA_HSMPIN</name>
    <value>
      DELETE FROM DPA_HSMPIN
      WHERE PEOPLE_SYSTEM_ID = @idPeople@ AND ID_AMM = @idAmministrazione@
    </value>
  </query>
  <query>
    <name>S_DPA_HSMPARAMETERS</name>
    <value>
      SELECT ID_AMM, DOMINIO, TSAURL, TSAUSER, TSAPASSWORD, USERAPPLICATIVA, PASSWORDAPPLICATIVA, SERVERURL
      FROM DPA_HSMPARAMETERS
      WHERE ID_AMM = @idAmministrazione@
    </value>
  </query>
  <query>
    <name>I_DPA_HSMPARAMETERS</name>
    <value>
      INSERT INTO DPA_HSMPARAMETERS (ID_AMM, DOMINIO, TSAURL, TSAUSER, TSAPASSWORD, USERAPPLICATIVA, PASSWORDAPPLICATIVA, SERVERURL)
      VALUES(@idAmministrazione@, '@dominio@', '@tsaurl@', '@tsauser@', '@tsapassword@', '@userapplicativa@', '@passwordapplicativa@', '@serverurl@')
    </value>
  </query>
  <query>
    <name>U_DPA_HSMPARAMETERS</name>
    <value>
      UPDATE DPA_HSMPARAMETERS SET
      DOMINIO = '@dominio@',
      TSAURL = '@tsaurl@',
      TSAUSER = '@tsauser@',
      TSAPASSWORD = '@tsapassword@',
      USERAPPLICATIVA = '@userapplicativa@',
      PASSWORDAPPLICATIVA = '@passwordapplicativa@',
      SERVERURL = '@serverurl@'
      WHERE ID_AMM = @idAmministrazione@
    </value>
  </query>
  <query>
    <name>D_DPA_HSMPARAMETERS</name>
    <value>
      DELETE FROM DPA_HSMPARAMETERS
      WHERE ID_AMM = @idAmministrazione@
    </value>
  </query>
  <!--  INIZIO FASCICOLAZIONE OBBLIGATORIA TIPI DOC -->
  <query>
    <name>S_DPA_CLASSIFICAZIONE_TIPI_DOC</name>
    <value>
      SELECT *
      FROM DPA_CLASSIFICAZIONE_TIPI_DOC
      WHERE ID_AMM = @idAmm@
    </value>
  </query>
  <query>
    <name>U_DPA_CLASSIFICAZIONE_TIPI_DOC</name>
    <value>
      UPDATE DPA_CLASSIFICAZIONE_TIPI_DOC
      SET CHA_FASC_OBBLIGATORIA = '@chaFascObbligatoria@'
      WHERE ID_AMM = @idAmm@ AND TIPO_DOC = '@tipoDoc@'
    </value>
  </query>
  <query>
    <name>I_DPA_CLASSIFICAZIONE_TIPI_DOC</name>
    <value>
      INSERT INTO DPA_CLASSIFICAZIONE_TIPI_DOC
      (
      ID_AMM,
      TIPO_DOC,
      CHA_FASC_OBBLIGATORIA
      )
      VALUES
      (
      @idAmm@,
      '@tipoDoc@',
      '@chaFascObbligatoria@'
      )
    </value>
  </query>
  <!--  FINE FASCICOLAZIONE OBBLIGATORIA TIPI DOC  -->
  <!-- STRUTTURE SOTTOFASCICOLI -->
  <query>
    <name>S_STRUTTURE_SOTTOFASCICOLI</name>
    <value>
      SELECT SYSTEM_ID,NAME FROM PROJECT_TEMPLATE
      WHERE ID_AMM = @idAmm@
    </value>
  </query>
  <query>
    <name>D_STRUTTURE_TEMPLATE</name>
    <value>
      DELETE FROM PROJECT_TEMPLATE WHERE SYSTEM_ID = @SystemId@
    </value>
  </query>
  <query>
    <name>U_STRUTTURE_TEMPLATE</name>
    <value>
      UPDATE PROJECT_TEMPLATE SET NAME = '@NAME@' WHERE SYSTEM_ID = @ID@
    </value>
  </query>
  <query>
    <name>U_NODI_STRUTTURA</name>
    <value>
      UPDATE PROJECT_STRUCTURE SET ID_PARENT = @IdParent@, NAME = '@Name@', ID_TEMPLATE = @IdTemplate@
      WHERE SYSTEM_ID = @SystemId@
    </value>
  </query>
  <query>
    <name>D_NODI_STRUTTURA</name>
    <value>
      DELETE FROM PROJECT_STRUCTURE WHERE SYSTEM_ID = @SystemId@
    </value>
  </query>
  <query>
    <name>I_REL_PROJECT_STRUCTURE</name>
    <value>
      INSERT INTO REL_PROJECT_STRUCTURE
      (ID_TIPO_FASCICOLO,ID_TITOLARIO,ID_TEMPLATE)
      VALUES
      (@ID_TIPO_FASCICOLO@,@ID_TITOLARIO@,@ID_TEMPLATE@)
    </value>
  </query>
  <query>
    <name>S_TIPO_FASCICOLO</name>
    <value>
      SELECT b.SYSTEM_ID, DESCRIPTION
      FROM PROJECT a JOIN DPA_TIPO_FASC b ON (a.ID_TIPO_FASC = b.SYSTEM_ID)
      WHERE a.SYSTEM_ID = @ID_FASCICOLO@
    </value>
  </query>
  <query>
    <name>S_NODO_IN_FASCICOLI</name>
    <value>
      select count(*) from project where ID_PARENT IN
      (
      select system_id
      from project
      where
      cha_tipo_proj = 'C'
      and description = '@NODE_NAME@'
      and
      ( id_fascicolo IN (select system_id from project where cha_tipo_proj = 'F' and cha_stato != 'C' and id_tipo_fasc in (
      select id_tipo_fascicolo from rel_project_structure where id_template = @ID_TEMPLATE@ and id_tipo_fascicolo is not null))
      or
      id_fascicolo IN (select system_id from project where cha_tipo_proj = 'F' and cha_stato != 'C' and id_parent in (
      select id_titolario from rel_project_structure where id_template = @ID_TEMPLATE@ and id_titolario is not null))
      ))
      @PARAM1@
    </value>
  </query>
  <query>
    <name>S_FOLDERTEMPLATE_IN_FASCICOLI</name>
    <value>
      SELECT
      system_id AS ID_FOLDER,
      id_parent AS ID_PARENT_FOLDER,
      id_fascicolo AS ID_FASCICOLO,
      description AS FOLDER_DESCRIPTION,
      cha_tipo_fascicolo,
      dta_apertura AS APERTURA
      FROM project
      WHERE
      cha_tipo_proj = 'C' AND
      description = '@NAME@'
      AND
      ( id_fascicolo IN (select system_id from project where cha_tipo_proj = 'F' and cha_stato != 'C' and id_tipo_fasc in (
      select id_tipo_fascicolo from rel_project_structure where id_template = @ID_TEMPLATE@ and id_tipo_fascicolo is not null))
      or
      id_fascicolo IN (select system_id from project where cha_tipo_proj = 'F' and cha_stato != 'C' and id_parent in (
      select id_titolario from rel_project_structure where id_template = @ID_TEMPLATE@ and id_titolario is not null))
      )
      @PARAM1@
    </value>
  </query>
  <query>
    <name>S_ROOTFOLDER_IN_FASCICOLI</name>
    <value>
      SELECT
      system_id AS ID_FOLDER,
      id_parent AS ID_PARENT_FOLDER,
      id_fascicolo AS ID_FASCICOLO,
      description AS FOLDER_DESCRIPTION,
      cha_tipo_fascicolo,
      dta_apertura AS APERTURA
      FROM project
      WHERE
      cha_tipo_proj = 'C' AND
      ( id_fascicolo IN (select system_id from project where cha_tipo_proj = 'F' and cha_stato != 'C' and id_tipo_fasc in (
      select id_tipo_fascicolo from rel_project_structure where id_template = @ID_TEMPLATE@ and id_tipo_fascicolo is not null))
      or
      id_fascicolo IN (select system_id from project where cha_tipo_proj = 'F' and cha_stato != 'C' and id_parent in (
      select id_titolario from rel_project_structure where id_template = @ID_TEMPLATE@ and id_titolario is not null))
      ) and id_parent = id_fascicolo
      @PARAM1@
    </value>
  </query>
  <query>
    <name>U_FOLDERNAME_PROJECT</name>
    <value>
      UPDATE project SET description = '@NEWNAME@' WHERE system_id = @SYSTEM_ID@
    </value>
  </query>
  <query>
    <name>GET_IDPRJ_BY_ASS_TEMPLATES</name>
    <value>
      SELECT ID_PROJECT
      FROM DPA_ASS_TEMPLATES_FASC
      WHERE ID_OGGETTO = @id_ogg_fasc@
      AND VALORE_OGGETTO_DB = '@valore_oggetto_db@'
      ORDER BY ID_PROJECT @ordine@
    </value>
  </query>
  <query>
    <name>GET_IDDOC_BY_ASS_TEMPLATES</name>
    <value>
      SELECT DOC_NUMBER
      FROM DPA_ASSOCIAZIONE_TEMPLATES
      WHERE ID_OGGETTO = @id_ogg_custom@
      AND VALORE_OGGETTO_DB = '@valore_oggetto_db@'
      ORDER BY DOC_NUMBER @ordine@
    </value>
  </query>
  <!-- CAP SERVICES -->
  <query>
    <name>CAP_REFACTOR_TRASMUT_1</name>
    <value>
      UPDATE DPA_TRASM_UTENTE
      SET VAR_NOTE_RIF = '@notaDaIns@',
      VAR_NOTE_ACC=NULL,
      CHA_RIFIUTATA = '1',
      CHA_ACCETTATA='0',
      CHA_VISTA='1',
      CHA_IN_TODOLIST='0',
      DTA_ACCETTATA = NULL,
      DTA_RIFIUTATA = @funzionedata@,
      DTA_RIMOZIONE_TODOLIST= @funzionedata@
      WHERE
      ID_TRASM_SINGOLA IN
      (SELECT SYSTEM_ID FROM DPA_TRASM_SINGOLA WHERE ID_TRASMISSIONE IN
      (SELECT SYSTEM_ID FROM DPA_TRASMISSIONE WHERE ID_PROJECT =@idFascicolo@)
      )
    </value>
  </query>
  <query>
    <name>CAP_REFACTOR_TRSING_2</name>
    <value>
      UPDATE DPA_TRASM_SINGOLA
      SET VAR_NOTE_SING = '@notaDaIns@'
      WHERE ID_TRASMISSIONE IN
      (SELECT SYSTEM_ID FROM DPA_TRASMISSIONE WHERE ID_PROJECT =@idFascicolo@)
    </value>
  </query>
  <query>
    <name>CAP_REFACTOR_TRASM_3</name>
    <value>
      UPDATE DPA_TRASMISSIONE
      SET DTA_INVIO = @funzionedata@,
      VAR_NOTE_GENERALI='@notaDaIns@'
      WHERE ID_PROJECT = @idFascicolo@
    </value>
  </query>
  <query>
    <name>CAP_GET_OPPS_PENDING</name>
    <value>
      SELECT
      DISTINCT(D.SYSTEM_ID  + ' § ' + F.VAR_DESC_RAGIONE + ' § ' + CONVERT(nvarchar(10),B.DTA_SCADENZA,104) + ' § ' + B.ID_CORR_GLOBALE) AS OPP
      @apprInfo@
      ,C.DTA_INVIO
      FROM DPA_TRASM_UTENTE A, DPA_TRASM_SINGOLA B, DPA_TRASMISSIONE C,
      PROJECT D, DPA_TIPO_FASC E, DPA_RAGIONE_TRASM F
      WHERE A.ID_TRASM_SINGOLA = B.SYSTEM_ID
      AND B.ID_TRASMISSIONE = C.SYSTEM_ID
      AND C.ID_PROJECT = D.SYSTEM_ID
      AND D.ID_TIPO_FASC = E.SYSTEM_ID
      AND E.VAR_DESC_FASC LIKE '@typePrefix@%'
      AND C.DTA_INVIO IS NOT NULL
      AND NOT EXISTS (SELECT 'X' FROM DPA_TRASM_UTENTE WHERE ID_TRASM_SINGOLA = B.SYSTEM_ID AND (CHA_ACCETTATA ='1' OR CHA_RIFIUTATA = '1'))
      /*
      AND A.CHA_ACCETTATA='0'
      AND A.CHA_RIFIUTATA='0'
      AND A.DTA_RIFIUTATA IS NULL
      AND A.DTA_ACCETTATA IS NULL
      */
      @soloApproval@

      AND F.SYSTEM_ID = B.ID_RAGIONE
      AND A.ID_PEOPLE=@id_people@
      @idOpp@
      ORDER BY C.DTA_INVIO DESC
    </value>
  </query>
  <query>
    <name>CAP_GET_OPPS_APPROVED</name>
    <value>
      SELECT
      DISTINCT(D.SYSTEM_ID + ' § ' + F.VAR_DESC_RAGIONE + ' § ' + CONVERT(nvarchar(10),B.DTA_SCADENZA,104) + ' § ' + B.ID_CORR_GLOBALE) AS OPP
      , C.DTA_INVIO
      FROM DPA_TRASM_UTENTE A, DPA_TRASM_SINGOLA B, DPA_TRASMISSIONE C,
      PROJECT D, DPA_TIPO_FASC E, DPA_RAGIONE_TRASM F
      WHERE A.ID_TRASM_SINGOLA = B.SYSTEM_ID
      AND B.ID_TRASMISSIONE = C.SYSTEM_ID
      AND C.ID_PROJECT = D.SYSTEM_ID
      AND D.ID_TIPO_FASC = E.SYSTEM_ID
      AND E.VAR_DESC_FASC LIKE '@typePrefix@%'
      AND C.DTA_INVIO IS NOT NULL
      /*
      AND (A.CHA_ACCETTATA='1' or A.CHA_RIFIUTATA='1')
      AND (A.DTA_RIFIUTATA IS not NULL or A.DTA_ACCETTATA IS not NULL)
      and (A.VAR_NOTE_RIF IS NULL OR A.VAR_NOTE_RIF NOT LIKE 'REMOVED%')
      */
      and exists (select 'X' from dpa_trasm_utente where id_trasm_singola = b.system_id and (cha_accettata ='1' or cha_rifiutata = '1')
      and (VAR_NOTE_SING IS NULL OR VAR_NOTE_SING NOT LIKE 'REMOVED%'))
      AND F.SYSTEM_ID = B.ID_RAGIONE
      @soloApproval@
      AND A.ID_PEOPLE=@id_people@
      @idOpp@
      ORDER BY C.DTA_INVIO DESC
    </value>
  </query>
  <query>
    <name>CAP_GET_OPP_APPROVALS</name>
    <value>
      SELECT
      (SELECT X.CHA_ACCETTATA + X.CHA_RIFIUTATA+'§'+
      X.VAR_NOTE_RIF+ X.VAR_NOTE_ACC+'§'+
      Y.VAR_NOME+'§'+ Y.VAR_COGNOME+'§'+
      convert(nvarchar (10), X.DTA_ACCETTATA, 103) +' '+ convert(nvarchar (8), X.DTA_ACCETTATA, 108)+
      convert(nvarchar (10), X.DTA_RIFIUTATA, 103) +' '+ convert(nvarchar (8), X.DTA_RIFIUTATA, 108)
      FROM DPA_TRASM_UTENTE X, PEOPLE Y
      WHERE X.ID_PEOPLE = Y.SYSTEM_ID AND (X.DTA_ACCETTATA IS NOT NULL OR X.DTA_RIFIUTATA IS NOT NULL)
      AND X.ID_TRASM_SINGOLA = B.SYSTEM_ID) AS UTENTE,
      F.VAR_DESC_RAGIONE, B.SYSTEM_ID AS IDTRASMSING, H.VAR_DESC_CORR,
      convert(nvarchar (10), C.DTA_INVIO, 103) +' '+ convert(nvarchar (8), C.DTA_INVIO, 108) AS DTAINVIO
      FROM DPA_TRASM_SINGOLA B, DPA_TRASMISSIONE C,
      DPA_RAGIONE_TRASM F, DPA_CORR_GLOBALI H
      WHERE B.ID_TRASMISSIONE = C.SYSTEM_ID
      AND C.DTA_INVIO IS NOT NULL
      AND (C.VAR_NOTE_GENERALI IS NULL OR C.VAR_NOTE_GENERALI NOT LIKE 'REMOVED%')
      AND F.SYSTEM_ID = B.ID_RAGIONE
      AND C.ID_PROJECT =  @idOpp@
      AND B.ID_CORR_GLOBALE = H.SYSTEM_ID
      ORDER BY B.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>CAP_CTRL_CONTRIBUTION</name>
    <value>
      SELECT
      C.VAR_DESC_RAGIONE,
      (SELECT ID_PROFILE_REVIEW FROM DPA_TASK WHERE ID_PROJECT = A.ID_PROJECT
      AND ID_TRASMISSIONE = A.SYSTEM_ID AND ID_TRASM_SINGOLA = B.SYSTEM_ID
      AND ID_RAGIONE_TRASM= C.SYSTEM_ID) AS CONTRIBUTO
      FROM DPA_TRASMISSIONE A,DPA_TRASM_SINGOLA B, DPA_RAGIONE_TRASM C
      WHERE B.ID_TRASMISSIONE = A.SYSTEM_ID
      AND B.ID_RAGIONE= C.SYSTEM_ID
      AND A.ID_PROJECT = @idOpp@
      AND A.DTA_INVIO IS NOT NULL
      AND A.VAR_NOTE_GENERALI NOT LIKE 'REMOVED%'
    </value>
  </query>
  <query>
    <name>S_DPA_ASSOCIAZIONE_STATI_PHASES</name>
    <value>
      SELECT SP.ID_STATO, SP.ID_PHASES, SP.POSITION_PHASE, SP.CHA_INTERMEDIATE_PHASE, P.DESCRIPTION AS DESCRIZIONE_PHASE, S.STATO_INIZIALE, SP.ID_TIPO_ATTO
      FROM DPA_ASSOCIAZIONE_STATI_PHASES SP, DPA_PHASES P, DPA_STATI S
      WHERE SP.ID_PHASES=P.SYSTEM_ID AND SP.ID_DIAGRAMMA=@idDiagramma@ AND S.SYSTEM_ID = SP.ID_STATO
      ORDER BY SP.POSITION_PHASE
    </value>
  </query>
  <query>
    <name>S_DPA_ASSOCIAZIONE_STATI_PHASES_BY_ID_FASE</name>
    <value>
      SELECT SP.ID_STATO, SP.ID_PHASES,SP.POSITION_PHASE, SP.CHA_INTERMEDIATE_PHASE, P.DESCRIPTION AS DESCRIZIONE_PHASE, S.STATO_INIZIALE, S.VAR_DESCRIZIONE AS DESCRIZIONE_STATO
      FROM DPA_ASSOCIAZIONE_STATI_PHASES SP, DPA_PHASES P, DPA_STATI S
      WHERE SP.ID_PHASES=P.SYSTEM_ID AND SP.ID_DIAGRAMMA=@idDiagramma@ AND S.SYSTEM_ID = SP.ID_STATO AND SP.ID_PHASES=@idFase@
      ORDER BY SP.POSITION_PHASE
    </value>
  </query>
  <query>
    <name>S_DPA_STATI_BY_ID</name>
    <value>
      SELECT *
      FROM DPA_STATI
      WHERE SYSTEM_ID = @idStato@
    </value>
  </query>
  <query>
    <name>S_GET_ALL_FASI</name>
    <value>
      SELECT SYSTEM_ID AS ID_FASE, DESCRIPTION AS DESCRIZIONE
      FROM DPA_PHASES
      ORDER BY POSITION
    </value>
  </query>
  <query>
    <name>I_ASS_FASI_STATI</name>
    <value>
      INSERT INTO DPA_ASSOCIAZIONE_STATI_PHASES
      (ID_STATO, ID_PHASES, ID_DIAGRAMMA, POSITION_PHASE, CHA_INTERMEDIATE_PHASE, ID_TIPO_ATTO)
      SELECT
      '@id_stato@', SYSTEM_ID, '@id_diagramma@', POSITION, '0', @id_tipo_doc@
      FROM DPA_PHASES
      WHERE SYSTEM_ID = @id_fase@
    </value>
  </query>
  <query>
    <name>D_ASS_FASI_STATI</name>
    <value>
      DELETE FROM DPA_ASSOCIAZIONE_STATI_PHASES
      WHERE ID_DIAGRAMMA = @id_diagramma@
    </value>
  </query>
  <query>
    <name>S_GET_STATI_SCADENZE</name>
    <value>
      SELECT ID_STATO, CHA_TIPO_STATO, CHA_TERMINI
      FROM DPA_ASS_STATI_SCADENZE
      WHERE ID_DIAGRAMMA = @id_diagramma@
    </value>
  </query>
  <query>
    <name>I_STATI_SCADENZE</name>
    <value>
      INSERT INTO DPA_ASS_STATI_SCADENZE
      (ID_STATO, CHA_TIPO_STATO, CHA_TERMINI, ID_DIAGRAMMA)
      VALUES
      (@id_stato@, '@tipo_stato@', '@termini@', @id_diagramma@)
    </value>
  </query>
  <query>
    <name>D_STATI_SCADENZE</name>
    <value>
      DELETE FROM DPA_ASS_STATI_SCADENZE
      WHERE ID_DIAGRAMMA = @id_diagramma@
    </value>
  </query>
  <query>
    <name>S_GET_EVENTI_CAMBIO_STATO_AUTOMATICO</name>
    <value>
      SELECT SYSTEM_ID, VAR_DESCRIZIONE, VAR_CODICE
      FROM DPA_AUTOMATISMI_STATI
    </value>
  </query>
  <query>
    <name>S_GET_CAMBI_STATO_BY_STATO</name>
    <value>
      SELECT A.ID_STATO_FINALE, A.ID_TIPO_EVENTO,
      B.VAR_CODICE AS CODICE_EVENTO, B.VAR_DESCRIZIONE AS DESC_EVENTO,
      A.ID_RAGIONE, C.VAR_DESC_RAGIONE,
      A.ID_TIPO_DOC, D.VAR_DESC_ATTO AS TIPOLOGIA
      FROM DPA_CAMBIO_STATO_AUTO A
      LEFT JOIN DPA_AUTOMATISMI_STATI B ON A.ID_TIPO_EVENTO = B.SYSTEM_ID
      LEFT JOIN DPA_RAGIONE_TRASM C ON A.ID_RAGIONE = C.SYSTEM_ID
      LEFT JOIN DPA_TIPO_ATTO D ON A.ID_TIPO_DOC = D.SYSTEM_ID
      WHERE A.ID_STATO_INIZIALE = @id_stato@
    </value>
  </query>
  <query>
    <name>I_CAMBIO_STATO_AUTOMATICO</name>
    <value>
      INSERT INTO DPA_CAMBIO_STATO_AUTO
      (ID_STATO_INIZIALE, ID_STATO_FINALE, ID_TIPO_EVENTO, ID_AMM, ID_TIPO_DOC, ID_RAGIONE)
      VALUES
      (@id_stato_iniziale@, @id_stato_finale@, @id_tipo_evento@, @id_amm@, @id_tipo_doc@, @id_ragione@)
    </value>
  </query>
  <query>
    <name>D_CAMBIO_STATO_AUTOMATICO</name>
    <value>
      DELETE FROM DPA_CAMBIO_STATO_AUTO
      WHERE ID_STATO_INIZIALE = @id_stato_iniziale@ AND ID_STATO_FINALE = @id_stato_finale@
    </value>
  </query>
  <query>
    <name>S_GET_CAMBIO_STATO_BY_ID_FASC</name>
    <value>
      SELECT A.ID_STATO_FINALE, C.VAR_CODICE, A.ID_TIPO_DOC, A.ID_RAGIONE
      FROM DPA_CAMBIO_STATO_AUTO A, DPA_DIAGRAMMI B, DPA_AUTOMATISMI_STATI C
      WHERE A.ID_STATO_INIZIALE = B.ID_STATO AND A.ID_TIPO_EVENTO=C.SYSTEM_ID
      AND B.ID_PROJECT = @id_project@
    </value>
  </query>
  <query>
    <name>S_COD_LIV_C</name>
    <value>
      SELECT ( case
      when MAX(CONVERT(int,LTRIM(SUBSTRING (CAST(var_cod_liv1 as varchar),LEN(var_cod_liv1)-3, LEN(var_cod_liv1))))) is null
      then 1
      else MAX(CONVERT(int,LTRIM(SUBSTRING (CAST(var_cod_liv1 as varchar),LEN(var_cod_liv1)-3, LEN(var_cod_liv1))))) + 1
      end )as TOT
      FROM PROJECT
      WHERE var_cod_liv1 LIKE '@param1@%'
      AND cha_tipo_proj = 'C'
      AND id_amm = @param2@
      AND num_livello = @param3@
      @param4@
    </value>
  </query>
  <!-- INTEGRAZIONE RGS -->
  <query>
    <name>S_DPA_CONTESTO_PROCEDURALE_BY_ID</name>
    <value>
      SELECT *
      FROM DPA_CONTESTO_PROCEDURALE
      WHERE SYSTEM_ID = @idContesto@
    </value>
  </query>
  <query>
    <name>I_DPA_FLUSSO_PROCEDURALE</name>
    <value>
      INSERT INTO DPA_FLUSSO_PROCEDURALE
      (
      ID_PROCESSO,
      ID_MESSAGGIO,
      DTA_ARRIVO,
      ID_PROFILE,
      NOME_REGISTRO,
      NUMERO_REGISTRO	,
      DTA_REGISTRO
      )
      VALUES
      (
      '@idProcesso@',
      @idMessaggio@,
      @dataArrivo@,
      @idProfile@,
      '@nomeRegistroIn@',
      @numeroRegistroIn@,
      @dataRegistroIn@
      )
    </value>
  </query>
  <query>
    <name>S_DPA_CORR_INTEROP_BY_ID_CORR</name>
    <value>
      SELECT *
      FROM DPA_CORR_INTEROP
      WHERE ID_CORR = @idCorr@
    </value>
  </query>
  <query>
    <name>S_DPA_TIPO_MESSAGGI_FLUSSO_INIZIALE</name>
    <value>
      SELECT *
      FROM DPA_TIPO_MESSAGGI_FLUSSO
      WHERE CHA_MESSAGGIO_INIZIALE = '1'
    </value>
  </query>
  <query>
    <name>S_DPA_TIPO_MESSAGGI_FLUSSO_BY_ID_PROFILE</name>
    <value>
      SELECT T.*
      FROM DPA_TIPO_MESSAGGI_FLUSSO t join DPA_FLUSSO_PROCEDURALE f on t.ID_MESSAGGIO = f.ID_MESSAGGIO
      WHERE ID_PROFILE = @idProfile@
    </value>
  </query>
  <query>
    <name>S_DPA_FLUSSO_MESSAGGI_BY_ID_MESSAGGIO</name>
    <value>
      SELECT *
      FROM DPA_TIPO_MESSAGGI_FLUSSO t join DPA_FLUSSO_MESSAGGI m on t.ID_MESSAGGIO = m.ID_MESSAGGIO_SUCCESSIVO
      WHERE m.ID_MESSAGGIO = @idMessaggio@
    </value>
  </query>
  <query>
    <name>S_DPA_FLUSSO_PROCEDURALE_ID_PROCESSO</name>
    <value>
      SELECT ID_PROCESSO
      FROM DPA_FLUSSO_PROCEDURALE
      WHERE ID_PROFILE = @idProfile@
    </value>
  </query>
  <query>
    <name>S_DPA_FLUSSO_PROCEDURALE_BY_ID_PROCESSO</name>
    <value>
      SELECT F.SYSTEM_ID, F.DTA_ARRIVO AS DATA_ARRIVO, F.NOME_REGISTRO, F.NUMERO_REGISTRO,
      convert(nvarchar (10), f.DTA_REGISTRO, 103) AS DTA_REGISTRO,
      F.ID_PROCESSO,
      P.SYSTEM_ID AS ID_PROFILE, P.NUM_PROTO, P.VAR_PROF_OGGETTO,
      M.ID_MESSAGGIO, M.DESCRIZIONE, M.CHA_MESSAGGIO_INIZIALE, M.CHA_MESSAGGIO_FINALE
      FROM DPA_FLUSSO_PROCEDURALE F, DPA_TIPO_MESSAGGI_FLUSSO M, PROFILE P
      WHERE F.ID_PROCESSO = '@idProcesso@'
      AND M.ID_MESSAGGIO = F.ID_MESSAGGIO
      AND P.SYSTEM_ID = F.ID_PROFILE
      ORDER BY F.DTA_ARRIVO
    </value>
  </query>
  <query>
    <name>S_DPA_CONTESTO_PROCEDURALE</name>
    <value>
      SELECT *
      FROM DPA_CONTESTO_PROCEDURALE
    </value>
  </query>
  <query>
    <name>S_DPA_FLUSSO_PROCEDURALE_BY_ID_PROCESSO_INIZIALE</name>
    <vale>
      SELECT *
      FROM DPA_FLUSSO_PROCEDURALE
      WHERE ID_PROCESSO='@idProcesso@' AND ID_MESSAGGIO=@idMessaggio@
    </vale>
  </query>
  <query>
    <name>S_PROJECT_NO_SECURITY2_BY_ID_PROFILE</name>
    <value>
      SELECT /*+ INDEX (A) */
      A.SYSTEM_ID, A.DESCRIPTION, A.CHA_TIPO_PROJ, A.VAR_CODICE,
      A.ID_AMM,A.NUM_LIVELLO, A.CHA_TIPO_FASCICOLO, A.ID_FASCICOLO, A.ID_PARENT,
      A.VAR_COD_ULTIMO, DOCSADM.checksecurity(a.system_id, @param4@, @param5@, @idRuoloPubblico@, 'F') as SICUREZZA,
      @param1@ AS DTA_APERTURA,@param2@ AS DTA_CHIUSURA,
      A.CHA_STATO, A.ID_TIPO_PROC, A.VAR_NOTE, A.ID_REGISTRO,DOCSADM.getaccessrightsProject(@param4@,@param5@, @idRuoloPubblico@,A.system_id) AS ACCESSRIGHTS, A.CARTACEO, A.ID_TITOLARIO, A.NUM_FASCICOLO,
      A.AUTHOR, A.ID_RUOLO_CREATORE, A.ID_UO_CREATORE, DOCSADM.getFascPrimaria(@param3@, A.SYSTEM_ID) as CHA_FASC_PRIMARIA, A.CHA_CONSENTI_CLASS, a.CHA_CONSENTI_FASC, A.COD_EXT_APP
      FROM 	  PROJECT A JOIN  PROJECT C ON A.SYSTEM_ID = C.ID_FASCICOLO
      JOIN PROJECT_COMPONENTS B ON C.SYSTEM_ID=B.PROJECT_ID AND B.LINK=@param3@
      WHERE A.CHA_TIPO_PROJ = 'F' AND A.CHA_STATO = 'A'
      ORDER BY B.DTA_CLASS ASC
    </value>
  </query>
  <query>
    <name>I_DPA_CONTESTO_PROCEDURALE</name>
    <value>
      INSERT INTO DPA_CONTESTO_PROCEDURALE
      (
      TIPO_CONTESTO_PROCEDURALE,
      NOME,
      FAMIGLIA,
      VERSIONE
      )
      VALUES
      (
      '@tipoContesto@',
      '@nome@',
      @famiglia@,
      @versione@
      )
    </value>
  </query>
  <query>
    <name>U_DPA_TIPO_ATTO_CONTESTO</name>
    <value>
      UPDATE DPA_TIPO_ATTO
      SET ID_CONTESTO_PROCEDURALE = @idContestoProcedurale@
      WHERE SYSTEM_ID = @idTipoAtto@
    </value>
  </query>
  <query>
    <name>I_DPA_CORR_INTEROP</name>
    <value>
      INSERT INTO DPA_CORR_INTEROP(ID_CORR, CHA_INTEROPERANTE_RGS)
      VALUES(@idCorr@, '@interoperanteRGS@')
    </value>
  </query>
  <query>
    <name>D_DPA_CORR_INTEROP</name>
    <value>
      DELETE FROM DPA_CORR_INTEROP
      WHERE ID_CORR = @idCorr@
    </value>
  </query>
  <!-- FINE INTEGRAZIONE RGS -->
  <query>
    <name>S_GET_LICENSE</name>
    <value>
      SELECT VAR_CONTENT
      FROM DPA_LIC
      WHERE COD_APP='@codApp@'
    </value>
  </query>
  <query>
    <name>S_STATO_FASC_TRASMISSIONI</name>
    <value>
      SELECT DISTINCT B.SYSTEM_ID AS ID_TRASM
      FROM DPA_STATI_RAGIONI_TRASM A, DPA_TRASMISSIONE B, DPA_TRASM_SINGOLA C
      WHERE A.ID_RAGIONE_TRASM=C.ID_RAGIONE
      AND C.ID_TRASMISSIONE=B.SYSTEM_ID
      AND B.DTA_INVIO IS NULL
      AND B.ID_PROJECT=@idFasc@
      AND A.ID_STATO=@idStato@
    </value>
  </query>
  <query>
    <name>S_STATO_RAGIONI</name>
    <value>
      SELECT B.VAR_DESC_RAGIONE
      FROM DPA_STATI_RAGIONI_TRASM A, DPA_RAGIONE_TRASM B
      WHERE A.ID_RAGIONE_TRASM=B.SYSTEM_ID
      AND A.ID_STATO=@idStato@
    </value>
  </query>
  <query>
    <name>S_CREATORE_FASCICOLO</name>
    <value>
      SELECT AUTHOR,ID_RUOLO_CREATORE,ID_UO_CREATORE,ID_PEOPLE_DELEGATO
      FROM PROJECT WHERE SYSTEM_ID = @param1@
    </value>
  </query>
  <query>
    <name>S_FOLDER_HAS_DOCUMENTS</name>
    <value>SELECT COUNT(*) FROM PROJECT_COMPONENTS WHERE PROJECT_ID = @param1@</value>
  </query>
  <!-- CAP -->
  <query>
    <name>S_DPA_CAP_COMUNI</name>
    <value>
      SELECT *
      FROM DPA_INFO_COMUNI
      @condition@
      order by VAR_CAP
    </value>
  </query>
  <query>
    <name>S_DPA_CAP</name>
    <value>
      SELECT *
      FROM DPA_INFO_COMUNI
      WHERE VAR_CAP = '@cap@'
      @condComune@
    </value>
  </query>
  <query>
    <name>S_DPA_CAP_COMUNI_BY_COMUNE</name>
    <value>
      SELECT VAR_COMUNE
      FROM DPA_INFO_COMUNI
      WHERE VAR_COMUNE like '%@comune@%'
      GROUP BY VAR_COMUNE
      ORDER BY VAR_COMUNE
    </value>
  </query>
  <query>
    <name>S_DPA_PROVINCIA_BY_COMUNE</name>
    <value>
      SELECT *
      FROM DPA_INFO_COMUNI
      WHERE VAR_COMUNE = '@comune@'
    </value>
  </query>
  <!-- FINE CAP -->
  <query>
    <name>S_DPA_AMMINISTRA_TRASMISSIONE_AUTO_DOC</name>
    <value>
      SELECT TRASMISSIONE_AUTO_DOC
      FROM DPA_AMMINISTRA
      WHERE SYSTEM_ID = @idAmm@
    </value>
  </query>
  <!-- PORTALE PROCEDIMENTI -->
  <query>
    <name>I_DPA_PROCEDIMENTI</name>
    <value>
      INSERT INTO DPA_PROCEDIMENTI
      (ID_PROJECT, ID_PROFILE, CHA_PRINCIPALE, CHA_VISUALIZZATO, ID_CORR_GLOBALI, ID_ESTERNO)
      VALUES
      ('@idProject@', '@idProfile@','@docPrinc@','@visualizzato@', '@idCorrGlobali@', '@idProcedimento@')
    </value>
  </query>
  <query>
    <name>I_DPA_PROCEDIMENTI_FASI</name>
    <value>
      INSERT INTO DPA_ASS_PROCEDIMENTI_FASI
      (ID_PROJECT, ID_PHASE, ID_STATO, DTA_START)
      SELECT '@id_project@', ID_PHASES, ID_STATO, GETDATE()
      FROM DPA_ASSOCIAZIONE_STATI_PHASES
      WHERE ID_STATO='@id_stato@'
    </value>
  </query>
  <query>
    <name>U_DPA_PROCEDIMENTI</name>
    <value>
      UPDATE DPA_PROCEDIMENTI SET CHA_VISUALIZZATO='1', DATA_VISUALIZZAZIONE=GETDATE()
      WHERE @cond@
    </value>
  </query>
  <query>
    <name>S_PROC_GET_DOC_NON_VISUALIZZATI</name>
    <value>
      SELECT P.ID_PROJECT, P.ID_ESTERNO, F.DESCRIPTION, COUNT(P.ID_PROFILE) AS UNREAD_DOCS
      FROM DPA_PROCEDIMENTI P, PROJECT F
      WHERE P.ID_CORR_GLOBALI=@idCorrGlobali@
      AND P.ID_PROJECT=F.SYSTEM_ID
      AND P.CHA_VISUALIZZATO='0'
      GROUP BY P.ID_PROJECT, P.ID_ESTERNO, F.DESCRIPTION
      ORDER BY P.ID_PROJECT
    </value>
  </query>
  <query>
    <name>S_GET_STATO_VIS_DOC_PROC</name>
    <value>
      SELECT CHA_VISUALIZZATO
      FROM DPA_PROCEDIMENTI
      WHERE ID_PROJECT=@id_procedimento@ AND ID_PROFILE=@id_doc@
    </value>
  </query>
  <query>
    <name>S_IS_FOLDER_IN_PROCEEDING</name>
    <value>
      SELECT COUNT(A.ID_PROJECT)
      FROM DPA_PROCEDIMENTI A, PROJECT B
      WHERE A.ID_PROJECT=B.ID_FASCICOLO
      AND B.SYSTEM_ID=@idFolder@
    </value>
  </query>
  <query>
    <name>S_GET_PROCEDIMENTO</name>
    <value>
      SELECT A.ID_PROJECT, A.CHA_PRINCIPALE, A.CHA_VISUALIZZATO, A.ID_CORR_GLOBALI, A.ID_PROFILE, A.ID_ESTERNO,
      CONVERT(CHAR,A.DATA_VISUALIZZAZIONE,103) AS DATA_VISUALIZZAZIONE,
      (SELECT P.DESCRIPTION FROM PROJECT P WHERE P.SYSTEM_ID=A.ID_PROJECT) AS DESCRIPTION
      FROM DPA_PROCEDIMENTI A
      @fromCond@
      WHERE @whereCond@
      ORDER BY A.CHA_PRINCIPALE DESC, A.ID_PROFILE
    </value>
  </query>
  <query>
    <name>S_PROCEDIMENTO_CAMBIO_STATO</name>
    <value>
      SELECT ID_STATO
      FROM DPA_CAMBIO_STATO_PROC
      WHERE TIPO_EVENTO='@evento@' AND ID_OGGETTO='@id_obj@'
    </value>
  </query>
  <query>
    <name>S_GET_PROCEDIMENTI_AMM</name>
    <value>
      SELECT DISTINCT C.VAR_DESC_FASC, C.SYSTEM_ID AS ID_PROC
      FROM PROJECT A, DPA_PROCEDIMENTI B, DPA_TIPO_FASC C
      WHERE A.SYSTEM_ID=B.ID_PROJECT AND A.ID_TIPO_FASC=C.SYSTEM_ID AND C.ID_AMM='@id_amm@'
    </value>
  </query>
  <query>
    <name>S_GET_PROCEDIMENTI_REPORT</name>
    <value>
      SELECT A.SYSTEM_ID AS ID_PROJECT,
      A.DESCRIPTION AS DESC_PROJECT,
      A.ID_TIPO_FASC, C.VAR_DESC_FASC,
      D.SYSTEM_ID AS ID_STATO, D.Var_descrizione AS DESC_STATO, D.Stato_iniziale, D.Stato_finale,
      E.SYSTEM_ID AS ID_FASE, E.DESCRIPTION AS DESC_FASE, B.DTA_START
      FROM PROJECT A, DPA_ASS_PROCEDIMENTI_FASI B, DPA_TIPO_FASC C, DPA_STATI D, DPA_PHASES E
      WHERE A.SYSTEM_ID = B.ID_PROJECT AND A.ID_TIPO_FASC = C.SYSTEM_ID AND B.ID_STATO = D.SYSTEM_ID AND B.ID_PHASE = E.SYSTEM_ID
      @filters@
      ORDER BY A.SYSTEM_ID, B.DTA_START
    </value>
  </query>
  <query>
    <name>S_GET_FASI_DIAGRAMMA</name>
    <value>
      SELECT DISTINCT B.SYSTEM_ID AS ID_FASE, B.DESCRIPTION, A.POSITION_PHASE
      FROM DPA_ASSOCIAZIONE_STATI_PHASES A, DPA_PHASES B
      WHERE A.ID_PHASES = B.SYSTEM_ID AND A.ID_DIAGRAMMA = '@id_diagramma@'
      ORDER BY A.POSITION_PHASE
    </value>
  </query>
  <query>
    <name>S_ESITO_PROCEDIMENTO</name>
    <value>
      SELECT TOP 1 B.ESITO
      FROM DPA_ASS_PROCEDIMENTI_FASI A, DPA_ESITO_PROCEDIMENTO B
      WHERE A.ID_PROJECT='@id_project@' AND A.ID_STATO = B.ID_STATO
      ORDER BY A.DTA_START DESC
    </value>
  </query>
  <query>
    <name>S_AOO_PROCEDIMENTI</name>
    <value>
      SELECT A.SYSTEM_ID, A.VAR_CODICE, A.VAR_DESC_REGISTRO, A.ID_AMM
      FROM DPA_EL_REGISTRI A, DPA_TIPO_FASC B
      WHERE B.ID_AMM = A.ID_AMM AND A.CHA_RF = 0
      AND B.ABILITATO_SI_NO='1' AND B.IN_ESERCIZIO='SI'
      AND B.VAR_DESC_FASC = '@template@'
      AND B.ID_AMM &lt;&gt; @id_amm@
      ORDER BY A.VAR_CODICE
    </value>
  </query>
  <query>
    <name>S_GET_PROCEDIMENTO_ISTANZA</name>
    <value>
      SELECT TOP 1 ID_PROFILE
      FROM DPA_PROCEDIMENTI
      WHERE ID_PROJECT = @id_project@
      AND CHA_PRINCIPALE = '1'
      ORDER BY ID_PROFILE ASC
    </value>
  </query>
  <query>
    <name>U_DPA_PROCEDIMENTI_REINDIRIZZAMENTO</name>
    <value>
      UPDATE DPA_PROCEDIMENTI
      SET ID_PROJECT_REDIRECT = @new_id_project@,
      ID_AOO_REDIRECT = @new_id_aoo@
      WHERE ID_PROJECT = @old_id_project@
    </value>
  </query>
  <query>
    <name>D_DPA_PROCEDIMENTI_REINDIRIZZAMENTO</name>
    <value>
      DELETE FROM DPA_PROCEDIMENTI
      WHERE ID_PROJECT = @id_project@
      AND CHA_PRINCIPALE = '0'
    </value>
  </query>
  <query>
    <name>S_PROCEDIMENTO_REINDIRIZZATO</name>
    <value>
      SELECT ISNULL(ID_PROJECT_REDIRECT,'0') AS ID_REDIRECT, ID_AOO_REDIRECT
      FROM DPA_PROCEDIMENTI
      WHERE ID_PROJECT = @id_project@
    </value>
  </query>
  <!-- QUERY PER AMMINISTRAZIONE -->
  <query>
    <name>S_GET_LISTA_UO_PROCEDIMENTI</name>
    <value>
      SELECT A.SYSTEM_ID, A.VAR_COD_RUBRICA, A.VAR_DESC_CORR, B.VAR_CODICE_AMM
      FROM DPA_CORR_GLOBALI A, DPA_AMMINISTRA B
      WHERE A.ID_AMM=B.SYSTEM_ID
      AND A.CHA_TIPO_URP='U' AND A.CHA_TIPO_IE='I'
      AND A.VAR_DESC_CORR LIKE '%@search_string@%'
    </value>
  </query>
  <query>
    <name>S_PORTALE_AMM_GET_TIPI_DOC</name>
    <value>
      SELECT T.DESCRIZIONE FROM (
      SELECT A.VAR_DESC_ATTO AS DESCRIZIONE, COUNT(B.SYSTEM_ID) AS AOO_COUNTER
      FROM DPA_TIPO_ATTO A, DPA_EL_REGISTRI B
      WHERE A.In_Esercizio='SI' AND A.CHA_PROCEDIMENTALE='1'
      AND A.ABILITATO_SI_NO = '1'
      AND A.VAR_DESC_ATTO != 'CAMPI COMUNI'
      AND A.ID_AMM = B.ID_AMM AND B.CHA_RF = '0'
      AND B.SYSTEM_ID IN (@aoo@)
      GROUP BY (A.VAR_DESC_ATTO)
      ) T WHERE T.AOO_COUNTER=@num_aoo@
      ORDER BY T.DESCRIZIONE
    </value>
  </query>
  <query>
    <name>S_PORTALE_AMM_GET_TIPI_FASC</name>
    <value>
      SELECT T.DESCRIZIONE FROM (
      SELECT A.VAR_DESC_FASC AS DESCRIZIONE, COUNT(B.SYSTEM_ID) AS AOO_COUNTER
      FROM DPA_TIPO_FASC A, DPA_EL_REGISTRI B
      WHERE A.In_Esercizio='SI' AND A.CHA_PROCEDIMENTALE='1'
      AND A.ABILITATO_SI_NO = '1'
      AND A.VAR_DESC_FASC != 'CAMPI COMUNI'
      AND A.ID_AMM = B.ID_AMM AND B.CHA_RF = '0'
      AND B.SYSTEM_ID IN (@aoo@)
      GROUP BY (A.VAR_DESC_FASC)
      ) T WHERE T.AOO_COUNTER=@num_aoo@
      ORDER BY T.DESCRIZIONE
    </value>
  </query>
  <query>
    <name>S_PORTALE_AMM_GET_AOO</name>
    <value>
      SELECT A.SYSTEM_ID, A.ID_AMM, A.VAR_CODICE, A.VAR_DESC_REGISTRO, B.VAR_CODICE_AMM
      FROM DPA_EL_REGISTRI A, DPA_AMMINISTRA B
      WHERE A.ID_AMM=B.SYSTEM_ID AND A.CHA_RF=0
      ORDER BY A.VAR_CODICE
    </value>
  </query>
  <query>
    <name>S_GET_CAMPI_PROCEDIMENTALI_FASC</name>
    <value>
      SELECT *
      FROM DPA_CAMPI_PROCEDIMENTALI_FASC
    </value>
  </query>
  <query>
    <name>S_GET_TEMPLATE_DOC_ID_BY_DESCRIZIONE</name>
    <value>
      SELECT SYSTEM_ID
      FROM DPA_TIPO_ATTO
      WHERE ABILITATO_SI_NO='1' AND
      VAR_DESC_ATTO = '@descrizione@'
      AND ID_AMM=@id_amm@
    </value>
  </query>
  <query>
    <name>S_GET_TEMPLATE_FASC_ID_BY_DESCRIZIONE</name>
    <value>
      SELECT SYSTEM_ID
      FROM DPA_TIPO_FASC
      WHERE ABILITATO_SI_NO='1' AND
      VAR_DESC_FASC = '@descrizione@'
      AND ID_AMM=@id_amm@
    </value>
  </query>
  <query>
    <name>S_GET_TIPO_STATO_PROCEDIMENTO</name>
    <value>
      SELECT *
      FROM DPA_ASS_STATI_SCADENZE
      WHERE ID_STATO = @id_stato@
    </value>
  </query>
  <query>
    <name>S_GET_DATA_ULTIMO_CAMBIO_STATO</name>
    <value>
      SELECT TOP 1 CONVERT(char,B.Dta_date,103)
      FROM DPA_STATI A, DPA_DIAGRAMMI_STO B, DPA_DIAGRAMMI C
      WHERE A.Var_descrizione = B.Var_desc_new_stato
      AND B.Id_Project = @id_project@
      AND B.Id_Project = C.Id_Project AND A.ID_DIAGRAMMA = C.Id_diagramma
      ORDER BY B.Dta_date DESC
    </value>
  </query>
  <query>
    <name>S_CHECK_STATO_CHIUSURA_PROCEDIMENTO</name>
    <value>
      SELECT ID_STATO
      FROM DPA_ASSOCIAZIONE_STATI_PHASES A, DPA_PHASES B
      WHERE A.ID_PHASES = B.SYSTEM_ID
      AND B.DESCRIPTION = 'CHIUSO'
      AND A.ID_STATO = @id_stato@
    </value>
  </query>
  <!-- fine PORTALE PROCEDIMENTI -->
  <!-- BACHECA MIBACT -->
  <query>
    <name>MIBACT_GET_C_NOTIFY</name>
    <value>
      SELECT
      A.VAR_PROF_OGGETTO AS DOC_TITOLO,
      CONVERT(VARCHAR(8), A.DTA_PROTO, 112) AS DOC_DATA_CREAZIONE,
      A.NUM_PROTO AS DOC_PROTOCOLLO,
      B.VALORE_OGGETTO_DB AS DOC_N_CIRCOLARE,
      (SELECT VAR_NOME + ' ' + VAR_COGNOME FROM PEOPLE WHERE SYSTEM_ID = E.ID_PEOPLE_OPERATORE) AS DOC_AUTORE,
      (SELECT Y.VAR_COD_RUBRICA FROM DPA_CORR_GLOBALI X, DPA_CORR_GLOBALI Y WHERE X.ID_GRUPPO = E.ID_GRUPPO_OPERATORE AND Y.SYSTEM_ID= X.ID_UO) AS SERVIZIO_CODICE,
      (SELECT Y.VAR_DESC_CORR FROM DPA_CORR_GLOBALI X, DPA_CORR_GLOBALI Y WHERE X.ID_GRUPPO = E.ID_GRUPPO_OPERATORE AND Y.SYSTEM_ID= X.ID_UO) AS SERVIZIO_DESCRIZIONE,
      (SELECT VAR_CODICE FROM DPA_EL_REGISTRI WHERE SYSTEM_ID = A.ID_REGISTRO) AS UFFECOD_ESPIIDAOO,
      A.SYSTEM_ID AS ESPI_CODICE,
      F.VAR_DESCRIZIONE AS STATO,
      CONVERT(VARCHAR(8), A.DTA_ANNULLA, 112) AS DOC_DATA_ANNULLA,
      E.ID_AMM AS ID_AMMINISTRAZIONE,
      E.ID_PEOPLE_OPERATORE AS ID_UTENTE,
      E.ID_GRUPPO_OPERATORE AS ID_GRUPPO
      FROM
      PROFILE A,
      DPA_ASSOCIAZIONE_TEMPLATES B,
      DPA_OGGETTI_CUSTOM C,
      DPA_DIAGRAMMI D,
      DPA_LOG E,
      DPA_STATI F
      WHERE
      A.SYSTEM_ID = D.DOC_NUMBER
      AND D.ID_STATO = F.SYSTEM_ID
      AND A.SYSTEM_ID = E.ID_OGGETTO
      AND A.SYSTEM_ID = B.DOC_NUMBER
      AND C.SYSTEM_ID = B.ID_OGGETTO
      AND F.VAR_DESCRIZIONE IN (@statinotifica@)
      AND E.VAR_COD_AZIONE = 'DOC_CAMBIO_STATO'
      AND E.VAR_DESC_OGGETTO LIKE '%@statoinvia@'
      AND C.DESCRIZIONE = '@descncircolare@'
      ORDER BY E.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>MIBACT_GET_INFOFILE_DOC</name>
    <value>
      SELECT A.PATH, A.VERSION_ID, A.DOCNUMBER, A.FILE_SIZE,
      A.VAR_IMPRONTA, A.EXT ,A.VAR_NOMEORIGINALE,
      CONVERT(VARCHAR(10), A.DTA_FILE_ACQUIRED, 103) AS DATA_ACQ_FILE,
      CONVERT(VARCHAR(10), B.DTA_CREAZIONE, 103) AS DATA_CREA_VERS,
      B.VERSION, B.VERSION_LABEL,
      C.AUTHOR AS ID_PEOPLE,
      C.ID_RUOLO_CREATORE AS ID_CORR_RUOLO,
      C.VAR_PROF_OGGETTO AS OGGETTO
      FROM COMPONENTS A, VERSIONS B, PROFILE C
      WHERE A.VERSION_ID= B.VERSION_ID
      AND (C.SYSTEM_ID = @idDoc@ OR C.ID_DOCUMENTO_PRINCIPALE = @idDoc@)
      AND VAR_IMPRONTA IS NOT NULL
      AND A.DOCNUMBER=C.SYSTEM_ID
      AND B.VERSION_ID = (SELECT MAX(VERSION_ID) FROM VERSIONS WHERE DOCNUMBER = C.SYSTEM_ID)
      ORDER BY C.SYSTEM_ID
    </value>
  </query>
  <!-- FINE BACHECA MIBACT -->
  <query>
    <name>S_DPA_PROJECT_NODI_FIGLI_E_FASCICOLI</name>
    <value>
      WITH n(system_id, cha_tipo_proj) AS
      (SELECT system_id, cha_tipo_proj
      FROM project
      WHERE system_id in  ( SELECT SYSTEM_ID FROM PROJECT WHERE VAR_CODICE = '@codice@'
      AND ID_AMM = (SELECT ID_AMM FROM PEOPLE WHERE SYSTEM_ID = @idPeople@)
      AND id_titolario in (select  system_id from project where id_titolario=0 and cha_stato!='D'))
      UNION ALL
      SELECT P1.SYSTEM_ID, P1.CHA_TIPO_PROJ
      FROM PROJECT P1, n
      WHERE n.SYSTEM_ID = P1.ID_PARENT)
      SELECT system_id, cha_tipo_proj FROM n
    </value>
  </query>
  <query>
    <name>U_DPA_CHIAVI_CONFIGURAZIONE_VALORE</name>
    <value>
      UPDATE DPA_CHIAVI_CONFIGURAZIONE
      SET VAR_VALORE = @valore@
      WHERE ID_AMM=@idAmm@ AND VAR_CODICE='@codice@'
    </value>
  </query>
  <query>
    <name>I_DPA_LOG_ATTIVATI_ALL</name>
    <value>
      INSERT INTO DPA_LOG_ATTIVATI(SYSTEM_ID_ANAGRAFICA, ID_AMM, NOTIFY)
      SELECT L.SYSTEM_ID, @idAmm@,
      CASE
      WHEN L.NOTIFICATION = '1' THEN 'OBB'
      WHEN L.NOTIFICATION = '0' THEN 'NN'
      END
      FROM DPA_ANAGRAFICA_LOG L
      WHERE (L.ID_AMM IS NULL OR L.ID_AMM=@idAmm@) AND NOT EXISTS(SELECT 'X' FROM DPA_LOG_ATTIVATI A WHERE A.SYSTEM_ID_ANAGRAFICA=L.SYSTEM_ID AND A.ID_AMM=@idAmm@)
    </value>
  </query>
  <query>
    <name>D_DPA_CHECK_MAILBOX_BY_EMAIL</name>
    <value>
      DELETE FROM DPA_CHECK_MAILBOX
      WHERE MAIL='@email@' AND IDREG=@idRegistro@ AND CONCLUDED=0
    </value>
  </query>
  <query>
    <name>S_GET_UO_SOTTOPOSTE</name>
    <value>
      WITH n(system_id) AS
      (SELECT system_id from DPA_CORR_GLOBALI where id_parent = @idUo@ and dta_fine is null
      UNION ALL
      SELECT c1.system_id from DPA_CORR_GLOBALI as c1, n where n.system_id = c1.ID_PARENT and DTA_FINE is null)
      SELECT * from n
    </value>
  </query>
  <query>
    <name>S_CONFIG_REPORT_CONSERVAZIONE</name>
    <value>
      SELECT VAR_FIXED_RECIPIENTS, CHA_ATTIVA_STRUTTURA, CHA_MAIL_STRUTTURA, MAIL_SUBJECT, MAIL_BODY,
      VAR_SMTP_SERVER, VAR_MAIL_FROM, VAR_USERNAME_SMTP, VAR_PASSWORD_SMTP, VAR_PORT_SMTP, CHA_SSL
      FROM DPA_REPORT_VERSAMENTO
      WHERE ID_AMM=@idAmm@
    </value>
  </query>
  <query>
    <name>S_MAIL_STRUTTURA</name>
    <value>
      SELECT CHA_MAIL_STRUTTURA, VAR_SMTP_SERVER, VAR_MAIL_FROM, VAR_USERNAME_SMTP, VAR_PASSWORD_SMTP, VAR_PORT_SMTP, CHA_SSL
      FROM DPA_REPORT_VERSAMENTO
      WHERE ID_AMM=@idAmm@
    </value>
  </query>
  <query>
    <name>I_MAIL_STRUTTURA</name>
    <value>
      INSERT INTO DPA_REPORT_VERSAMENTO
      (ID_AMM, CHA_MAIL_STRUTTURA, VAR_SMTP_SERVER, VAR_MAIL_FROM, VAR_USERNAME_SMTP, VAR_PASSWORD_SMTP, VAR_PORT_SMTP, CHA_SSL)
      VALUES
      ('@idAmm@', '@mailString@', '@smtp_server@', '@mail_from@', '@username@', '@password@', '@port@', '@ssl@')
    </value>
  </query>
  <query>
    <name>U_MAIL_STRUTTURA</name>
    <value>
      UPDATE DPA_REPORT_VERSAMENTO
      SET CHA_MAIL_STRUTTURA='@mailString@',
      VAR_SMTP_SERVER='@smtp_server@',
      VAR_MAIL_FROM='@mail_from@',
      VAR_USERNAME_SMTP='@username@',
      VAR_PASSWORD_SMTP='@password@',
      VAR_PORT_SMTP='@port@',
      CHA_SSL='@ssl@'
      WHERE ID_AMM='@idAmm@'
    </value>
  </query>
  <query>
    <name>S_CONS_REPORT_SINGOLA_AMM_1</name>
    <value>
      SELECT * FROM (
      SELECT p.var_codice, p.var_descrizione, p.cha_tipo_policy,
      (SELECT COUNT(DISTINCT TRUNC(data_esecuzione_policy)) FROM DPA_VERSAMENTI_POLICY WHERE ID_POLICY=P.SYSTEM_ID
      AND DATA_ESECUZIONE_POLICY @filtro_data@ ) AS NUM_ESECUZIONI_PERIODO,
      (SELECT COUNT(DISTINCT v.system_id) from dpa_versamento v, dpa_versamenti_policy vp where v.id_profile=vp.id_profile and vp.id_policy=p.system_id and v.cha_stato='C'
      AND vp.DATA_ESECUZIONE_POLICY @filtro_data@ ) as PRESI_CARICO,
      (SELECT COUNT(DISTINCT v.system_id) from dpa_versamento v, dpa_versamenti_policy vp where v.id_profile=vp.id_profile and vp.id_policy=p.system_id and v.cha_stato='R'
      AND vp.DATA_ESECUZIONE_POLICY @filtro_data@ ) as RIFIUTATI,
      (SELECT COUNT(DISTINCT v.system_id) from dpa_versamento v, dpa_versamenti_policy vp where v.id_profile=vp.id_profile and vp.id_policy=p.system_id and v.cha_stato='F'
      AND vp.DATA_ESECUZIONE_POLICY @filtro_data@ ) as FALLITI,
      (SELECT COUNT(DISTINCT v.system_id) from dpa_versamento v, dpa_versamenti_policy vp where v.id_profile=vp.id_profile and vp.id_policy=p.system_id and (v.cha_stato != 'C' and v.cha_stato != 'R' and v.cha_stato != 'F' )
      AND vp.DATA_ESECUZIONE_POLICY @filtro_data@ ) as ALTRI,
      (SELECT COUNT(DISTINCT v.system_id) from dpa_versamento v, dpa_versamenti_policy vp where v.id_profile=vp.id_profile and vp.id_policy=p.system_id
      AND vp.DATA_ESECUZIONE_POLICY @filtro_data@ ) as TOT
      FROM dpa_policy_parer p, dpa_esecuzione_policy_parer e, dpa_amministra a
      WHERE p.system_id=e.id_policy
      AND a.system_id=p.id_amm
      AND p.cha_tipo_policy='D'
      AND e.num_esecuzioni>0
      AND a.system_id=@id_amm@
      ORDER BY a.var_desc_amm, p.var_codice
      ) TAB WHERE TAB.NUM_ESECUZIONI_PERIODO > 0
    </value>
  </query>
  <query>
    <name>S_CONS_REPORT_SINGOLA_AMM_2</name>
    <value>
      SELECT DISTINCT b.id_profile, b.cha_stato,
      TO_CHAR(b.dta_invio, 'DD/MM/YYYY') as data_invio,
      xmltype(b.var_file_risposta).extract('//EsitoVersamento/EsitoGenerale/CodiceErrore/text()').getstringval() as codice_errore,
      xmltype(b.var_file_risposta).extract('//EsitoVersamento/EsitoGenerale/MessaggioErrore/text()').getstringval() as messaggio_errore
      from profile a, dpa_versamento b, dpa_amministra d, dpa_versamenti_policy c
      where a.system_id=b.id_profile
      and b.cha_stato='R'
      and b.id_amm=d.system_id
      and d.system_id=@id_amm@
      and c.id_profile=b.id_profile
      and c.data_esecuzione_policy @filtro_data@
      UNION
      SELECT DISTINCT b.id_profile, b.cha_stato,
      TO_CHAR(b.dta_invio, 'DD/MM/YYYY') as data_invio,
      '' as codice_errore,
      '' as messaggio_errore
      from profile a, dpa_versamento b, dpa_amministra d, dpa_versamenti_policy c
      where a.system_id=b.id_profile
      and (b.cha_stato='E' or b.cha_stato='F')
      and b.id_amm=d.system_id
      and d.system_id=@id_amm@
      and c.id_profile=b.id_profile
      and c.data_esecuzione_policy @filtro_data@
      order by id_profile
    </value>
  </query>
  <!-- PORTALE PROCEDIMENTI -->
  <query>
    <name>I_DPA_PROCEDIMENTI</name>
    <value>
      INSERT INTO DPA_PROCEDIMENTI
      (ID_PROJECT, ID_PROFILE, CHA_PRINCIPALE, CHA_VISUALIZZATO, ID_CORR_GLOBALI, ID_ESTERNO)
      VALUES
      ('@idProject@', '@idProfile@','@docPrinc@','@visualizzato@', '@idCorrGlobali@', '@idProcedimento@')
    </value>
  </query>
  <query>
    <name>I_DPA_PROCEDIMENTI_FASI</name>
    <value>
      INSERT INTO DPA_ASS_PROCEDIMENTI_FASI
      (ID_PROJECT, ID_PHASE, ID_STATO, DTA_START)
      SELECT '@id_project@', ID_PHASES, ID_STATO, GETDATE()
      FROM DPA_ASSOCIAZIONE_STATI_PHASES
      WHERE ID_STATO='@id_stato@'
    </value>
  </query>
  <query>
    <name>U_DPA_PROCEDIMENTI</name>
    <value>
      UPDATE DPA_PROCEDIMENTI SET CHA_VISUALIZZATO='1', DATA_VISUALIZZAZIONE=SYSDATE()
      WHERE @cond@
    </value>
  </query>
  <query>
    <name>S_PROC_GET_DOC_NON_VISUALIZZATI</name>
    <value>
      SELECT P.ID_PROJECT, P.ID_ESTERNO, F.DESCRIPTION, COUNT(P.ID_PROFILE) AS UNREAD_DOCS
      FROM DPA_PROCEDIMENTI P, PROJECT F
      WHERE P.ID_CORR_GLOBALI=@idCorrGlobali@
      AND P.ID_PROJECT=F.SYSTEM_ID
      AND P.CHA_VISUALIZZATO='0'
      GROUP BY P.ID_PROJECT, P.ID_ESTERNO, F.DESCRIPTION
      ORDER BY P.ID_PROJECT
    </value>
  </query>
  <query>
    <name>S_GET_STATO_VIS_DOC_PROC</name>
    <value>
      SELECT CHA_VISUALIZZATO
      FROM DPA_PROCEDIMENTI
      WHERE ID_PROJECT=@id_procedimento@ AND ID_PROFILE=@id_doc@
    </value>
  </query>
  <query>
    <name>S_IS_FOLDER_IN_PROCEEDING</name>
    <value>
      SELECT COUNT(A.ID_PROJECT)
      FROM DPA_PROCEDIMENTI A, PROJECT B
      WHERE A.ID_PROJECT=B.ID_FASCICOLO
      AND B.SYSTEM_ID=@idFolder@
    </value>
  </query>
  <query>
    <name>S_GET_PROCEDIMENTO</name>
    <value>
      SELECT A.ID_PROJECT, A.CHA_PRINCIPALE, A.CHA_VISUALIZZATO, A.ID_CORR_GLOBALI, A.ID_PROFILE, A.ID_ESTERNO,
      TO_CHAR(A.DATA_VISUALIZZAZIONE, 'DD/MM/YYYY') AS DATA_VISUALIZZAZIONE,
      (SELECT P.DESCRIPTION FROM PROJECT P WHERE P.SYSTEM_ID=A.ID_PROJECT) AS DESCRIPTION
      FROM DPA_PROCEDIMENTI A
      @fromCond@
      WHERE @whereCond@
      ORDER BY A.CHA_PRINCIPALE DESC, A.ID_PROFILE
    </value>
  </query>
  <query>
    <name>S_PROCEDIMENTO_CAMBIO_STATO</name>
    <value>
      SELECT ID_STATO
      FROM DPA_CAMBIO_STATO_PROC
      WHERE TIPO_EVENTO='@evento@' AND ID_OGGETTO='@id_obj@'
    </value>
  </query>
  <query>
    <name>S_GET_PROCEDIMENTI_AMM</name>
    <value>
      SELECT DISTINCT C.VAR_DESC_FASC, C.SYSTEM_ID AS ID_PROC
      FROM PROJECT A, DPA_PROCEDIMENTI B, DPA_TIPO_FASC C
      WHERE A.SYSTEM_ID=B.ID_PROJECT AND A.ID_TIPO_FASC=C.SYSTEM_ID AND C.ID_AMM='@id_amm@'
    </value>
  </query>
  <query>
    <name>S_GET_PROCEDIMENTI_REPORT</name>
    <value>
      SELECT A.SYSTEM_ID AS ID_PROJECT,
      A.DESCRIPTION AS DESC_PROJECT,
      A.ID_TIPO_FASC, C.VAR_DESC_FASC,
      D.SYSTEM_ID AS ID_STATO, D.Var_descrizione AS DESC_STATO, D.Stato_iniziale, D.Stato_finale,
      E.SYSTEM_ID AS ID_FASE, E.DESCRIPTION AS DESC_FASE, B.DTA_START
      FROM PROJECT A, DPA_ASS_PROCEDIMENTI_FASI B, DPA_TIPO_FASC C, DPA_STATI D, DPA_PHASES E
      WHERE A.SYSTEM_ID = B.ID_PROJECT AND A.ID_TIPO_FASC = C.SYSTEM_ID AND B.ID_STATO = D.SYSTEM_ID AND B.ID_PHASE = E.SYSTEM_ID
      @filters@
      ORDER BY A.SYSTEM_ID, B.DTA_START
    </value>
  </query>
  <query>
    <name>S_GET_FASI_DIAGRAMMA</name>
    <value>
      SELECT DISTINCT B.SYSTEM_ID AS ID_FASE, B.DESCRIPTION, A.POSITION_PHASE
      FROM DPA_ASSOCIAZIONE_STATI_PHASES A, DPA_PHASES B
      WHERE A.ID_PHASES = B.SYSTEM_ID AND A.ID_DIAGRAMMA = '@id_diagramma@'
      ORDER BY A.POSITION_PHASE
    </value>
  </query>
  <query>
    <name>S_ESITO_PROCEDIMENTO</name>
    <value>
      SELECT TOP 1 B.ESITO
      FROM DPA_ASS_PROCEDIMENTI_FASI A, DPA_ESITO_PROCEDIMENTO B
      WHERE A.ID_PROJECT='@id_project@' AND A.ID_STATO = B.ID_STATO
      ORDER BY A.DTA_START DESC
    </value>
  </query>
  <!-- fine PORTALE PROCEDIMENTI -->
  <query>
    <name>I_INFO_FIRMA_DIGITALE</name>
    <value>
      INSERT INTO DPA_INFO_FIRMA_DIGITALE
      (ID_PROFILE, VERSION_ID, DATA_APPOSIZIONE)
      VALUES
      ('@id_profile@', '@version_id@', GETDATE())
    </value>
  </query>
  <query>
    <name>S_DPA_CHECK_MAILBOX_REG_MAIL</name>
    <value>
      SELECT ID
      FROM DPA_CHECK_MAILBOX WITH(NOLOCK)
      WHERE IDREG=@idReg@ AND MAIL='@mail@' AND CONCLUDED = '0'
    </value>
  </query>
  <query>
    <name>S_UTENTI</name>
    <value>
      select SYSTEM_ID, USER_ID, FULL_NAME, VAR_NOME, VAR_COGNOME from PEOPLE
    </value>
  </query>
  <query>
    <name>S_UTENTI_OLD</name>
    <value>
      SELECT P.SYSTEM_ID AS SYSTEM_ID,
      P.USER_ID AS USER_ID,
      P.FULL_NAME AS FULL_NAME,
      P.VAR_NOME AS VAR_NOME,
      P.VAR_COGNOME AS VAR_COGNOME,
      A.SYSTEM_ID AS ID_AMM,
      A.VAR_CODICE_AMM AS CODICE_AMM
      FROM PEOPLE P, DPA_AMMINISTRA A
      WHERE P.ID_AMM = A.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>S_UTENTI_COUNT_AMMINISTRAZIONI_GROUP_BY_USER_ID</name>
    <value>
      SELECT USER_ID, COUNT(*) AS NUM_AMMINISTRAZIONI
      FROM PEOPLE
      GROUP BY USER_ID
    </value>
  </query>
  <query>
    <name>S_UTENTI_MIN_SYSTEM_ID_GROUP_BY_USER_ID</name>
    <value>
      SELECT USER_ID, MIN(SYSTEM_ID) AS MIN_SYSTEM_ID
      FROM PEOPLE
      GROUP BY USER_ID
    </value>
  </query>
  <query>
    <name>S_UTENTI_BY_ID_LIST_OLD</name>
    <value>
      SELECT SYSTEM_ID, USER_ID, FULL_NAME, VAR_NOME, VAR_COGNOME
      FROM PEOPLE p1
      WHERE SYSTEM_ID in
      (SELECT min(SYSTEM_ID)
      FROM PEOPLE
      GROUP BY USER_ID)
    </value>
  </query>
  <query>
    <name>S_UTENTI_BY_ID_LIST</name>
    <value>
      SELECT SYSTEM_ID, USER_ID, FULL_NAME, VAR_NOME, VAR_COGNOME
      FROM PEOPLE p1
      WHERE SYSTEM_ID in
      (SELECT min(SYSTEM_ID)
      FROM PEOPLE
      GROUP BY USER_ID)
    </value>
  </query>
  <!-- VISUALIZZATORE ESPI -->
  <query>
    <name>S_DPA_VISUALIZZA_ESPI</name>
    <value>
      SELECT * FROM DPA_VISUALIZZA_ESPI
      WHERE ID_AMM = @idAmm@
      AND USERNAME = '@userName@'
    </value>
  </query>
  <query>
    <name>I_DPA_VISUALIZZA_ESPI</name>
    <value>
      INSERT INTO DPA_VISUALIZZA_ESPI
      (ID_AMM, USERNAME, FLAG_VISUALIZZA_RISERVATI)
	VALUES
      (@idAmm@, '@username@', @visualizzaRiservati@)
    </value>
  </query>
  <query>
    <name>D_DPA_VISUALIZZA_ESPI</name>
    <value>
      DELETE FROM DPA_VISUALIZZA_ESPI
      WHERE ID_AMM = @idAmm@
      AND USERNAME = '@username@'
    </value>
  </query>
  <query>
    <name>U_DPA_VISUALIZZA_ESPI_SET_RISERVATI</name>
    <value>
      UPDATE DPA_VISUALIZZA_ESPI
      SET FLAG_VISUALIZZA_RISERVATI = @visualizzaRiservati@
      WHERE ID_AMM = @idAmm@
      AND USERNAME = '@username@'
    </value>
  </query>
  <query>
    <name>S_AMM_LIST_ESPI</name>
    <value>
      SELECT VE.ID_AMM, VE.USERNAME, VE.FLAG_VISUALIZZA_RISERVATI,
      --CONCAT(A.VAR_CODICE_AMM, ' - ', A.VAR_DESC_AMM) AS DESCRIZIONE
      A.VAR_CODICE_AMM
      FROM DPA_VISUALIZZA_ESPI VE, DPA_AMMINISTRA A
      WHERE VE.ID_AMM = A.SYSTEM_ID
      AND VE.USERNAME = '@userName@'
    </value>
  </query>
  <query>
    <name>S_UTENTI_BY_AOO_ESPI_OLD</name>
    <value>
      SELECT * FROM DPA_VISUALIZZA_ESPI WHERE ID_AMM = @idAmm@
    </value>
  </query>
  <query>
    <name>S_UTENTI_BY_AOO_ESPI_OLD2</name>
    <value>
      SELECT VE.ID_AMM, VE.USERNAME, VE.FLAG_VISUALIZZA_RISERVATI,
      CONCAT(A.VAR_CODICE_AMM, ' - ', A.VAR_DESC_AMM) AS DESCRIZIONE
      FROM DPA_VISUALIZZA_ESPI VE, DPA_AMMINISTRA A
      WHERE VE.ID_AMM = A.SYSTEM_ID
      AND VE.ID_AMM = @idAmm@
    </value>
  </query>
  <query>
    <name>S_UTENTI_BY_AOO_ESPI</name>
    <value>
      SELECT P.SYSTEM_ID, VE.ID_AMM, VE.USERNAME, VE.FLAG_VISUALIZZA_RISERVATI,
      CONCAT(A.VAR_CODICE_AMM, ' - ', A.VAR_DESC_AMM) AS DESCRIZIONE
      FROM DPA_VISUALIZZA_ESPI VE, DPA_AMMINISTRA A, PEOPLE P
      WHERE VE.ID_AMM = A.SYSTEM_ID
      AND P.USER_ID = VE.USERNAME
      AND VE.ID_AMM = @idAmm@
      AND P.SYSTEM_ID in
      (SELECT min(SYSTEM_ID)
      FROM PEOPLE
      GROUP BY USER_ID)
    </value>
  </query>
  <query>
    <name>S_ALL_AMMINISTRAZIONI</name>
    <value>
      SELECT SYSTEM_ID, VAR_CODICE_AMM, VAR_DESC_AMM FROM DPA_AMMINISTRA
    </value>
  </query>
  <query>
    <name>S_AOO_USER_ASSOCIATION</name>
    <value>
      SELECT VE.ID_AMM, A.VAR_CODICE_AMM, VE.USERNAME, VE.FLAG_VISUALIZZA_RISERVATI
      FROM DPA_VISUALIZZA_ESPI VE, DPA_AMMINISTRA A
      WHERE VE.ID_AMM = A.SYSTEM_ID
      AND VE.ID_AMM = @idAmm@
      AND VE.USERNAME = '@userName@'
    </value>
  </query>
  <!-- FINE VISUALIZZATORE ESPI -->
  <query>
    <name>I_DETTAGLI_SEGNATURA_PROFILE</name>
    <value>
      INSERT INTO
      [DPA_SEG_PERM]
      (
      [PROFILE_ID],
      [VERSION_ID],
      [VAR_SEGNATURA_PROTOCOLLO],
      [VAR_SEGNATURA_REPERTORIO],
      [VAR_SEGNATURA_NP],
      [CHA_PERMANENTE_PROTOCOLLO],
      [CHA_PERMANENTE_REPERTORIO],
      [CHA_PERMANENTE_NP],
      [CHA_SEGNATO]
      )
      VALUES
      (
      @id_profile@,
      @id_versione@,
      '@segnatura_protocollo@',
      '@segnatura_repertorio@',
      '@segnatura_np@',
      '@is_permenente_protocollo@',
      '@is_permenente_repertorio@',
      '@is_permenente_np@',
      '@is_segnato@'
      )
    </value>
  </query>
  <query>
    <name>S_GET_DETTAGLIO_SEGNATURA_PROFILE</name>
    <value>
      SELECT
      [SYSTEM_ID],
      [PROFILE_ID],
      [VERSION_ID],
      [VAR_SEGNATURA_PROTOCOLLO],
      [VAR_SEGNATURA_REPERTORIO],
      [VAR_SEGNATURA_NP],
      [CHA_PERMANENTE_PROTOCOLLO],
      [CHA_PERMANENTE_REPERTORIO],
      [CHA_PERMANENTE_NP],
      [CHA_SEGNATO]
      FROM [DPA_SEG_PERM]
      WHERE [PROFILE_ID] = @id_profile@
      ORDER BY VERSION_ID DESC
    </value>
  </query>
  <query>
    <name>U_DETTAGLIO_SEGNATURA_SET_SEGNATO</name>
    <value>
      UPDATE
      [DPA_SEG_PERM]
      SET [CHA_SEGNATO] = 1
      WHERE [PROFILE_ID] = @id_profile@
    </value>
  </query>
  <query>
    <name>U_DETTAGLIO_SEGNATURA_SET_POSITION</name>
    <value>
      UPDATE
      [DPA_SEG_PERM_POSITION]
      SET [SEGNATURA_POSITION] = '@position@'
      WHERE [PROFILE_ID] = @id_profile@
    </value>
  </query>
  <query>
    <name>S_IS_SEGNATURA_REPERTORIO_PERMANENTE</name>
    <value>
      SELECT
      OC.CHA_PERMANENTE as IS_PERMANENTE
      FROM
      [DPA_ASSOCIAZIONE_TEMPLATES] AT,
      [DPA_OGGETTI_CUSTOM] OC,
      [DPA_TIPO_ATTO] TA
      WHERE
      AT.Doc_Number = '@doc_number@' AND
      AT.ID_OGGETTO = OC.SYSTEM_ID AND
      OC.REPERTORIO = 1 AND
      AT.ID_TEMPLATE = TA.SYSTEM_ID
    </value>
  </query>
  <query>
    <name>I_DETTAGLIOSEGNATURAPOSITION_INSERT</name>
    <value>
      INSERT INTO [DOCSADM].[DPA_SEG_PERM_POSITION]
      (
      [PROFILE_ID]
      ,[SEGNATURA_POSITION]
      )
      VALUES
      (
      @id_profile@
      ,'@position@'
      )
    </value>
  </query>
  <query>
    <name>S_GET_DETTAGLIOSEGNATURAPOSITION</name>
    <value>
      SELECT
      [SYSTEM_ID]
      ,[PROFILE_ID]
      ,[SEGNATURA_POSITION]
      FROM
      [DOCSADM].[DPA_SEG_PERM_POSITION]
      WHERE
      [PROFILE_ID] = @profile_id@
    </value>
  </query>
  <query>
    <name>U_PROFILE_UPDATE_SEGNATURA</name>
    <value>
      UPDATE
      [PROFILE]
      SET [VAR_SEGNATURA] = '@segnatura@',
      DOCNAME = '@segnatura@'
      WHERE
      SYSTEM_ID = @system_id@
    </value>
  </query>
</listeQuery>

